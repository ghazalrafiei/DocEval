['text':'!/usr/bin/env python','line_number':1,'multiline':False]
['text':' coding=utf-8','line_number':2,'multiline':False]
['text':' Copyright 2020 The HuggingFace Inc. team. All rights reserved.','line_number':3,'multiline':False]
['text':'','line_number':4,'multiline':False]
['text':' Licensed under the Apache License, Version 2.0 (the "License");','line_number':5,'multiline':False]
['text':' you may not use this file except in compliance with the License.','line_number':6,'multiline':False]
['text':' You may obtain a copy of the License at','line_number':7,'multiline':False]
['text':'','line_number':8,'multiline':False]
['text':'     http://www.apache.org/licenses/LICENSE-2.0','line_number':9,'multiline':False]
['text':'','line_number':10,'multiline':False]
['text':' Unless required by applicable law or agreed to in writing, software','line_number':11,'multiline':False]
['text':' distributed under the License is distributed on an "AS IS" BASIS,','line_number':12,'multiline':False]
['text':' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.','line_number':13,'multiline':False]
['text':' See the License for the specific language governing permissions and','line_number':14,'multiline':False]
['text':' limitations under the License.','line_number':15,'multiline':False]
['text':' You can also adapt this script on your own text classification task. Pointers for this are left as comments.','line_number':17,'multiline':False]
['text':' Will error if the minimal version of Transformers is not installed. Remove at your own risks.','line_number':50,'multiline':False]
['text':' region Command-line arguments','line_number':68,'multiline':False]
['text':' endregion','line_number':195,'multiline':False]
['text':' region Argument parsing','line_number':199,'multiline':False]
['text':' See all possible arguments in src/transformers/training_args.py','line_number':200,'multiline':False]
['text':' or by passing the --help flag to this script.','line_number':201,'multiline':False]
['text':' We now keep distinct sets of args, for a cleaner separation of concerns.','line_number':202,'multiline':False]
['text':' If we pass only one argument to the script and it's the path to a json file,','line_number':206,'multiline':False]
['text':' let's parse it to get our arguments.','line_number':207,'multiline':False]
['text':' Sending telemetry. Tracking the example usage helps us better allocate resources to maintain them. The','line_number':221,'multiline':False]
['text':' information sent is the one passed as arguments along with your Python/PyTorch versions.','line_number':222,'multiline':False]
['text':' endregion','line_number':227,'multiline':False]
['text':' region Checkpoints','line_number':229,'multiline':False]
['text':' endregion','line_number':243,'multiline':False]
['text':' region Logging','line_number':245,'multiline':False]
['text':' Set the verbosity to info of the Transformers logger (on main process only):','line_number':253,'multiline':False]
['text':' endregion','line_number':259,'multiline':False]
['text':' region Dataset and labels','line_number':261,'multiline':False]
['text':' Set seed before initializing model.','line_number':262,'multiline':False]
['text':' Downloading and loading a dataset from the hub. In distributed training, the load_dataset function guarantee','line_number':265,'multiline':False]
['text':' that only one local process can concurrently download the dataset.','line_number':266,'multiline':False]
['text':' See more about loading any type of standard or custom dataset at','line_number':273,'multiline':False]
['text':' https://huggingface.co/docs/datasets/loading_datasets.','line_number':274,'multiline':False]
['text':' Loading a dataset from local csv files','line_number':292,'multiline':False]
['text':' Loading a dataset from local json files','line_number':295,'multiline':False]
['text':' endregion','line_number':301,'multiline':False]
['text':' region Load model config and tokenizer','line_number':303,'multiline':False]
['text':'','line_number':304,'multiline':False]
['text':' In distributed training, the .from_pretrained methods guarantee that only one local process can concurrently','line_number':305,'multiline':False]
['text':' download model & vocab.','line_number':306,'multiline':False]
['text':' endregion','line_number':324,'multiline':False]
['text':' region Dataset preprocessing','line_number':326,'multiline':False]
['text':' Padding strategy','line_number':329,'multiline':False]
['text':' We will pad later, dynamically at batch creation, to the max sequence length in each batch','line_number':333,'multiline':False]
['text':' Some models have set the order of the labels to use, so let's make sure we do use it.','line_number':336,'multiline':False]
['text':' Some have all caps in their config, some don't.','line_number':339,'multiline':False]
['text':' Tokenize the texts','line_number':365,'multiline':False]
['text':' endregion','line_number':379,'multiline':False]
['text':' region Metric function','line_number':381,'multiline':False]
['text':' endregion','line_number':392,'multiline':False]
['text':' region Load pretrained model','line_number':395,'multiline':False]
['text':' endregion','line_number':408,'multiline':False]
['text':' region Convert data to a tf.data.Dataset','line_number':410,'multiline':False]
['text':' model.prepare_tf_dataset() wraps a Hugging Face dataset in a tf.data.Dataset which is ready to use in','line_number':440,'multiline':False]
['text':' training. This is the recommended way to use a Hugging Face dataset when training with Keras. You can also','line_number':441,'multiline':False]
['text':' use the lower-level dataset.to_tf_dataset() method, but you will have to specify things like column names','line_number':442,'multiline':False]
['text':' yourself if you use this method, whereas they are automatically inferred from the model input names when','line_number':443,'multiline':False]
['text':' using model.prepare_tf_dataset()','line_number':444,'multiline':False]
['text':' For more info see the docs:','line_number':445,'multiline':False]
['text':' https://huggingface.co/docs/transformers/main/en/main_classes/model#transformers.TFPreTrainedModel.prepare_tf_dataset','line_number':446,'multiline':False]
['text':' https://huggingface.co/docs/datasets/main/en/package_reference/main_classes#datasets.Dataset.to_tf_dataset','line_number':447,'multiline':False]
['text':' endregion','line_number':457,'multiline':False]
['text':' region Optimizer, loss and compilation','line_number':459,'multiline':False]
['text':' Just write anything because we won't be using it','line_number':480,'multiline':False]
['text':' Transformers models compute the right loss for their task by default when labels are passed, and will','line_number':485,'multiline':False]
['text':' use this for training unless you specify your own loss function in compile().','line_number':486,'multiline':False]
['text':' endregion','line_number':488,'multiline':False]
['text':' region Preparing push_to_hub and model card','line_number':490,'multiline':False]
['text':' endregion','line_number':511,'multiline':False]
['text':' region Training and validation','line_number':513,'multiline':False]
['text':' Do both evaluation and training in the Keras fit loop, unless the task is MNLI','line_number':516,'multiline':False]
['text':' because MNLI has two validation sets','line_number':517,'multiline':False]
['text':' endregion','line_number':527,'multiline':False]
['text':' region Evaluation','line_number':529,'multiline':False]
['text':' We normally do validation as part of the Keras fit loop, but we run it independently','line_number':531,'multiline':False]
['text':' if there was no fit() step (because we didn't train the model) or if the task is MNLI,','line_number':532,'multiline':False]
['text':' because MNLI has a separate validation-mismatched validation set','line_number':533,'multiline':False]
['text':' In this example, we compute advanced metrics only at the end of training, and only compute','line_number':535,'multiline':False]
['text':' loss and accuracy on the validation set each epoch, but','line_number':536,'multiline':False]
['text':' if you'd like to compute metrics every epoch that are too complex to be written as','line_number':537,'multiline':False]
['text':' standard Keras metrics, you can use our KerasMetricCallback. See','line_number':538,'multiline':False]
['text':' https://huggingface.co/docs/transformers/main/en/main_classes/keras_callbacks','line_number':539,'multiline':False]
['text':' Loop to handle MNLI double evaluation (matched, mis-matched)','line_number':542,'multiline':False]
['text':' endregion','line_number':562,'multiline':False]
['text':' region Prediction','line_number':564,'multiline':False]
['text':' Loop to handle MNLI double evaluation (matched, mis-matched)','line_number':568,'multiline':False]
['text':' endregion','line_number':608,'multiline':False]
['text':' If we're not pushing to hub, at least save a local copy when we're done','line_number':611,'multiline':False]
