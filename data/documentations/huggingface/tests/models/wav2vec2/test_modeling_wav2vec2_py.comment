['text':' coding=utf-8','line_number':1,'multiline':False]
['text':' Copyright 2021 The HuggingFace Inc. team. All rights reserved.','line_number':2,'multiline':False]
['text':'','line_number':3,'multiline':False]
['text':' Licensed under the Apache License, Version 2.0 (the "License");','line_number':4,'multiline':False]
['text':' you may not use this file except in compliance with the License.','line_number':5,'multiline':False]
['text':' You may obtain a copy of the License at','line_number':6,'multiline':False]
['text':'','line_number':7,'multiline':False]
['text':'     http://www.apache.org/licenses/LICENSE-2.0','line_number':8,'multiline':False]
['text':'','line_number':9,'multiline':False]
['text':' Unless required by applicable law or agreed to in writing, software','line_number':10,'multiline':False]
['text':' distributed under the License is distributed on an "AS IS" BASIS,','line_number':11,'multiline':False]
['text':' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.','line_number':12,'multiline':False]
['text':' See the License for the specific language governing permissions and','line_number':13,'multiline':False]
['text':' limitations under the License.','line_number':14,'multiline':False]
['text':' use a spawn pool, which should trigger a warning if different than fork','line_number':118,'multiline':False]
['text':' force batch_decode to internally create a spawn pool, which should trigger a warning if different than fork','line_number':125,'multiline':False]
['text':' speech is longer','line_number':145,'multiline':False]
['text':' this is most likely not correctly set yet','line_number':159,'multiline':False]
['text':' test does not pass for models making use of `group_norm`','line_number':310,'multiline':False]
['text':' check: https://github.com/pytorch/fairseq/issues/3227','line_number':311,'multiline':False]
['text':' pad input','line_number':321,'multiline':False]
['text':' make sure that dropout is disabled','line_number':339,'multiline':False]
['text':' pad input','line_number':349,'multiline':False]
['text':' make sure that dropout is disabled','line_number':367,'multiline':False]
['text':' pad input','line_number':376,'multiline':False]
['text':' freeze feature encoder','line_number':394,'multiline':False]
['text':' pad input','line_number':403,'multiline':False]
['text':' it's important that we make sure that target lengths are at least','line_number':408,'multiline':False]
['text':' one shorter than logit lengths to prevent -inf','line_number':409,'multiline':False]
['text':' freeze everything but the classification head','line_number':423,'multiline':False]
['text':' pad input','line_number':431,'multiline':False]
['text':' freeze everything but the classification head','line_number':446,'multiline':False]
['text':' pad input','line_number':454,'multiline':False]
['text':' Wav2Vec2 has no inputs_embeds','line_number':551,'multiline':False]
['text':' `input_ids` is renamed to `input_values`','line_number':555,'multiline':False]
['text':' Wav2Vec2 cannot resize token embeddings','line_number':559,'multiline':False]
['text':' since it has no tokens embeddings','line_number':560,'multiline':False]
['text':' Wav2Vec2 has no inputs_embeds','line_number':564,'multiline':False]
['text':' and thus the `get_input_embeddings` fn','line_number':565,'multiline':False]
['text':' is not implemented','line_number':566,'multiline':False]
['text':' non-robust architecture does not exist in Flax','line_number':571,'multiline':False]
['text':' non-robust architecture does not exist in Flax','line_number':576,'multiline':False]
['text':' no need to test all models as different heads yield the same functionality','line_number':585,'multiline':False]
['text':' set layer drop to 0','line_number':590,'multiline':False]
['text':' Encoder-/Decoder-only models','line_number':608,'multiline':False]
['text':' overwrite from test_modeling_common','line_number':654,'multiline':False]
['text':' Wav2Vec2 cannot be torchscripted because of group norm.','line_number':724,'multiline':False]
['text':' TODO: fix it','line_number':726,'multiline':False]
['text':' To be sure we have no Nan','line_number':732,'multiline':False]
['text':' Test that the model can be serialized and restored properly','line_number':803,'multiline':False]
['text':' Avoid memory leak. Without this, each call increase RAM usage by ~20MB.','line_number':823,'multiline':False]
['text':' (Even with this call, there are still memory leak by ~0.04MB)','line_number':824,'multiline':False]
['text':' Wav2Vec2 has no inputs_embeds','line_number':905,'multiline':False]
['text':' `input_ids` is renamed to `input_values`','line_number':909,'multiline':False]
['text':' Wav2Vec2 cannot resize token embeddings','line_number':913,'multiline':False]
['text':' since it has no tokens embeddings','line_number':914,'multiline':False]
['text':' Wav2Vec2 has no inputs_embeds','line_number':918,'multiline':False]
['text':' and thus the `get_input_embeddings` fn','line_number':919,'multiline':False]
['text':' is not implemented','line_number':920,'multiline':False]
['text':' no need to test all models as different heads yield the same functionality','line_number':929,'multiline':False]
['text':' set layer drop to 0','line_number':934,'multiline':False]
['text':' Encoder-/Decoder-only models','line_number':952,'multiline':False]
['text':' overwrite from test_modeling_common','line_number':998,'multiline':False]
['text':' more losses','line_number':1040,'multiline':False]
['text':' loss_more_masked has to be bigger or equal loss since more masked inputs have to be predicted','line_number':1052,'multiline':False]
['text':' test that loading adapter weights with mismatched vocab sizes can be loaded','line_number':1166,'multiline':False]
['text':' save safe weights','line_number':1235,'multiline':False]
['text':' save pt weights','line_number':1257,'multiline':False]
['text':' with these settings num_masked_spans=0.5, which means probabilistic rounding','line_number':1302,'multiline':False]
['text':' ensures that in 5 out of 10 method calls, num_masked_spans=0, and in','line_number':1303,'multiline':False]
['text':' the other 5 out of 10, cases num_masked_spans=1','line_number':1304,'multiline':False]
['text':' as we test for at least 10 masked dimension and at least','line_number':1325,'multiline':False]
['text':' 10 non-masked dimension, this test could fail with probability:','line_number':1326,'multiline':False]
['text':' P(100 coin flips, at most 9 heads) = 1.66e-18','line_number':1327,'multiline':False]
['text':' because of overlap mask don't have to add up exactly to `mask_prob * sequence_length`, but have to be smaller or equal','line_number':1340,'multiline':False]
['text':' force one example to be heavily padded','line_number':1370,'multiline':False]
['text':' make sure that non-padded examples cannot be padded','line_number':1377,'multiline':False]
['text':' mask half of the input','line_number':1386,'multiline':False]
['text':' each value in vector consits of same value','line_number':1401,'multiline':False]
['text':' sample negative indices','line_number':1404,'multiline':False]
['text':' make sure no negatively sampled vector is actually a positive one','line_number':1411,'multiline':False]
['text':' make sure that full vectors are sampled and not values of vectors => this means that `unique()` yields a single value for `hidden_size` dim','line_number':1415,'multiline':False]
['text':' second half of last input tensor is padded','line_number':1424,'multiline':False]
['text':' each value in vector consits of same value','line_number':1431,'multiline':False]
['text':' replace masked feature vectors with -100 to test that those are not sampled','line_number':1434,'multiline':False]
['text':' sample negative indices','line_number':1437,'multiline':False]
['text':' make sure no negatively sampled vector is actually a positive one','line_number':1449,'multiline':False]
['text':' make sure that full vectors are sampled and not values of vectors => this means that `unique()` yields a single value for `hidden_size` dim','line_number':1453,'multiline':False]
['text':' clean-up as much as possible GPU memory occupied by PyTorch','line_number':1463,'multiline':False]
['text':' automatic decoding with librispeech','line_number':1469,'multiline':False]
['text':' compute cosine similarity','line_number':1576,'multiline':False]
['text':' retrieve cosine sim of masked features','line_number':1579,'multiline':False]
['text':' cosine similarity of model is all > 0.5 as model is','line_number':1582,'multiline':False]
['text':' pre-trained on contrastive loss','line_number':1583,'multiline':False]
['text':' fmt: off','line_number':1584,'multiline':False]
['text':' fmt: on','line_number':1592,'multiline':False]
['text':' compute cosine similarity','line_number':1627,'multiline':False]
['text':' retrieve cosine sim of masked features','line_number':1630,'multiline':False]
['text':' ... now compare to randomly initialized model','line_number':1633,'multiline':False]
['text':' compute cosine similarity','line_number':1645,'multiline':False]
['text':' retrieve cosine sim of masked features','line_number':1650,'multiline':False]
['text':' a pretrained wav2vec2 model has learned to predict the quantized latent states','line_number':1653,'multiline':False]
['text':' => the cosine similarity between quantized states and predicted states > 0.5','line_number':1654,'multiline':False]
['text':' a random wav2vec2 model has not learned to predict the quantized latent states','line_number':1655,'multiline':False]
['text':' => the cosine similarity between quantized states and predicted states is very likely < 0.1','line_number':1656,'multiline':False]
['text':' check diversity loss','line_number':1706,'multiline':False]
['text':' check overall loss (contrastive loss + diversity loss)','line_number':1711,'multiline':False]
['text':' s3prl logits for the same batch','line_number':1729,'multiline':False]
['text':' s3prl logits for the same batch','line_number':1780,'multiline':False]
['text':' s3prl logits for the same batch','line_number':1799,'multiline':False]
['text':' should correspond to =>:','line_number':1831,'multiline':False]
['text':' [','line_number':1832,'multiline':False]
['text':' "a man said to the universe sir i exist",','line_number':1833,'multiline':False]
['text':' "sweat covered brion's body trickling into the tight loin cloth that was the only garment he wore",','line_number':1834,'multiline':False]
['text':' "the cut on his chest still dripping blood the ache of his overstrained eyes even the soaring arena around him with the thousands of spectators were trivialities not worth thinking about",','line_number':1835,'multiline':False]
['text':' "his instant panic was followed by a small sharp blow high on his chest",','line_number':1836,'multiline':False]
['text':' ]','line_number':1837,'multiline':False]
['text':' test user-managed pool','line_number':1884,'multiline':False]
['text':' user-managed pool + num_processes should trigger a warning','line_number':1890,'multiline':False]
['text':' labels is a one-hot array of shape (num_frames, num_speakers)','line_number':1916,'multiline':False]
['text':' s3prl logits for the same batch','line_number':1919,'multiline':False]
['text':' TODO: update the tolerance after the CI moves to torch 1.10','line_number':1931,'multiline':False]
['text':' id10002 vs id10002','line_number':1949,'multiline':False]
['text':' id10006 vs id10002','line_number':1951,'multiline':False]
['text':' id10002 vs id10004','line_number':1953,'multiline':False]
['text':' TODO: update the tolerance after the CI moves to torch 1.10','line_number':1956,'multiline':False]
