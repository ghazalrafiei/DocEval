['text':'*****************************************************************************
 * Copyright (c) 2023, Tri Dao.
 *****************************************************************************','line_number':1,'multiline':True]
['text':' The number of threads.','line_number':65,'multiline':False]
['text':' 4x1x1 or 8x1x1 thread group','line_number':79,'multiline':False]
['text':' 1x2x1 or 1x2x2 value group for 16x16x16 MMA and LDSM','line_number':80,'multiline':False]
['text':' This has to be kBlockKSmem, using kHeadDim gives wrong results for d=128','line_number':84,'multiline':False]
['text':' This has to be kBlockN and not 8, otherwise we get wrong results for d=128','line_number':97,'multiline':False]
['text':' Maybe the VtransposeNoSwizzle just needs to have the right shape','line_number':103,'multiline':False]
['text':' And the strides don't matter?','line_number':104,'multiline':False]
['text':' Using kBlockKSmem here is 6-10% faster than kBlockKGmem for d=128 because of bank conflicts.','line_number':124,'multiline':False]
['text':' For example, for d=128, smem is split into 2 "pages", each page takes care of columns','line_number':125,'multiline':False]
['text':' 0-63 and 64-127. If we have 16 threads per row for gmem read, when we write to smem,','line_number':126,'multiline':False]
['text':' thread 0 - 7 will write to the first page and thread 8 - 15 will write to the second page,','line_number':127,'multiline':False]
['text':' to the same banks.','line_number':128,'multiline':False]
['text':' We use CACHEGLOBAL instead of CACHEALWAYS for both Q and K/V, since we won't be reading','line_number':134,'multiline':False]
['text':' from the same address by the same threadblock. This is slightly faster.','line_number':135,'multiline':False]
['text':' Val layout, 8 vals per read','line_number':144,'multiline':False]
['text':' Val layout, 8 vals per store','line_number':148,'multiline':False]
['text':' Val layout, 8 vals per store','line_number':157,'multiline':False]
['text':' namespace pytorch_flash','line_number':160,'multiline':False]
['text':'//////////////////////////////////////////////////////////////////////////////////////////////////','line_number':161,'multiline':False]
