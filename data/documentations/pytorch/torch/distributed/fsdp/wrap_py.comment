['text':' Copyright (c) Facebook, Inc. and its affiliates.','line_number':1,'multiline':False]
['text':'','line_number':2,'multiline':False]
['text':' This source code is licensed under the BSD license found in the','line_number':3,'multiline':False]
['text':' LICENSE file in the root directory of this source tree.','line_number':4,'multiline':False]
['text':' NOTE: We intentionally keep this function simple and isolate the complexity','line_number':38,'multiline':False]
['text':' to `fn` to enable using this function generically. We may move this to a','line_number':39,'multiline':False]
['text':' non-FSDP-specific folder and/or make it public in the future.','line_number':40,'multiline':False]
['text':' Track visited modules to avoid visiting shared modules multiple times','line_number':52,'multiline':False]
['text':' Explicitly avoid wrapping the root module since for FSDP, it is','line_number':94,'multiline':False]
['text':' handled by the caller','line_number':95,'multiline':False]
['text':' This policy overrides any existing policy','line_number':116,'multiline':False]
['text':' Only inherit from the root kwargs if not already specified','line_number':118,'multiline':False]
['text':' always recurse','line_number':181,'multiline':False]
['text':' Shallow copy to avoid coupling changes across modules','line_number':208,'multiline':False]
['text':' nonwrapped_numel is not used.','line_number':213,'multiline':False]
['text':' Override the root kwargs with the ones specified by the','line_number':270,'multiline':False]
['text':' lambda function','line_number':271,'multiline':False]
['text':' always recurse','line_number':301,'multiline':False]
['text':' always recurse','line_number':324,'multiline':False]
['text':' if not recursing, decide whether we should wrap based on whether the type of module','line_number':327,'multiline':False]
['text':' is in `module_classes`.','line_number':328,'multiline':False]
['text':' Additional custom arguments','line_number':352,'multiline':False]
['text':' type: ignore[attr-defined]','line_number':380,'multiline':False]
['text':' type: ignore[attr-defined]','line_number':385,'multiline':False]
['text':' Keep the argument `min_num_params` for BC for now, but it represents the','line_number':390,'multiline':False]
['text':' minimum non-wrapped *numel* before triggering a wrapping','line_number':391,'multiline':False]
['text':' We should recurse if the module is big enough but not in force_leaf_modules list.','line_number':395,'multiline':False]
['text':' If we are not recursing, determine if we should wrap.','line_number':398,'multiline':False]
['text':' Set those defaults to the size_based_auto_wrap_policy function. Make them easy to be imported.','line_number':402,'multiline':False]
['text':' type: ignore[attr-defined]','line_number':403,'multiline':False]
['text':' type: ignore[attr-defined]','line_number':404,'multiline':False]
['text':' If module has a _wrap_overrides attribute, we force overriding the','line_number':483,'multiline':False]
['text':' FSDP config with these attributes for this module. Currently this','line_number':484,'multiline':False]
['text':' is only used to disable mixed precision for BatchNorm when','line_number':485,'multiline':False]
['text':' auto_wrapping.','line_number':486,'multiline':False]
['text':' type: ignore[arg-type]','line_number':487,'multiline':False]
['text':' Make sure no child is already wrapped.','line_number':521,'multiline':False]
['text':' wrapper_cls is a function as opposed to a class type, just bypass above check.','line_number':528,'multiline':False]
['text':' We count all params, assuming none of them are already wrapped.','line_number':531,'multiline':False]
['text':' Iterate through the children, recursively wrap if necessary','line_number':539,'multiline':False]
['text':' Keep track of how many parameters have been wrapped','line_number':552,'multiline':False]
['text':' decide if we need to wrap the current module,','line_number':554,'multiline':False]
['text':' since the left over parameters exceed the number of params to wrap','line_number':555,'multiline':False]
['text':' Leaf node or final wrapping of the remainder both happen here.','line_number':560,'multiline':False]
['text':' Context flag','line_number':573,'multiline':False]
['text':' The wrapper class','line_number':574,'multiline':False]
['text':' Wrapper's args','line_number':575,'multiline':False]
['text':' Get and save the wrapper cls for the context.','line_number':587,'multiline':False]
['text':' Save the rest.','line_number':593,'multiline':False]
