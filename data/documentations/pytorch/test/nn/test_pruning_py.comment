['text':' Owner(s): ["module: nn"]','line_number':1,'multiline':False]
['text':' torch/nn/utils/prune.py','line_number':18,'multiline':False]
['text':' neither float not int should raise TypeError','line_number':30,'multiline':False]
['text':' float not in [0, 1] should raise ValueError','line_number':34,'multiline':False]
['text':' negative int should raise ValueError','line_number':40,'multiline':False]
['text':' all these should pass without errors because they're valid amounts','line_number':44,'multiline':False]
['text':' if amount is int and amount > tensor_size, raise ValueError','line_number':62,'multiline':False]
['text':' amount is a float so this should not raise an error','line_number':66,'multiline':False]
['text':' this is okay','line_number':69,'multiline':False]
['text':' if 1 is int, means 1 unit','line_number':88,'multiline':False]
['text':' if 1. is float, means 100% of units','line_number':93,'multiline':False]
['text':' fixturize test','line_number':109,'multiline':False]
['text':' TODO: add other modules','line_number':110,'multiline':False]
['text':' mask has the same size as tensor being pruned','line_number':120,'multiline':False]
['text':' 'orig' tensor has the same size as the original tensor','line_number':125,'multiline':False]
['text':' new tensor has the same size as the original tensor','line_number':130,'multiline':False]
['text':' fixturize test','line_number':141,'multiline':False]
['text':' TODO: add other modules','line_number':142,'multiline':False]
['text':' tensor prior to pruning','line_number':150,'multiline':False]
['text':' fixturize test','line_number':162,'multiline':False]
['text':' TODO: add other modules','line_number':163,'multiline':False]
['text':' tensor prior to pruning','line_number':170,'multiline':False]
['text':' weight = weight_orig * weight_mask','line_number':173,'multiline':False]
['text':' output prior to pruning','line_number':187,'multiline':False]
['text':' compute grad pre-pruning and check it's equal to all ones','line_number':189,'multiline':False]
['text':' don't grab pointer!','line_number':191,'multiline':False]
['text':' remove grads','line_number':196,'multiline':False]
['text':' force the mask to be made of all 1s','line_number':199,'multiline':False]
['text':' with mask of 1s, output should be identical to no mask','line_number':202,'multiline':False]
['text':' with mask of 1s, grad should be identical to no mask','line_number':206,'multiline':False]
['text':' calling forward twice in a row shouldn't change output','line_number':211,'multiline':False]
['text':' output prior to pruning','line_number':221,'multiline':False]
['text':' compute grad pre-pruning and check it's equal to all ones','line_number':223,'multiline':False]
['text':' don't grab pointer!','line_number':225,'multiline':False]
['text':' remove grads','line_number':230,'multiline':False]
['text':' force the mask to be made of all 1s','line_number':233,'multiline':False]
['text':' amount won't count','line_number':238,'multiline':False]
['text':' with mask of 1s, output should be identical to no mask','line_number':240,'multiline':False]
['text':' with mask of 1s, grad should be identical to no mask','line_number':244,'multiline':False]
['text':' calling forward twice in a row shouldn't change output','line_number':249,'multiline':False]
['text':' define custom mask to assign with mock','line_number':258,'multiline':False]
['text':' check grad is zero for masked weights','line_number':263,'multiline':False]
['text':' weight_orig is the parameter, so it's the tensor that will accumulate the grad','line_number':272,'multiline':False]
['text':' all 1s, except for masked units','line_number':273,'multiline':False]
['text':' make sure that weight_orig update doesn't modify [1, 0] and [0, 3]','line_number':276,'multiline':False]
['text':' update weights','line_number':278,'multiline':False]
['text':' since these are pruned, they should not be updated','line_number':282,'multiline':False]
['text':' define custom mask to assign with mock','line_number':292,'multiline':False]
['text':' define custom mask to assign with mock','line_number':314,'multiline':False]
['text':' check grad is zero for masked weights','line_number':319,'multiline':False]
['text':' if you call pruning twice, the hook becomes a PruningContainer','line_number':360,'multiline':False]
['text':' save it for later sanity check','line_number':363,'multiline':False]
['text':' prune again','line_number':365,'multiline':False]
['text':' check that container._tensor_name is correctly set no matter how','line_number':372,'multiline':False]
['text':' many pruning methods are in the container','line_number':373,'multiline':False]
['text':' check that the pruning container has the right length','line_number':376,'multiline':False]
['text':' equal to the number of pruning iters','line_number':377,'multiline':False]
['text':' m.weight has been pruned twice','line_number':378,'multiline':False]
['text':' check that the entries of the pruning container are of the expected','line_number':380,'multiline':False]
['text':' type and in the expected order','line_number':381,'multiline':False]
['text':' check that all entries that are 0 in the 1st mask are 0 in the','line_number':385,'multiline':False]
['text':' 2nd mask too','line_number':386,'multiline':False]
['text':' prune again','line_number':389,'multiline':False]
['text':' check that container._tensor_name is correctly set no matter how','line_number':391,'multiline':False]
['text':' many pruning methods are in the container','line_number':392,'multiline':False]
['text':' create an empty container','line_number':397,'multiline':False]
['text':' test adding a pruning method to a container','line_number':405,'multiline':False]
['text':' test error raised if tensor name is different','line_number':408,'multiline':False]
['text':' test that adding a non-pruning method object to a pruning container','line_number':414,'multiline':False]
['text':' raises a TypeError','line_number':415,'multiline':False]
['text':' create an empty container','line_number':426,'multiline':False]
['text':' 1) test unstructured pruning','line_number':430,'multiline':False]
['text':' create a new pruning method','line_number':431,'multiline':False]
['text':' add the pruning method to the container','line_number':434,'multiline':False]
['text':' create tensor to be pruned','line_number':437,'multiline':False]
['text':' create prior mask by hand','line_number':439,'multiline':False]
['text':' since we are pruning the two lowest magnitude units, the outcome of','line_number':441,'multiline':False]
['text':' the calculation should be this:','line_number':442,'multiline':False]
['text':' 2) test structured pruning','line_number':447,'multiline':False]
['text':' since we are pruning the lowest magnitude one of the two rows, the','line_number':451,'multiline':False]
['text':' outcome of the calculation should be this:','line_number':452,'multiline':False]
['text':' 2) test structured pruning, along another axis','line_number':457,'multiline':False]
['text':' since we are pruning the lowest magnitude of the four columns, the','line_number':461,'multiline':False]
['text':' outcome of the calculation should be this:','line_number':462,'multiline':False]
['text':' modify its weight matrix by hand','line_number':473,'multiline':False]
['text':' check that pruning again removes the next two smallest entries','line_number':485,'multiline':False]
['text':' modify its weight matrix by hand','line_number':498,'multiline':False]
['text':' check that pruning again removes two entries of m.weight that are colocated with','line_number':513,'multiline':False]
['text':' the next two smallest absolute values of importance scores.','line_number':514,'multiline':False]
['text':' create a random tensors with entries in {-2, 0, 2}','line_number':528,'multiline':False]
['text':' check that 1 column is fully prune, the others are left untouched','line_number':546,'multiline':False]
['text':' expected effect of pruning 1 of the 3 channels by L2-norm','line_number':562,'multiline':False]
['text':' expected effect of pruning 1 of the 2 columns along axis -1 by L1-norm','line_number':569,'multiline':False]
['text':' expected effect of pruning 1 of the 3 channels by L2-norm','line_number':590,'multiline':False]
['text':' expected effect of pruning 1 of the 2 columns along axis -1 by L1-norm','line_number':597,'multiline':False]
['text':' first prune','line_number':614,'multiline':False]
['text':' then remove pruning','line_number':622,'multiline':False]
['text':' check that the module isn't pruned','line_number':640,'multiline':False]
['text':' since it isn't pruned, pruning can't be removed from it','line_number':642,'multiline':False]
['text':' modify the weight matrices by hand','line_number':653,'multiline':False]
['text':' prune the 4 smallest weights globally by L1 magnitude','line_number':668,'multiline':False]
['text':' modify the weight matrices by hand','line_number':688,'multiline':False]
['text':' prune the 4 smallest weights globally by L1 magnitude','line_number':711,'multiline':False]
['text':' new mask','line_number':731,'multiline':False]
['text':' old mask','line_number':733,'multiline':False]
['text':' some tensor (not actually used)','line_number':736,'multiline':False]
['text':' create a model','line_number':777,'multiline':False]
['text':' check that everything looks normal before pruning','line_number':783,'multiline':False]
['text':' prune one of its parameters','line_number':788,'multiline':False]
['text':' check that the original weight and the new mask are present','line_number':791,'multiline':False]
['text':' check that the original weight and the new mask are present','line_number':803,'multiline':False]
['text':' create a model','line_number':812,'multiline':False]
['text':' check that everything looks normal before pruning','line_number':818,'multiline':False]
['text':' prune one of its parameters','line_number':823,'multiline':False]
['text':' check that the original weight and the new mask are present','line_number':826,'multiline':False]
['text':' make pruning permanent and restore parameter names as in base','line_number':834,'multiline':False]
['text':' architecture','line_number':835,'multiline':False]
['text':' check that the original weight and the new mask are no longer present','line_number':838,'multiline':False]
['text':' save the state dict of model and reload it into new_model','line_number':843,'multiline':False]
['text':' check that the original weight and the new mask are not present in','line_number':853,'multiline':False]
['text':' new_model either.','line_number':854,'multiline':False]
['text':' create a new pruning method','line_number':862,'multiline':False]
['text':' create tensor to be pruned','line_number':864,'multiline':False]
['text':' create prior mask by hand','line_number':866,'multiline':False]
['text':' since we are pruning the two lowest magnitude units, the outcome of','line_number':868,'multiline':False]
['text':' the calculation should be this:','line_number':869,'multiline':False]
['text':' create a new pruning method','line_number':875,'multiline':False]
['text':' create tensor to be pruned','line_number':877,'multiline':False]
['text':' create prior mask by hand','line_number':882,'multiline':False]
['text':' since we are pruning the two lowest magnitude units, the outcome of','line_number':884,'multiline':False]
['text':' the calculation should be this:','line_number':885,'multiline':False]
['text':' create a new pruning method','line_number':891,'multiline':False]
['text':' create tensor to be pruned','line_number':893,'multiline':False]
['text':' create prior mask by hand','line_number':895,'multiline':False]
['text':' since we are pruning the two lowest magnitude units, the outcome of','line_number':897,'multiline':False]
['text':' the calculation should be this:','line_number':898,'multiline':False]
['text':' This Module has 4 parameters called:','line_number':907,'multiline':False]
['text':' 'weight_ih_l0', 'weight_hh_l0', 'bias_ih_l0', 'bias_hh_l0'','line_number':908,'multiline':False]
['text':' Pruning one of them causes one of the weights to become a tensor','line_number':910,'multiline':False]
['text':' Removing the pruning reparametrization restores the Parameter','line_number':917,'multiline':False]
['text':' Make sure that, upon removal of the reparametrization, the','line_number':924,'multiline':False]
['text':' `._parameters` and `.named_parameters` contain the right params.','line_number':925,'multiline':False]
['text':' Specifically, the original weight ('weight_ih_l0') should be placed','line_number':926,'multiline':False]
['text':' back in the parameters, while the reparametrization component','line_number':927,'multiline':False]
['text':' ('weight_ih_l0_orig') should be removed.','line_number':928,'multiline':False]
