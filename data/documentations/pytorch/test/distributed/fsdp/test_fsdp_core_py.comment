['text':' Owner(s): ["oncall: distributed"]','line_number':1,'multiline':False]
['text':' Note that CUDAInitMode.CUDA_NEVER works currently only with CPU','line_number':82,'multiline':False]
['text':' offload as we explicitly bring the param back to CUDA device. In','line_number':83,'multiline':False]
['text':' general, it will not work since we try to all_gather p.data which is','line_number':84,'multiline':False]
['text':' on CPU but NCCL only supports GPU.','line_number':85,'multiline':False]
['text':' `MixtureOfExperts`` implements custom gradient reduction logic, so','line_number':220,'multiline':False]
['text':' the reference behavior should follow that logic instead of DDP','line_number':221,'multiline':False]
['text':' Establish reference behavior','line_number':268,'multiline':False]
['text':' Initialize the same model but change its first parameter value','line_number':281,'multiline':False]
['text':' in-place after FSDP initialization','line_number':282,'multiline':False]
['text':' Inputs always cuda, as computation happens on CUDA device only','line_number':330,'multiline':False]
['text':' this is pre-bwd hook','line_number':333,'multiline':False]
['text':' It doesn't get removed','line_number':337,'multiline':False]
['text':' Since `_register_pre_backward_hooks()` modifies the forward output,','line_number':359,'multiline':False]
['text':' we cannot directly mock it. We implement our own counter instead.','line_number':360,'multiline':False]
['text':' Run a forward in eval mode','line_number':414,'multiline':False]
['text':' Run a forward in `no_grad()` and compare','line_number':417,'multiline':False]
['text':' Skip testing `NO_SHARD` since it doubly uses','line_number':438,'multiline':False]
['text':' `_use_unsharded_views()` for sharded views. Testing','line_number':439,'multiline':False]
['text':' `FULL_SHARD` and `SHARD_GRAD_OP` provides good confidence','line_number':440,'multiline':False]
['text':' that the `as_params` logic is correct.','line_number':441,'multiline':False]
['text':' Define a model with enough FSDP instances to exercise prefetching','line_number':479,'multiline':False]
