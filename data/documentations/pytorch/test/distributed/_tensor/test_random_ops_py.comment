['text':' Copyright (c) Meta Platforms, Inc. and affiliates','line_number':1,'multiline':False]
['text':' Owner(s): ["oncall: distributed"]','line_number':2,'multiline':False]
['text':' NOTE: currently random initialization on cuda device has different','line_number':33,'multiline':False]
['text':' behavior from other devices. Unify the test once the behavior is unified.','line_number':34,'multiline':False]
['text':' create DTensor from Tensor','line_number':45,'multiline':False]
['text':' DTensor random init','line_number':49,'multiline':False]
['text':' compare with local tensors from other ranks','line_number':53,'multiline':False]
['text':' other rank should have a different local tensor','line_number':62,'multiline':False]
['text':' seed synchronization happens after the first `distribute_tensor` call','line_number':92,'multiline':False]
['text':' test suite sets each rank's seed to the same value but in actual','line_number':110,'multiline':False]
['text':' execution the default random seed will be different (a random value).','line_number':111,'multiline':False]
['text':' The DTensor random ops will use the same random seed even though the','line_number':112,'multiline':False]
['text':' torch random generator keeps different seeds on ranks.','line_number':113,'multiline':False]
['text':' TODO: add test before/after enabling distribute region','line_number':115,'multiline':False]
['text':' a random op call shifts the offset','line_number':123,'multiline':False]
['text':' the dtensor is now replicate on all ranks','line_number':126,'multiline':False]
['text':' allgather the local tensors','line_number':132,'multiline':False]
['text':' compare with local tensors from other ranks','line_number':137,'multiline':False]
['text':' other rank should have an identical local tensor','line_number':141,'multiline':False]
['text':' compare with local tensors from other ranks','line_number':163,'multiline':False]
['text':' other rank should have an identical local tensor','line_number':167,'multiline':False]
['text':' compare with local tensors from other ranks','line_number':180,'multiline':False]
['text':' other rank should have an identical local tensor','line_number':184,'multiline':False]
['text':' this list of placements should be enough to cover','line_number':204,'multiline':False]
['text':' check shard information is correct','line_number':230,'multiline':False]
['text':' compute local size and offset','line_number':246,'multiline':False]
['text':' get the local shard size and local shard offset for each shard','line_number':251,'multiline':False]
['text':' local_shard_list_on_dim[i] has the list of all shards on that dim','line_number':252,'multiline':False]
['text':' as a tuple (local_shard_offset, local_shard_size)','line_number':253,'multiline':False]
['text':' random op call','line_number':274,'multiline':False]
['text':' the local shard','line_number':277,'multiline':False]
['text':' allgather the local tensors','line_number':279,'multiline':False]
['text':' compare local tensor with each other shard','line_number':282,'multiline':False]
['text':' test suite sets each rank's seed to the same value but in actual','line_number':296,'multiline':False]
['text':' execution the default random seed will be different (a random value).','line_number':297,'multiline':False]
['text':' The DTensor random ops will use the same random seed even though the','line_number':298,'multiline':False]
['text':' torch random generator keeps different seeds on ranks. This ensures','line_number':299,'multiline':False]
['text':' that Replicate DTensor will have the same initialized results','line_number':300,'multiline':False]
['text':' across ranks.','line_number':301,'multiline':False]
['text':' disable the distribute region for RNG','line_number':311,'multiline':False]
['text':' allgather the local tensors','line_number':315,'multiline':False]
['text':' compare with local tensors from other ranks','line_number':320,'multiline':False]
['text':' the RNG result on each rank differs even they're supposed','line_number':323,'multiline':False]
['text':' to be replicated','line_number':324,'multiline':False]
['text':' enable the distribute region for RNG','line_number':331,'multiline':False]
['text':' allgather the local tensors','line_number':337,'multiline':False]
['text':' compare with local tensors from other ranks','line_number':342,'multiline':False]
['text':' the RNG result on each rank are the same because they're replicated','line_number':344,'multiline':False]
['text':' other rank should have an identical local tensor','line_number':346,'multiline':False]
