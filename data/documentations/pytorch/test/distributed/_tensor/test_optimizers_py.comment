['text':' Owner(s): ["oncall: distributed"]','line_number':1,'multiline':False]
['text':' shard function to do full sharding on all parameters of a module','line_number':26,'multiline':False]
['text':' make sure partial sum get cleared after backward()','line_number':33,'multiline':False]
['text':' prepare input','line_number':40,'multiline':False]
['text':' split the input tensor to be sharded input','line_number':42,'multiline':False]
['text':' prepare output to be local torch.Tensor','line_number':47,'multiline':False]
['text':' run forward/backward/optim for original model','line_number':64,'multiline':False]
['text':' run forward/backward/optim for distributed model','line_number':71,'multiline':False]
['text':' check that the optimizer update parameters with same numerics','line_number':78,'multiline':False]
['text':' TODO: add fused_adam support','line_number':87,'multiline':False]
['text':' use ones to make sure the single machine model have the same input','line_number':112,'multiline':False]
['text':' on different ranks','line_number':113,'multiline':False]
['text':' TODO: add fused_adamw support','line_number':121,'multiline':False]
['text':' use ones to make sure the single machine model have the same input','line_number':154,'multiline':False]
['text':' on different ranks','line_number':155,'multiline':False]
['text':' use ones to make sure the single machine model have the same input','line_number':194,'multiline':False]
['text':' on different ranks','line_number':195,'multiline':False]
['text':' use ones to make sure the single machine model have the same input','line_number':248,'multiline':False]
['text':' on different ranks','line_number':249,'multiline':False]
['text':' use ones to make sure the single machine model have the same input','line_number':307,'multiline':False]
['text':' on different ranks','line_number':308,'multiline':False]
['text':' use ones to make sure the single machine model have the same input','line_number':347,'multiline':False]
['text':' on different ranks','line_number':348,'multiline':False]
['text':' use ones to make sure the single machine model have the same input','line_number':386,'multiline':False]
['text':' on different ranks','line_number':387,'multiline':False]
['text':' use ones to make sure the single machine model have the same input','line_number':425,'multiline':False]
['text':' on different ranks','line_number':426,'multiline':False]
