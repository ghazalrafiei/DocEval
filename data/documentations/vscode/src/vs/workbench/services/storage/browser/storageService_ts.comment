['text':'---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------','line_number':1,'multiline':True]
['text':' every 5s because async operations are not permitted on shutdown','line_number':24,'multiline':False]
['text':' Init storages','line_number':62,'multiline':False]
['text':' First clear any previously associated disposables','line_number':87,'multiline':False]
['text':' Remember profile associated to profile storage','line_number':90,'multiline':False]
['text':' If we are using default profile storage, the profile storage is','line_number':95,'multiline':False]
['text':' actually the same as application storage. As such we','line_number':96,'multiline':False]
['text':' avoid creating the storage library a second time on','line_number':97,'multiline':False]
['text':' the same DB.','line_number':98,'multiline':False]
['text':' Close old profile storage but only if this is','line_number':172,'multiline':False]
['text':' different from application storage!','line_number':173,'multiline':False]
['text':' Create new profile storage & init','line_number':178,'multiline':False]
['text':' Handle data switch and eventing','line_number':181,'multiline':False]
['text':' this flush() will potentially cause new state to be stored','line_number':190,'multiline':False]
['text':' since new state will only be created while the document','line_number':191,'multiline':False]
['text':' has focus, one optimization is to not run this when the','line_number':192,'multiline':False]
['text':' document has no focus, assuming that state has not changed','line_number':193,'multiline':False]
['text':'','line_number':194,'multiline':False]
['text':' another optimization is to not collect more state if we','line_number':195,'multiline':False]
['text':' have a pending update already running which indicates','line_number':196,'multiline':False]
['text':' that the connection is either slow or disconnected and','line_number':197,'multiline':False]
['text':' thus unhealthy.','line_number':198,'multiline':False]
['text':' Safari: there is an issue where the page can hang on load when','line_number':204,'multiline':False]
['text':' a previous session has kept IndexedDB transactions running.','line_number':205,'multiline':False]
['text':' The only fix seems to be to cancel any pending transactions','line_number':206,'multiline':False]
['text':' (https://github.com/microsoft/vscode/issues/136295)','line_number':207,'multiline':False]
['text':'','line_number':208,'multiline':False]
['text':' On all other browsers, we keep the databases opened because','line_number':209,'multiline':False]
['text':' we expect data to be written when the unload happens.','line_number':210,'multiline':False]
['text':' Always dispose to ensure that no timeouts or callbacks','line_number':217,'multiline':False]
['text':' get triggered in this phase.','line_number':218,'multiline':False]
['text':' Clear key/values','line_number':224,'multiline':False]
['text':' Clear databases','line_number':235,'multiline':False]
['text':'*
	 * Name of the database.
	 ','line_number':254,'multiline':True]
['text':'*
	 * Whether an update in the DB is currently pending
	 * (either update or delete operation).
	 ','line_number':259,'multiline':True]
['text':'*
	 * For testing only.
	 ','line_number':265,'multiline':True]
['text':' No-op','line_number':281,'multiline':False]
['text':' Check for storage change events from other','line_number':347,'multiline':False]
['text':' windows/tabs via `BroadcastChannel` mechanisms.','line_number':348,'multiline':False]
['text':' Run the update','line_number':380,'multiline':False]
['text':' Broadcast changes to other windows/tabs if enabled','line_number':389,'multiline':False]
['text':' and only if we actually did update storage items.','line_number':390,'multiline':False]
['text':' Return early if the request is empty','line_number':403,'multiline':False]
['text':' Update `ItemTable` with inserts and/or deletes','line_number':412,'multiline':False]
['text':' Inserts','line_number':416,'multiline':False]
['text':' Deletes','line_number':423,'multiline':False]
['text':' not suported in IndexedDB','line_number':437,'multiline':False]
['text':' Wait for pending updates to having finished','line_number':443,'multiline':False]
['text':' Finally, close IndexedDB','line_number':446,'multiline':False]
