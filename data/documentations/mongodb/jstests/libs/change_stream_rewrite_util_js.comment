['text':'*
 * Helper functions that are used in change streams rewrite test cases.
 ','line_number':1,'multiline':True]
['text':' Function which generates a write workload on the specified collection, including all events that','line_number':12,'multiline':False]
['text':' a change stream may consume. Assumes that the specified collection does not already exist.','line_number':13,'multiline':False]
['text':' If this is a sharded passthrough, make sure we shard on something other than _id so that a','line_number':16,'multiline':False]
['text':' non-id field appears in the documentKey. This will generate 'create' and 'shardCollection'.','line_number':17,'multiline':False]
['text':' If the collection hasn't already been created, do so here.','line_number':24,'multiline':False]
['text':' Build an index, collMod it, then drop it.','line_number':27,'multiline':False]
['text':' Modify the collection's validation options.','line_number':35,'multiline':False]
['text':' Change the validation options back.','line_number':43,'multiline':False]
['text':' Insert some documents.','line_number':51,'multiline':False]
['text':' Update half of them. We generate these updates individually so that they generate different','line_number':57,'multiline':False]
['text':' values for the 'updatedFields', 'removedFields' and 'truncatedArrays' subfields.','line_number':58,'multiline':False]
['text':' only populates 'updatedFields'','line_number':60,'multiline':False]
['text':' only populates 'removedFields'','line_number':61,'multiline':False]
['text':' only populates 'truncatedArrays'','line_number':62,'multiline':False]
['text':' populates all fields','line_number':63,'multiline':False]
['text':' Replace the other half.','line_number':70,'multiline':False]
['text':' Delete half of the updated documents.','line_number':75,'multiline':False]
['text':' Create, modify, and drop a view on the collection.','line_number':80,'multiline':False]
['text':' If the caller is prepared to handle potential invalidations, include the following events.','line_number':85,'multiline':False]
['text':' Rename the collection.','line_number':87,'multiline':False]
['text':' Rename it back.','line_number':92,'multiline':False]
['text':' Drop the collection.','line_number':96,'multiline':False]
['text':' Drop the database.','line_number':99,'multiline':False]
['text':' Helper function to fully exhaust a change stream from the specified point and return all events.','line_number':105,'multiline':False]
['text':' Assumes that all relevant events can fit into a single 16MB batch.','line_number':106,'multiline':False]
['text':' Open a whole-cluster stream based on the supplied arguments.','line_number':109,'multiline':False]
['text':' Run getMore until the post-batch resume token advances. In a sharded passthrough, this will','line_number':114,'multiline':False]
['text':' guarantee that all shards have returned results, and we expect all results to fit into a','line_number':115,'multiline':False]
['text':' single batch, so we know we have exhausted the stream.','line_number':116,'multiline':False]
['text':' runs a getMore','line_number':118,'multiline':False]
['text':' Close the cursor since we have already retrieved all results.','line_number':121,'multiline':False]
['text':' Extract all events from the streams. Since the cursor is closed, it will not attempt to','line_number':124,'multiline':False]
['text':' retrieve any more batches from the server.','line_number':125,'multiline':False]
['text':' Helper function to check whether this value is a plain old javascript object.','line_number':129,'multiline':False]
['text':' Verifies the number of change streams events returned from a particular shard.','line_number':134,'multiline':False]
['text':' Verifies the number of oplog events read by a particular shard.','line_number':149,'multiline':False]
['text':' Returns a newly created sharded collection sharded by caller provided shard key.','line_number':158,'multiline':False]
['text':' Shard the test collection and split it into two chunks: one that contains all {shardKey: <lt','line_number':169,'multiline':False]
['text':' splitAt>} documents and one that contains all {shardKey: <gte splitAt>} documents.','line_number':170,'multiline':False]
['text':' shard key ','line_number':173,'multiline':True]
['text':' split at ','line_number':174,'multiline':True]
['text':' move the chunk containing {shardKey: splitAt} to its own shard ','line_number':175,'multiline':True]
['text':' A helper that opens a change stream on the whole cluster with the user supplied match expression','line_number':181,'multiline':False]
['text':' 'userMatchExpr' and 'changeStreamSpec'. The helper validates that:','line_number':182,'multiline':False]
['text':' 1. for each shard, the events are seen in the order specified by 'expectedResult' which structure','line_number':183,'multiline':False]
['text':'    is { collOrDbName : { operationType : [eventIdentifier1, eventIdentifier2, ..], ... }, .. }.','line_number':184,'multiline':False]
['text':' 2. There are no additional events being returned other than the ones in the 'expectedResult'.','line_number':185,'multiline':False]
['text':' 3. the filtering is been done at oplog level, and each of the shard read only the','line_number':186,'multiline':False]
['text':' 'expectedOplogNReturnedPerShard' documents.','line_number':187,'multiline':False]
