['text':'
 * Test that a node in rollback state can safely be removed from the replica set
 * config via reconfig. See SERVER-48179.
 ','line_number':1,'multiline':True]
['text':' RollbackTest begins with a 3 node replSet in steady-state replication.','line_number':12,'multiline':False]
['text':' Isolate the current primary from the replica sets. Ops applied here will get rolled back.','line_number':18,'multiline':False]
['text':' Elect the previous secondary as the new primary.','line_number':22,'multiline':False]
['text':' Enable a failpoint to hang after transitioning to rollback mode.','line_number':26,'multiline':False]
['text':' Reconnect the isolated node and rollback should start.','line_number':30,'multiline':False]
['text':' The connection will be closed during rollback, so retries are needed here.','line_number':33,'multiline':False]
['text':' Enable a failpoint to hang after processing heartbeat reconfig, so we can','line_number':39,'multiline':False]
['text':' verify that the old primary was successfully removed while rolling back.','line_number':40,'multiline':False]
['text':' RollbackTest stopped replication on tie breaker node, need to restart it.','line_number':44,'multiline':False]
['text':' Otherwise the new config, which contains only the new primary and the tie','line_number':45,'multiline':False]
['text':' breaker, cannot be majority committed.','line_number':46,'multiline':False]
['text':' Now, we'll remove the node going through rollback from the replica set.','line_number':49,'multiline':False]
['text':' The new primary will then propagate the new config to the other nodes via heartbeat.','line_number':50,'multiline':False]
['text':' When the node in rollback processes a heartbeat from the primary with a new config,','line_number':51,'multiline':False]
['text':' it will learn it is removed and transition to the RS_REMOVED state.','line_number':52,'multiline':False]
['text':' Verify the rollback node is removed from replica set config.','line_number':65,'multiline':False]
['text':' Now we disable the fail points, allowing the rollback to continue.','line_number':69,'multiline':False]
['text':' Add the removed node back the replica set config, so that we can execute the last','line_number':73,'multiline':False]
['text':' step of the RollbackTest to transition back to steady state.','line_number':74,'multiline':False]
['text':' Verify the removed node is added back and primary sees its state as SECONDARY.','line_number':82,'multiline':False]
['text':' Transition back to steady state.','line_number':85,'multiline':False]
