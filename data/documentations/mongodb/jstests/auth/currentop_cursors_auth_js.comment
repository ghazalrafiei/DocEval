['text':'*
 * Tests that a user's ability to view open cursors via $currentOp obeys authentication rules on
 * both mongoD and mongoS.
 * @tags: [assumes_read_concern_unchanged, requires_auth, requires_replication]
 ','line_number':1,'multiline':True]
['text':' Create a new sharded cluster for testing and enable auth.','line_number':8,'multiline':False]
['text':' Create one root user and one regular user on the given connection.','line_number':20,'multiline':False]
['text':' Create the necessary users at both cluster and shard-local level.','line_number':34,'multiline':False]
['text':' grantDirectShardOperationsRole ','line_number':35,'multiline':True]
['text':' grantDirectShardOperationsRole ','line_number':36,'multiline':True]
['text':' Run the various auth tests on the given shard or mongoS connection.','line_number':38,'multiline':False]
['text':' Log in as the root user.','line_number':43,'multiline':False]
['text':' Verify that we can see our own cursor with {allUsers: false}.','line_number':53,'multiline':False]
['text':' Log in as the non-root user.','line_number':66,'multiline':False]
['text':' Verify that we cannot see the root user's cursor.','line_number':70,'multiline':False]
['text':' Make sure that the behavior is the same when 'allUsers' is not explicitly specified.','line_number':79,'multiline':False]
['text':' Verify that the user without the 'inprog' privilege cannot view shard cursors via mongoS.','line_number':88,'multiline':False]
['text':' Create a cursor with the second (non-root) user and confirm that we can see it.','line_number':98,'multiline':False]
['text':' Log back in with the root user and confirm that the first cursor is still present.','line_number':111,'multiline':False]
['text':' Confirm that the root user can see both users' cursors with {allUsers: true}.','line_number':123,'multiline':False]
['text':' The root user can also see both cursors on the shard via mongoS with {localOps: false}.','line_number':133,'multiline':False]
['text':' Clean up the cursors so that they don't affect subsequent tests.','line_number':144,'multiline':False]
['text':' Make sure to logout to allow __system user to use the implicit session.','line_number':148,'multiline':False]
