['text':' Check that OCSP verification works','line_number':1,'multiline':False]
['text':' @tags: [requires_http_client, requires_ocsp_stapling]','line_number':2,'multiline':False]
['text':' We're sleeping here to give the server enough time to fetch a new OCSP response','line_number':41,'multiline':False]
['text':' saying that it's revoked.','line_number':42,'multiline':False]
['text':' This ensures that the client was viewing a stapled response.','line_number':51,'multiline':False]
['text':' have the server refresh its response every 10 seconds','line_number':56,'multiline':False]
['text':' Have the OCSP server revoke the certificate. Clients should observe a refreshed stapled response','line_number':63,'multiline':False]
['text':' after ocspValidationRefreshPeriodSecs','line_number':64,'multiline':False]
['text':' the client should be trying to connect after its certificate has been revoked.','line_number':69,'multiline':False]
['text':' The mongoRunner spawns a new Mongo Object to validate the collections which races','line_number':73,'multiline':False]
['text':' with the shutdown logic of the mock_ocsp responder on some platforms. We need this','line_number':74,'multiline':False]
['text':' sleep to make sure that the threads don't interfere with each other.','line_number':75,'multiline':False]
['text':' Next, we're going to test that the server deletes its OCSP response before the','line_number':79,'multiline':False]
['text':' response expires.','line_number':80,'multiline':False]
['text':' If the server stapled an expired response, then the client would refuse to connect.','line_number':92,'multiline':False]
['text':' We now check that the server has not stapled a response.','line_number':93,'multiline':False]
['text':' Make sure that the refresh period is set to a very large value so that we can','line_number':99,'multiline':False]
['text':' make sure that the period defined by the mock OCSP responder overrides it.','line_number':100,'multiline':False]
['text':' Kill the ocsp responder, start it with cert revoked, and wait 20 seconds','line_number':119,'multiline':False]
['text':' so the server refreshes its stapled OCSP response.','line_number':120,'multiline':False]
['text':' By asserting here that a new connection cannot be established to the','line_number':127,'multiline':False]
['text':' mongod, we prove that the server has refreshed its stapled response sooner','line_number':128,'multiline':False]
['text':' than the refresh period indicated.','line_number':129,'multiline':False]
['text':' The mongoRunner spawns a new Mongo Object to validate the collections which races','line_number':134,'multiline':False]
['text':' with the shutdown logic of the mock_ocsp responder on some platforms. We need this','line_number':135,'multiline':False]
['text':' sleep to make sure that the threads don't interfere with each other.','line_number':136,'multiline':False]
