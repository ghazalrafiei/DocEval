['text':'','line_number':1,'multiline':False]
['text':' Utility functions for multi-version replica sets','line_number':2,'multiline':False]
['text':'','line_number':3,'multiline':False]
['text':' In a 2-node replica set the secondary can step up after a restart. In fact while the','line_number':6,'multiline':False]
['text':' secondary is being restarted, the primary may end up stepping down (due to heartbeats not','line_number':7,'multiline':False]
['text':' being received) and for the restarted node to run for and win the election.','line_number':8,'multiline':False]
['text':'*
 * Upgrade or downgrade replica sets.
 *
 * @param options {Object} see ReplSetTest.start & MongoRunner.runMongod.
 * @param user {string} optional, user name for authentication.
 * @param pwd {string} optional, password for authentication. Must be set if user is set.
 ','line_number':12,'multiline':True]
['text':' An election occured during upgrade, old primary is now a secondary.','line_number':37,'multiline':False]
['text':' Merge new options into node settings.','line_number':50,'multiline':False]
['text':' We don't support downgrading data files for arbiters. We need to instead delete the dbpath.','line_number':70,'multiline':False]
['text':' Make sure we don't set {startClean:true} on other nodes unless the user explicitly requested.','line_number':76,'multiline':False]
['text':' Merge new options into node settings.','line_number':89,'multiline':False]
['text':' waitForState() runs the logout command via asCluster() on either the current primary or the','line_number':97,'multiline':False]
['text':' first node in the replica set so we re-authenticate on all connections before calling','line_number':98,'multiline':False]
['text':' awaitNodesAgreeOnPrimary().','line_number':99,'multiline':False]
['text':' Must retry this command, as it might return "currently running for election" and fail.','line_number':135,'multiline':False]
['text':' Node might still be running for an election that will fail because it lost the election','line_number':136,'multiline':False]
['text':' race with another node, at test initialization.  See SERVER-23133.','line_number':137,'multiline':False]
['text':' Due to a rare race condition in stepdown, it's possible the secondary just replicated','line_number':167,'multiline':False]
['text':' the most recent write and sent replSetUpdatePosition to the primary, and that','line_number':168,'multiline':False]
['text':' replSetUpdatePosition command gets interrupted by the stepdown.  In that case,','line_number':169,'multiline':False]
['text':' the secondary will clear its sync source, but will be unable to re-connect to the','line_number':170,'multiline':False]
['text':' primary that is trying to step down, because they are at the same OpTime.  The primary','line_number':171,'multiline':False]
['text':' will then get stuck waiting forever for the secondary to catch up so it can complete','line_number':172,'multiline':False]
['text':' stepdown.  Adding a garbage write here ensures that the secondary will be able to','line_number':173,'multiline':False]
['text':' resume syncing from the primary in this case, which in turn will let the primary','line_number':174,'multiline':False]
['text':' finish stepping down successfully.','line_number':175,'multiline':False]
['text':' Skip the 'authenticated' property because the new connection hasn't been authenticated even','line_number':188,'multiline':False]
['text':' if the original one was. This ensures Mongo.prototype.getDB() will attempt to authenticate','line_number':189,'multiline':False]
['text':' automatically if TestData is configured appropriately.','line_number':190,'multiline':False]
['text':'','line_number':191,'multiline':False]
['text':' Skip the '_defaultSession' property because the DriverSession object is bound to the original','line_number':192,'multiline':False]
['text':' connection object. Copying the '_defaultSession' property would cause commands to go through','line_number':193,'multiline':False]
['text':' the original connection despite methods being called on DB objects from the new connection.','line_number':194,'multiline':False]
