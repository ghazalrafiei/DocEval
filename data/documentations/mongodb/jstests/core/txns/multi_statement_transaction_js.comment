['text':' Test basic multi-statement transaction.','line_number':1,'multiline':False]
['text':'','line_number':2,'multiline':False]
['text':' @tags: [','line_number':3,'multiline':False]
['text':'   # The test runs commands that are not allowed with security token: endSession.','line_number':4,'multiline':False]
['text':'   not_allowed_with_signed_security_token,','line_number':5,'multiline':False]
['text':'   uses_transactions','line_number':6,'multiline':False]
['text':' ]','line_number':7,'multiline':False]
['text':' TODO(SERVER-39704): Remove the following load after SERVER-39704 is completed','line_number':9,'multiline':False]
['text':'**********************************************************************************************
 * Insert two documents in a transaction.
 *********************************************************************************************','line_number':28,'multiline':True]
['text':' TODO(SERVER-39704): We use the withTxnAndAutoRetryOnMongos','line_number':36,'multiline':False]
['text':' function to handle how MongoS will propagate a StaleShardVersion error as a','line_number':37,'multiline':False]
['text':' TransientTransactionError. After SERVER-39704 is completed the','line_number':38,'multiline':False]
['text':' withTxnAndAutoRetryOnMongos function can be removed','line_number':39,'multiline':False]
['text':' Insert a doc within the transaction.','line_number':41,'multiline':False]
['text':' Cannot read with default read concern.','line_number':44,'multiline':False]
['text':' But read in the same transaction returns the doc.','line_number':46,'multiline':False]
['text':' Read with aggregation also returns the document.','line_number':49,'multiline':False]
['text':' Insert a doc within a transaction.','line_number':53,'multiline':False]
['text':' Cannot read with default read concern.','line_number':56,'multiline':False]
['text':' Cannot read with default read concern.','line_number':58,'multiline':False]
['text':' Read with default read concern sees the committed transaction.','line_number':62,'multiline':False]
['text':'**********************************************************************************************
 * Update documents in a transaction.
 *********************************************************************************************','line_number':66,'multiline':True]
['text':' Insert the docs to be updated.','line_number':74,'multiline':False]
['text':' Update the docs in a new transaction.','line_number':78,'multiline':False]
['text':' TODO(SERVER-39704): We use the withTxnAndAutoRetryOnMongos','line_number':80,'multiline':False]
['text':' function to handle how MongoS will propagate a StaleShardVersion error as a','line_number':81,'multiline':False]
['text':' TransientTransactionError. After SERVER-39704 is completed the','line_number':82,'multiline':False]
['text':' withTxnAndAutoRetryOnMongos function can be removed','line_number':83,'multiline':False]
['text':' Batch update in transaction.','line_number':87,'multiline':False]
['text':' Cannot read with default read concern.','line_number':93,'multiline':False]
['text':' Read with default read concern sees the committed transaction.','line_number':98,'multiline':False]
['text':'**********************************************************************************************
 * Insert, update and read documents in a transaction.
 *********************************************************************************************','line_number':102,'multiline':True]
['text':' TODO(SERVER-39704): We use the withTxnAndAutoRetryOnMongos','line_number':110,'multiline':False]
['text':' function to handle how MongoS will propagate a StaleShardVersion error as a','line_number':111,'multiline':False]
['text':' TransientTransactionError. After SERVER-39704 is completed the','line_number':112,'multiline':False]
['text':' withTxnAndAutoRetryOnMongos function can be removed','line_number':113,'multiline':False]
['text':' Update the two docs in transaction.','line_number':117,'multiline':False]
['text':' Cannot read with default read concern.','line_number':121,'multiline':False]
['text':' But read in the same transaction returns the docs.','line_number':125,'multiline':False]
['text':' Read with default read concern sees the committed transaction.','line_number':130,'multiline':False]
['text':' TODO(SERVER-39704): We use the withTxnAndAutoRetryOnMongos','line_number':141,'multiline':False]
['text':' function to handle how MongoS will propagate a StaleShardVersion error as a','line_number':142,'multiline':False]
['text':' TransientTransactionError. After SERVER-39704 is completed the','line_number':143,'multiline':False]
['text':' withTxnAndAutoRetryOnMongos function can be removed','line_number':144,'multiline':False]
['text':' Remove three docs in transaction.','line_number':148,'multiline':False]
['text':' Batch delete.','line_number':151,'multiline':False]
['text':' Cannot read the new doc and still see the to-be removed docs with default read concern.','line_number':157,'multiline':False]
['text':' But read in the same transaction sees the docs get deleted.','line_number':162,'multiline':False]
['text':' Read with default read concern sees the commmitted transaction.','line_number':167,'multiline':False]
