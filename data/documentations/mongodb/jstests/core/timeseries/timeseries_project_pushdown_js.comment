['text':'*
 * Test the behavior of $project with pipelines that require the whole document. Specifically, we
 * are targeting that rewrites for $project with $getField, or '$$ROOT'/'$$CURRENT' should only
 * occur in certain situations.
 *
 * @tags: [
 *   requires_timeseries,
 *   requires_fcv_72,
 * ]
 ','line_number':1,'multiline':True]
['text':'','line_number':28,'multiline':False]
['text':' The following tests confirm the behavior of queries in the form: {$getField: "fieldName"}.','line_number':29,'multiline':False]
['text':'','line_number':30,'multiline':False]
['text':' $getField does not traverse objects, and should not be rewritten when it relies on a mix of','line_number':39,'multiline':False]
['text':' metaField and measurement fields. Let's validate that behavior.','line_number':40,'multiline':False]
['text':' missing field.','line_number':45,'multiline':False]
['text':'','line_number':52,'multiline':False]
['text':' The following tests confirm the behavior of queries in the form: {$getField: {$literal:','line_number':53,'multiline':False]
['text':' "fieldName"}}.','line_number':54,'multiline':False]
['text':'','line_number':55,'multiline':False]
['text':' missing field.','line_number':60,'multiline':False]
['text':' There is a difference between the metaField "meta1", and "$meta1". Field paths are allowed to','line_number':67,'multiline':False]
['text':' have a '$' and are accessed by $getField. We need to validate we return the correct results when','line_number':68,'multiline':False]
['text':' we have both the metaField and "$meta1".','line_number':69,'multiline':False]
['text':' missing field.','line_number':74,'multiline':False]
['text':'','line_number':81,'multiline':False]
['text':' The following tests confirm the behavior of queries in the form: {$getField: <expr>}.','line_number':82,'multiline':False]
['text':'','line_number':83,'multiline':False]
['text':' When we rely on both the metaField and a measurementField we should not perform the rewrite and','line_number':99,'multiline':False]
['text':' return the correct result.','line_number':100,'multiline':False]
['text':'','line_number':115,'multiline':False]
['text':' The following tests confirm the behavior of queries in the form: {$getField: {input: "string",','line_number':116,'multiline':False]
['text':' field: "string"}}.','line_number':117,'multiline':False]
['text':'','line_number':118,'multiline':False]
['text':' missing subfield.','line_number':123,'multiline':False]
['text':' Validate the correct results are returned when there is a field with '$' inside the metaField.','line_number':130,'multiline':False]
['text':' The rewrite should be valid and return the correct field.','line_number':131,'multiline':False]
['text':' missing subfield.','line_number':136,'multiline':False]
['text':' When we rely on both the metaField and a measurementField we should not perform the rewrite and','line_number':143,'multiline':False]
['text':' return the correct result.','line_number':144,'multiline':False]
['text':' missing subfield.','line_number':149,'multiline':False]
['text':' same test as above but with $addFields and not $project.','line_number':163,'multiline':False]
['text':' missing subfield.','line_number':169,'multiline':False]
['text':'','line_number':185,'multiline':False]
['text':' The following tests confirm the behavior of queries in the form: {$getField: {input: <expr>,','line_number':186,'multiline':False]
['text':' field: <expr>}}.','line_number':187,'multiline':False]
['text':'','line_number':188,'multiline':False]
['text':' missing subfield.','line_number':193,'multiline':False]
['text':' When we rely on both the metaField and a measurementField we should not perform the rewrite and','line_number':209,'multiline':False]
['text':' return the correct result.','line_number':210,'multiline':False]
['text':' missing field.','line_number':215,'multiline':False]
['text':' This test validates that $project with '$$ROOT' which requires the whole document returns the','line_number':236,'multiline':False]
['text':' correct results.','line_number':237,'multiline':False]
