['text':'*
 * Test that eventFilter and wholeBucketFilter are removed for queries in time-series collections
 * with fixed buckets.
 *
 * @tags: [
 *     # We need a timeseries collection.
 *     requires_timeseries,
 *     requires_fcv_71,
 *     # Explain of a resolved view must be executed by mongos.
 *     directly_against_shardsvrs_incompatible,
 *     # Refusing to run a test that issues an aggregation command with explain because it may
 *     # return incomplete results if interrupted by a stepdown.
 *     does_not_support_stepdowns,
 *     # The `simulate_atlas_proxy` override cannot deep copy very large or small dates.
 *     simulate_atlas_proxy_incompatible,
 * ]
 ','line_number':1,'multiline':True]
['text':' Validate that _eventFilter and wholeBucketFilter are correct.','line_number':44,'multiline':False]
['text':' Need to convert the 'bucketRoundingSeconds' and 'bucketMaxSpanSeconds' to milliseconds.','line_number':72,'multiline':False]
['text':' Add documents that will span over multiple buckets.','line_number':74,'multiline':False]
['text':'','line_number':95,'multiline':False]
['text':' These tests validate that the query is successfully rewritten in different $match','line_number':96,'multiline':False]
['text':' expressions.','line_number':97,'multiline':False]
['text':'','line_number':98,'multiline':False]
['text':' $lt when the predicate doesn't align with the bucket boundary, and we expect an _eventFilter.','line_number':100,'multiline':False]
['text':' $lt when the predicate does align with the bucket boundary, and we don't expect an','line_number':108,'multiline':False]
['text':' _eventFilter.','line_number':109,'multiline':False]
['text':' $lte always has an eventFilter to catch edge cases.','line_number':115,'multiline':False]
['text':' $gt always has an eventFilter to capture all of the correct results.','line_number':123,'multiline':False]
['text':' $gte when the predicate does align with the bucket boundary, and we don't expect an','line_number':138,'multiline':False]
['text':' _eventFilter.','line_number':139,'multiline':False]
['text':' $gte when the predicate doesn't align with the bucket boundary, and we expect an','line_number':145,'multiline':False]
['text':' _eventFilter.','line_number':146,'multiline':False]
['text':' $eq always has an eventFilter to capture all of the correct results.','line_number':154,'multiline':False]
['text':' $in always has an eventFilter to capture all of the correct results.','line_number':178,'multiline':False]
['text':' Test a $match expression that is a conjunction, with all the predicates on the 'timeField'','line_number':190,'multiline':False]
['text':' that do align with bucket boundaries.','line_number':191,'multiline':False]
['text':' Test multiple $match expressions, with all the predicates on the 'timeField' that align with','line_number':204,'multiline':False]
['text':' the bucket boundaries.','line_number':205,'multiline':False]
['text':' Test that a $group stage can replace the unpack stage after the $match stage is rewritten.','line_number':214,'multiline':False]
['text':' The $group rewrite can occur, because we do not have an _eventFilter. Therefore, we do not','line_number':215,'multiline':False]
['text':' need to unpack the buckets to individually filter measurements, and can remove the unpack','line_number':216,'multiline':False]
['text':' stage.','line_number':217,'multiline':False]
['text':'','line_number':233,'multiline':False]
['text':' These tests validate that the query is not rewritten when the requirements are not met.','line_number':234,'multiline':False]
['text':'','line_number':235,'multiline':False]
['text':' Test a $match expression that is a conjunction, with all the predicates on the 'timeField'','line_number':237,'multiline':False]
['text':' that don't align with bucket boundaries.','line_number':238,'multiline':False]
['text':' Test multiple $match expressions, with all the predicates on the 'timeField' that don't align','line_number':266,'multiline':False]
['text':' with bucket boundaries.','line_number':267,'multiline':False]
['text':' Test multiple $match expressions, where one predicate is on the 'timeField' and aligns with','line_number':284,'multiline':False]
['text':' the bucket boundaries, and the other predicate is on a different field.','line_number':285,'multiline':False]
['text':' Test the fixed bucketing specific rewrites are not done for queries that use an extended','line_number':293,'multiline':False]
['text':' range. We still do the generic rewrites on the 'control' fields.','line_number':294,'multiline':False]
['text':' Test the fixed bucketing specific rewrites are not done if the bucketing parameters have','line_number':303,'multiline':False]
['text':' been changed. We still do the generic rewrites on the 'control' fields. This test needs to','line_number':304,'multiline':False]
['text':' run last, since collMod will permanently change the flag to false.','line_number':305,'multiline':False]
['text':' This query was rewritten without 'eventFilter' earlier, but now that collection's bucketing','line_number':310,'multiline':False]
['text':' parameters have changed, the query will need an 'eventFilter'.','line_number':311,'multiline':False]
['text':' Run the test with different rounding parameters.','line_number':321,'multiline':False]
['text':' roundingParam ','line_number':322,'multiline':True]
['text':' startingTime ','line_number':323,'multiline':True]
['text':' 1 hour','line_number':323,'multiline':False]
['text':' roundingParam ','line_number':324,'multiline':True]
['text':' startingTime ','line_number':325,'multiline':True]
['text':' 1 day','line_number':325,'multiline':False]
['text':' roundingParam ','line_number':326,'multiline':True]
['text':' startingTime ','line_number':327,'multiline':True]
['text':' 1 minute','line_number':327,'multiline':False]
['text':' eventFilter ','line_number':332,'multiline':True]
['text':' wholeBucketFilter ','line_number':333,'multiline':True]
['text':' fixedBuckets ','line_number':334,'multiline':True]
['text':'expectUnpackStage ','line_number':335,'multiline':True]
['text':' Insert 1000 documents at random times spanning 3 years (between 2012 and 2015). These dates','line_number':363,'multiline':False]
['text':' were chosen arbitrarily.','line_number':364,'multiline':False]
['text':' Validate simple queries with the optimization return the same result as the query run without','line_number':370,'multiline':False]
['text':' the optimization.','line_number':371,'multiline':False]
['text':' Validate the same results are returned with a completely random timestamp. We will not check','line_number':375,'multiline':False]
['text':' the explain output, since we cannot guarantee the time will align with the bucket boundaries.','line_number':376,'multiline':False]
['text':' shouldCheckExplain ','line_number':378,'multiline':True]
['text':' shouldCheckExplain ','line_number':380,'multiline':True]
