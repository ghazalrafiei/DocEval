['text':'*
 * Tests that '$_internalIndexKey' expression works as expected under various scenarios.
 *
 * @tags: [
 *   does_not_support_stepdowns,
 *   requires_fcv_63,
 * ]
 ','line_number':1,'multiline':True]
['text':'*
 * Returns the hash of the provided BSON element that is compatible with 'hashed' indexes.
 ','line_number':13,'multiline':True]
['text':' A dictionary consisting of various test scenarios that must be run against the','line_number':20,'multiline':False]
['text':' '$_internalIndexKey'.','line_number':21,'multiline':False]
['text':'','line_number':22,'multiline':False]
['text':' Below is the description about the fields:','line_number':23,'multiline':False]
['text':' doc - The document that must be inserted to the collection. The '$_internalIndexKey' would','line_number':24,'multiline':False]
['text':'       observe this document using '$$ROOT' and generate the corresponding keys if possible.','line_number':25,'multiline':False]
['text':' spec - The index specification document that is passed to the '$_internalIndexKey'.','line_number':26,'multiline':False]
['text':' expectedIndexKeys - The keys document that the '$_internalIndexKey' must returned corresponding','line_number':27,'multiline':False]
['text':'                     to the 'doc' and the 'spec'.','line_number':28,'multiline':False]
['text':' expectedErrorCode - The error code that the '$_internalIndexKey' must throw in case of an','line_number':29,'multiline':False]
['text':'                     exception.','line_number':30,'multiline':False]
['text':'','line_number':32,'multiline':False]
['text':' Test '$_internalIndexKey' against invalid arguments.','line_number':33,'multiline':False]
['text':'','line_number':34,'multiline':False]
['text':' $_internalIndexKey requires both 'doc' and 'spec' arguments.','line_number':37,'multiline':False]
['text':' $_internalIndexKey requires both 'doc' and 'spec' arguments.','line_number':41,'multiline':False]
['text':' $_internalIndexKey requires both 'doc' and 'spec' arguments.','line_number':46,'multiline':False]
['text':' $_internalIndexKey requires both 'doc' and 'spec' arguments.','line_number':51,'multiline':False]
['text':' Index key pattern field ordering must be ascending.','line_number':56,'multiline':False]
['text':' $_internalIndexKey requires 'spec' argument to be an object.','line_number':61,'multiline':False]
['text':' The field 'a' is not valid','line_number':67,'multiline':False]
['text':' for an index specification.','line_number':68,'multiline':False]
['text':' The field 'a' is not valid for an index','line_number':74,'multiline':False]
['text':' specification.','line_number':75,'multiline':False]
['text':' The field '$literal' is not valid for an','line_number':81,'multiline':False]
['text':' index specification.','line_number':82,'multiline':False]
['text':' The field '$const' is not valid for an','line_number':88,'multiline':False]
['text':' index specification.','line_number':89,'multiline':False]
['text':'','line_number':92,'multiline':False]
['text':' ++++ Btree index tests ++++','line_number':93,'multiline':False]
['text':' Test '$_internalIndexKey' against various shapes of 'doc' and 'spec'. The 'doc' contains','line_number':94,'multiline':False]
['text':' nested fields, arrays and combination of both. The 'spec' contains simple/composite fields,','line_number':95,'multiline':False]
['text':' dotted field paths and combination of both.','line_number':96,'multiline':False]
['text':'','line_number':97,'multiline':False]
['text':'','line_number':202,'multiline':False]
['text':' ++++ Btree index tests ++++','line_number':203,'multiline':False]
['text':' These cases cause the '$_internalIndexKey' to return null and undefined keys for some or all','line_number':204,'multiline':False]
['text':' fields.','line_number':205,'multiline':False]
['text':'','line_number':206,'multiline':False]
['text':'','line_number':263,'multiline':False]
['text':' ++++ Btree index tests ++++','line_number':264,'multiline':False]
['text':' Test '$_internalIndexKey' by passing collation.','line_number':265,'multiline':False]
['text':'','line_number':266,'multiline':False]
['text':'','line_number':292,'multiline':False]
['text':' ++++ Btree index tests ++++','line_number':293,'multiline':False]
['text':' These tests causes '$_internalIndexKey' to throw exceptions for btree indexes.','line_number':294,'multiline':False]
['text':'','line_number':295,'multiline':False]
['text':' Ambiguous field name found in array.','line_number':299,'multiline':False]
['text':' Ambiguous field name found in array.','line_number':304,'multiline':False]
['text':' Cannot index parallel arrays [b] [a].','line_number':310,'multiline':False]
['text':' Malformed 'collation' document provided.','line_number':315,'multiline':False]
['text':' Index keys cannot contain an empty field.','line_number':321,'multiline':False]
['text':' Index keys cannot contain an empty field.','line_number':327,'multiline':False]
['text':' Index keys cannot contain an empty field.','line_number':333,'multiline':False]
['text':' Index keys cannot contain an empty field.','line_number':339,'multiline':False]
['text':'','line_number':342,'multiline':False]
['text':' ++++ Hashed index tests ++++','line_number':343,'multiline':False]
['text':' Test '$_internalIndexKey' against various shapes of 'doc' and 'spec' with hashed index.','line_number':344,'multiline':False]
['text':'','line_number':345,'multiline':False]
['text':' A maximum of one index field is allowed to be hashed but found 2.','line_number':400,'multiline':False]
['text':' hashed indexes do not currently support array values.','line_number':405,'multiline':False]
['text':'','line_number':408,'multiline':False]
['text':' ++++ 2d index tests ++++','line_number':409,'multiline':False]
['text':' Test '$_internalIndexKey' against various shapes of 'doc' and 'spec' with 2d index.','line_number':410,'multiline':False]
['text':'','line_number':411,'multiline':False]
['text':' can't have 2 geo fields.','line_number':440,'multiline':False]
['text':' geo field only has 1 element.','line_number':445,'multiline':False]
['text':'','line_number':448,'multiline':False]
['text':' ++++ 2dsphere index tests ++++','line_number':449,'multiline':False]
['text':' Test '$_internalIndexKey' against various shapes of 'doc' and 'spec' with 2dsphere index.','line_number':450,'multiline':False]
['text':'','line_number':451,'multiline':False]
['text':' unknown GeoJSON type','line_number':553,'multiline':False]
['text':'','line_number':556,'multiline':False]
['text':' ++++ 2dsphere_bucket index tests ++++','line_number':557,'multiline':False]
['text':' Test '$_internalIndexKey' against various shapes of 'doc' and 'spec' with 2dsphere_bucket','line_number':558,'multiline':False]
['text':' index.','line_number':559,'multiline':False]
['text':'','line_number':560,'multiline':False]
['text':' Can't extract geo keys: unknown GeoJSON type.','line_number':720,'multiline':False]
['text':' Time-series bucket documents must have 'control' object present.','line_number':737,'multiline':False]
['text':'','line_number':740,'multiline':False]
['text':' ++++ text index tests ++++','line_number':741,'multiline':False]
['text':' Test '$_internalIndexKey' against various shapes of 'doc' and 'spec' with text index.','line_number':742,'multiline':False]
['text':'','line_number':743,'multiline':False]
['text':'','line_number':1007,'multiline':False]
['text':' ++++ wildcard index tests ++++','line_number':1008,'multiline':False]
['text':' Test '$_internalIndexKey' against various shapes of 'doc' and 'spec' with wildcard index.','line_number':1009,'multiline':False]
['text':'','line_number':1010,'multiline':False]
['text':' Must have 'wildcardProjection'.','line_number':1039,'multiline':False]
['text':' Run each test scenario and verify that the '$_internalIndexKey' returns the','line_number':1043,'multiline':False]
['text':' expected response.','line_number':1044,'multiline':False]
['text':' Drop the collection so the '$$ROOT' does not pick documents from the last test','line_number':1048,'multiline':False]
['text':' scenario.','line_number':1049,'multiline':False]
['text':' Insert the document to the collection if the field 'doc' exists in the','line_number':1052,'multiline':False]
['text':' test-scenario dictionary.','line_number':1053,'multiline':False]
['text':' Prepare the pipeline that consists of the '$_internalIndexKey' expression. The','line_number':1058,'multiline':False]
['text':' 'doc' field corresponds to the '$$ROOT', as such there must be only document in','line_number':1059,'multiline':False]
['text':' the collection, so that the aggregate command returns only one key document for','line_number':1060,'multiline':False]
['text':' each test scenario.','line_number':1061,'multiline':False]
['text':' If the 'expectedIndexKeys' field is present, then the aggregate command must','line_number':1071,'multiline':False]
['text':' succeed and the','line_number':1072,'multiline':False]
['text':' '$_internalIndexKey' must return expected keys document. Otherwise the','line_number':1073,'multiline':False]
['text':' 'expectedErrorCode' must be present and the aggregate command in such case must','line_number':1074,'multiline':False]
['text':' throw an exception.','line_number':1075,'multiline':False]
