['text':' Tests for using $planCacheStats to list cached plans.','line_number':1,'multiline':False]
['text':'','line_number':2,'multiline':False]
['text':' @tags: [','line_number':3,'multiline':False]
['text':'   # If the balancer is on and chunks are moved, the plan cache can have entries with isActive:','line_number':4,'multiline':False]
['text':'   # false when the test assumes they are true because the query has already been run many times.','line_number':5,'multiline':False]
['text':'   assumes_balancer_off,','line_number':6,'multiline':False]
['text':'   assumes_read_concern_unchanged,','line_number':7,'multiline':False]
['text':'   # This test attempts to perform queries and introspect the server's plan cache entries. The','line_number':8,'multiline':False]
['text':'   # former operation may be routed to a secondary in the replica set, whereas the latter must be','line_number':9,'multiline':False]
['text':'   # routed to the primary.','line_number':10,'multiline':False]
['text':'   assumes_read_preference_unchanged,','line_number':11,'multiline':False]
['text':'   assumes_unsharded_collection,','line_number':12,'multiline':False]
['text':'   does_not_support_stepdowns,','line_number':13,'multiline':False]
['text':'   does_not_support_repeated_reads,','line_number':14,'multiline':False]
['text':'   inspects_whether_plan_cache_entry_is_active,','line_number':15,'multiline':False]
['text':'   requires_fcv_62,','line_number':16,'multiline':False]
['text':'   # Plan cache state is node-local and will not get migrated alongside tenant data.','line_number':17,'multiline':False]
['text':'   tenant_migration_incompatible,','line_number':18,'multiline':False]
['text':'   # TODO SERVER-67607: Test plan cache with CQF enabled.','line_number':19,'multiline':False]
['text':'   cqf_experimental_incompatible,','line_number':20,'multiline':False]
['text':'   references_foreign_collection,','line_number':21,'multiline':False]
['text':'   # This tests perform queries and expect a particular number of candidate plans to be evaluated,','line_number':22,'multiline':False]
['text':'   # creating unanticipated indexes can lead to a different number of candidate plans.','line_number':23,'multiline':False]
['text':'   assumes_no_implicit_index_creation,','line_number':24,'multiline':False]
['text':'   # Query settings are atlas proxy and direct shard execution incompatible.','line_number':25,'multiline':False]
['text':'   directly_against_shardsvrs_incompatible,','line_number':26,'multiline':False]
['text':'   simulate_atlas_proxy_incompatible,','line_number':27,'multiline':False]
['text':'   # Query settings are not supported in upgrade/downgrade scenario','line_number':28,'multiline':False]
['text':'   cannot_run_during_upgrade_downgrade,','line_number':29,'multiline':False]
['text':'   # This test checks a new field "solutionHash" in $planCacheStats, not available in previous','line_number':30,'multiline':False]
['text':'   # versions.','line_number':31,'multiline':False]
['text':'   requires_fcv_72,','line_number':32,'multiline':False]
['text':'   multiversion_incompatible,','line_number':33,'multiline':False]
['text':' ]','line_number':34,'multiline':False]
['text':' We expect exactly one matching cache entry.','line_number':60,'multiline':False]
['text':' We expect exactly one matching cache entry.','line_number':70,'multiline':False]
['text':' Assert that timeOfCreation exists in the cache entry. The difference between the current time','line_number':84,'multiline':False]
['text':' and the time a plan was cached should not be larger than an hour.','line_number':85,'multiline':False]
['text':' We expect exactly one matching cache entry.','line_number':92,'multiline':False]
['text':' We need two indices so that the MultiPlanRunner is executed.','line_number':107,'multiline':False]
['text':' Check that there are no cache entries associated with an unknown field.','line_number':111,'multiline':False]
['text':' Create a cache entry.','line_number':114,'multiline':False]
['text':' Verify that the time of creation listed for the plan cache entry is reasonably close to 'now'.','line_number':119,'multiline':False]
['text':' Retrieve plans for valid cache entry.','line_number':123,'multiline':False]
['text':' Note that SBE plan cache entry does not include "creationExecStats". We expect that there','line_number':129,'multiline':False]
['text':' were two candidate plans evaluated when the cache entry was created.','line_number':130,'multiline':False]
['text':' Test the queryHash and planCacheKey property by comparing entries for two different','line_number':135,'multiline':False]
['text':' query shapes.','line_number':136,'multiline':False]
['text':' Assert on queryHash.','line_number':139,'multiline':False]
['text':' Assert on planCacheKey.','line_number':143,'multiline':False]
['text':' Assert on solutionHash.','line_number':147,'multiline':False]
['text':' Generate more plans for test query by adding indexes (compound and sparse).  This will also','line_number':152,'multiline':False]
['text':' clear the plan cache.','line_number':153,'multiline':False]
['text':' Verify that the time of creation listed for the plan cache entry is reasonably close to 'now'.','line_number':162,'multiline':False]
['text':' Test that the cache entry is listed as active.','line_number':166,'multiline':False]
['text':' Note that SBE plan cache entry does not include "creationExecStats". There should be the same','line_number':172,'multiline':False]
['text':' number of candidate plan scores as candidate plans.','line_number':173,'multiline':False]
['text':' Scores should be greater than zero and sorted descending.','line_number':176,'multiline':False]
['text':'','line_number':185,'multiline':False]
['text':' Test that $planCacheStats against a particular collection does not list cached $lookup plans','line_number':186,'multiline':False]
['text':' if the collection is the foreign collection (not the main collection).','line_number':187,'multiline':False]
['text':'','line_number':188,'multiline':False]
['text':' Make sure we have one plan cache entry for main collection and the plan is indexed NLJ.','line_number':200,'multiline':False]
['text':' The '$planCacheStats' pipeline executed against the foreign collection shouldn't include','line_number':212,'multiline':False]
['text':' cached $lookup plans.','line_number':213,'multiline':False]
['text':' Ensure query setting entry is present in $planCacheStats output.','line_number':218,'multiline':False]
['text':' TODO: SERVER-71537 Remove Feature Flag for PM-412.','line_number':219,'multiline':False]
['text':' Set query settings for a query to use 'settings.indexHints.allowedIndexes' indexes.','line_number':221,'multiline':False]
['text':' Specify 'allowedIndexes' with more than one index, otherwise it will result in single','line_number':224,'multiline':False]
['text':' solution plan, that won't be cached in classic.','line_number':225,'multiline':False]
['text':' Run the query, such that a plan cache entry is created.','line_number':232,'multiline':False]
['text':' Ensure plan cache entry contains 'settings'.','line_number':235,'multiline':False]
