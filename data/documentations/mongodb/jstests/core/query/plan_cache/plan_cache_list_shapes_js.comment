['text':' Test using the $planCacheStats aggregation metadata source to list all of the query shapes cached','line_number':1,'multiline':False]
['text':' for a particular collection.','line_number':2,'multiline':False]
['text':'','line_number':3,'multiline':False]
['text':' @tags: [','line_number':4,'multiline':False]
['text':'   # If all chunks are moved off of a shard, it can cause the plan cache to miss commands.','line_number':5,'multiline':False]
['text':'   assumes_balancer_off,','line_number':6,'multiline':False]
['text':'   does_not_support_stepdowns,','line_number':7,'multiline':False]
['text':'   # This test attempts to perform queries with plan cache filters set up. The former operation','line_number':8,'multiline':False]
['text':'   # may be routed to a secondary in the replica set, whereas the latter must be routed to the','line_number':9,'multiline':False]
['text':'   # primary.','line_number':10,'multiline':False]
['text':'   assumes_read_concern_unchanged,','line_number':11,'multiline':False]
['text':'   assumes_read_preference_unchanged,','line_number':12,'multiline':False]
['text':'   assumes_unsharded_collection,','line_number':13,'multiline':False]
['text':'   # Plan cache state is node-local and will not get migrated alongside tenant data.','line_number':14,'multiline':False]
['text':'   tenant_migration_incompatible,','line_number':15,'multiline':False]
['text':'   # TODO SERVER-67607: Test plan cache with CQF enabled.','line_number':16,'multiline':False]
['text':'   cqf_experimental_incompatible,','line_number':17,'multiline':False]
['text':' ]','line_number':18,'multiline':False]
['text':' Utility function to list query shapes in cache.','line_number':33,'multiline':False]
['text':' We need two indices so that the MultiPlanRunner is executed.','line_number':43,'multiline':False]
['text':' Run a query.','line_number':47,'multiline':False]
['text':' We now expect the two indices to be compared and a cache entry to exist.  Retrieve query','line_number':50,'multiline':False]
['text':' shapes from the test collection Number of shapes should match queries executed by multi-plan','line_number':51,'multiline':False]
['text':' runner.','line_number':52,'multiline':False]
['text':' Running a different query shape should cause another entry to be cached.','line_number':57,'multiline':False]
['text':' Check that each shape has a unique queryHash.','line_number':62,'multiline':False]
['text':' Check that queries with different regex options have distinct shapes.','line_number':65,'multiline':False]
['text':' Insert some documents with strings so we have something to search for.','line_number':67,'multiline':False]
['text':' Run a query with a regex. Also must include 'a' so that the query may use more than one','line_number':73,'multiline':False]
['text':' index, and thus, must use the MultiPlanner.','line_number':74,'multiline':False]
['text':' Run the same query, but with different regex options. We expect that this should cause a','line_number':84,'multiline':False]
['text':' shape to get added.','line_number':85,'multiline':False]
['text':' There is one more result since the query is now case sensitive.','line_number':87,'multiline':False]
