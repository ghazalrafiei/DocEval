['text':'*
 * Verifies that a node waits for the write done on stepup to become majority committed before
 * resuming coordinating transaction commits.
 *
 * @tags: [uses_transactions, uses_multi_shard_transaction]
 ','line_number':1,'multiline':True]
['text':' The UUID consistency check uses connections to shards cached on the ShardingTest object, but this','line_number':8,'multiline':False]
['text':' test causes failovers on a shard, so the cached connection is not usable.','line_number':9,'multiline':False]
['text':' Create a sharded collection with a chunk on each shard:','line_number':49,'multiline':False]
['text':' shard0: [-inf, 0)','line_number':50,'multiline':False]
['text':' shard1: [0, 10)','line_number':51,'multiline':False]
['text':' shard2: [10, +inf)','line_number':52,'multiline':False]
['text':' The default WC is majority and stopServerReplication will prevent satisfying any majority','line_number':54,'multiline':False]
['text':' writes.','line_number':55,'multiline':False]
['text':' These forced refreshes are not strictly necessary; they just prevent extra TXN log lines','line_number':68,'multiline':False]
['text':' from the shards starting, aborting, and restarting the transaction due to needing to','line_number':69,'multiline':False]
['text':' refresh after the transaction has started.','line_number':70,'multiline':False]
['text':' Start a new transaction by inserting a document onto each shard.','line_number':76,'multiline':False]
['text':' Make the commit coordination hang before writing the decision, and send commitTransaction.','line_number':92,'multiline':False]
['text':' Stop replication on all nodes in the coordinator replica set so that the write done on stepup','line_number':97,'multiline':False]
['text':' cannot become majority committed, regardless of which node steps up.','line_number':98,'multiline':False]
['text':' Induce the coordinator primary to step down, but allow it to immediately step back up.','line_number':101,'multiline':False]
['text':' The router should retry commitTransaction against the primary and time out waiting to','line_number':108,'multiline':False]
['text':' access the coordinator catalog.','line_number':109,'multiline':False]
['text':' Re-enable replication, so that the write done on stepup can become majority committed.','line_number':112,'multiline':False]
['text':' Now, commitTransaction should succeed.','line_number':115,'multiline':False]
