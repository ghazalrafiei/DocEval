['text':' Tests that $lookup and its subpipelines obey the read preference specified by the user.','line_number':1,'multiline':False]
['text':' @tags: [requires_majority_read_concern, requires_fcv_51]','line_number':2,'multiline':False]
['text':' In this test we perform writes which we expect to read on a secondary, so we need to enable','line_number':11,'multiline':False]
['text':' causal consistency.','line_number':12,'multiline':False]
['text':' Shard each collection on _id with 2 chunks: [MinKey, 0), [0, MaxKey].','line_number':24,'multiline':False]
['text':' Turn on the profiler.','line_number':29,'multiline':False]
['text':' Write a document to each chunk.','line_number':41,'multiline':False]
['text':' Ensure the query with the given read preference returns expected results. We specify','line_number':50,'multiline':False]
['text':' {batchSize: 1} to exercise the case where $lookup subpipelines are dispatched during a','line_number':51,'multiline':False]
['text':' getMore. This way, we can ensure sub-operations in a getMore have the right read preference.','line_number':52,'multiline':False]
['text':' For each replica set and for each involved collection, ensure queries are routed to the','line_number':64,'multiline':False]
['text':' appropriate node.','line_number':65,'multiline':False]
['text':' Check that aggregates are sent to the appropriate node in the replica set.','line_number':71,'multiline':False]
['text':' Check that no aggregates are sent to the other node in the replica set.','line_number':81,'multiline':False]
['text':' Test that $lookup and its subpipelines go to the primaries by default.','line_number':94,'multiline':False]
['text':' Test that $lookup and its subpipelines go to the secondaries when the readPreference is','line_number':99,'multiline':False]
['text':' secondary.','line_number':100,'multiline':False]
['text':' Test that $lookup, its subpipelines, and a nested $lookup's subpipelines go to the secondaries','line_number':103,'multiline':False]
['text':' if the read preference is secondary.','line_number':104,'multiline':False]
