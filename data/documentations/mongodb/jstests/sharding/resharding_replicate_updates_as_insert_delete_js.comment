['text':'','line_number':1,'multiline':False]
['text':' Test to verify that updates that would change the resharding key value are replicated as an','line_number':2,'multiline':False]
['text':' insert, delete pair.','line_number':3,'multiline':False]
['text':' @tags: [','line_number':4,'multiline':False]
['text':'   uses_atclustertime,','line_number':5,'multiline':False]
['text':' ]','line_number':6,'multiline':False]
['text':'','line_number':7,'multiline':False]
['text':'','line_number':40,'multiline':False]
['text':' Wait for cloning to have at least started on the recipient shards to know that the donor','line_number':49,'multiline':False]
['text':' shards have begun including the "destinedRecipient" field in their oplog entries.','line_number':50,'multiline':False]
['text':' When the updateDocumentShardKeyUsingTransactionApi feature flag is enabled, ordinary','line_number':54,'multiline':False]
['text':' updates that modify a document's shard key will complete.','line_number':55,'multiline':False]
['text':' mongos will automatically retry the update as a pair of delete and insert commands in','line_number':113,'multiline':False]
['text':' a multi-document transaction. We permit NoSuchTransaction errors because it is','line_number':114,'multiline':False]
['text':' possible for the resharding operation running in the background to cause the shard','line_number':115,'multiline':False]
['text':' version to be bumped. The StaleConfig error won't be automatically retried by mongos','line_number':116,'multiline':False]
['text':' for the second statement in the transaction (the insert) and would lead to a','line_number':117,'multiline':False]
['text':' NoSuchTransaction error.','line_number':118,'multiline':False]
['text':' The handling of WCOS errors with internal transactions advances the router's','line_number':120,'multiline':False]
['text':' notion of the transaction "statement" number between the initial update, the','line_number':121,'multiline':False]
['text':' delete, and the insert, so if the shard version changes and is detected by the','line_number':122,'multiline':False]
['text':' delete or insert, the router will refuse to retry and return the stale version','line_number':123,'multiline':False]
['text':' error instead.','line_number':124,'multiline':False]
['text':' With internal transactions the applyOps array for a retryable write update will have a','line_number':145,'multiline':False]
['text':' noop entry at the front.','line_number':146,'multiline':False]
['text':' isRetryableWrite ','line_number':164,'multiline':True]
