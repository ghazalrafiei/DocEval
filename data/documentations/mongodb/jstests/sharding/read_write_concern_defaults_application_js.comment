['text':'*
 * Tests that commands correctly apply read/write concern defaults.
 *
 * The following fields are required for each command that is not skipped:
 *
 * - setUp: [OPTIONAL] A function that does any set up (inserts, etc.) needed to check the command's
 *   results. These operations will run with the default RWC set, so ensure they use appropriate
 *   explicit RWC if necessary.
 * - command: The command to run, with all required options. If a function, is called with the
 *   connection as the argument, and the returned object is used. The readConcern/writeConcern
 *   fields may be appended to this object. The command object cannot include its own explicit
 *   readConcern/writeConcern fields.
 * - checkReadConcern: Boolean that controls whether to check the application of readConcern.
 * - checkWriteConcern: Boolean that controls whether to check the application of writeConcern.
 * - db: [OPTIONAL] The database to run the command against.
 * - target: [OPTIONAL] If set to "sharded", command is only valid on sharded clusters. If set to
 *   "replset", command is only valid on non-sharded clusters. If omitted, command is valid on
 *   sharded and non-sharded clusters.
 * - shardedTargetsConfigServer: [OPTIONAL] When sharded, the operation is sent to the config
 *   server, rather than to the shard.
 * - useLogs: Normally, profiling is used to check behavior.  Set this to true to use slow op log
 *   lines instead.
 *
 * @tags: [
 *   does_not_support_stepdowns,
 *   requires_majority_read_concern,
 *   requires_profiling,
 *   uses_transactions,
 * ]
 ','line_number':1,'multiline':True]
['text':' TODO SERVER-50144 Remove this and allow orphan checking.','line_number':39,'multiline':False]
['text':' This test calls removeShard which can leave docs in config.rangeDeletions in state "pending",','line_number':40,'multiline':False]
['text':' therefore preventing orphans from being cleaned up.','line_number':41,'multiline':False]
['text':' Check that a test case is well-formed.','line_number':57,'multiline':False]
['text':' Can be removed once 6.0 is last LTS','line_number':102,'multiline':False]
['text':' TODO SERVER-73029 remove','line_number':109,'multiline':False]
['text':' Can be removed once 6.0 is last LTS','line_number':110,'multiline':False]
['text':' Ensure that the dbVersion is known.','line_number':217,'multiline':False]
['text':' Start the transaction.','line_number':221,'multiline':False]
['text':' TODO SERVER-52419: Run this test and remove the skip.','line_number':270,'multiline':False]
['text':' setUp: function(conn) {','line_number':271,'multiline':False]
['text':'     assert.commandWorked(conn.getDB(db).runCommand({create: coll, writeConcern: {w:','line_number':272,'multiline':False]
['text':'     1}}));','line_number':273,'multiline':False]
['text':' },','line_number':274,'multiline':False]
['text':' db: "admin",','line_number':275,'multiline':False]
['text':' command: {','line_number':276,'multiline':False]
['text':'     bulkWrite: 1,','line_number':277,'multiline':False]
['text':'     ops: [{insert: 0, document: {_id: ObjectId()}}],','line_number':278,'multiline':False]
['text':'     nsInfo: [{ns: db + "." + coll}]','line_number':279,'multiline':False]
['text':' },','line_number':280,'multiline':False]
['text':' checkReadConcern: false,','line_number':281,'multiline':False]
['text':' checkWriteConcern: true,','line_number':282,'multiline':False]
['text':' // TODO SERVER-23266: If the overall batch command if profiled, then it would be better','line_number':283,'multiline':False]
['text':' // to use profiling.  In the meantime, use logs.','line_number':284,'multiline':False]
['text':' useLogs: true,','line_number':285,'multiline':False]
['text':' Ensure that the dbVersion is known.','line_number':330,'multiline':False]
['text':' Start the transaction.','line_number':334,'multiline':False]
['text':' TODO SERVER-23266: If the overall batch command if profiled, then it would be better to','line_number':418,'multiline':False]
['text':' use profiling.  In the meantime, use logs.','line_number':419,'multiline':False]
['text':' TODO SERVER-23266: If the overall batch command if profiled, then it would be better to','line_number':793,'multiline':False]
['text':' use profiling.  In the meantime, use logs.','line_number':794,'multiline':False]
['text':' Running setDefaultRWConcern in the middle of a scenario would define defaults when there','line_number':841,'multiline':False]
['text':' shouldn't be for subsequently-tested commands. Thus it is special-cased to be run at the end of','line_number':842,'multiline':False]
['text':' the scenario.','line_number':843,'multiline':False]
['text':' Example log line (broken over several lines), indicating the sections matched by the regex','line_number':867,'multiline':False]
['text':' generated by this function:','line_number':868,'multiline':False]
['text':' 2020-01-28T16:46:57.373+1100 I  COMMAND  [conn18] command test.foo appName: "MongoDB Shell"','line_number':869,'multiline':False]
['text':'      command: aggregate { aggregate: "foo", ..., comment: "5e2fcad149034875e22c9fbc", ... }','line_number':870,'multiline':False]
['text':'     ^^^^^^^^^^^^^^^^^^^                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^','line_number':871,'multiline':False]
['text':'      planSummary: COLLSCAN keysExamined:0 docsExamined:1 ... readConcern:{ level: "majority" }','line_number':872,'multiline':False]
['text':'                                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^','line_number':873,'multiline':False]
['text':'      writeConcern:{ w: "majority", wtimeout: 1234567 } storage:{} protocol:op_msg 275ms','line_number':874,'multiline':False]
['text':'     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^','line_number':875,'multiline':False]
['text':' Example profile document, indicating the fields matched by the filter generated by this function:','line_number':890,'multiline':False]
['text':' {','line_number':891,'multiline':False]
['text':'     "op" : "insert",','line_number':892,'multiline':False]
['text':'     "ns" : "test.foo",','line_number':893,'multiline':False]
['text':'     "command" : {','line_number':894,'multiline':False]
['text':'         "aggregate" : "foo",','line_number':895,'multiline':False]
['text':'         "pipeline" : [ ... ],','line_number':896,'multiline':False]
['text':'         ...','line_number':897,'multiline':False]
['text':' >>>     "comment" : "5e2fd42654a611422be06518",','line_number':898,'multiline':False]
['text':'         "lsid" : { ... },','line_number':899,'multiline':False]
['text':'         ...','line_number':900,'multiline':False]
['text':'     },','line_number':901,'multiline':False]
['text':'     "keysExamined" : 0,','line_number':902,'multiline':False]
['text':'     "docsExamined" : 1,','line_number':903,'multiline':False]
['text':'     ...','line_number':904,'multiline':False]
['text':'     "readConcern" : {','line_number':905,'multiline':False]
['text':' >>>     "level" : "majority"','line_number':906,'multiline':False]
['text':'     },','line_number':907,'multiline':False]
['text':'     "writeConcern" : {','line_number':908,'multiline':False]
['text':' >>>     "w" : "majority",','line_number':909,'multiline':False]
['text':' >>>     "wtimeout" : 1234567','line_number':910,'multiline':False]
['text':'     },','line_number':911,'multiline':False]
['text':'     "storage" : { },','line_number':912,'multiline':False]
['text':'     "responseLength" : 222,','line_number':913,'multiline':False]
['text':'     "protocol" : "op_msg",','line_number':914,'multiline':False]
['text':'     "millis" : 194,','line_number':915,'multiline':False]
['text':'     "planSummary" : "COLLSCAN",','line_number':916,'multiline':False]
['text':'      ...','line_number':917,'multiline':False]
['text':' }','line_number':918,'multiline':False]
['text':' Filter out failed operations ','line_number':923,'multiline':True]
['text':' These commands were removed but break this test in multiversion','line_number':945,'multiline':False]
['text':' If this test is only suitable for sharded or replset, skip it in the other case.','line_number':966,'multiline':False]
['text':' Determine the appropriate connection to use for checking the command.','line_number':975,'multiline':False]
['text':' Set up profiling or logging, as appropriate.','line_number':981,'multiline':False]
['text':' Do any test-specific setup.','line_number':989,'multiline':False]
['text':' Get the command from the test case.','line_number':994,'multiline':False]
['text':' Add extra fields for RWC if necessary, and an identifying comment.','line_number':1001,'multiline':False]
['text':' When sharded, the field order is: comment, readConcern, writeConcern.','line_number':1002,'multiline':False]
['text':' Otherwise, the field order is: readConcern, writeConcern, comment.','line_number':1003,'multiline':False]
['text':' This is necessary to work around truncation of long log lines in the RamLog when looking','line_number':1004,'multiline':False]
['text':' for the operation's log line.','line_number':1005,'multiline':False]
['text':' Run the command.','line_number':1030,'multiline':False]
['text':' Check that the command applied the correct RWC.','line_number':1034,'multiline':False]
['text':' Clean up the collection by dropping the DB. This also drops all associated indexes and','line_number':1048,'multiline':False]
['text':' clears the profiler collection, except for users and roles.','line_number':1049,'multiline':False]
['text':' The setDefaultRWConcern entry in testCases is skip, because we run the actual case here after','line_number':1065,'multiline':False]
['text':' all other commands.','line_number':1066,'multiline':False]
['text':' The target RWC is always {level: "majority"} and {w: "majority", wtimeout: 1234567}','line_number':1071,'multiline':False]
['text':' TODO: SERVER-80318 Delete block','line_number':1124,'multiline':False]
