['text':'*
 * Tests config shard topology.
 *
 * @tags: [
 *   requires_persistence,
 *   requires_fcv_70,
 * ]
 ','line_number':1,'multiline':True]
['text':'','line_number':56,'multiline':False]
['text':' Basic unsharded CRUD.','line_number':57,'multiline':False]
['text':'','line_number':58,'multiline':False]
['text':'','line_number':63,'multiline':False]
['text':' Basic sharded CRUD.','line_number':64,'multiline':False]
['text':'','line_number':65,'multiline':False]
['text':' Flushing routing / db cache updates works.','line_number':71,'multiline':False]
['text':' Add a shard to move chunks to and from it in later tests.','line_number':75,'multiline':False]
['text':'','line_number':83,'multiline':False]
['text':' Basic sharded DDL.','line_number':84,'multiline':False]
['text':'','line_number':85,'multiline':False]
['text':'','line_number':95,'multiline':False]
['text':' Basic secondary reads.','line_number':96,'multiline':False]
['text':'','line_number':97,'multiline':False]
['text':'','line_number':109,'multiline':False]
['text':' Failover in shard role works.','line_number':110,'multiline':False]
['text':'','line_number':111,'multiline':False]
['text':' Basic CRUD and sharded DDL still works.','line_number':114,'multiline':False]
['text':'','line_number':120,'multiline':False]
['text':' Restart in shard role works. Restart all nodes to verify they don't rely on a majority of','line_number':121,'multiline':False]
['text':' nodes being up.','line_number':122,'multiline':False]
['text':'','line_number':123,'multiline':False]
['text':' wait ','line_number':126,'multiline':True]
['text':' Waits for a stable primary.','line_number':128,'multiline':False]
['text':' Basic CRUD and sharded DDL still works.','line_number':130,'multiline':False]
['text':'','line_number':136,'multiline':False]
['text':' Collections on the config server support changeStreamPreAndPostImages when the config server','line_number':137,'multiline':False]
['text':' is acting as a shard.','line_number':138,'multiline':False]
['text':'','line_number':139,'multiline':False]
['text':' Sharding metadata collections still cannot have changeStreamPreAndPostImages set.','line_number':144,'multiline':False]
['text':'','line_number':156,'multiline':False]
['text':' Can't remove configShard using the removeShard command.','line_number':157,'multiline':False]
['text':'','line_number':158,'multiline':False]
['text':'','line_number':165,'multiline':False]
['text':' Remove the config shard.','line_number':166,'multiline':False]
['text':'','line_number':167,'multiline':False]
['text':' Shard a second collection to verify it gets dropped locally by the transition.','line_number':170,'multiline':False]
['text':' Create a sharded and unsharded timeseries collection and verify they and their buckets','line_number':176,'multiline':False]
['text':' collections are correctly dropped. This provides coverage for views and sharded views.','line_number':177,'multiline':False]
['text':' Use write concern to verify the commands support them. Any values weaker than the default','line_number':194,'multiline':False]
['text':' sharding metadata write concerns will be upgraded.','line_number':195,'multiline':False]
['text':' The removal won't complete until all chunks and dbs are moved off the config shard.','line_number':200,'multiline':False]
['text':' Move away every chunk but one.','line_number':204,'multiline':False]
['text':' Blocked because of the sharded and unsharded databases and the remaining chunk.','line_number':216,'multiline':False]
['text':' The draining sharded collections should not have been locally dropped yet.','line_number':226,'multiline':False]
['text':' Move away the final chunk, but block range deletion and verify this blocks the transition.','line_number':233,'multiline':False]
['text':' The config server owns no chunks, but must wait for its range deletions.','line_number':241,'multiline':False]
['text':' Start the final transition command. This will trigger locally dropping all tracked user','line_number':251,'multiline':False]
['text':' databases on the config server. Hang after removing one database and trigger a failover to','line_number':252,'multiline':False]
['text':' verify the final transition can be resumed on the new primary and the database dropping is','line_number':253,'multiline':False]
['text':' idempotent.','line_number':254,'multiline':False]
['text':' All sharded collections should have been dropped locally from the config server.','line_number':272,'multiline':False]
['text':' Basic CRUD and sharded DDL work.','line_number':278,'multiline':False]
['text':' Flushing routing / db cache updates works.','line_number':283,'multiline':False]
['text':'','line_number':286,'multiline':False]
['text':' A config server that isn't currently a shard can support changeStreamPreAndPostImages. Note','line_number':287,'multiline':False]
['text':' sharding metadata databases cannot have this option, so we have to make a direct connection','line_number':288,'multiline':False]
['text':' to the config server to create a collection on a different db.','line_number':289,'multiline':False]
['text':'','line_number':290,'multiline':False]
['text':'','line_number':300,'multiline':False]
['text':' Can't create configShard using the addShard command.','line_number':301,'multiline':False]
['text':'','line_number':302,'multiline':False]
['text':' Ensure that the config server's RSM hasn't been removed and that it can still target itself.','line_number':306,'multiline':False]
['text':'','line_number':317,'multiline':False]
['text':' Add back the config shard.','line_number':318,'multiline':False]
['text':'','line_number':319,'multiline':False]
['text':' Create an index while the collection is not on the config server to verify it clones the','line_number':321,'multiline':False]
['text':' correct indexes when receiving its first chunk after the transition.','line_number':322,'multiline':False]
['text':' Use write concern to verify the command support them. Any values weaker than the default','line_number':325,'multiline':False]
['text':' sharding metadata write concerns will be upgraded.','line_number':326,'multiline':False]
['text':' Basic CRUD and sharded DDL work.','line_number':330,'multiline':False]
['text':' Move a chunk for the indexed collection to the config server and it should create the correct','line_number':336,'multiline':False]
['text':' index locally.','line_number':337,'multiline':False]
