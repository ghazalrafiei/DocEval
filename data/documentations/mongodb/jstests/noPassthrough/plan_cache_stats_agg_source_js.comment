['text':'*
 * Tests for the $planCacheStats aggregation metadata source.
 * @tags: [
 *   # TODO SERVER-67607: Test plan cache with CQF enabled.
 *   cqf_experimental_incompatible,
 * ]
 ','line_number':1,'multiline':True]
['text':' Returns a BSON object representing the plan cache entry for the query shape {a: 1, b: 1}.','line_number':29,'multiline':False]
['text':' Fails when the collection does not exist.','line_number':39,'multiline':False]
['text':' Create a collection with two indices.','line_number':44,'multiline':False]
['text':' Should return an empty result set when there are no cache entries yet.','line_number':48,'multiline':False]
['text':' Run three distinct query shapes and check that there are three cache entries.','line_number':57,'multiline':False]
['text':' We should be able to find particular cache entries by maching on the query from which the','line_number':63,'multiline':False]
['text':' entry was created.','line_number':64,'multiline':False]
['text':' A similar match on a query filter that was never run should turn up nothing.','line_number':75,'multiline':False]
['text':' Test $group over the plan cache metadata.','line_number':80,'multiline':False]
['text':' Explain should show that a $match gets absorbed into the $planCacheStats stage.','line_number':85,'multiline':False]
['text':' Get the plan cache metadata for a particular query.','line_number':95,'multiline':False]
['text':' Verify that $planCacheStats reports the same 'queryHash' and 'planCacheKey' as explain','line_number':98,'multiline':False]
['text':' for this query shape.','line_number':99,'multiline':False]
['text':' Since the query shape was only run once, the plan cache entry should not be active.','line_number':104,'multiline':False]
['text':' Sanity check 'works' value.','line_number':107,'multiline':False]
['text':' Verify that the 'timeOfCreation' for the entry is now +/- one day.','line_number':111,'multiline':False]
['text':' After creating an index filter on a different query shape, $planCacheStats should still','line_number':123,'multiline':False]
['text':' report that no index filter is set. Setting a filter clears the cache, so we rerun the query','line_number':124,'multiline':False]
['text':' associated with the cache entry.','line_number':125,'multiline':False]
['text':' Create an index filter on shape {a: 1, b: 1}, and verify that indexFilterSet is now true.','line_number':134,'multiline':False]
['text':' Verify that the entry has the expected 'createdFromQuery' field.','line_number':144,'multiline':False]
['text':' Check that the cached plan is an index scan either on {a: 1} or {b: 1}.','line_number':151,'multiline':False]
['text':' There should be at least two plans in 'creationExecStats', and each should have at least one','line_number':158,'multiline':False]
['text':' index scan.','line_number':159,'multiline':False]
['text':' If we are in SBE mode, then explain output format is different for 'creationExecStats'.','line_number':164,'multiline':False]
['text':' Assert that the entry has an array of at least two scores, and that all scores are greater','line_number':169,'multiline':False]
['text':' than 1.','line_number':170,'multiline':False]
['text':' Should throw an error if $planCacheStats is not first.','line_number':178,'multiline':False]
['text':' If the plan cache is cleared, then there are no longer any results returned by','line_number':182,'multiline':False]
['text':' $planCacheStats.','line_number':183,'multiline':False]
