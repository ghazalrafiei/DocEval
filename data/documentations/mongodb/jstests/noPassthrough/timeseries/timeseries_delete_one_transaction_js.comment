['text':'*
 * Tests the deleteOne command on time-series collections in multi-document transactions.
 ','line_number':1,'multiline':True]
['text':' Insert test documents.','line_number':32,'multiline':False]
['text':' 1. Delete one document from the collection in a transaction.','line_number':37,'multiline':False]
['text':' Expect one deleted document with meta: 0.','line_number':50,'multiline':False]
['text':' 2. deleteOne should not have visible changes when the transaction is aborted.','line_number':54,'multiline':False]
['text':' The transaction was aborted so no documents should have been deleted.','line_number':67,'multiline':False]
['text':' 3. Run a few deleteOnes in a single transaction.','line_number':71,'multiline':False]
['text':' Expect all documents with {meta: 0} to be deleted.','line_number':87,'multiline':False]
['text':' 4. Tests performing deleteOnes in and out of a transaction on abort.','line_number':91,'multiline':False]
['text':' Delete all documents for meta values 0, 1.','line_number':100,'multiline':False]
['text':' Outside of the session and transaction, perform a deleteOne.','line_number':106,'multiline':False]
['text':' The aborted transaction should not have deleted any documents.','line_number':113,'multiline':False]
['text':' The delete outside of the transaction should have succeeded.','line_number':117,'multiline':False]
['text':' 5. Tests performing deleteOnes in and out of a transaction on commit.','line_number':121,'multiline':False]
['text':' Within the transaction.','line_number':131,'multiline':False]
['text':' Outside of the session and transaction, perform deleteOne.','line_number':135,'multiline':False]
['text':' Expect all documents to have been deleted.','line_number':142,'multiline':False]
['text':' 6. Tests a race to delete the same document in and out of a transaction.','line_number':146,'multiline':False]
['text':' Within the transaction, perform deleteOne.','line_number':155,'multiline':False]
['text':' Note: there is a change the parallel shell runs after the transaction is committed and that','line_number':159,'multiline':False]
['text':' is fine as both interleavings should succeed.','line_number':160,'multiline':False]
['text':' Outside of the session and transaction, perform deleteOne.','line_number':166,'multiline':False]
['text':' Allow non-transactional deleteOne to finish.','line_number':174,'multiline':False]
['text':' 7. Tests a transactional deleteOne on a document which gets inserted after the transaction','line_number':179,'multiline':False]
['text':' starts.','line_number':180,'multiline':False]
['text':' Ensure the document does not exist within the snapshot of the newly started transaction.','line_number':190,'multiline':False]
['text':' Outside of the session and transaction, insert document.','line_number':193,'multiline':False]
['text':' Double check the document is still not visible from within the transaction.','line_number':196,'multiline':False]
['text':' Within the transaction, perform deleteOne.','line_number':199,'multiline':False]
['text':' The newly inserted document should be present even though the transaction commits after the','line_number':206,'multiline':False]
['text':' insert.','line_number':207,'multiline':False]
['text':' 8. Tests two side-by-side transactional deleteOnes on the same document.','line_number':211,'multiline':False]
['text':' Start transactions on different sessions.','line_number':223,'multiline':False]
['text':' Ensure the document exists in the snapshot of both transactions.','line_number':227,'multiline':False]
['text':' Perform deleteOne on transaction A.','line_number':231,'multiline':False]
['text':' We expect the deleteOne on transaction B to fail, causing the transaction to abort.','line_number':242,'multiline':False]
['text':' Sidenote: avoiding the deleteOne method from 'crud_api.js' because it throws.','line_number':243,'multiline':False]
['text':' Ensure the document does not exist in the snapshot of transaction A.','line_number':249,'multiline':False]
['text':' Since transaction A has not committed yet, the document should still be present outside of','line_number':251,'multiline':False]
['text':' the transaction.','line_number':252,'multiline':False]
['text':' Ensure the document has been successfully deleted after transaction A commits.','line_number':255,'multiline':False]
