['text':'*
 * Test that $setWindowFields works as expected on time-series collections.
 *
 * @tags: [
 *     assumes_no_implicit_collection_creation_after_drop,
 *     assumes_unsharded_collection,
 *     do_not_wrap_aggregations_in_facets,
 *     does_not_support_stepdowns,
 *     does_not_support_transactions,
 *     requires_pipeline_optimization,
 *     requires_timeseries,
 * ]
 ','line_number':1,'multiline':True]
['text':'*
 * Runs the given 'pipeline' and asserts that the explain behavior is as expected and the pipeline
 * returns correct results.
 *
 * The 'expectedOpts' object contains:
 * - inExcludeSpec: The include or exclude list for the $_internalUnpackBucket.
 ','line_number':81,'multiline':True]
['text':' The unpacking stage might or might not be lowered to SBE.','line_number':91,'multiline':False]
['text':' The sort generated by $setWindowFields is on {attributes.sensor: 1, time: 1} which cannot be','line_number':122,'multiline':False]
['text':' pushed past $_internalUnpackBucket as it is not fully on the 'meta' field. Since we will be','line_number':123,'multiline':False]
['text':' returning the whole document the $_internalUnpackBucket will unpack all regular fields.','line_number':124,'multiline':False]
['text':' $setWindowFields that uses sort on metaField and timeField: {attributes.sensor: 1, time: 1} and','line_number':205,'multiline':False]
['text':' computes over a measurement field.','line_number':206,'multiline':False]
['text':' $_internalUnpackBucket should use dependency analysis to unpack only the needed fields.','line_number':218,'multiline':False]
['text':' $setWindowFields that uses sort on a measurement fields: {language: 1, _id: 1} and computes over','line_number':230,'multiline':False]
['text':' a metaField.','line_number':231,'multiline':False]
['text':' $_internalUnpackBucket should use dependency analysis to unpack only the needed fields.','line_number':243,'multiline':False]
['text':' $_internalUnpackBucket can use dependency analysis to unpack only certain needed fields.','line_number':263,'multiline':False]
['text':' $setWindowFields that uses sort on a metaField and a measurement: {attributes.sensor: 1,','line_number':278,'multiline':False]
['text':' contributions: -1} and computes over a different measurement, followed by $match on a metaField.','line_number':279,'multiline':False]
['text':' $match should swap with $setWindowFields and $_internalUnpackBucket so "attributes.field"','line_number':292,'multiline':False]
['text':' shouldn't be a dependency.','line_number':293,'multiline':False]
