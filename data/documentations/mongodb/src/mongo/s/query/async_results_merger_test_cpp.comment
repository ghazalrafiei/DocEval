['text':'*
 *    Copyright (C) 2018-present MongoDB, Inc.
 *
 *    This program is free software: you can redistribute it and/or modify
 *    it under the terms of the Server Side Public License, version 1,
 *    as published by MongoDB, Inc.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    Server Side Public License for more details.
 *
 *    You should have received a copy of the Server Side Public License
 *    along with this program. If not, see
 *    <http://www.mongodb.com/licensing/server-side-public-license>.
 *
 *    As a special exception, the copyright holders give permission to link the
 *    code of portions of this program with the OpenSSL library under certain
 *    conditions as described in each individual source file and distribute
 *    linked combinations including the program with the OpenSSL library. You
 *    must comply with the Server Side Public License in all respects for
 *    all of the code used other than as permitted herein. If you modify file(s)
 *    with this exception, you may extend this exception to your version of the
 *    file(s), but you are not obligated to do so. If you do not wish to do so,
 *    delete this exception statement from your version. If you delete this
 *    exception statement from all source files in the program, then also delete
 *    it in the license file.
 ','line_number':1,'multiline':True]
['text':' IWYU pragma: no_include "cxxabi.h"','line_number':35,'multiline':False]
['text':' txnOpIndex ','line_number':92,'multiline':True]
['text':' eventIdentifier ','line_number':94,'multiline':True]
['text':' Before any requests are scheduled, ARM is not ready to return results.','line_number':106,'multiline':False]
['text':' Schedule requests.','line_number':110,'multiline':False]
['text':' Before any responses are delivered, ARM is not ready to return results.','line_number':113,'multiline':False]
['text':' Shard responds; the handleBatchResponse callbacks are run and ARM's remotes get updated.','line_number':117,'multiline':False]
['text':' Now that the responses have been delivered, ARM is ready to return results.','line_number':123,'multiline':False]
['text':' Because the response contained a cursorId of 0, ARM marked the remote as exhausted.','line_number':126,'multiline':False]
['text':' ARM returns the correct results.','line_number':129,'multiline':False]
['text':' After returning all the buffered results, ARM returns EOF immediately because the cursor was','line_number':137,'multiline':False]
['text':' exhausted.','line_number':138,'multiline':False]
['text':' Before any requests are scheduled, ARM is not ready to return results.','line_number':150,'multiline':False]
['text':' Schedule requests.','line_number':154,'multiline':False]
['text':' Before any responses are delivered, ARM is not ready to return results.','line_number':157,'multiline':False]
['text':' Shard responds; the handleBatchResponse callbacks are run and ARM's remotes get updated.','line_number':161,'multiline':False]
['text':' Now that the responses have been delivered, ARM is ready to return results.','line_number':167,'multiline':False]
['text':' Because the response contained a cursorId of 0, ARM marked the remote as exhausted.','line_number':170,'multiline':False]
['text':' ARM returns all results in order.','line_number':173,'multiline':False]
['text':' After returning all the buffered results, ARM returns EOF immediately because the cursor was','line_number':181,'multiline':False]
['text':' exhausted.','line_number':182,'multiline':False]
['text':' Before any requests are scheduled, ARM is not ready to return results.','line_number':195,'multiline':False]
['text':' Schedule requests.','line_number':199,'multiline':False]
['text':' Before any responses are delivered, ARM is not ready to return results.','line_number':202,'multiline':False]
['text':' First shard responds; the handleBatchResponse callback is run and ARM's remote gets updated.','line_number':206,'multiline':False]
['text':' ARM is ready to return first result.','line_number':213,'multiline':False]
['text':' ARM is not exhausted, because second shard has yet to respond.','line_number':216,'multiline':False]
['text':' ARM returns results from first shard immediately.','line_number':219,'multiline':False]
['text':' There are no further buffered results, so ARM is not ready.','line_number':227,'multiline':False]
['text':' Make next event to be signaled.','line_number':230,'multiline':False]
['text':' Second shard responds; the handleBatchResponse callback is run and ARM's remote gets updated.','line_number':233,'multiline':False]
['text':' ARM is ready to return remaining results.','line_number':240,'multiline':False]
['text':' ARM returns results from second shard immediately.','line_number':244,'multiline':False]
['text':' After returning all the buffered results, the ARM returns EOF immediately because both shards','line_number':252,'multiline':False]
['text':' cursors were exhausted.','line_number':253,'multiline':False]
['text':' Before any requests are scheduled, ARM is not ready to return results.','line_number':267,'multiline':False]
['text':' Schedule requests.','line_number':271,'multiline':False]
['text':' Before any responses are delivered, ARM is not ready to return results.','line_number':274,'multiline':False]
['text':' First shard responds; the handleBatchResponse callback is run and ARM's remote gets updated.','line_number':278,'multiline':False]
['text':' ARM is not ready to return results until receiving responses from all remotes.','line_number':284,'multiline':False]
['text':' ARM is not exhausted, because second shard has yet to respond.','line_number':287,'multiline':False]
['text':' Second shard responds; the handleBatchResponse callback is run and ARM's remote gets updated.','line_number':290,'multiline':False]
['text':' Now that all remotes have responded, ARM is ready to return results.','line_number':296,'multiline':False]
['text':' ARM returns all results in sorted order.','line_number':300,'multiline':False]
['text':' After returning all the buffered results, the ARM returns EOF immediately because both shards','line_number':314,'multiline':False]
['text':' cursors were exhausted.','line_number':315,'multiline':False]
['text':' Before any requests are scheduled, ARM is not ready to return results.','line_number':328,'multiline':False]
['text':' Schedule requests.','line_number':332,'multiline':False]
['text':' First shard responds; the handleBatchResponse callback is run and ARM's remote gets updated.','line_number':335,'multiline':False]
['text':' ARM is ready to return first result.','line_number':342,'multiline':False]
['text':' ARM is not exhausted, because second shard has yet to respond and first shard's response did','line_number':345,'multiline':False]
['text':' not contain cursorId=0.','line_number':346,'multiline':False]
['text':' ARM returns results from first shard immediately.','line_number':349,'multiline':False]
['text':' There are no further buffered results, so ARM is not ready.','line_number':357,'multiline':False]
['text':' Make next event to be signaled.','line_number':360,'multiline':False]
['text':' Second shard responds; the handleBatchResponse callback is run and ARM's remote gets updated.','line_number':363,'multiline':False]
['text':' ARM is ready to return second shard's results.','line_number':370,'multiline':False]
['text':' ARM is not exhausted, because first shard's response did not contain cursorId=0.','line_number':373,'multiline':False]
['text':' ARM returns results from second shard immediately.','line_number':376,'multiline':False]
['text':' ARM is not ready to return results until further results are obtained from first shard.','line_number':384,'multiline':False]
['text':' Make next event to be signaled.','line_number':387,'multiline':False]
['text':' First shard returns remainder of results.','line_number':390,'multiline':False]
['text':' ARM is ready to return remaining results.','line_number':397,'multiline':False]
['text':' ARM returns remaining results immediately.','line_number':401,'multiline':False]
['text':' After returning all the buffered results, the ARM returns EOF immediately because both shards','line_number':409,'multiline':False]
['text':' cursors were exhausted.','line_number':410,'multiline':False]
['text':' Schedule requests.','line_number':426,'multiline':False]
['text':' Deliver responses.','line_number':431,'multiline':False]
['text':' ARM returns all results in sorted order.','line_number':444,'multiline':False]
['text':' After returning all the buffered results, the ARM returns EOF immediately because both shards','line_number':465,'multiline':False]
['text':' cursors were exhausted.','line_number':466,'multiline':False]
['text':' Parsing the batch results in an error because the sort key is missing.','line_number':482,'multiline':False]
['text':' Required to kill the 'arm' on error before destruction.','line_number':494,'multiline':False]
['text':' Because there was firstBatch, ARM is immediately ready to return results.','line_number':507,'multiline':False]
['text':' Because the cursorId was not zero, ARM is not exhausted.','line_number':510,'multiline':False]
['text':' ARM returns the correct results.','line_number':513,'multiline':False]
['text':' Now that the firstBatch results have been returned, ARM must wait for further results.','line_number':520,'multiline':False]
['text':' Schedule requests.','line_number':523,'multiline':False]
['text':' Before any responses are delivered, ARM is not ready to return results.','line_number':526,'multiline':False]
['text':' Shard responds; the handleBatchResponse callbacks are run and ARM's remotes get updated.','line_number':530,'multiline':False]
['text':' Now that the responses have been delivered, ARM is ready to return results.','line_number':536,'multiline':False]
['text':' Because the response contained a cursorId of 0, ARM marked the remote as exhausted.','line_number':539,'multiline':False]
['text':' ARM returns the correct results.','line_number':542,'multiline':False]
['text':' After returning all the buffered results, ARM returns EOF immediately because the cursor was','line_number':550,'multiline':False]
['text':' exhausted.','line_number':551,'multiline':False]
['text':' Because there was firstBatch, ARM is immediately ready to return results.','line_number':566,'multiline':False]
['text':' Because one of the remotes' cursorId was not zero, ARM is not exhausted.','line_number':569,'multiline':False]
['text':' ARM returns the correct results.','line_number':572,'multiline':False]
['text':' Now that the firstBatch results have been returned, ARM must wait for further results.','line_number':579,'multiline':False]
['text':' Schedule requests.','line_number':582,'multiline':False]
['text':' Before any responses are delivered, ARM is not ready to return results.','line_number':585,'multiline':False]
['text':' Shard responds; the handleBatchResponse callbacks are run and ARM's remotes get updated.','line_number':589,'multiline':False]
['text':' Now that the responses have been delivered, ARM is ready to return results.','line_number':595,'multiline':False]
['text':' Because the response contained a cursorId of 0, ARM marked the remote as exhausted.','line_number':598,'multiline':False]
['text':' ARM returns the correct results.','line_number':601,'multiline':False]
['text':' After returning all the buffered results, ARM returns EOF immediately because the cursor was','line_number':609,'multiline':False]
['text':' exhausted.','line_number':610,'multiline':False]
['text':' Both shards respond with the first batch.','line_number':627,'multiline':False]
['text':' When we ask the shards for their next batch, the first shard responds and the second shard','line_number':649,'multiline':False]
['text':' never responds.','line_number':650,'multiline':False]
['text':' We can continue to return results from first shard, while second shard remains unresponsive.','line_number':667,'multiline':False]
['text':' Required to kill the 'arm' on error before destruction.','line_number':703,'multiline':False]
['text':' Required to kill the 'arm' on error before destruction.','line_number':736,'multiline':False]
['text':' Required to kill the 'arm' on error before destruction.','line_number':771,'multiline':False]
['text':' Error to call nextEvent()() before the previous event is signaled.','line_number':785,'multiline':False]
['text':' Required to kill the 'arm' on error before destruction.','line_number':801,'multiline':False]
['text':' Make a request to the shard that will never get answered.','line_number':824,'multiline':False]
['text':' Executor shuts down before a response is received.','line_number':830,'multiline':False]
['text':' Ensure that the executor finishes all of the outstanding callbacks before the ARM is freed.','line_number':835,'multiline':False]
['text':' Killed cursors are considered ready, but return an error when you try to receive the next','line_number':849,'multiline':False]
['text':' doc.','line_number':850,'multiline':False]
['text':' ARM shouldn't schedule killCursors on anything since all of the remotes are exhausted.','line_number':882,'multiline':False]
['text':' Cursor 3 is not exhausted.','line_number':909,'multiline':False]
['text':' ARM should schedule killCursors on cursor 123','line_number':916,'multiline':False]
['text':' Kill event will only be signalled once the callbacks for the pending batches have run.','line_number':943,'multiline':False]
['text':' Check that the ARM kills both batches.','line_number':946,'multiline':False]
['text':' Run the callbacks which were canceled.','line_number':950,'multiline':False]
['text':' Ensure that we properly signal those waiting for more results to be ready.','line_number':953,'multiline':False]
['text':' Attempting to schedule more network operations on a killed arm is an error.','line_number':975,'multiline':False]
['text':' Mark the OperationContext as killed from this thread.','line_number':1011,'multiline':False]
['text':' Issue a blocking wait for the next result asynchronously on a different thread.','line_number':1017,'multiline':False]
['text':' Wait for the merger to be interrupted.','line_number':1023,'multiline':False]
['text':' Kill should complete.','line_number':1026,'multiline':False]
['text':' Mark the OperationContext as killed from this thread.','line_number':1039,'multiline':False]
['text':' Issue a blocking wait for the next result asynchronously on a different thread.','line_number':1045,'multiline':False]
['text':' Wait for the merger to be interrupted.','line_number':1051,'multiline':False]
['text':' Kill should complete.','line_number':1054,'multiline':False]
['text':' In the tailable case, we expect EOF after every batch.','line_number':1081,'multiline':False]
['text':' Remote responds with an empty batch and a non-zero cursor id.','line_number':1118,'multiline':False]
['text':' After receiving an empty batch, the ARM should return boost::none, but remotes should not be','line_number':1125,'multiline':False]
['text':' marked as exhausted.','line_number':1126,'multiline':False]
['text':' Remote responds with an empty batch and a zero cursor id.','line_number':1146,'multiline':False]
['text':' Afterwards, the ARM should return boost::none and remote cursors should be marked as','line_number':1153,'multiline':False]
['text':' exhausted.','line_number':1154,'multiline':False]
['text':' An error occurs with the first host.','line_number':1221,'multiline':False]
['text':' Instead of propagating the error, we should be willing to return results from the two','line_number':1225,'multiline':False]
['text':' remaining shards.','line_number':1226,'multiline':False]
['text':' Now the second host becomes unreachable. We should still be willing to return results from','line_number':1244,'multiline':False]
['text':' the third shard.','line_number':1245,'multiline':False]
['text':' Once the last reachable shard indicates that its cursor is closed, we're done.','line_number':1262,'multiline':False]
['text':' The lone host involved in this query returns an error. This should simply cause us to return','line_number':1299,'multiline':False]
['text':' EOF.','line_number':1300,'multiline':False]
['text':' First host returns single result','line_number':1319,'multiline':False]
['text':' From the second host we get a network (retriable) error.','line_number':1325,'multiline':False]
['text':' Two shards.','line_number':1342,'multiline':False]
['text':' First host returns single result.','line_number':1353,'multiline':False]
['text':' From the second host we get a MaxTimeMSExpired error.','line_number':1359,'multiline':False]
['text':' two shards','line_number':1378,'multiline':False]
['text':' First host returns single result','line_number':1389,'multiline':False]
['text':' From the second host we get a MaxTimeMSExpired error.','line_number':1395,'multiline':False]
['text':' Required to kill the 'arm' on error before destruction.','line_number':1404,'multiline':False]
['text':' two shards','line_number':1412,'multiline':False]
['text':' From the first host we get a MaxTimeMSExpired error.','line_number':1423,'multiline':False]
['text':' Second host returns single result *after* first host times out.','line_number':1426,'multiline':False]
['text':' Both hosts return network (retriable) errors.','line_number':1454,'multiline':False]
['text':' Required to kill the 'arm' on error before destruction.','line_number':1466,'multiline':False]
['text':' Pending getMore request should already have been scheduled without the maxTimeMS.','line_number':1496,'multiline':False]
['text':' The next getMore request should include the maxTimeMS.','line_number':1515,'multiline':False]
['text':' Clean up.','line_number':1521,'multiline':False]
['text':' Create one cursor whose initial response has a postBatchResumeToken.','line_number':1536,'multiline':False]
['text':' Create a second cursor whose initial batch has no PBRT.','line_number':1547,'multiline':False]
['text':' We should be dead by now.','line_number':1559,'multiline':False]
['text':' We should be dead by now.','line_number':1589,'multiline':False]
['text':' Clean up the cursors.','line_number':1622,'multiline':False]
['text':' Schedule one response with an oplog timestamp in it.','line_number':1647,'multiline':False]
['text':' Should be ready now.','line_number':1660,'multiline':False]
['text':' Add the new shard.','line_number':1663,'multiline':False]
['text':' Now shouldn't be ready, our guarantee from the new shard isn't sufficiently advanced.','line_number':1672,'multiline':False]
['text':' Schedule another response from the other shard.','line_number':1676,'multiline':False]
['text':' Clean up the cursors.','line_number':1697,'multiline':False]
['text':' Schedule one response with an oplog timestamp in it.','line_number':1725,'multiline':False]
['text':' Should be ready now.','line_number':1737,'multiline':False]
['text':' Add the new shard.','line_number':1740,'multiline':False]
['text':' Now shouldn't be ready, our guarantee from the new shard isn't sufficiently advanced.','line_number':1749,'multiline':False]
['text':' Schedule another response from the other shard.','line_number':1753,'multiline':False]
['text':' The last observed time should still be later than the first shard, so we can get the data','line_number':1762,'multiline':False]
['text':' from it.','line_number':1763,'multiline':False]
['text':' Clean up the cursors.','line_number':1775,'multiline':False]
['text':' Create three cursors with empty initial batches. Each batch has a PBRT.','line_number':1790,'multiline':False]
['text':' We have no results to return, so the ARM is not ready.','line_number':1812,'multiline':False]
['text':' The high water mark should be the second cursor's PBRT, since it is the lowest of the three.','line_number':1816,'multiline':False]
['text':' Advance the PBRT of the second cursor. It should still be the lowest. The fixture expects','line_number':1819,'multiline':False]
['text':' each cursor to be updated in-order, so we keep the first and third PBRTs constant.','line_number':1820,'multiline':False]
['text':' Advance the second cursor again, so that it surpasses the other two. The third cursor becomes','line_number':1829,'multiline':False]
['text':' the new high water mark.','line_number':1830,'multiline':False]
['text':' Advance the third cursor such that the first cursor becomes the high water mark.','line_number':1838,'multiline':False]
['text':' Clean up the cursors.','line_number':1846,'multiline':False]
['text':' Create three cursors with empty initial batches. Each batch has a PBRT. The third cursor is','line_number':1857,'multiline':False]
['text':' the $changeStream opened on "config.shards" to monitor for the addition of new shards.','line_number':1858,'multiline':False]
['text':' We have no results to return, so the ARM is not ready.','line_number':1881,'multiline':False]
['text':' For a change stream cursor on "config.shards", the first batch is not eligible to provide the','line_number':1885,'multiline':False]
['text':' HWM. Despite the fact that 'pbrtConfigCursor' has the lowest PBRT, the ARM returns the PBRT','line_number':1886,'multiline':False]
['text':' of 'pbrtSecondCursor' as the current high water mark. This guards against the possibility','line_number':1887,'multiline':False]
['text':' that the user requests a start time in the future. The "config.shards" cursor must start','line_number':1888,'multiline':False]
['text':' monitoring for shards at the current point in time, and so its initial PBRT will be lower','line_number':1889,'multiline':False]
['text':' than that of the shards. We do not wish to return a high water mark to the client that is','line_number':1890,'multiline':False]
['text':' earlier than the start time they specified in their request.','line_number':1891,'multiline':False]
['text':' Advance the PBRT of the 'pbrtConfigCursor'. It is still the lowest, but is ineligible to','line_number':1895,'multiline':False]
['text':' provide the high water mark because it is still lower than the high water mark that was','line_number':1896,'multiline':False]
['text':' already returned. As above, the guards against the possibility that the user requested a','line_number':1897,'multiline':False]
['text':' stream with a start point at an arbitrary point in the future.','line_number':1898,'multiline':False]
['text':' The high water mark has not advanced from its previous value.','line_number':1908,'multiline':False]
['text':' If the "config.shards" cursor returns a result, this document does not advance the HWM. We','line_number':1912,'multiline':False]
['text':' consume this event internally but do not return it to the client, and its resume token is not','line_number':1913,'multiline':False]
['text':' actually resumable. We therefore do not want to expose it to the client via the PBRT.','line_number':1914,'multiline':False]
['text':' The config cursor has a lower sort key than the other shards, so we can retrieve the event.','line_number':1930,'multiline':False]
['text':' Reading the config cursor event document does not advance the high water mark.','line_number':1935,'multiline':False]
['text':' If the next config batch is empty but the PBRT is still the resume token of the addShard','line_number':1939,'multiline':False]
['text':' event, it does not advance the ARM's high water mark sort key.','line_number':1940,'multiline':False]
['text':' If none of the above criteria obtain, then the "config.shards" cursor is eligible to advance','line_number':1951,'multiline':False]
['text':' the ARM's high water mark. The only reason we allow the config.shards cursor to participate','line_number':1952,'multiline':False]
['text':' in advancing of the high water mark at all is so that we cannot end up in a situation where','line_number':1953,'multiline':False]
['text':' the config cursor is always the lowest and the high water mark can therefore never advance.','line_number':1954,'multiline':False]
['text':' Clean up the cursors.','line_number':1967,'multiline':False]
['text':' Required to kill the 'arm' on error before destruction.','line_number':2011,'multiline':False]
['text':' Before any requests are scheduled, ARM is not ready to return results.','line_number':2022,'multiline':False]
['text':' Schedule requests.','line_number':2026,'multiline':False]
['text':' Before any responses are delivered, ARM is not ready to return results.','line_number':2029,'multiline':False]
['text':' Kill the ARM while a batch is still outstanding. The callback for the outstanding batch','line_number':2033,'multiline':False]
['text':' should be canceled.','line_number':2034,'multiline':False]
['text':' Check that the ARM will run killCursors.','line_number':2037,'multiline':False]
['text':' Let the callback run now that it's been canceled.','line_number':2040,'multiline':False]
['text':' There should be no lsid txnNumber in the scheduled getMore.','line_number':2053,'multiline':False]
['text':' There should be an lsid and no txnNumber in the scheduled getMore.','line_number':2075,'multiline':False]
['text':' Subsequent requests still pass the lsid.','line_number':2087,'multiline':False]
['text':' The first scheduled getMore should pass the txnNumber the ARM was constructed with.','line_number':2116,'multiline':False]
['text':' Subsequent requests still pass the txnNumber.','line_number':2128,'multiline':False]
['text':' Subsequent getMore requests should include txnNumber.','line_number':2133,'multiline':False]
['text':' Should crash.','line_number':2157,'multiline':False]
['text':' While detached from the OperationContext, schedule an empty batch response. Because the','line_number':2171,'multiline':False]
['text':' response is empty and this is a tailable cursor, the ARM will need to run another getMore on','line_number':2172,'multiline':False]
['text':' that host, but it should not schedule this without a non-null OperationContext.','line_number':2173,'multiline':False]
['text':' Tests that we haven't asked for the next batch yet.','line_number':2183,'multiline':False]
['text':' After manually requesting the next getMore, the ARM should be ready.','line_number':2185,'multiline':False]
['text':' Schedule the next getMore response.','line_number':2189,'multiline':False]
['text':' namespace','line_number':2207,'multiline':False]
['text':' namespace mongo','line_number':2208,'multiline':False]
