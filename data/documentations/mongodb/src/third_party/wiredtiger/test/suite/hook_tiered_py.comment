['text':'!/usr/bin/env python','line_number':1,'multiline':False]
['text':'','line_number':2,'multiline':False]
['text':' Public Domain 2014-present MongoDB, Inc.','line_number':3,'multiline':False]
['text':' Public Domain 2008-2014 WiredTiger, Inc.','line_number':4,'multiline':False]
['text':'','line_number':5,'multiline':False]
['text':' This is free and unencumbered software released into the public domain.','line_number':6,'multiline':False]
['text':'','line_number':7,'multiline':False]
['text':' Anyone is free to copy, modify, publish, use, compile, sell, or','line_number':8,'multiline':False]
['text':' distribute this software, either in source code form or as a compiled','line_number':9,'multiline':False]
['text':' binary, for any purpose, commercial or non-commercial, and by any','line_number':10,'multiline':False]
['text':' means.','line_number':11,'multiline':False]
['text':'','line_number':12,'multiline':False]
['text':' In jurisdictions that recognize copyright laws, the author or authors','line_number':13,'multiline':False]
['text':' of this software dedicate any and all copyright interest in the','line_number':14,'multiline':False]
['text':' software to the public domain. We make this dedication for the benefit','line_number':15,'multiline':False]
['text':' of the public at large and to the detriment of our heirs and','line_number':16,'multiline':False]
['text':' successors. We intend this dedication to be an overt act of','line_number':17,'multiline':False]
['text':' relinquishment in perpetuity of all present and future rights to this','line_number':18,'multiline':False]
['text':' software under copyright law.','line_number':19,'multiline':False]
['text':'','line_number':20,'multiline':False]
['text':' THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,','line_number':21,'multiline':False]
['text':' EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF','line_number':22,'multiline':False]
['text':' MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.','line_number':23,'multiline':False]
['text':' IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR','line_number':24,'multiline':False]
['text':' OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,','line_number':25,'multiline':False]
['text':' ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR','line_number':26,'multiline':False]
['text':' OTHER DEALINGS IN THE SOFTWARE.','line_number':27,'multiline':False]
['text':'','line_number':28,'multiline':False]
['text':' [TEST_TAGS]','line_number':29,'multiline':False]
['text':' ignored_file','line_number':30,'multiline':False]
['text':' [END_TAGS]','line_number':31,'multiline':False]
['text':' hook_tiered.py','line_number':33,'multiline':False]
['text':'','line_number':34,'multiline':False]
['text':' Substitute tiered tables for regular (row-store) tables in Python tests.','line_number':35,'multiline':False]
['text':'','line_number':36,'multiline':False]
['text':' These hooks are intended for basic testing of tiered tables.  There are several','line_number':37,'multiline':False]
['text':' pieces of functionality here.','line_number':38,'multiline':False]
['text':'','line_number':39,'multiline':False]
['text':' 1. We add tiered storage parameters to the config when calling wiredtiger_open()','line_number':40,'multiline':False]
['text':'','line_number':41,'multiline':False]
['text':' 2. If we create an object that is *not* a table:, we add options to its config','line_number':42,'multiline':False]
['text':'    so that it will be stored local-only.  Tiered storage isn't intended (yet?) for','line_number':43,'multiline':False]
['text':'    use with lsm or column store.','line_number':44,'multiline':False]
['text':'','line_number':45,'multiline':False]
['text':' 3. We add calls to flush_tier().  Currently we only flush after a checkpoint() call,','line_number':46,'multiline':False]
['text':'    but we should add others.','line_number':47,'multiline':False]
['text':'','line_number':48,'multiline':False]
['text':' 4. We stub out some functions that aren't supported by tiered tables.  This will','line_number':49,'multiline':False]
['text':'    break tests of those functions.  But often when they are used in other tests, we','line_number':50,'multiline':False]
['text':'    can get away with returning success without performing the operation.','line_number':51,'multiline':False]
['text':'','line_number':52,'multiline':False]
['text':' To run, for example, the cursor tests with these hooks enabled:','line_number':53,'multiline':False]
['text':'     ../test/suite/run.py --hook tiered cursor','line_number':54,'multiline':False]
['text':'','line_number':55,'multiline':False]
['text':' These are the hook functions that are run when particular APIs are called.','line_number':62,'multiline':False]
['text':' Add the local storage extension whenever we call wiredtiger_open','line_number':64,'multiline':False]
['text':' Construct the configuration string based on the storage source.','line_number':76,'multiline':False]
['text':' If there is already tiered storage enabled, we shouldn't enable it here.','line_number':95,'multiline':False]
['text':' We might attempt to let the wiredtiger_open complete without alteration,','line_number':96,'multiline':False]
['text':' however, we alter several other API methods that would do weird things with','line_number':97,'multiline':False]
['text':' a different tiered_storage configuration. So better to skip the test entirely.','line_number':98,'multiline':False]
['text':' Similarly if this test is already set up to run tiered vs non-tiered scenario, let's','line_number':102,'multiline':False]
['text':' not get in the way.','line_number':103,'multiline':False]
['text':' Mark this test as readonly, but don't disallow it.  See testcase_is_readonly().','line_number':110,'multiline':False]
['text':' Build the extension strings, we'll need to merge it with any extensions','line_number':129,'multiline':False]
['text':' already in the configuration.','line_number':130,'multiline':False]
['text':' convert from a readonly tuple to a writeable list','line_number':146,'multiline':False]
['text':' Modify the list','line_number':147,'multiline':False]
['text':' We want readonly tests to run with tiered storage, since it is possible to do readonly','line_number':154,'multiline':False]
['text':' operations.  This function is called for two purposes:','line_number':155,'multiline':False]
['text':'  - when readonly is enabled, we don't want to do flush_tier calls.','line_number':156,'multiline':False]
['text':'  - normally the hook silently removes other (not supported) calls, like compact/rename/salvage.','line_number':157,'multiline':False]
['text':'    Except that some tests enable readonly and call these functions, expecting an exception.','line_number':158,'multiline':False]
['text':'    So for these "modifying" APIs, we want to actually do the operation (but only when readonly).','line_number':159,'multiline':False]
['text':' Called to replace Connection.close','line_number':176,'multiline':False]
['text':' Insert a call to flush_tier before closing connection.','line_number':177,'multiline':False]
['text':' We cannot call flush_tier on a readonly connection.','line_number':179,'multiline':False]
['text':' Likewise we should not call flush_tier if the test case has failed,','line_number':180,'multiline':False]
['text':' and the connection is being closed at the end of the run after the failure.','line_number':181,'multiline':False]
['text':' Otherwise, diagnosing the original failure may be troublesome.','line_number':182,'multiline':False]
['text':' Called to replace Session.checkpoint.','line_number':192,'multiline':False]
['text':' We add a call to flush_tier during every checkpoint to make sure we are exercising tiered','line_number':193,'multiline':False]
['text':' functionality.','line_number':194,'multiline':False]
['text':' FIXME-WT-10771 We cannot do named checkpoints with tiered storage objects.','line_number':196,'multiline':False]
['text':' We can't really continue the test without the name, as the name will certainly be used.','line_number':197,'multiline':False]
['text':' We cannot call flush_tier on a readonly connection.','line_number':202,'multiline':False]
['text':' Enable flush_tier on checkpoint.','line_number':204,'multiline':False]
['text':' Called to replace Session.compact','line_number':208,'multiline':False]
['text':' FIXME-PM-2538','line_number':210,'multiline':False]
['text':' Compact isn't implemented for tiered tables.  Only call it if this can't be the uri','line_number':211,'multiline':False]
['text':' of a tiered table.  Note this isn't a precise match for when we did/didn't create','line_number':212,'multiline':False]
['text':' a tiered table, but we don't have the create config around to check.','line_number':213,'multiline':False]
['text':' Background compaction can be enabled or disabled, each compact call it issues should circle','line_number':214,'multiline':False]
['text':' back here.','line_number':215,'multiline':False]
['text':' We want readonly connections to do the real call, see comment in testcase_is_readonly.','line_number':216,'multiline':False]
['text':' Called to replace Session.create','line_number':223,'multiline':False]
['text':' If the test isn't creating a table (i.e., it's a column store or lsm) create it as a','line_number':230,'multiline':False]
['text':' "local only" object.  Otherwise we get tiered storage from the connection defaults.','line_number':231,'multiline':False]
['text':' We want readonly connections to do the real call, see comment in testcase_is_readonly.','line_number':232,'multiline':False]
['text':' FIXME-WT-9832 Column store testing should be allowed with this hook.','line_number':233,'multiline':False]
['text':' FIXME-PM-2532','line_number':242,'multiline':False]
['text':' Called to replace Session.open_cursor. This is needed to skip tests that','line_number':243,'multiline':False]
['text':' do backup on (tiered) table data sources, as that is not yet supported.','line_number':244,'multiline':False]
['text':' Called to replace Session.rename','line_number':250,'multiline':False]
['text':' Rename isn't implemented for tiered tables.  Only call it if this can't be the uri','line_number':252,'multiline':False]
['text':' of a tiered table.  Note this isn't a precise match for when we did/didn't create','line_number':253,'multiline':False]
['text':' a tiered table, but we don't have the create config around to check.','line_number':254,'multiline':False]
['text':' We want readonly connections to do the real call, see comment in testcase_is_readonly.','line_number':255,'multiline':False]
['text':' Called to replace Session.salvage','line_number':261,'multiline':False]
['text':' Salvage isn't implemented for tiered tables.  Only call it if this can't be the uri','line_number':263,'multiline':False]
['text':' of a tiered table.  Note this isn't a precise match for when we did/didn't create','line_number':264,'multiline':False]
['text':' a tiered table, but we don't have the create config around to check.','line_number':265,'multiline':False]
['text':' We want readonly connections to do the real call, see comment in testcase_is_readonly.','line_number':266,'multiline':False]
['text':' Called to replace Session.verify','line_number':272,'multiline':False]
['text':' Verify isn't implemented for tiered tables.  Only call it if this can't be the uri','line_number':274,'multiline':False]
['text':' of a tiered table.  Note this isn't a precise match for when we did/didn't create','line_number':275,'multiline':False]
['text':' a tiered table, but we don't have the create config around to check.','line_number':276,'multiline':False]
['text':' We want readonly connections to do the real call, see comment in testcase_is_readonly.','line_number':277,'multiline':False]
['text':' Every hook file must have one or more classes descended from WiredTigerHook','line_number':283,'multiline':False]
['text':' This is where the hook functions are 'hooked' to API methods.','line_number':284,'multiline':False]
['text':' Caller can specify an optional command-line argument.  We're not using it','line_number':287,'multiline':False]
['text':' now, but this is where it would show up.','line_number':288,'multiline':False]
['text':' Override some platform APIs','line_number':290,'multiline':False]
['text':' Our current tiered storage implementation has a slow version of truncate, and','line_number':293,'multiline':False]
['text':' some tests are sensitive to that.','line_number':294,'multiline':False]
['text':'','line_number':295,'multiline':False]
['text':' FIXME-WT-11023: when we implement a fast truncate for tiered storage, we might remove','line_number':296,'multiline':False]
['text':' this, and visit tests that are marked with @wttest.prevent(..."slow_truncate"...)','line_number':297,'multiline':False]
['text':' Determine whether a test should be skipped, if it should also return the reason for skipping.','line_number':303,'multiline':False]
['text':' Some features aren't supported with tiered storage currently. If they exist in','line_number':304,'multiline':False]
['text':' the test name (or scenario name) skip the test.','line_number':305,'multiline':False]
['text':' Skip tests that won't work on tiered cursors','line_number':325,'multiline':False]
['text':' Strip matching parens, which act as a quoting mechanism.','line_number':370,'multiline':False]
['text':' Override some platform APIs for this hook.','line_number':387,'multiline':False]
['text':' We want to split args something like arg.split(','), except that we need','line_number':396,'multiline':False]
['text':' to sometimes allow commas as part of the individual parameters, which we','line_number':397,'multiline':False]
['text':' allow via parens.  For example, a developer can run:','line_number':398,'multiline':False]
['text':'  run.py --hook \','line_number':399,'multiline':False]
['text':'    'tiered=(tier_storage_source=dir_store,tier_storage_source_config=(force_delay=5,delay_ms=10))'','line_number':400,'multiline':False]
['text':'','line_number':401,'multiline':False]
['text':' and that should appear as two parameters to the tiered hook.','line_number':402,'multiline':False]
['text':' Note: this regular expression does not handle arbitrary nesting of parens','line_number':405,'multiline':False]
['text':'wttest.WiredTigerTestCase.tty('Tiered hook params={}'.format(params))','line_number':410,'multiline':False]
['text':' Every hook file must have a top level initialize function,','line_number':448,'multiline':False]
['text':' returning a list of WiredTigerHook objects.','line_number':449,'multiline':False]
