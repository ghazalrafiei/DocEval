['text':'************************************************
*      Perl-Compatible Regular Expressions       *
************************************************','line_number':1,'multiline':True]
['text':' PCRE is a library of functions to support regular expressions whose syntax
and semantics are as close as possible to those of the Perl 5 language.

                       Written by Philip Hazel
     Original API code Copyright (c) 1997-2012 University of Cambridge
          New API code Copyright (c) 2016-2022 University of Cambridge

-----------------------------------------------------------------------------
Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions are met:

    * Redistributions of source code must retain the above copyright notice,
      this list of conditions and the following disclaimer.

    * Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in the
      documentation and/or other materials provided with the distribution.

    * Neither the name of the University of Cambridge nor the names of its
      contributors may be used to endorse or promote products derived from
      this software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE
LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
POSSIBILITY OF SUCH DAMAGE.
-----------------------------------------------------------------------------
','line_number':5,'multiline':True]
['text':' Block containing newline information ','line_number':46,'multiline':True]
['text':' Field containing processed string start ','line_number':47,'multiline':True]
['text':' Field containing processed string end ','line_number':48,'multiline':True]
['text':' In rare error cases debugging might require calling pcre2_printint(). ','line_number':52,'multiline':True]
['text':' Other debugging code can be enabled by these defines. ','line_number':64,'multiline':True]
['text':' #define DEBUG_SHOW_CAPTURES ','line_number':66,'multiline':True]
['text':' #define DEBUG_SHOW_PARSED ','line_number':67,'multiline':True]
['text':' There are a few things that vary with different code unit sizes. Handle them
by defining macros in order to minimize #if usage. ','line_number':69,'multiline':True]
['text':' Either 16-bit or 32-bit ','line_number':76,'multiline':True]
['text':' 32-bit ','line_number':82,'multiline':True]
['text':' Macros to store and retrieve a PCRE2_SIZE value in the parsed pattern, which
consists of uint32_t elements. Assume that if uint32_t can't hold it, two of
them will be able to (i.e. assume a 64-bit world). ','line_number':87,'multiline':True]
['text':' Macros for manipulating elements of the parsed pattern vector. ','line_number':111,'multiline':True]
['text':' Function definitions to allow mutual recursion ','line_number':117,'multiline':True]
['text':'************************************************
*      Code parameters and static tables         *
************************************************','line_number':143,'multiline':True]
['text':' COMPILE_WORK_SIZE specifies the size of stack workspace, which is used in
different ways in the different pattern scans. The parsing and group-
identifying pre-scan uses it to handle nesting, and needs it to be 16-bit
aligned for this. Having defined the size in code units, we set up
C16_WORK_SIZE as the number of elements in the 16-bit vector.

During the first compiling phase, when determining how much memory is required,
the regex is partly compiled into this space, but the compiled parts are
discarded as soon as they can be, so that hopefully there will never be an
overrun. The code does, however, check for an overrun, which can occur for
pathological patterns. The size of the workspace depends on LINK_SIZE because
the length of compiled items varies with this.

In the real compile phase, this workspace is not currently used. ','line_number':151,'multiline':True]
['text':' Size in code units ','line_number':166,'multiline':True]
['text':' A uint32_t vector is used for caching information about the size of
capturing groups, to improve performance. A default is created on the stack of
this size. ','line_number':171,'multiline':True]
['text':' The overrun tests check for a slightly smaller size so that they detect the
overrun before it actually does run off the end of the data block. ','line_number':177,'multiline':True]
['text':' This value determines the size of the initial vector that is used for
remembering named groups during the pre-compile. It is allocated on the stack,
but if it is too small, it is expanded, in a similar way to the workspace. The
value is the number of slots in the list. ','line_number':182,'multiline':True]
['text':' The pre-compiling pass over the pattern creates a parsed pattern in a vector
of uint32_t. For short patterns this lives on the stack, with this size. Heap
memory is used for longer patterns. ','line_number':189,'multiline':True]
['text':' Maximum length value to check against when making sure that the variable
that holds the compiled pattern length does not overflow. We make it a bit less
than INT_MAX to allow for adding in group terminating code units, so that we
don't have to check them every time. ','line_number':195,'multiline':True]
['text':' Code values for parsed patterns, which are stored in a vector of 32-bit
unsigned ints. Values less than META_END are literal data values. The coding
for identifying the item is in the top 16-bits, leaving 16 bits for the
additional data that some of them need. The META_CODE, META_DATA, and META_DIFF
macros are used to manipulate parsed pattern elements.

NOTE: When these definitions are changed, the table of extra lengths for each
code (meta_extra_lengths, just below) must be updated to remain in step. ','line_number':202,'multiline':True]
['text':' End of pattern ','line_number':211,'multiline':True]
['text':' alternation ','line_number':213,'multiline':True]
['text':' atomic group ','line_number':214,'multiline':True]
['text':' Back ref ','line_number':215,'multiline':True]
['text':' \k'name' ','line_number':216,'multiline':True]
['text':' Next is a literal > META_END ','line_number':217,'multiline':True]
['text':' (?C with numerical argument ','line_number':218,'multiline':True]
['text':' (?C with string argument ','line_number':219,'multiline':True]
['text':' Capturing parenthesis ','line_number':220,'multiline':True]
['text':' ^ metacharacter ','line_number':221,'multiline':True]
['text':' start non-empty class ','line_number':222,'multiline':True]
['text':' empty class ','line_number':223,'multiline':True]
['text':' negative empty class ','line_number':224,'multiline':True]
['text':' end of non-empty class ','line_number':225,'multiline':True]
['text':' start non-empty negative class ','line_number':226,'multiline':True]
['text':' (?(?assertion)... ','line_number':227,'multiline':True]
['text':' (?(DEFINE)... ','line_number':228,'multiline':True]
['text':' (?(<name>)... ','line_number':229,'multiline':True]
['text':' (?(digits)... ','line_number':230,'multiline':True]
['text':' (?(R&name)... ','line_number':231,'multiline':True]
['text':' (?(Rdigits)... ','line_number':232,'multiline':True]
['text':' (?(VERSION<op>x.y)... ','line_number':233,'multiline':True]
['text':' $ metacharacter ','line_number':234,'multiline':True]
['text':' . metacharacter ','line_number':235,'multiline':True]
['text':' \d and friends ','line_number':236,'multiline':True]
['text':' closing parenthesis ','line_number':237,'multiline':True]
['text':' no capture parens ','line_number':238,'multiline':True]
['text':' (?i) and friends ','line_number':239,'multiline':True]
['text':' POSIX class item ','line_number':240,'multiline':True]
['text':' negative POSIX class item ','line_number':241,'multiline':True]
['text':' range with at least one escape ','line_number':242,'multiline':True]
['text':' range defined literally ','line_number':243,'multiline':True]
['text':' Recursion ','line_number':244,'multiline':True]
['text':' (?&name) ','line_number':245,'multiline':True]
['text':' (*script_run:...) ','line_number':246,'multiline':True]
['text':' These must be kept together to make it easy to check that an assertion
is present where expected in a conditional group. ','line_number':248,'multiline':True]
['text':' (?= ','line_number':251,'multiline':True]
['text':' (?! ','line_number':252,'multiline':True]
['text':' (?<= ','line_number':253,'multiline':True]
['text':' (?<! ','line_number':254,'multiline':True]
['text':' These cannot be conditions ','line_number':256,'multiline':True]
['text':' (*napla: ','line_number':258,'multiline':True]
['text':' (*naplb: ','line_number':259,'multiline':True]
['text':' These must be kept in this order, with consecutive values, and the _ARG
versions of COMMIT, PRUNE, SKIP, and THEN immediately after their non-argument
versions. ','line_number':261,'multiline':True]
['text':' (*MARK) ','line_number':265,'multiline':True]
['text':' (*ACCEPT) ','line_number':266,'multiline':True]
['text':' (*FAIL) ','line_number':267,'multiline':True]
['text':' These               ','line_number':268,'multiline':True]
['text':'   pairs             ','line_number':269,'multiline':True]
['text':'     must            ','line_number':270,'multiline':True]
['text':'       be            ','line_number':271,'multiline':True]
['text':'         kept        ','line_number':272,'multiline':True]
['text':'           in        ','line_number':273,'multiline':True]
['text':'             this    ','line_number':274,'multiline':True]
['text':'               order ','line_number':275,'multiline':True]
['text':' These must be kept in groups of adjacent 3 values, and all together. ','line_number':277,'multiline':True]
['text':' *  ','line_number':279,'multiline':True]
['text':' *+ ','line_number':280,'multiline':True]
['text':' *? ','line_number':281,'multiline':True]
['text':' +  ','line_number':282,'multiline':True]
['text':' ++ ','line_number':283,'multiline':True]
['text':' +? ','line_number':284,'multiline':True]
['text':' ?  ','line_number':285,'multiline':True]
['text':' ?+ ','line_number':286,'multiline':True]
['text':' ?? ','line_number':287,'multiline':True]
['text':' {n,m}  repeat ','line_number':288,'multiline':True]
['text':' {n,m}+ repeat ','line_number':289,'multiline':True]
['text':' {n,m}? repeat ','line_number':290,'multiline':True]
['text':' This is a special "meta code" that is used only to distinguish (*asr: from
(*sr: in the table of aphabetic assertions. It is never stored in the parsed
pattern because (*asr: is turned into (*sr:(*atomic: at that stage. There is
therefore no need for it to have a length entry, so use a high value. ','line_number':295,'multiline':True]
['text':' Table of extra lengths for each of the meta codes. Must be kept in step with
the definitions above. For some items these values are a basic length to which
a variable amount has to be added. ','line_number':302,'multiline':True]
['text':' META_END ','line_number':307,'multiline':True]
['text':' META_ALT ','line_number':308,'multiline':True]
['text':' META_ATOMIC ','line_number':309,'multiline':True]
['text':' META_BACKREF - more if group is >= 10 ','line_number':310,'multiline':True]
['text':' META_BACKREF_BYNAME ','line_number':311,'multiline':True]
['text':' META_BIGVALUE ','line_number':312,'multiline':True]
['text':' META_CALLOUT_NUMBER ','line_number':313,'multiline':True]
['text':' META_CALLOUT_STRING ','line_number':314,'multiline':True]
['text':' META_CAPTURE ','line_number':315,'multiline':True]
['text':' META_CIRCUMFLEX ','line_number':316,'multiline':True]
['text':' META_CLASS ','line_number':317,'multiline':True]
['text':' META_CLASS_EMPTY ','line_number':318,'multiline':True]
['text':' META_CLASS_EMPTY_NOT ','line_number':319,'multiline':True]
['text':' META_CLASS_END ','line_number':320,'multiline':True]
['text':' META_CLASS_NOT ','line_number':321,'multiline':True]
['text':' META_COND_ASSERT ','line_number':322,'multiline':True]
['text':' META_COND_DEFINE ','line_number':323,'multiline':True]
['text':' META_COND_NAME ','line_number':324,'multiline':True]
['text':' META_COND_NUMBER ','line_number':325,'multiline':True]
['text':' META_COND_RNAME ','line_number':326,'multiline':True]
['text':' META_COND_RNUMBER ','line_number':327,'multiline':True]
['text':' META_COND_VERSION ','line_number':328,'multiline':True]
['text':' META_DOLLAR ','line_number':329,'multiline':True]
['text':' META_DOT ','line_number':330,'multiline':True]
['text':' META_ESCAPE - more for ESC_P, ESC_p, ESC_g, ESC_k ','line_number':331,'multiline':True]
['text':' META_KET ','line_number':332,'multiline':True]
['text':' META_NOCAPTURE ','line_number':333,'multiline':True]
['text':' META_OPTIONS ','line_number':334,'multiline':True]
['text':' META_POSIX ','line_number':335,'multiline':True]
['text':' META_POSIX_NEG ','line_number':336,'multiline':True]
['text':' META_RANGE_ESCAPED ','line_number':337,'multiline':True]
['text':' META_RANGE_LITERAL ','line_number':338,'multiline':True]
['text':' META_RECURSE ','line_number':339,'multiline':True]
['text':' META_RECURSE_BYNAME ','line_number':340,'multiline':True]
['text':' META_SCRIPT_RUN ','line_number':341,'multiline':True]
['text':' META_LOOKAHEAD ','line_number':342,'multiline':True]
['text':' META_LOOKAHEADNOT ','line_number':343,'multiline':True]
['text':' META_LOOKBEHIND ','line_number':344,'multiline':True]
['text':' META_LOOKBEHINDNOT ','line_number':345,'multiline':True]
['text':' META_LOOKAHEAD_NA ','line_number':346,'multiline':True]
['text':' META_LOOKBEHIND_NA ','line_number':347,'multiline':True]
['text':' META_MARK - plus the string length ','line_number':348,'multiline':True]
['text':' META_ACCEPT ','line_number':349,'multiline':True]
['text':' META_FAIL ','line_number':350,'multiline':True]
['text':' META_COMMIT ','line_number':351,'multiline':True]
['text':' META_COMMIT_ARG - plus the string length ','line_number':352,'multiline':True]
['text':' META_PRUNE ','line_number':353,'multiline':True]
['text':' META_PRUNE_ARG - plus the string length ','line_number':354,'multiline':True]
['text':' META_SKIP ','line_number':355,'multiline':True]
['text':' META_SKIP_ARG - plus the string length ','line_number':356,'multiline':True]
['text':' META_THEN ','line_number':357,'multiline':True]
['text':' META_THEN_ARG - plus the string length ','line_number':358,'multiline':True]
['text':' META_ASTERISK ','line_number':359,'multiline':True]
['text':' META_ASTERISK_PLUS ','line_number':360,'multiline':True]
['text':' META_ASTERISK_QUERY ','line_number':361,'multiline':True]
['text':' META_PLUS ','line_number':362,'multiline':True]
['text':' META_PLUS_PLUS ','line_number':363,'multiline':True]
['text':' META_PLUS_QUERY ','line_number':364,'multiline':True]
['text':' META_QUERY ','line_number':365,'multiline':True]
['text':' META_QUERY_PLUS ','line_number':366,'multiline':True]
['text':' META_QUERY_QUERY ','line_number':367,'multiline':True]
['text':' META_MINMAX ','line_number':368,'multiline':True]
['text':' META_MINMAX_PLUS ','line_number':369,'multiline':True]
['text':' META_MINMAX_QUERY ','line_number':370,'multiline':True]
['text':' Types for skipping parts of a parsed pattern. ','line_number':373,'multiline':True]
['text':' Macro for setting individual bits in class bitmaps. It took some
experimenting to figure out how to stop gcc 5.3.0 from warning with
-Wconversion. This version gets a warning:

  #define SETBIT(a,b) a[(b)/8] |= (uint8_t)(1u << ((b)&7))

Let's hope the apparently less efficient version isn't actually so bad if the
compiler is clever with identical subexpressions. ','line_number':377,'multiline':True]
['text':' Values and flags for the unsigned xxcuflags variables that accompany xxcu
variables, which are concerned with first and required code units. A value
greater than or equal to REQ_NONE means "no code unit set"; otherwise the
matching xxcu variable is set, and the low valued bits are relevant. ','line_number':388,'multiline':True]
['text':' Not yet found anything ','line_number':393,'multiline':True]
['text':' Found not fixed character ','line_number':394,'multiline':True]
['text':' Code unit in xxcu is caseless ','line_number':395,'multiline':True]
['text':' Code unit is followed by non-literal ','line_number':396,'multiline':True]
['text':' These flags are used in the groupinfo vector. ','line_number':398,'multiline':True]
['text':' This simple test for a decimal digit works for both ASCII/Unicode and EBCDIC
and is fast (a good compiler can turn it into a subtraction and unsigned
comparison). ','line_number':404,'multiline':True]
['text':' Table to identify hex digits. The tables in chartables are dependent on the
locale, and may mark arbitrary characters as digits. We want to recognize only
0-9, a-z, and A-Z as hex digits, which is why we have a private table here. It
costs 256 bytes, but it is a lot faster than doing character value tests (at
least in some simple cases I timed), and in some applications one wants PCRE2
to compile efficiently as well as match efficiently. The value in the table is
the binary hex digit value, or 0xff for non-hex digits. ','line_number':410,'multiline':True]
['text':' This is the "normal" case, for ASCII systems, and EBCDIC systems running in
UTF-8 mode. ','line_number':418,'multiline':True]
['text':'   0-  7 ','line_number':424,'multiline':True]
['text':'   8- 15 ','line_number':425,'multiline':True]
['text':'  16- 23 ','line_number':426,'multiline':True]
['text':'  24- 31 ','line_number':427,'multiline':True]
['text':'    - '  ','line_number':428,'multiline':True]
['text':'  ( - /  ','line_number':429,'multiline':True]
['text':'  0 - 7  ','line_number':430,'multiline':True]
['text':'  8 - ?  ','line_number':431,'multiline':True]
['text':'  @ - G  ','line_number':432,'multiline':True]
['text':'  H - O  ','line_number':433,'multiline':True]
['text':'  P - W  ','line_number':434,'multiline':True]
['text':'  X - _  ','line_number':435,'multiline':True]
['text':'  ` - g  ','line_number':436,'multiline':True]
['text':'  h - o  ','line_number':437,'multiline':True]
['text':'  p - w  ','line_number':438,'multiline':True]
['text':'  x -127 ','line_number':439,'multiline':True]
['text':' 128-135 ','line_number':440,'multiline':True]
['text':' 136-143 ','line_number':441,'multiline':True]
['text':' 144-151 ','line_number':442,'multiline':True]
['text':' 152-159 ','line_number':443,'multiline':True]
['text':' 160-167 ','line_number':444,'multiline':True]
['text':' 168-175 ','line_number':445,'multiline':True]
['text':' 176-183 ','line_number':446,'multiline':True]
['text':' 184-191 ','line_number':447,'multiline':True]
['text':' 192-199 ','line_number':448,'multiline':True]
['text':' 2ff-207 ','line_number':449,'multiline':True]
['text':' 208-215 ','line_number':450,'multiline':True]
['text':' 216-223 ','line_number':451,'multiline':True]
['text':' 224-231 ','line_number':452,'multiline':True]
['text':' 232-239 ','line_number':453,'multiline':True]
['text':' 240-247 ','line_number':454,'multiline':True]
['text':' 248-255 ','line_number':455,'multiline':True]
['text':' This is the "abnormal" case, for EBCDIC systems not running in UTF-8 mode. ','line_number':459,'multiline':True]
['text':'   0-  7  0 ','line_number':463,'multiline':True]
['text':'   8- 15    ','line_number':464,'multiline':True]
['text':'  16- 23 10 ','line_number':465,'multiline':True]
['text':'  24- 31    ','line_number':466,'multiline':True]
['text':'  32- 39 20 ','line_number':467,'multiline':True]
['text':'  40- 47    ','line_number':468,'multiline':True]
['text':'  48- 55 30 ','line_number':469,'multiline':True]
['text':'  56- 63    ','line_number':470,'multiline':True]
['text':'    - 71 40 ','line_number':471,'multiline':True]
['text':'  72- |     ','line_number':472,'multiline':True]
['text':'  & - 87 50 ','line_number':473,'multiline':True]
['text':'  88- 95    ','line_number':474,'multiline':True]
['text':'  - -103 60 ','line_number':475,'multiline':True]
['text':' 104- ?     ','line_number':476,'multiline':True]
['text':' 112-119 70 ','line_number':477,'multiline':True]
['text':' 120- "     ','line_number':478,'multiline':True]
['text':' 128- g  80 ','line_number':479,'multiline':True]
['text':'  h -143    ','line_number':480,'multiline':True]
['text':' 144- p  90 ','line_number':481,'multiline':True]
['text':'  q -159    ','line_number':482,'multiline':True]
['text':' 160- x  A0 ','line_number':483,'multiline':True]
['text':'  y -175    ','line_number':484,'multiline':True]
['text':'  ^ -183 B0 ','line_number':485,'multiline':True]
['text':' 184-191    ','line_number':486,'multiline':True]
['text':'  { - G  C0 ','line_number':487,'multiline':True]
['text':'  H -207    ','line_number':488,'multiline':True]
['text':'  } - P  D0 ','line_number':489,'multiline':True]
['text':'  Q -223    ','line_number':490,'multiline':True]
['text':'  \ - X  E0 ','line_number':491,'multiline':True]
['text':'  Y -239    ','line_number':492,'multiline':True]
['text':'  0 - 7  F0 ','line_number':493,'multiline':True]
['text':'  8 -255    ','line_number':494,'multiline':True]
['text':' EBCDIC ','line_number':495,'multiline':True]
['text':' Table for handling alphanumeric escaped characters. Positive returns are
simple data values; negative values are for special things like \d and so on.
Zero means further processing is needed (for things like \x), or the escape is
invalid. ','line_number':498,'multiline':True]
['text':' This is the "normal" table for ASCII systems or for EBCDIC systems running
in UTF-8 mode. It runs from '0' to 'z'. ','line_number':503,'multiline':True]
['text':' This is the "abnormal" table for EBCDIC systems without UTF-8 support.
It runs from 'a' to '9'. For some minimal testing of EBCDIC features, the code
is sometimes compiled on an ASCII system. In this case, we must not use CHAR_a
because it is defined as 'a', which of course picks up the ASCII value. ','line_number':554,'multiline':True]
['text':' Check for a real EBCDIC environment ','line_number':559,'multiline':True]
['text':' Testing in an ASCII environment ','line_number':563,'multiline':True]
['text':' EBCDIC 'a' ','line_number':564,'multiline':True]
['text':' EBCDIC '9' ','line_number':565,'multiline':True]
['text':'  80 ','line_number':570,'multiline':True]
['text':'  88 ','line_number':571,'multiline':True]
['text':'  90 ','line_number':572,'multiline':True]
['text':'  98 ','line_number':573,'multiline':True]
['text':'  A0 ','line_number':574,'multiline':True]
['text':'  A8 ','line_number':575,'multiline':True]
['text':'  B0 ','line_number':576,'multiline':True]
['text':'  B8 ','line_number':577,'multiline':True]
['text':'  C0 ','line_number':578,'multiline':True]
['text':'  C8 ','line_number':579,'multiline':True]
['text':'  D0 ','line_number':580,'multiline':True]
['text':'  D8 ','line_number':581,'multiline':True]
['text':'  E0 ','line_number':582,'multiline':True]
['text':'  E8 ','line_number':583,'multiline':True]
['text':'  F0 ','line_number':584,'multiline':True]
['text':'  F8 ','line_number':585,'multiline':True]
['text':' We also need a table of characters that may follow \c in an EBCDIC
environment for characters 0-31. ','line_number':588,'multiline':True]
['text':' EBCDIC ','line_number':593,'multiline':True]
['text':' Table of special "verbs" like (*PRUNE). This is a short table, so it is
searched linearly. Put all the names into a single string, in order to reduce
the number of relocations when a shared library is dynamically linked. The
string is built from string macros so that it works in UTF-8 mode on EBCDIC
platforms. ','line_number':596,'multiline':True]
['text':' Length of verb name ','line_number':603,'multiline':True]
['text':' Base META_ code ','line_number':604,'multiline':True]
['text':' Argument requirement ','line_number':605,'multiline':True]
['text':' Empty name is a shorthand for MARK ','line_number':609,'multiline':True]
['text':' > 0 => must have an argument ','line_number':620,'multiline':True]
['text':' < 0 => Optional argument, convert to pre-MARK ','line_number':622,'multiline':True]
['text':' Optional argument; bump META code if found ','line_number':626,'multiline':True]
['text':' Verb opcodes, indexed by their META code offset from META_MARK. ','line_number':633,'multiline':True]
['text':' Table of "alpha assertions" like (*pla:...), similar to the (*VERB) table. ','line_number':639,'multiline':True]
['text':' Length of name ','line_number':642,'multiline':True]
['text':' Base META_ code ','line_number':643,'multiline':True]
['text':' sr = script run ','line_number':679,'multiline':True]
['text':' asr = atomic script run ','line_number':680,'multiline':True]
['text':' script run ','line_number':681,'multiline':True]
['text':' atomic script run ','line_number':682,'multiline':True]
['text':' Offsets from OP_STAR for case-independent and negative repeat opcodes. ','line_number':687,'multiline':True]
['text':' Tables of names of POSIX character classes and their lengths. The names are
now all in a single string, to reduce the number of relocations when a shared
library is dynamically loaded. The list of lengths is terminated by a zero
length entry. The first three must be alpha, lower, upper, as this is assumed
for handling case independence. The indices for graph, print, and punct are
needed, so identify them. ','line_number':693,'multiline':True]
['text':' Table of class bit maps for each POSIX class. Each class is formed from a
base map, with an optional addition or removal of another map. Then, for some
classes, there is some additional tweaking: for [:blank:] the vertical space
characters are removed, and for [:alpha:] and [:alnum:] the underscore
character is removed. The triples in the table consist of the base map offset,
second map offset or -1 if no second map, and a non-negative value for map
addition or a negative value for map subtraction (if there are two maps). The
absolute value of the third field has these meanings: 0 => no tweaking, 1 =>
remove vertical space characters, 2 => remove underscore. ','line_number':713,'multiline':True]
['text':' alpha ','line_number':724,'multiline':True]
['text':' lower ','line_number':725,'multiline':True]
['text':' upper ','line_number':726,'multiline':True]
['text':' alnum - word without underscore ','line_number':727,'multiline':True]
['text':' ascii ','line_number':728,'multiline':True]
['text':' blank - a GNU extension ','line_number':729,'multiline':True]
['text':' cntrl ','line_number':730,'multiline':True]
['text':' digit ','line_number':731,'multiline':True]
['text':' graph ','line_number':732,'multiline':True]
['text':' print ','line_number':733,'multiline':True]
['text':' punct ','line_number':734,'multiline':True]
['text':' space ','line_number':735,'multiline':True]
['text':' word - a Perl extension ','line_number':736,'multiline':True]
['text':' xdigit ','line_number':737,'multiline':True]
['text':' The POSIX class Unicode property substitutes that are used in UCP mode must
be in the order of the POSIX class names, defined above. ','line_number':742,'multiline':True]
['text':' alpha ','line_number':746,'multiline':True]
['text':' lower ','line_number':747,'multiline':True]
['text':' upper ','line_number':748,'multiline':True]
['text':' alnum ','line_number':749,'multiline':True]
['text':' ascii, treat as non-UCP ','line_number':750,'multiline':True]
['text':' blank, treat as \h ','line_number':751,'multiline':True]
['text':' cntrl ','line_number':752,'multiline':True]
['text':' digit ','line_number':753,'multiline':True]
['text':' graph ','line_number':754,'multiline':True]
['text':' print ','line_number':755,'multiline':True]
['text':' punct ','line_number':756,'multiline':True]
['text':' space ','line_number':757,'multiline':True]
['text':' Xps is POSIX space, but from 8.34 ','line_number':757,'multiline':True]
['text':' word  ','line_number':758,'multiline':True]
['text':' Perl and POSIX space are the same ','line_number':758,'multiline':True]
['text':' xdigit, treat as non-UCP ','line_number':759,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':762,'multiline':True]
['text':' Masks for checking option settings. When PCRE2_LITERAL is set, only a subset
are allowed. ','line_number':764,'multiline':True]
['text':' Compile time error code numbers. They are given names so that they can more
easily be tracked. When a new number is added, the tables called eint1 and
eint2 in pcre2posix.c may need to be updated, and a new error text must be
added to compile_error_texts in pcre2_error.c. Also, the error codes in
pcre2.h.in must be updated - their values are exactly 100 greater than these
values. ','line_number':790,'multiline':True]
['text':' This is a table of start-of-pattern options such as (*UTF) and settings such
as (*LIMIT_MATCH=nnnn) and (*CRLF). For completeness and backward
compatibility, (*UTFn) is supported in the relevant libraries, but (*UTF) is
generic and always supported. ','line_number':809,'multiline':True]
['text':' Value is an option bit ','line_number':814,'multiline':True]
['text':' Value is a flag bit ','line_number':815,'multiline':True]
['text':' Value is a newline type ','line_number':816,'multiline':True]
['text':' Value is a \R type ','line_number':817,'multiline':True]
['text':' Read integer value for heap limit ','line_number':818,'multiline':True]
['text':' Read integer value for match limit ','line_number':819,'multiline':True]
['text':' Read integer value for depth limit ','line_number':820,'multiline':True]
['text':' NB: STRING_UTFn_RIGHTPAR contains the length as well ','line_number':829,'multiline':True]
['text':' This table is used when converting repeating opcodes into possessified
versions as a result of an explicit possessive quantifier such as ++. A zero
value means there is no possessified version - in those cases the item in
question must be wrapped in ONCE brackets. The table is truncated at OP_CALLOUT
because all relevant opcodes are less than that. ','line_number':855,'multiline':True]
['text':' 0 - 15  ','line_number':862,'multiline':True]
['text':' 16 - 31 ','line_number':863,'multiline':True]
['text':' NOTI ','line_number':865,'multiline':True]
['text':' STAR, MINSTAR ','line_number':866,'multiline':True]
['text':' PLUS, MINPLUS ','line_number':867,'multiline':True]
['text':' QUERY, MINQUERY ','line_number':868,'multiline':True]
['text':' UPTO, MINUPTO ','line_number':869,'multiline':True]
['text':' EXACT ','line_number':870,'multiline':True]
['text':' POS{STAR,PLUS,QUERY,UPTO} ','line_number':871,'multiline':True]
['text':' STARI, MINSTARI ','line_number':873,'multiline':True]
['text':' PLUSI, MINPLUSI ','line_number':874,'multiline':True]
['text':' QUERYI, MINQUERYI ','line_number':875,'multiline':True]
['text':' UPTOI, MINUPTOI ','line_number':876,'multiline':True]
['text':' EXACTI ','line_number':877,'multiline':True]
['text':' POS{STARI,PLUSI,QUERYI,UPTOI} ','line_number':878,'multiline':True]
['text':' NOTSTAR, NOTMINSTAR ','line_number':880,'multiline':True]
['text':' NOTPLUS, NOTMINPLUS ','line_number':881,'multiline':True]
['text':' NOTQUERY, NOTMINQUERY ','line_number':882,'multiline':True]
['text':' NOTUPTO, NOTMINUPTO ','line_number':883,'multiline':True]
['text':' NOTEXACT ','line_number':884,'multiline':True]
['text':' NOTPOS{STAR,PLUS,QUERY,UPTO} ','line_number':885,'multiline':True]
['text':' NOTSTARI, NOTMINSTARI ','line_number':887,'multiline':True]
['text':' NOTPLUSI, NOTMINPLUSI ','line_number':888,'multiline':True]
['text':' NOTQUERYI, NOTMINQUERYI ','line_number':889,'multiline':True]
['text':' NOTUPTOI, NOTMINUPTOI ','line_number':890,'multiline':True]
['text':' NOTEXACTI ','line_number':891,'multiline':True]
['text':' NOTPOS{STARI,PLUSI,QUERYI,UPTOI} ','line_number':892,'multiline':True]
['text':' TYPESTAR, TYPEMINSTAR ','line_number':894,'multiline':True]
['text':' TYPEPLUS, TYPEMINPLUS ','line_number':895,'multiline':True]
['text':' TYPEQUERY, TYPEMINQUERY ','line_number':896,'multiline':True]
['text':' TYPEUPTO, TYPEMINUPTO ','line_number':897,'multiline':True]
['text':' TYPEEXACT ','line_number':898,'multiline':True]
['text':' TYPEPOS{STAR,PLUS,QUERY,UPTO} ','line_number':899,'multiline':True]
['text':' CRSTAR, CRMINSTAR ','line_number':901,'multiline':True]
['text':' CRPLUS, CRMINPLUS ','line_number':902,'multiline':True]
['text':' CRQUERY, CRMINQUERY ','line_number':903,'multiline':True]
['text':' CRRANGE, CRMINRANGE ','line_number':904,'multiline':True]
['text':' CRPOS{STAR,PLUS,QUERY,RANGE} ','line_number':905,'multiline':True]
['text':' CLASS, NCLASS, XCLASS ','line_number':907,'multiline':True]
['text':' REF, REFI ','line_number':908,'multiline':True]
['text':' DNREF, DNREFI ','line_number':909,'multiline':True]
['text':' RECURSE, CALLOUT ','line_number':910,'multiline':True]
['text':'************************************************
*     Show the parsed pattern for debugging      *
************************************************','line_number':915,'multiline':True]
['text':' For debugging the pre-scan, this code, which outputs the parsed data vector,
can be enabled. ','line_number':919,'multiline':True]
['text':' There's just one escape we might have here that isn't negated in the
      escapes table. ','line_number':980,'multiline':True]
['text':' Offset of next pattern item ','line_number':1090,'multiline':True]
['text':' Length of next pattern item ','line_number':1091,'multiline':True]
['text':' This is kept as a name, because it might be. ','line_number':1141,'multiline':True]
['text':' DEBUG_SHOW_PARSED ','line_number':1182,'multiline':True]
['text':'************************************************
*               Copy compiled code               *
************************************************','line_number':1186,'multiline':True]
['text':' Compiled JIT code cannot be copied, so the new compiled block has no
associated JIT data. ','line_number':1190,'multiline':True]
['text':' If the code is one that has been deserialized, increment the reference count
in the decoded tables. ','line_number':1205,'multiline':True]
['text':'************************************************
*     Copy compiled code and character tables    *
************************************************','line_number':1219,'multiline':True]
['text':' Compiled JIT code cannot be copied, so the new compiled block has no
associated JIT data. This version of code_copy also makes a separate copy of
the character tables. ','line_number':1223,'multiline':True]
['text':'************************************************
*               Free compiled code               *
************************************************','line_number':1258,'multiline':True]
['text':' Decoded tables belong to the codes after deserialization, and they must
    be freed when there are no more references to them. The *ref_count should
    always be > 0. ','line_number':1274,'multiline':True]
['text':'************************************************
*         Read a number, possibly signed         *
************************************************','line_number':1293,'multiline':True]
['text':' This function is used to read numbers in the pattern. The initial pointer
must be the sign or first digit of the number. When relative values (introduced
by + or -) are allowed, they are relative group numbers, and the result must be
greater than zero.

Arguments:
  ptrptr      points to the character pointer variable
  ptrend      points to the end of the input string
  allow_sign  if < 0, sign not allowed; if >= 0, sign is relative to this
  max_value   the largest number allowed
  max_error   the error to give for an over-large number
  intptr      where to put the result
  errcodeptr  where to put an error code

Returns:      TRUE  - a number was read
              FALSE - errorcode == 0 => no number was found
                      errorcode != 0 => an error occurred
','line_number':1297,'multiline':True]
['text':' +0 and -0 are not allowed ','line_number':1357,'multiline':True]
['text':' Non-existent subpattern ','line_number':1364,'multiline':True]
['text':'************************************************
*         Read repeat counts                     *
************************************************','line_number':1380,'multiline':True]
['text':' Read an item of the form {n,m} and return the values if non-NULL pointers
are supplied. Repeat counts must be less than 65536 (MAX_REPEAT_COUNT); a
larger value is used for "unlimited". We have to use signed arguments for
read_number() because it is capable of returning a signed value.

Arguments:
  ptrptr         points to pointer to character after'{'
  ptrend         pointer to end of input
  minp           if not NULL, pointer to int for min
  maxp           if not NULL, pointer to int for max (-1 if no max)
                 returned as -1 if no max
  errorcodeptr   points to error code variable

Returns:         FALSE if not a repeat quantifier, errorcode set zero
                 FALSE on error, with errorcode set non-zero
                 TRUE on success, with pointer updated to point after '}'
','line_number':1384,'multiline':True]
['text':' This value is larger than MAX_REPEAT_COUNT ','line_number':1410,'multiline':True]
['text':' Check the syntax ','line_number':1412,'multiline':True]
['text':' The only error from read_number() is for a number that is too big. ','line_number':1430,'multiline':True]
['text':' Update the pattern pointer ','line_number':1461,'multiline':True]
['text':'************************************************
*            Handle escapes                      *
************************************************','line_number':1470,'multiline':True]
['text':' This function is called when a \ has been encountered. It either returns a
positive value for a simple escape such as \d, or 0 for a data character, which
is placed in chptr. A backreference to group n is returned as negative n. On
entry, ptr is pointing at the character after \. On exit, it points after the
final code unit of the escape sequence.

This function is also called from pcre2_substitute() to handle escape sequences
in replacement strings. In this case, the cb argument is NULL, and in the case
of escapes that have further processing, only sequences that define a data
character are recognised. The isclass argument is not relevant; the options
argument is the final value of the compiled pattern's options.

Arguments:
  ptrptr         points to the input position pointer
  ptrend         points to the end of the input
  chptr          points to a returned data character
  errorcodeptr   points to the errorcode variable (containing zero)
  options        the current options bits
  isclass        TRUE if inside a character class
  cb             compile data block or NULL when called from pcre2_substitute()

Returns:         zero => a data character
                 positive => a special escape sequence
                 negative => a numerical back reference
                 on error, errorcodeptr is set non-zero
','line_number':1474,'multiline':True]
['text':' If backslash is at the end of the string, it's an error. ','line_number':1512,'multiline':True]
['text':' Get character value, increment pointer ','line_number':1520,'multiline':True]
['text':' Be optimistic ','line_number':1521,'multiline':True]
['text':' Non-alphanumerics are literals, so we just leave the value in c. An initial
value test saves a memory lookup for code points outside the alphanumeric
range. ','line_number':1523,'multiline':True]
['text':' Definitely literal ','line_number':1527,'multiline':True]
['text':' Otherwise, do a table lookup. Non-zero values need little processing here. A
positive value is a literal value for something like \n. A negative value is
the negation of one of the ESC_ macros that is passed back for handling by the
calling function. Some extra checking is needed for \N because only \N{U+dddd}
is supported. If the value is zero, further processing is handled below. ','line_number':1529,'multiline':True]
['text':' Negative table entry ','line_number':1543,'multiline':True]
['text':' Else return a special escape ','line_number':1545,'multiline':True]
['text':' Note \P, \p, or \X ','line_number':1547,'multiline':True]
['text':' Perl supports \N{name} for character names and \N{U+dddd} for numerical
    Unicode code points, as well as plain \N for "not newline". PCRE does not
    support \N{name}. However, it does support quantification such as \N{2,3},
    so if \N{ is not followed by U+dddd we check for a quantifier. ','line_number':1549,'multiline':True]
['text':' \N{U+ can be handled by the \x{ code. However, this construction is
      not valid in EBCDIC environments because it specifies a Unicode
      character, not a codepoint in the local code. For example \N{U+0041}
      must be "A" in all environments. Also, in Perl, \N{U+ forces Unicode
      casing semantics for the entire pattern, so allow it only in UTF (i.e.
      Unicode) mode. ','line_number':1558,'multiline':True]
['text':' Not a fancy escape after all ','line_number':1573,'multiline':True]
['text':' Give an error if what follows is not a quantifier, but don't override
      an error set by the quantifier reader (e.g. number overflow). ','line_number':1580,'multiline':True]
['text':' Escapes that need further processing, including those that are unknown, have
a zero entry in the lookup table. When called from pcre2_substitute(), only \c,
\o, and \x are recognized (\u and \U can never appear as they are used for case
forcing). ','line_number':1593,'multiline':True]
['text':' Filter calls from pcre2_substitute(). ','line_number':1606,'multiline':True]
['text':' Do not modify \x handling ','line_number':1615,'multiline':True]
['text':' A number of Perl escapes are not handled by PCRE. We give an explicit
    error. ','line_number':1620,'multiline':True]
['text':' \u is unrecognized when neither PCRE2_ALT_BSUX nor PCRE2_EXTRA_ALT_BSUX
    is set. Otherwise, \u must be followed by exactly four hex digits or, if
    PCRE2_EXTRA_ALT_BSUX is set, by any number of hex digits in braces.
    Otherwise it is a lowercase u letter. This gives some compatibility with
    ECMAScript (aka JavaScript). ','line_number':1629,'multiline':True]
['text':' Test for 32-bit overflow ','line_number':1649,'multiline':True]
['text':' Show where ','line_number':1652,'multiline':True]
['text':' *hptr != } will cause another break below ','line_number':1653,'multiline':True]
['text':' No hex digits ','line_number':1659,'multiline':True]
['text':' Hit end of input ','line_number':1660,'multiline':True]
['text':' No } terminator ','line_number':1661,'multiline':True]
['text':' Hex escape not recognized ','line_number':1662,'multiline':True]
['text':' Accept the code point ','line_number':1664,'multiline':True]
['text':' Must be exactly 4 hex digits ','line_number':1668,'multiline':True]
['text':' Less than 4 chars ','line_number':1670,'multiline':True]
['text':' Not a hex digit ','line_number':1671,'multiline':True]
['text':' Not a hex digit ','line_number':1672,'multiline':True]
['text':' Not a hex digit ','line_number':1674,'multiline':True]
['text':' Not a hex digit ','line_number':1676,'multiline':True]
['text':' \U is unrecognized unless PCRE2_ALT_BSUX or PCRE2_EXTRA_ALT_BSUX is set,
    in which case it is an upper case letter. ','line_number':1693,'multiline':True]
['text':' In a character class, \g is just a literal "g". Outside a character
    class, \g must be followed by one of a number of specific things:

    (1) A number, either plain or braced. If positive, it is an absolute
    backreference. If negative, it is a relative backreference. This is a Perl
    5.10 feature.

    (2) Perl 5.10 also supports \g{name} as a reference to a named group. This
    is part of Perl's movement towards a unified syntax for back references. As
    this is synonymous with \k{name}, we fudge it up by pretending it really
    was \k{name}.

    (3) For Oniguruma compatibility we also support \g followed by a name or a
    number either in angle brackets or in single quotes. However, these are
    (possibly recursive) subroutine calls, _not_ backreferences. We return
    the ESC_g code.

    Summary: Return a negative number for a numerical back reference, ESC_k for
    a named back reference, and ESC_g for a named or numbered subroutine call.
    ','line_number':1700,'multiline':True]
['text':' If there is a brace delimiter, try to read a numerical reference. If
    there isn't one, assume we have a name and treat it as \k. ','line_number':1736,'multiline':True]
['text':' No number found ','line_number':1745,'multiline':True]
['text':' Read an undelimited number ','line_number':1756,'multiline':True]
['text':' No number found ','line_number':1763,'multiline':True]
['text':' The handling of escape sequences consisting of a string of digits
    starting with one that is not zero is not straightforward. Perl has changed
    over the years. Nowadays \g{} for backreferences and \o{} for octal are
    recommended to avoid the ambiguities in the old syntax.

    Outside a character class, the digits are read as a decimal number. If the
    number is less than 10, or if there are that many previous extracting left
    brackets, it is a back reference. Otherwise, up to three octal digits are
    read to form an escaped character code. Thus \123 is likely to be octal 123
    (cf \0123, which is octal 012 followed by the literal 3).

    Inside a character class, \ followed by a digit is always either a literal
    8 or 9 or an octal number. ','line_number':1777,'multiline':True]
['text':' Back to the digit ','line_number':1797,'multiline':True]
['text':' As we know we are at a digit, the only possible error from
      read_number() is a number that is too large to be a group number. In this
      case we fall through handle this as not a group reference. If we have
      read a small enough number, check for a back reference.

      \1 to \9 are always back references. \8x and \9x are too; \1x to \7x
      are octal escapes if there are not that many previous captures. ','line_number':1799,'multiline':True]
['text':' Indicates a back reference ','line_number':1811,'multiline':True]
['text':' Put the pointer back and fall through ','line_number':1815,'multiline':True]
['text':' Handle a digit following \ when the number is not a back reference, or
    we are within a character class. If the first digit is 8 or 9, Perl used to
    generate a binary zero and then treat the digit as a following literal. At
    least by Perl 5.18 this changed so as not to insert the binary zero. ','line_number':1818,'multiline':True]
['text':' Fall through ','line_number':1825,'multiline':True]
['text':' \0 always starts an octal number, but we may drop through to here with a
    larger first octal digit. The original code used just to take the least
    significant 8 bits of octal numbers (I think this is what early Perls used
    to do). Nowadays we allow for larger numbers in UTF-8 mode and 16-bit mode,
    but no more than 3 octal digits. ','line_number':1827,'multiline':True]
['text':' \o is a relatively new Perl feature, supporting a more general way of
    specifying character codes in octal. The only supported form is \o{ddd}. ','line_number':1842,'multiline':True]
['text':' Leading zeroes ','line_number':1860,'multiline':True]
['text':' When PCRE2_ALT_BSUX or PCRE2_EXTRA_ALT_BSUX is set, \x must be followed
    by two hexadecimal digits. Otherwise it is a lowercase x letter. ','line_number':1895,'multiline':True]
['text':' Less than 2 characters ','line_number':1902,'multiline':True]
['text':' Not a hex digit ','line_number':1903,'multiline':True]
['text':' Not a hex digit ','line_number':1904,'multiline':True]
['text':' Handle \x in Perl's style. \x{ddd} is a character code which can be
    greater than 0xff in UTF-8 or non-8bit mode, but only if the ddd are hex
    digits. If not, { used to be treated as a data character. However, Perl
    seems to read hex digits up to the first non-such, and ignore the rest, so
    that, for example \x{zz} matches a binary zero. This seems crazy, so PCRE
    now gives an error. ','line_number':1909,'multiline':True]
['text':' Leading zeroes ','line_number':1934,'multiline':True]
['text':' If the sequence of hex digits does not end with '}', give an error.
        We used just to recognize this construct and fall through to the normal
        \x handling, but nowadays Perl gives an error, which seems much more
        sensible, so we do too. ','line_number':1961,'multiline':True]
['text':' End of \x{} processing ','line_number':1971,'multiline':True]
['text':' Read a up to two hex digits after \x ','line_number':1973,'multiline':True]
['text':' Not a hex digit ','line_number':1978,'multiline':True]
['text':' Not a hex digit ','line_number':1981,'multiline':True]
['text':' End of \xdd handling ','line_number':1984,'multiline':True]
['text':' End of Perl-style \x handling ','line_number':1985,'multiline':True]
['text':' The handling of \c is different in ASCII and EBCDIC environments. In an
    ASCII (or Unicode) environment, an error is given if the character
    following \c is not a printable ASCII character. Otherwise, the following
    character is upper-cased if it is a letter, and after that the 0x40 bit is
    flipped. The result is the value of the escape.

    In an EBCDIC environment the handling of \c is compatible with the
    specification in the perlebcdic document. The following character must be
    a letter or one of small number of special characters. These provide a
    means of defining the character values 0-31.

    For testing the EBCDIC handling of \c in an ASCII environment, recognize
    the EBCDIC value of 'c' explicitly. ','line_number':1988,'multiline':True]
['text':' Handle \c in an ASCII/Unicode environment. ','line_number':2015,'multiline':True]
['text':' ASCII/UTF-8 coding ','line_number':2017,'multiline':True]
['text':' Excludes all non-printable ASCII ','line_number':2018,'multiline':True]
['text':' Handle \c in an EBCDIC environment. The special case \c? is converted to
    255 (0xff) or 95 (0x5f) if other characters suggest we are using the
    POSIX-BC encoding. (This is the way Perl indicates that it handles \c?.)
    The other valid sequences correspond to a list of specific characters. ','line_number':2025,'multiline':True]
['text':' EBCDIC ','line_number':2041,'multiline':True]
['text':' Any other alphanumeric following \ is an error. Perl gives an error only
    if in warning mode, but PCRE doesn't have a warning mode. ','line_number':2046,'multiline':True]
['text':' Point to the character at fault ','line_number':2051,'multiline':True]
['text':' Set the pointer to the next character before returning. ','line_number':2056,'multiline':True]
['text':'************************************************
*               Handle \P and \p                 *
************************************************','line_number':2066,'multiline':True]
['text':' This function is called after \P or \p has been encountered, provided that
PCRE2 is compiled with support for UTF and Unicode properties. On entry, the
contents of ptrptr are pointing after the P or p. On exit, it is left pointing
after the final code unit of the escape sequence.

Arguments:
  ptrptr         the pattern position pointer
  negptr         a boolean that is set TRUE for negation else FALSE
  ptypeptr       an unsigned int that is set to the type value
  pdataptr       an unsigned int that is set to the detailed property value
  errorcodeptr   the error code variable
  cb             the compile data

Returns:         TRUE if the type value was found, or FALSE for an invalid type
','line_number':2070,'multiline':True]
['text':' \P or \p can be followed by a name in {}, optionally preceded by ^ for
negation. ','line_number':2101,'multiline':True]
['text':' If { doesn't follow \p or \P there is just one following character, which
must be an ASCII letter. ','line_number':2133,'multiline':True]
['text':' If the property contains ':' or '=' we have class name and value separately
specified. The following are supported:

  . Bidi_Class (synonym bc), for which the property names are "bidi<name>".
  . Script (synonym sc) for which the property name is the script name
  . Script_Extensions (synonym scx), ditto

As this is a small number, we currently just check the names directly. If this
grows, a sorted table and a switch will be neater.

For both the script properties, set a PT_xxx value so that (1) they can be
distinguished and (2) invalid script names that happen to be the name of
another property can be diagnosed. ','line_number':2145,'multiline':True]
['text':' Terminate property name ','line_number':2164,'multiline':True]
['text':' There is no strcpy_c8 function ','line_number':2170,'multiline':True]
['text':' Adjust the string in name[] as needed ','line_number':2189,'multiline':True]
['text':' Search for a recognized property using binary chop. ','line_number':2195,'multiline':True]
['text':' When a matching property is found, some extra checking is needed when the
  \p{xx:yy} syntax is used and xx is either sc or scx. ','line_number':2206,'multiline':True]
['text':' Non-script found ','line_number':2229,'multiline':True]
['text':' Unrecognized property ','line_number':2235,'multiline':True]
['text':' Malformed \P or \p ','line_number':2238,'multiline':True]
['text':'************************************************
*           Check for POSIX class syntax         *
************************************************','line_number':2247,'multiline':True]
['text':' This function is called when the sequence "[:" or "[." or "[=" is
encountered in a character class. It checks whether this is followed by a
sequence of characters terminated by a matching ":]" or ".]" or "=]". If we
reach an unescaped ']' without the special preceding character, return FALSE.

Originally, this function only recognized a sequence of letters between the
terminators, but it seems that Perl recognizes any sequence of characters,
though of course unknown POSIX names are subsequently rejected. Perl gives an
"Unknown POSIX class" error for [:f\oo:] for example, where previously PCRE
didn't consider this to be a POSIX class. Likewise for [:1234:].

The problem in trying to be exactly like Perl is in the handling of escapes. We
have to be sure that [abc[:x\]pqr] is *not* treated as containing a POSIX
class, but [abc[:x\]pqr:]] is (so that an error can be generated). The code
below handles the special cases \\ and \], but does not try to do any other
escape processing. This makes it different from Perl for cases such as
[:l\ower:] where Perl recognizes it as the POSIX class "lower" but PCRE does
not recognize "l\ower". This is a lesser evil than not diagnosing bad classes
when Perl does, I think.

A user pointed out that PCRE was rejecting [:a[:digit:]] whereas Perl was not.
It seems that the appearance of a nested POSIX class supersedes an apparent
external class. For example, [:a[:digit:]b:] matches "a", "b", ":", or
a digit. This is handled by returning FALSE if the start of a new group with
the same terminator is encountered, since the next closing sequence must close
the nested group, not the outer one.

In Perl, unescaped square brackets may also appear as part of class names. For
example, [:a[:abc]b:] gives unknown POSIX class "[:abc]b:]". However, for
[:a[:abc]b][b:] it gives unknown POSIX class "[:abc]b][b:]", which does not
seem right at all. PCRE does not allow closing square brackets in POSIX class
names.

Arguments:
  ptr      pointer to the character after the initial [ (colon, dot, equals)
  ptrend   pointer to the end of the pattern
  endptr   where to return a pointer to the terminating ':', '.', or '='

Returns:   TRUE or FALSE
','line_number':2251,'multiline':True]
['text':' Don't combine these lines; the Solaris cc ','line_number':2295,'multiline':True]
['text':' compiler warns about "non-constant" initializer. ','line_number':2296,'multiline':True]
['text':'************************************************
*          Check POSIX class name                *
************************************************','line_number':2319,'multiline':True]
['text':' This function is called to check the name given in a POSIX-style class entry
such as [:alnum:].

Arguments:
  ptr        points to the first letter
  len        the length of the name

Returns:     a value representing the name, or -1 if unknown
','line_number':2323,'multiline':True]
['text':'************************************************
*       Read a subpattern or VERB name           *
************************************************','line_number':2350,'multiline':True]
['text':' This function is called from parse_regex() below whenever it needs to read
the name of a subpattern or a (*VERB) or an (*alpha_assertion). The initial
pointer must be to the character before the name. If that character is '*' we
are reading a verb or alpha assertion name. The pointer is updated to point
after the name, for a VERB or alpha assertion name, or after tha name's
terminator for a subpattern name. Returning both the offset and the name
pointer is redundant information, but some callers use one and some the other,
so it is simplest just to return both.

Arguments:
  ptrptr      points to the character pointer variable
  ptrend      points to the end of the input string
  utf         true if the input is UTF-encoded
  terminator  the terminator of a subpattern name must be this
  offsetptr   where to put the offset from the start of the pattern
  nameptr     where to put a pointer to the name in the input
  namelenptr  where to put the length of the name
  errcodeptr  where to put an error code
  cb          pointer to the compile data block

Returns:    TRUE if a name was read
            FALSE otherwise, with error code set
','line_number':2354,'multiline':True]
['text':' No characters in name ','line_number':2386,'multiline':True]
['text':' Subpattern name expected ','line_number':2388,'multiline':True]
['text':' Verb not recognized or malformed ','line_number':2389,'multiline':True]
['text':' In UTF mode, a group name may contain letters and decimal digits as defined
by Unicode properties, and underscores, but must not start with a digit. ','line_number':2396,'multiline':True]
['text':' Avoid compiler warning ','line_number':2426,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':2427,'multiline':True]
['text':' Handle non-group names and group names in non-UTF modes. A group name must
not start with a digit. If either of the others start with a digit it just
won't be recognized. ','line_number':2429,'multiline':True]
['text':' Check name length ','line_number':2446,'multiline':True]
['text':' Subpattern names must not be empty, and their terminator is checked here.
(What follows a verb or alpha assertion name is checked separately.) ','line_number':2455,'multiline':True]
['text':' Subpattern name expected ','line_number':2462,'multiline':True]
['text':'************************************************
*          Manage callouts at start of cycle     *
************************************************','line_number':2483,'multiline':True]
['text':' At the start of a new item in parse_regex() we are able to record the
details of the previous item in a prior callout, and also to set up an
automatic callout if enabled. Avoid having two adjacent automatic callouts,
which would otherwise happen for items such as \Q that contribute nothing to
the parsed pattern.

Arguments:
  ptr              current pattern pointer
  pcalloutptr      points to a pointer to previous callout, or NULL
  auto_callout     TRUE if auto_callouts are enabled
  parsed_pattern   the parsed pattern pointer
  cb               compile block

Returns: possibly updated parsed_pattern pointer.
','line_number':2487,'multiline':True]
['text':' Set up new automatic callout ','line_number':2518,'multiline':True]
['text':'************************************************
*      Parse regex and identify named groups     *
************************************************','line_number':2533,'multiline':True]
['text':' This function is called first of all. It scans the pattern and does two
things: (1) It identifies capturing groups and makes a table of named capturing
groups so that information about them is fully available to both the compiling
scans. (2) It writes a parsed version of the pattern with comments omitted and
escapes processed into the parsed_pattern vector.

Arguments:
  ptr             points to the start of the pattern
  options         compiling dynamic options (may change during the scan)
  has_lookbehind  points to a boolean, set TRUE if a lookbehind is found
  cb              pointer to the compile data block

Returns:   zero on success or a non-zero error code, with the
             error offset placed in the cb field
','line_number':2537,'multiline':True]
['text':' A structure and some flags for dealing with nested groups. ','line_number':2553,'multiline':True]
['text':' Options that are changeable within the pattern must be tracked during
parsing. Some (e.g. PCRE2_EXTENDED) are implemented entirely during parsing,
but all must be tracked so that META_OPTIONS items set the correct values for
the main compiling phase. ','line_number':2567,'multiline':True]
['text':' States used for analyzing ranges in character classes. The two OK values
must be last. ','line_number':2576,'multiline':True]
['text':' Only in 32-bit mode can there be literals > META_END. A macro encapsulates
the storing of literal values in the main parsed pattern, where they can always
be quantified. ','line_number':2581,'multiline':True]
['text':' Here's the actual function. ','line_number':2596,'multiline':True]
['text':' Value avoids compiler warning ','line_number':2605,'multiline':True]
['text':' Value avoids compiler warning ','line_number':2629,'multiline':True]
['text':' Insert leading items for word and line matching (features provided for the
benefit of pcre2grep). ','line_number':2633,'multiline':True]
['text':' If the pattern is actually a literal string, process it separately to avoid
cluttering up the main loop. ','line_number':2647,'multiline':True]
['text':' Internal error (parsed pattern overflow) ','line_number':2656,'multiline':True]
['text':' Process a real regex which may contain meta-characters. ','line_number':2669,'multiline':True]
['text':' The size of the nest_save structure might not be a factor of the size of the
workspace. Therefore we must round down end_nests so as to correctly avoid
creating a nest_save that spans the end of the workspace. ','line_number':2674,'multiline':True]
['text':' PCRE2_EXTENDED_MORE implies PCRE2_EXTENDED ','line_number':2681,'multiline':True]
['text':' Now scan the pattern ','line_number':2685,'multiline':True]
['text':' Internal error (parsed pattern overflow) ','line_number':2700,'multiline':True]
['text':' Parentheses too deeply nested ','line_number':2707,'multiline':True]
['text':' Get next input character, save its position for callout handling. ','line_number':2710,'multiline':True]
['text':' Copy quoted literals until \E, allowing for the possibility of automatic
  callouts, except when processing a (*VERB) "name".  ','line_number':2715,'multiline':True]
['text':' Skip E ','line_number':2723,'multiline':True]
['text':' A literal is not allowed if we are ','line_number':2727,'multiline':True]
['text':' expecting a conditional assertion, ','line_number':2728,'multiline':True]
['text':' but an empty \Q\E sequence is OK.  ','line_number':2729,'multiline':True]
['text':' Don't use PARSED_LITERAL() because it ','line_number':2734,'multiline':True]
['text':' sets okquantifier. ','line_number':2735,'multiline':True]
['text':' Next character ','line_number':2749,'multiline':True]
['text':' If we are processing the "name" part of a (*VERB:NAME) item, all
  characters up to the closing parenthesis are literals except when
  PCRE2_ALT_VERBNAMES is set. That causes backslash interpretation, but only \Q
  and \E and escaped characters are allowed (no character types such as \d). If
  PCRE2_EXTENDED is also set, we must ignore white space and # comments. Do
  this by not entering the special (*VERB:NAME) processing - they are then
  picked up below. Note that c is a character, not a code unit, so we must not
  use MAX_255 to test its size because MAX_255 tests code units and is assumed
  TRUE in 8-bit mode. ','line_number':2752,'multiline':True]
['text':' EITHER: not both options set ','line_number':2764,'multiline':True]
['text':' OR: character > 255 AND not Unicode Pattern White Space ','line_number':2768,'multiline':True]
['text':' OR: not a # comment or isspace() white space ','line_number':2771,'multiline':True]
['text':' and not CHAR_NEL when Unicode is supported ','line_number':2774,'multiline':True]
['text':' Don't use PARSED_LITERAL() because it ','line_number':2783,'multiline':True]
['text':' sets okquantifier. ','line_number':2784,'multiline':True]
['text':' This is the length in characters ','line_number':2792,'multiline':True]
['text':' But the limit on the length is in code units ','line_number':2794,'multiline':True]
['text':' If this name was on a verb such as (*ACCEPT) which does not continue,
      a (*MARK) was generated for the name. We now add the original verb as the
      next item. ','line_number':2803,'multiline':True]
['text':' Treat all as literal ','line_number':2821,'multiline':True]
['text':' Don't use PARSED_LITERAL() because it ','line_number':2825,'multiline':True]
['text':' sets okquantifier. ','line_number':2826,'multiline':True]
['text':' Ignore ','line_number':2836,'multiline':True]
['text':' Invalid in verb name ','line_number':2840,'multiline':True]
['text':' Next character in pattern ','line_number':2844,'multiline':True]
['text':' Not a verb name character. At this point we must process everything that
  must not change the quantification state. This is mainly comments, but we
  handle \Q and \E here as well, so that an item such as A\Q\E+ is treated as
  A+, as in Perl. An isolated \E is ignored. ','line_number':2847,'multiline':True]
['text':' Skip over whitespace and # comments in extended mode. Note that c is a
  character, not a code unit, so we must not use MAX_255 to test its size
  because MAX_255 tests code units and is assumed TRUE in 8-bit mode. The
  whitespace characters are those designated as "Pattern White Space" by
  Unicode, which are the isspace() characters plus CHAR_NEL (newline), which is
  U+0085 in Unicode, plus U+200E, U+200F, U+2028, and U+2029. These are a
  subset of space characters that match \h and \v. ','line_number':2862,'multiline':True]
['text':' For non-fixed-length newline cases, ','line_number':2880,'multiline':True]
['text':' IS_NEWLINE sets cb->nllen. ','line_number':2881,'multiline':True]
['text':' Next character in pattern ','line_number':2890,'multiline':True]
['text':' Skip over bracketed comments ','line_number':2894,'multiline':True]
['text':' A special error for missing ) in a comment ','line_number':2902,'multiline':True]
['text':' to make it easier to debug. ','line_number':2903,'multiline':True]
['text':' Next character in pattern ','line_number':2906,'multiline':True]
['text':' If the next item is not a quantifier, fill in length of any previous
  callout and create an auto callout if required. ','line_number':2909,'multiline':True]
['text':' If expect_cond_assert is 2, we have just passed (?( and are expecting an
  assertion, possibly preceded by a callout. If the value is 1, we have just
  had the callout and expect an assertion. There must be at least 3 more
  characters in all cases. When expect_cond_assert is 2, we know that the
  current character is an opening parenthesis, as otherwise we wouldn't be
  here. However, when it is 1, we need to check, and it's easiest just to check
  always. Note that expect_cond_assert may be negative, since all callouts just
  decrement it. ','line_number':2922,'multiline':True]
['text':' New alpha assertion format, possibly ','line_number':2937,'multiline':True]
['text':' Traditional symbolic format ','line_number':2941,'multiline':True]
['text':' Adjust error offset ','line_number':2962,'multiline':True]
['text':' Remember whether we are expecting a conditional assertion, and set the
  default for this item. ','line_number':2968,'multiline':True]
['text':' Remember quantification status for the previous significant item, then set
  default for this item. ','line_number':2974,'multiline':True]
['text':' If the previous significant item was a quantifier, adjust the parsed code
  if there is a following modifier. The base meta value is always followed by
  the PLUS and QUERY values, in that order. We do this here rather than after
  reading a quantifier so that intervening comments and /x whitespace can be
  ignored without having to replicate code. ','line_number':2982,'multiline':True]
['text':' Next character in pattern ','line_number':2993,'multiline':True]
['text':' Process the next item in the main part of a pattern. ','line_number':2997,'multiline':True]
['text':' Non-special character ','line_number':3001,'multiline':True]
['text':' ---- Escape sequence ---- ','line_number':3006,'multiline':True]
['text':' Get character value, increment pointer ','line_number':3020,'multiline':True]
['text':' Treat as literal character ','line_number':3022,'multiline':True]
['text':' The escape was a data escape or literal character. ','line_number':3025,'multiline':True]
['text':' The escape was a back (or forward) reference. We keep the offset in
    order to give a more useful diagnostic for a bad forward reference. For
    references to groups numbered less than 10 we can't use more than two items
    in parsed_pattern because they may be just two characters in the input (and
    in a 64-bit world an offset may need two elements). So for them, the offset
    of the first occurrent is held in a special vector. ','line_number':3032,'multiline':True]
['text':' The escape was a character class such as \d etc. or other special
    escape indicator such as \A or \X. Most of them generate just a single
    parsed item, but \P and \p are followed by a 16-bit type and a 16-bit
    value. They are supported only when Unicode is available. The type and
    value are packed into a single 32-bit value so that the whole sequences
    uses only two elements in the parsed_vector. This is because the same
    coding is used if \d (for example) is turned into \p{Nd} when PCRE2_UCP is
    set.

    There are also some cases where the escape sequence is followed by a name:
    \k{name}, \k<name>, and \k'name' are backreferences by name, and \g<name>
    and \g'name' are subroutine calls by name; \g{name} is a synonym for
    \k{name}. Note that \g<number> and \g'number' are handled by check_escape()
    and returned as a negative value (handled above). A name is coded as an
    offset into the pattern and a length. ','line_number':3056,'multiline':True]
['text':' Supported only with Unicode support ','line_number':3091,'multiline':True]
['text':' \A, \B, \b, \G, \K, \Z, \z cannot be quantified. ','line_number':3104,'multiline':True]
['text':' Escapes that change in UCP mode. Note that PCRE2_UCP will never be set
      without Unicode support because it is checked when pcre2_compile() is
      called. ','line_number':3108,'multiline':True]
['text':' Unicode property matching ','line_number':3148,'multiline':True]
['text':' End \P and \p ','line_number':3167,'multiline':True]
['text':' When \g is used with quotes or angle brackets as delimiters, it is a
      numerical or named subroutine call, and control comes here. When used
      with brace delimiters it is a numberical back reference and does not come
      here because check_escape() returns it directly as a reference. \k is
      always a named back reference. ','line_number':3169,'multiline':True]
['text':' For a non-braced \g, check for a numerical recursion. ','line_number':3187,'multiline':True]
['text':' Not a numerical recursion ','line_number':3207,'multiline':True]
['text':' \k and \g when used with braces are back references, whereas \g used
      with quotes or angle brackets is a recursion ','line_number':3212,'multiline':True]
['text':' End special escape processing ','line_number':3222,'multiline':True]
['text':' End escape sequence processing ','line_number':3224,'multiline':True]
['text':' ---- Single-character special items ---- ','line_number':3227,'multiline':True]
['text':' ---- Single-character quantifiers ---- ','line_number':3243,'multiline':True]
['text':' ---- Potential {n,m} quantifier ---- ','line_number':3258,'multiline':True]
['text':' Error in quantifier. ','line_number':3264,'multiline':True]
['text':' Not a quantifier ','line_number':3265,'multiline':True]
['text':' No more quantifier processing ','line_number':3266,'multiline':True]
['text':' Fall through ','line_number':3269,'multiline':True]
['text':' ---- Quantifier post-processing ---- ','line_number':3272,'multiline':True]
['text':' Check that a quantifier is allowed after the previous item. ','line_number':3274,'multiline':True]
['text':' Most (*VERB)s are not allowed to be quantified, but an ungreedy
    quantifier can be useful for (*ACCEPT) - meaning "succeed on backtrack", a
    sort of negated (*COMMIT). We therefore allow (*ACCEPT) to be quantified by
    wrapping it in non-capturing brackets, but we have to allow for a preceding
    (*MARK) for when (*ACCEPT) has an argument. ','line_number':3283,'multiline':True]
['text':' Now we can put the quantifier into the parsed pattern vector. At this
    stage, we have only the basic quantifier. The check for a following + or ?
    modifier happens at the top of the loop, after any intervening comments
    have been removed. ','line_number':3298,'multiline':True]
['text':' ---- Character class ---- ','line_number':3312,'multiline':True]
['text':' In another (POSIX) regex library, the ugly syntax [[:<:]] and [[:>:]] is
    used for "start of word" and "end of word". As these are otherwise illegal
    sequences, we don't break anything by recognizing them. They are replaced
    by \b(?=\w) and \b(?<=\w) respectively. Sequences like [a[:<:]] are
    erroneous and are handled by the normal code below. ','line_number':3317,'multiline':True]
['text':' The offset is used only for the "non-fixed length" error; this won't
        occur here, so just store zero. ','line_number':3338,'multiline':True]
['text':' PCRE supports POSIX class stuff inside a class. Perl gives an error if
    they are encountered at the top level, so we'll do that too. ','line_number':3356,'multiline':True]
['text':' Process a regular character class. If the first character is '^', set
    the negation flag. If the first few characters (either before or after ^)
    are \Q\E or \E or space or tab in extended-more mode, we skip them too.
    This makes for compatibility with Perl. ','line_number':3367,'multiline':True]
['text':' Note: just these two ','line_number':3386,'multiline':True]
['text':' Now the real contents of the class; c has the first "real" character.
    Empty classes are permitted only if the option is set. ','line_number':3393,'multiline':True]
['text':' End of class processing ','line_number':3400,'multiline':True]
['text':' Process a non-empty class. ','line_number':3403,'multiline':True]
['text':' In an EBCDIC environment, Perl treats alphabetic ranges specially
    because there are holes in the encoding, and simply using the range A-Z
    (for example) would include the characters in the holes. This applies only
    to ranges where both values are literal; [\xC1-\xE9] is different to [A-Z]
    in this respect. In order to accommodate this, we keep track of whether
    character values are literal or not, and a state variable for handling
    ranges. ','line_number':3408,'multiline':True]
['text':' Loop for the contents of the class ','line_number':3416,'multiline':True]
['text':' Inside \Q...\E everything is literal except \E ','line_number':3422,'multiline':True]
['text':' Reset literal state ','line_number':3428,'multiline':True]
['text':' Skip the 'E' ','line_number':3429,'multiline':True]
['text':' Skip over space and tab (only) in extended-more mode. ','line_number':3435,'multiline':True]
['text':' Handle POSIX class names. Perl allows a negation extension of the
      form [:^name:]. A square bracket that doesn't match the syntax is
      treated as a literal. We also recognize the POSIX constructions
      [.ch.] and [=ch=] ("collating elements") and fault them, as Perl
      5.6 and 5.8 do. ','line_number':3441,'multiline':True]
['text':' Perl treats a hyphen before a POSIX class as a literal, not the
        start of a range. However, it gives a warning in its warning mode. PCRE
        does not have a warning mode, so we give an error, because this is
        likely an error on the user's part. ','line_number':3456,'multiline':True]
['text':' Perl treats a hyphen after a POSIX class as a literal, not the
        start of a range. However, it gives a warning in its warning mode
        unless the hyphen is the last character in the class. PCRE does not
        have a warning mode, so we give an error, because this is likely an
        error on the user's part. ','line_number':3487,'multiline':True]
['text':' Set "a hyphen is not the start of a range" for the -] case, and also
        in case the POSIX class is followed by \E or \Q\E (possibly repeated -
        fuzzers do that kind of thing) and *then* a hyphen. This causes that
        hyphen to be treated as a literal. I don't think it's worth setting up
        special apparatus to do otherwise. ','line_number':3500,'multiline':True]
['text':' When PCRE2_UCP is set, some of the POSIX classes are converted to
        use Unicode properties \p or \P or, in one case, \h or \H. The
        substitutes table has two values per class, containing the type and
        value of a \p or \P item. The special cases are specified with a
        negative type: a non-zero value causes \h or \H to be used, and a zero
        value falls through to behave like a non-UCP POSIX class. ','line_number':3508,'multiline':True]
['text':' Fall through ','line_number':3533,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':3535,'multiline':True]
['text':' Non-UCP POSIX class ','line_number':3537,'multiline':True]
['text':' Handle potential start of range ','line_number':3543,'multiline':True]
['text':' Handle a literal character ','line_number':3552,'multiline':True]
['text':' Optimize one-char range ','line_number':3559,'multiline':True]
['text':' Check range is in order ','line_number':3561,'multiline':True]
['text':' Potential start of range ','line_number':3574,'multiline':True]
['text':' Handle escapes in a class ','line_number':3582,'multiline':True]
['text':' Get character value, increment pointer ','line_number':3597,'multiline':True]
['text':' Treat as literal character ','line_number':3599,'multiline':True]
['text':' Escaped character code point is in c ','line_number':3604,'multiline':True]
['text':' \b is backspace in a class ','line_number':3609,'multiline':True]
['text':' Enter literal mode ','line_number':3614,'multiline':True]
['text':' Ignore orphan \E ','line_number':3617,'multiline':True]
['text':' Always an error in a class ','line_number':3620,'multiline':True]
['text':' The second part of a range can be a single-character escape
        sequence (detected above), but not any of the other escapes. Perl
        treats a hyphen as a literal in such circumstances. However, in Perl's
        warning mode, a warning is given, so PCRE now faults it, as it is
        almost certainly a mistake on the user's part. ','line_number':3628,'multiline':True]
['text':' Not CLASS_ESCAPE_FAILED; always an error ','line_number':3637,'multiline':True]
['text':' Of the remaining escapes, only those that define characters are
        allowed in a class. None may start a range. ','line_number':3640,'multiline':True]
['text':' These escapes are converted to Unicode property tests when
          PCRE2_UCP is set. ','line_number':3657,'multiline':True]
['text':' Explicit Unicode property matching ','line_number':3695,'multiline':True]
['text':' End \P and \p ','line_number':3713,'multiline':True]
['text':' All others are not allowed in a class ','line_number':3715,'multiline':True]
['text':' Perl gives a warning unless a following hyphen is the last character
        in the class. PCRE throws an error. ','line_number':3721,'multiline':True]
['text':' Proceed to next thing in the class. ','line_number':3732,'multiline':True]
['text':' Missing terminating ']' ','line_number':3737,'multiline':True]
['text':' End of class-processing loop ','line_number':3742,'multiline':True]
['text':' -] at the end of a class is a literal '-' ','line_number':3744,'multiline':True]
['text':' End of character class ','line_number':3753,'multiline':True]
['text':' ---- Opening parenthesis ---- ','line_number':3756,'multiline':True]
['text':' If ( is not followed by ? it is either a capture or a special verb or an
    alpha assertion or a positive non-atomic lookahead. ','line_number':3761,'multiline':True]
['text':' Handle capturing brackets (or non-capturing if auto-capture is turned
      off). ','line_number':3768,'multiline':True]
['text':' Do nothing for (* followed by end of pattern or ) so it gives a "bad
      quantifier" error rather than "(*MARK) must have an argument". ','line_number':3787,'multiline':True]
['text':' Handle "alpha assertions" such as (*pla:...). Most of these are
      synonyms for the historical symbolic assertions, but the script run and
      non-atomic lookaround ones are new. They are distinguished by starting
      with a lower case letter. Checking both ends of the alphabet makes this
      work in all character codes. ','line_number':3793,'multiline':True]
['text':' Malformed ','line_number':3808,'multiline':True]
['text':' Scan the table of alpha assertion names ','line_number':3812,'multiline':True]
['text':' Alpha assertion not recognized ','line_number':3824,'multiline':True]
['text':' Check for expecting an assertion condition. If so, only atomic
        lookaround assertions are valid. ','line_number':3828,'multiline':True]
['text':' (Atomic) assertion expected ','line_number':3836,'multiline':True]
['text':' The lookaround alphabetic synonyms can mostly be handled by jumping
        to the code that handles the traditional symbolic forms. ','line_number':3840,'multiline':True]
['text':' Unknown code; should never occur because ','line_number':3846,'multiline':True]
['text':' the meta values come from a table above. ','line_number':3847,'multiline':True]
['text':' The script run facilities are handled here. Unicode support is
          required (give an error if not, as this is a security issue). Always
          record a META_SCRIPT_RUN item. Then, for the atomic version, insert
          META_ATOMIC and remember that we need two META_KETs at the end. ','line_number':3868,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':3893,'multiline':True]
['text':' ---- Handle (*VERB) and (*VERB:NAME) ---- ','line_number':3901,'multiline':True]
['text':' Malformed ','line_number':3911,'multiline':True]
['text':' Scan the table of verb names ','line_number':3915,'multiline':True]
['text':' Verb not recognized ','line_number':3927,'multiline':True]
['text':' An empty argument is treated as no argument. ','line_number':3931,'multiline':True]
['text':' Advance to the closing parens ','line_number':3935,'multiline':True]
['text':' Check for mandatory non-empty argument; this is (*MARK) ','line_number':3937,'multiline':True]
['text':' Remember where this verb, possibly with a preceding (*MARK), starts,
        for handling quantified (*ACCEPT). ','line_number':3945,'multiline':True]
['text':' It appears that Perl allows any characters whatsoever, other than a
        closing parenthesis, to appear in arguments ("names"), so we no longer
        insist on letters, digits, and underscores. Perl does not, however, do
        any interpretation within arguments, and has no means of including a
        closing parenthesis. PCRE supports escape processing but only when it
        is requested by an option. We set inverbname TRUE here, and let the
        main loop take care of this so that escape and \x processing is done by
        the main code above. ','line_number':3951,'multiline':True]
['text':' Skip past : or ) ','line_number':3960,'multiline':True]
['text':' Some optional arguments can be treated as a preceding (*MARK) ','line_number':3962,'multiline':True]
['text':' The remaining verbs with arguments (except *MARK) need a different
          opcode. ','line_number':3970,'multiline':True]
['text':' Set up for reading the name in the main loop. ','line_number':3979,'multiline':True]
['text':' No verb "name" argument ','line_number':3985,'multiline':True]
['text':' End of (*VERB) handling ','line_number':3989,'multiline':True]
['text':' Done with this parenthesis ','line_number':3990,'multiline':True]
['text':' End of groups that don't start with (? ','line_number':3991,'multiline':True]
['text':' ---- Items starting (? ---- ','line_number':3994,'multiline':True]
['text':' The type of item is determined by what follows (?. Handle (?| and option
    changes under "default" because both need a new block on the nest stack.
    Comments starting with (?# are handled above. Note that there is some
    ambiguity about the sequence (?- because if a digit follows it's a relative
    recursion or subroutine call whereas otherwise it's an option unsetting. ','line_number':3996,'multiline':True]
['text':' The + case is handled by CHAR_PLUS ','line_number':4008,'multiline':True]
['text':' We now have either (?| or a (possibly empty) option setting,
      optionally followed by a non-capturing group. ','line_number':4010,'multiline':True]
['text':' Start of non-capturing group that resets the capture count for each
      branch. ','line_number':4024,'multiline':True]
['text':' Scan for options imnsxJU to be set or unset. ','line_number':4037,'multiline':True]
['text':' ^ at the start unsets imnsx and disables the subsequent use of - ','line_number':4049,'multiline':True]
['text':' Correct the offset ','line_number':4068,'multiline':True]
['text':' Record that it changed in the external options ','line_number':4075,'multiline':True]
['text':' If x appears twice it sets the extended extended option. ','line_number':4086,'multiline':True]
['text':' Correct the offset ','line_number':4099,'multiline':True]
['text':' If we are setting extended without extended-more, ensure that any
        existing extended-more gets unset. Also, unsetting extended must also
        unset extended-more. ','line_number':4104,'multiline':True]
['text':' If the options ended with ')' this is not the start of a nested
        group with option changes, so the options change at this level.
        In this case, if the previous level set up a nest block, discard the
        one we have just created. Otherwise adjust it for the previous level.
        If the options ended with ':' we are starting a non-capturing group,
        possibly with an options setting. ','line_number':4114,'multiline':True]
['text':' This is not a nested group after all. ','line_number':4124,'multiline':True]
['text':' If nothing changed, no need to record. ','line_number':4131,'multiline':True]
['text':' End options processing ','line_number':4138,'multiline':True]
['text':' End default case after (? ','line_number':4139,'multiline':True]
['text':' ---- Python syntax support ---- ','line_number':4142,'multiline':True]
['text':' (?P<name> is the same as (?<name>, which defines a named group. ','line_number':4147,'multiline':True]
['text':' (?P>name) is the same as (?&name), which is a recursion or subroutine
      call. ','line_number':4155,'multiline':True]
['text':' (?P=name) is the same as \k<name>, a back reference by name. Anything
      else after (?P is an error. ','line_number':4160,'multiline':True]
['text':' End of (?P processing ','line_number':4174,'multiline':True]
['text':' ---- Recursion/subroutine calls by number ---- ','line_number':4177,'multiline':True]
['text':' (?R) == (?R0) ','line_number':4180,'multiline':True]
['text':' An item starting (?- followed by a digit comes here via the "default"
      case because (?- followed by a non-digit is an options setting. ','line_number':4189,'multiline':True]
['text':' Missing number ','line_number':4195,'multiline':True]
['text':' Fall through ','line_number':4198,'multiline':True]
['text':' + and - are relative ','line_number':4204,'multiline':True]
['text':' NB (?0) is permitted ','line_number':4207,'multiline':True]
['text':' Unknown group ','line_number':4209,'multiline':True]
['text':' End of recursive call by number handling ','line_number':4221,'multiline':True]
['text':' ---- Recursion/subroutine calls by name ---- ','line_number':4224,'multiline':True]
['text':' ---- Callout with numerical or string argument ---- ','line_number':4236,'multiline':True]
['text':' If the previous item was a condition starting (?(? an assertion,
      optionally preceded by a callout, is expected. This is checked later on,
      during actual compilation. However we need to identify this kind of
      assertion in this pass because it must not be qualified. The value of
      expect_cond_assert is set to 2 after (?(? is processed. We decrement it
      for a callout - still leaving a positive value that identifies the
      assertion. Multiple callouts or any other items will make it zero or
      less, which doesn't matter because they will cause an error later. ','line_number':4241,'multiline':True]
['text':' If previous_callout is not NULL, it means this follows a previous
      callout. If it was a manual callout, do nothing; this means its "length
      of next pattern item" field will remain zero. If it was an automatic
      callout, abolish it. ','line_number':4252,'multiline':True]
['text':' Save for updating next pattern item length, and skip one item before
      completing. ','line_number':4262,'multiline':True]
['text':' Handle a string argument; specific delimiter is required. ','line_number':4268,'multiline':True]
['text':' Skip pattern info ','line_number':4291,'multiline':True]
['text':' To give a more useful message ','line_number':4298,'multiline':True]
['text':' Handle a callout with an optional numerical argument, which must be
      less than or equal to 255. A missing argument gives 0. ','line_number':4316,'multiline':True]
['text':' Numerical callout ','line_number':4322,'multiline':True]
['text':' Skip pattern info ','line_number':4323,'multiline':True]
['text':' Both formats must have a closing parenthesis ','line_number':4336,'multiline':True]
['text':' Remember the offset to the next item in the pattern, and set a default
      length. This should get updated after the next item is read. ','line_number':4345,'multiline':True]
['text':' End callout ','line_number':4350,'multiline':True]
['text':' ---- Conditional group ---- ','line_number':4353,'multiline':True]
['text':' A condition can be an assertion, a number (referring to a numbered
      group's having been set), a name (referring to a named group), or 'R',
      referring to overall recursion. R<digits> and R&name are also permitted
      for recursion state tests. Numbers may be preceded by + or - to specify a
      relative group number.

      There are several syntaxes for testing a named group: (?(name)) is used
      by Python; Perl 5.10 onwards uses (?(<name>) or (?('name')).

      There are two unfortunate ambiguities. 'R' can be the recursive thing or
      the name 'R' (and similarly for 'R' followed by digits). 'DEFINE' can be
      the Perl DEFINE feature or the Python named test. We look for a name
      first; if not found, we try the other case.

      For compatibility with auto-callouts, we allow a callout to be specified
      before a condition that is an assertion. ','line_number':4355,'multiline':True]
['text':' If the next character is ? or * there must be an assertion next
      (optionally preceded by a callout). We do not check this here, but
      instead we set expect_cond_assert to 2. If this is still greater than
      zero (callouts decrement it) when the next assertion is read, it will be
      marked as a condition that must not be repeated. A value greater than
      zero also causes checking that an assertion (possibly with callout)
      follows. ','line_number':4376,'multiline':True]
['text':' Pull pointer back to the opening parenthesis. ','line_number':4387,'multiline':True]
['text':' End of conditional ','line_number':4389,'multiline':True]
['text':' Handle (?([+-]number)... ','line_number':4392,'multiline':True]
['text':' Number too big ','line_number':4407,'multiline':True]
['text':' No number found. Handle the special case (?(VERSION[>]=n.m)... ','line_number':4409,'multiline':True]
['text':' NOTE: cannot write IS_DIGIT(*(++ptr)) here because IS_DIGIT
        references its argument twice. ','line_number':4426,'multiline':True]
['text':' All the remaining cases now require us to read a name. We cannot at
      this stage distinguish ambiguous cases such as (?(R12) which might be a
      recursion test by number or a name, because the named groups have not yet
      all been identified. Those cases are treated as names, but given a
      different META code. ','line_number':4452,'multiline':True]
['text':' Point to char before name ','line_number':4475,'multiline':True]
['text':' Handle (?(R&name) ','line_number':4480,'multiline':True]
['text':' Back to closing parens ','line_number':4485,'multiline':True]
['text':' Handle (?(name). If the name is "DEFINE" we identify it with a
        special code. Likewise if the name consists of R followed only by
        digits. Otherwise, handle it like a quoted name. ','line_number':4488,'multiline':True]
['text':' Back to closing parens ','line_number':4503,'multiline':True]
['text':' Handle (?('name') or (?(<name>) ','line_number':4506,'multiline':True]
['text':' All these cases except DEFINE end with the name length and offset;
        DEFINE just has an offset (for the "too many branches" error). ','line_number':4510,'multiline':True]
['text':' End cases that read a name ','line_number':4515,'multiline':True]
['text':' Check the closing parenthesis of the condition ','line_number':4517,'multiline':True]
['text':' End of condition processing ','line_number':4525,'multiline':True]
['text':' ---- Atomic group ---- ','line_number':4528,'multiline':True]
['text':' Come from (*atomic: ','line_number':4531,'multiline':True]
['text':' ---- Lookahead assertions ---- ','line_number':4538,'multiline':True]
['text':' Come from (*pla: ','line_number':4541,'multiline':True]
['text':' Come from (?* ','line_number':4547,'multiline':True]
['text':' Come from (*nla: ','line_number':4553,'multiline':True]
['text':' ---- Lookbehind assertions ---- ','line_number':4559,'multiline':True]
['text':' (?< followed by = or ! or * is a lookbehind assertion. Otherwise (?<
      is the start of the name of a capturing group. ','line_number':4561,'multiline':True]
['text':' Come from (*plb: (*naplb: and (*nlb: ','line_number':4577,'multiline':True]
['text':' Fall through ','line_number':4582,'multiline':True]
['text':' If the previous item was a condition starting (?(? an assertion,
      optionally preceded by a callout, is expected. This is checked later on,
      during actual compilation. However we need to identify this kind of
      assertion in this pass because it must not be qualified. The value of
      expect_cond_assert is set to 2 after (?(? is processed. We decrement it
      for a callout - still leaving a positive value that identifies the
      assertion. Multiple callouts or any other items will make it zero or
      less, which doesn't matter because they will cause an error later. ','line_number':4584,'multiline':True]
['text':' ---- Define a named group ---- ','line_number':4610,'multiline':True]
['text':' A named group may be defined as (?'name') or (?<name>). In the latter
      case we jump to DEFINE_NAME from the disambiguation of (?< above with the
      terminator set to '>'. ','line_number':4612,'multiline':True]
['text':' Terminator ','line_number':4617,'multiline':True]
['text':' We have a name for this capturing group. It is also assigned a number,
      which is its primary means of identification. ','line_number':4623,'multiline':True]
['text':' Check not too many names ','line_number':4635,'multiline':True]
['text':' Adjust the entry size to accommodate the longest name found. ','line_number':4643,'multiline':True]
['text':' Scan the list to check for duplicates. For duplicate names, if the
      number is the same, break the loop, which causes the name to be
      discarded; otherwise, if DUPNAMES is not set, give an error.
      If it is set, allow the name with a different number, but continue
      scanning in case this is a duplicate with the same number. For
      non-duplicate names, give an error if the number is duplicated. ','line_number':4648,'multiline':True]
['text':' Mark as a duplicate ','line_number':4668,'multiline':True]
['text':' Duplicate names exist ','line_number':4669,'multiline':True]
['text':' Ignore duplicate with same number ','line_number':4678,'multiline':True]
['text':' Increase the list size if necessary ','line_number':4680,'multiline':True]
['text':' Add this name to the list ','line_number':4703,'multiline':True]
['text':' End of (? switch ','line_number':4711,'multiline':True]
['text':' End of ( handling ','line_number':4712,'multiline':True]
['text':' ---- Branch terminators ---- ','line_number':4715,'multiline':True]
['text':' Alternation: reset the capture count if we are in a (?| group. ','line_number':4717,'multiline':True]
['text':' End of group; reset the capture count to the maximum if we are in a (?|
    group and/or reset the options that are tracked during parsing. Disallow
    quantifier for a condition that is an assertion. ','line_number':4730,'multiline':True]
['text':' Unmatched closing parenthesis ','line_number':4753,'multiline':True]
['text':' End of switch on pattern character ','line_number':4761,'multiline':True]
['text':' End of main character scan loop ','line_number':4762,'multiline':True]
['text':' End of pattern reached. Check for missing ) at the end of a verb name. ','line_number':4764,'multiline':True]
['text':' Manage callout for the final item ','line_number':4772,'multiline':True]
['text':' Insert trailing items for word and line matching (features provided for the
benefit of pcre2grep). ','line_number':4778,'multiline':True]
['text':' Terminate the parsed pattern, then return success if all groups are closed.
Otherwise we have unclosed parentheses. ','line_number':4792,'multiline':True]
['text':' Internal error (parsed pattern overflow) ','line_number':4797,'multiline':True]
['text':' Come here for all failures. ','line_number':4807,'multiline':True]
['text':' Some errors need to indicate the previous character. ','line_number':4813,'multiline':True]
['text':' This failure happens several times. ','line_number':4819,'multiline':True]
['text':'************************************************
*       Find first significant opcode            *
************************************************','line_number':4828,'multiline':True]
['text':' This is called by several functions that scan a compiled expression looking
for a fixed first character, or an anchoring opcode etc. It skips over things
that do not influence this. For some calls, it makes sense to skip negative
forward and all backward assertions, and also the \b assertion; for others it
does not.

Arguments:
  code         pointer to the start of the group
  skipassert   TRUE if certain assertions are to be skipped

Returns:       pointer to the first significant opcode
','line_number':4832,'multiline':True]
['text':' Fall through ','line_number':4864,'multiline':True]
['text':' Not DEFINE ','line_number':4886,'multiline':True]
['text':' More than one branch ','line_number':4887,'multiline':True]
['text':' Control never reaches here ','line_number':4904,'multiline':True]
['text':'************************************************
*           Get othercase range                  *
************************************************','line_number':4910,'multiline':True]
['text':' This function is passed the start and end of a class range in UCP mode. It
searches up the characters, looking for ranges of characters in the "other"
case. Each call returns the next one, updating the start address. A character
with multiple other cases is returned on its own with a special return value.

Arguments:
  cptr        points to starting character value; updated
  d           end value
  ocptr       where to put start of othercase range
  odptr       where to put end of othercase range

Yield:        -1 when no more
               0 when a range is returned
              >0 the CASESET offset for char with multiple other cases
                in this case, ocptr contains the original
','line_number':4914,'multiline':True]
['text':' Find the first character that has an other case. If it has multiple other
cases, return its case offset value. ','line_number':4938,'multiline':True]
['text':' Character that has the set ','line_number':4945,'multiline':True]
['text':' Rest of input range ','line_number':4946,'multiline':True]
['text':' Reached end of range ','line_number':4952,'multiline':True]
['text':' Found a character that has a single other case. Search for the end of the
range, which is either the end of the input range, or a character that has zero
or more than one other cases. ','line_number':4954,'multiline':True]
['text':' End of othercase range ','line_number':4967,'multiline':True]
['text':' Rest of input range ','line_number':4968,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':4971,'multiline':True]
['text':'************************************************
* Add a character or range to a class (internal) *
************************************************','line_number':4975,'multiline':True]
['text':' This function packages up the logic of adding a character or range of
characters to a class. The character values in the arguments will be within the
valid values for the current mode (8-bit, 16-bit, UTF, etc). This function is
called only from within the "add to class" group of functions, some of which
are recursive and mutually recursive. The external entry point is
add_to_class().

Arguments:
  classbits     the bit map for characters < 256
  uchardptr     points to the pointer for extra data
  options       the options word
  cb            compile data
  start         start of range character
  end           end of range character

Returns:        the number of < 256 characters added
                the pointer to extra data is updated
','line_number':4979,'multiline':True]
['text':' If caseless matching is required, scan the range and process alternate
cases. In Unicode, there are 8-bit characters that have alternate cases that
are greater than 255 and vice-versa. Sometimes we can just extend the original
range. ','line_number':5006,'multiline':True]
['text':' Remove for recursive calls ','line_number':5019,'multiline':True]
['text':' Handle a single character that has more than one other case. ','line_number':5024,'multiline':True]
['text':' Do nothing if the other case range is within the original range. ','line_number':5029,'multiline':True]
['text':' Extend the original range if there is overlap, noting that if oc < c, we
      can't have od > end because a subrange is always shorter than the basic
      range. Otherwise, use a recursive call to add the additional range. ','line_number':5033,'multiline':True]
['text':' Extend downwards ','line_number':5037,'multiline':True]
['text':' Extend upwards ','line_number':5040,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':5047,'multiline':True]
['text':' Not UTF mode ','line_number':5049,'multiline':True]
['text':' Now handle the originally supplied range. Adjust the final value according
to the bit length - this means that the same lists of (e.g.) horizontal spaces
can be used in all cases. ','line_number':5058,'multiline':True]
['text':' Use the bitmap for characters < 256. Otherwise use extra data.','line_number':5067,'multiline':True]
['text':' Regardless of start, c will always be <= 255. ','line_number':5071,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':5099,'multiline':True]
['text':' Without UTF support, character values are constrained by the bit length,
  and can only be > 256 for 16-bit and 32-bit libraries. ','line_number':5101,'multiline':True]
['text':' PCRE2_CODE_UNIT_WIDTH == 8 ','line_number':5118,'multiline':True]
['text':' Updata extra data pointer ','line_number':5119,'multiline':True]
['text':' SUPPORT_WIDE_CHARS ','line_number':5121,'multiline':True]
['text':' Avoid compiler warning ','line_number':5122,'multiline':True]
['text':' SUPPORT_WIDE_CHARS ','line_number':5123,'multiline':True]
['text':' Number of 8-bit characters ','line_number':5125,'multiline':True]
['text':'************************************************
* Add a list of characters to a class (internal) *
************************************************','line_number':5131,'multiline':True]
['text':' This function is used for adding a list of case-equivalent characters to a
class when in UTF mode. This function is called only from within
add_to_class_internal(), with which it is mutually recursive.

Arguments:
  classbits     the bit map for characters < 256
  uchardptr     points to the pointer for extra data
  options       the options word
  cb            contains pointers to tables etc.
  p             points to row of 32-bit values, terminated by NOTACHAR
  except        character to omit; this is used when adding lists of
                  case-equivalent characters to avoid including the one we
                  already know about

Returns:        the number of < 256 characters added
                the pointer to extra data is updated
','line_number':5135,'multiline':True]
['text':'************************************************
*   External entry point for add range to class  *
************************************************','line_number':5174,'multiline':True]
['text':' This function sets the overall range so that the internal functions can try
to avoid duplication when handling case-independence.

Arguments:
  classbits     the bit map for characters < 256
  uchardptr     points to the pointer for extra data
  options       the options word
  cb            compile data
  start         start of range character
  end           end of range character

Returns:        the number of < 256 characters added
                the pointer to extra data is updated
','line_number':5178,'multiline':True]
['text':'************************************************
*   External entry point for add list to class   *
************************************************','line_number':5203,'multiline':True]
['text':' This function is used for adding a list of horizontal or vertical whitespace
characters to a class. The list must be in order so that ranges of characters
can be detected and handled appropriately. This function sets the overall range
so that the internal functions can try to avoid duplication when handling
case-independence.

Arguments:
  classbits     the bit map for characters < 256
  uchardptr     points to the pointer for extra data
  options       the options word
  cb            contains pointers to tables etc.
  p             points to row of 32-bit values, terminated by NOTACHAR
  except        character to omit; this is used when adding lists of
                  case-equivalent characters to avoid including the one we
                  already know about

Returns:        the number of < 256 characters added
                the pointer to extra data is updated
','line_number':5207,'multiline':True]
['text':'************************************************
*    Add characters not in a list to a class     *
************************************************','line_number':5249,'multiline':True]
['text':' This function is used for adding the complement of a list of horizontal or
vertical whitespace to a class. The list must be in order.

Arguments:
  classbits     the bit map for characters < 256
  uchardptr     points to the pointer for extra data
  options       the options word
  cb            contains pointers to tables etc.
  p             points to row of 32-bit values, terminated by NOTACHAR

Returns:        the number of < 256 characters added
                the pointer to extra data is updated
','line_number':5253,'multiline':True]
['text':'************************************************
*    Find details of duplicate group names       *
************************************************','line_number':5287,'multiline':True]
['text':' This is called from compile_branch() when it needs to know the index and
count of duplicates in the names table when processing named backreferences,
either directly, or as conditions.

Arguments:
  name          points to the name
  length        the length of the name
  indexptr      where to put the index
  countptr      where to put the count of duplicates
  errorcodeptr  where to put an error code
  cb            the compile block

Returns:        TRUE if OK, FALSE if not, error code set
','line_number':5291,'multiline':True]
['text':' Find the first entry in the table ','line_number':5314,'multiline':True]
['text':' This should not occur, because this function is called only when we know we
have duplicate names. Give an internal error. ','line_number':5323,'multiline':True]
['text':' Record the index and then see how many duplicates there are, updating the
backref map and maximum back reference as we do. ','line_number':5333,'multiline':True]
['text':'************************************************
*           Compile one branch                   *
************************************************','line_number':5357,'multiline':True]
['text':' Scan the parsed pattern, compiling it into the a vector of PCRE2_UCHAR. If
the options are changed during the branch, the pointer is used to change the
external options bits. This function is used during the pre-compile phase when
we are trying to find out the amount of memory needed, as well as during the
real compile phase. The value of lengthptr distinguishes the two phases.

Arguments:
  optionsptr        pointer to the option bits
  codeptr           points to the pointer to the current code point
  pptrptr           points to the current parsed pattern pointer
  errorcodeptr      points to error code variable
  firstcuptr        place to put the first required code unit
  firstcuflagsptr   place to put the first code unit flags
  reqcuptr          place to put the last required code unit
  reqcuflagsptr     place to put the last required code unit flags
  bcptr             points to current branch chain
  cb                contains pointers to tables etc.
  lengthptr         NULL during the real compile phase
                    points to length accumulator during pre-compile phase

Returns:            0 There's been an error, *errorcodeptr is non-zero
                   +1 Success, this branch must match at least one character
                   -1 Success, this branch may match an empty string
','line_number':5361,'multiline':True]
['text':' To please picky compilers ','line_number':5395,'multiline':True]
['text':' May change dynamically ','line_number':5398,'multiline':True]
['text':' We can fish out the UTF setting once and for all into a BOOL, but we must
not do this for other options (e.g. PCRE2_EXTENDED) because they may change
dynamically as we process the pattern. ','line_number':5423,'multiline':True]
['text':' No Unicode support ','line_number':5430,'multiline':True]
['text':' Helper variables for OP_XCLASS opcode (for characters > 255). We define
class_uchardata always so that it can be passed to add_to_class() always,
though it will not be used in non-UTF 8-bit cases. This avoids having to supply
alternative calls for the different cases. ','line_number':5434,'multiline':True]
['text':' Set up the default and non-default settings for greediness ','line_number':5445,'multiline':True]
['text':' Initialize no first unit, no required unit. REQ_UNSET means "no char
matching encountered yet". It gets changed to REQ_NONE if we hit something that
matches a non-fixed first unit; reqcu just remains unset if we never find one.

When we hit a repeat whose minimum is zero, we may have to adjust these values
to take the zero repeat into account. This is implemented by setting them to
zerofirstcu and zeroreqcu when such a repeat is encountered. The individual
item types that can be repeated set these backoff variables appropriately. ','line_number':5450,'multiline':True]
['text':' The variable req_caseopt contains either the REQ_CASELESS bit or zero,
according to the current setting of the caseless flag. The REQ_CASELESS value
leaves the lower 28 bit empty. It is added into the firstcu or reqcu variables
to record the case status of the value. This is used only for ASCII characters.
','line_number':5462,'multiline':True]
['text':' Switch on next META item until the end of the branch ','line_number':5470,'multiline':True]
['text':' Get next META item in the pattern and its potential argument. ','line_number':5492,'multiline':True]
['text':' If we are in the pre-compile phase, accumulate the length used for the
  previous cycle of this loop, unless the next item is a quantifier. ','line_number':5497,'multiline':True]
['text':' Check for overrun ','line_number':5503,'multiline':True]
['text':' There is at least one situation where code goes backwards: this is the
    case of a zero quantifier after a class (e.g. [ab]{0}). When the quantifier
    is processed, the whole class is eliminated. However, it is created first,
    so we have to allow memory for it. Therefore, don't ever reduce the length
    at this point. ','line_number':5510,'multiline':True]
['text':' If the next thing is not a quantifier, we add the length of the previous
    item into the total, and reset the code pointer to the start of the
    workspace. Otherwise leave the previous item available to be quantified. ','line_number':5518,'multiline':True]
['text':' Integer overflow ','line_number':5526,'multiline':True]
['text':' Pattern is too large ','line_number':5532,'multiline':True]
['text':' Remember where this code item starts so we can catch the "backwards"
    case above next time round. ','line_number':5538,'multiline':True]
['text':' Process the next parsed pattern item. If it is not a quantifier, remember
  where it starts so that it can be quantified when a quantifier follows.
  Checking for the legality of quantifiers happens in parse_regex(), except for
  a quantifier after an assertion that is a condition. ','line_number':5544,'multiline':True]
['text':' Default value for most subgroups ','line_number':5558,'multiline':True]
['text':' ===================================================================','line_number':5562,'multiline':True]
['text':' The branch terminates at pattern end or | or ) ','line_number':5563,'multiline':True]
['text':' ===================================================================','line_number':5577,'multiline':True]
['text':' Handle single-character metacharacters. In multiline mode, ^ disables
    the setting of any following char as a first character. ','line_number':5578,'multiline':True]
['text':' There can never be a first char if '.' is first, whatever happens about
    repeats. The value of reqcu doesn't change either. ','line_number':5595,'multiline':True]
['text':' ===================================================================','line_number':5609,'multiline':True]
['text':' Empty character classes are allowed if PCRE2_ALLOW_EMPTY_CLASS is set.
    Otherwise, an initial ']' is taken as a data character. When empty classes
    are allowed, [] must always fail, so generate OP_FAIL, whereas [^] must
    match any character, so generate OP_ALLANY. ','line_number':5610,'multiline':True]
['text':' ===================================================================','line_number':5625,'multiline':True]
['text':' Non-empty character class. If the included characters are all < 256, we
    build a 32-byte bitmap of the permitted characters, except in the special
    case where there is only one such character. For negated classes, we build
    the map as usual, then invert it at the end. However, we use a different
    opcode so that data characters > 255 can be handled correctly.

    If the class contains characters outside the 0-255 range, a different
    opcode is compiled. It may optionally have a bit map for characters < 256,
    but those above are are explicitly listed afterwards. A flag code unit
    tells whether the bitmap is present, and whether this is a negated class or
    not. ','line_number':5626,'multiline':True]
['text':' We can optimize the case of a single character in a class by generating
    OP_CHAR or OP_CHARI if it's positive, or OP_NOT or OP_NOTI if it's
    negative. In the negative case there can be no first char if this item is
    first, whatever repeat count may follow. In the case of reqcu, save the
    previous value for reinstating. ','line_number':5643,'multiline':True]
['text':' NOTE: at present this optimization is not effective if the only
    character in a class in 32-bit, non-UCP mode has its top bit set. ','line_number':5649,'multiline':True]
['text':' Move on to class end ','line_number':5659,'multiline':True]
['text':' A positive one-char class can be ','line_number':5660,'multiline':True]
['text':' handled as a normal literal character. ','line_number':5661,'multiline':True]
['text':' Set up the character ','line_number':5662,'multiline':True]
['text':' Handle a negative one-character class ','line_number':5666,'multiline':True]
['text':' For caseless UTF or UCP mode, check whether this character has more
      than one other case. If so, generate a special OP_NOTPROP item instead of
      OP_NOTI. ','line_number':5674,'multiline':True]
['text':' We are finished with this class ','line_number':5685,'multiline':True]
['text':' Char has only one other case, or UCP not available ','line_number':5688,'multiline':True]
['text':' We are finished with this class ','line_number':5692,'multiline':True]
['text':' End of 1-char optimization ','line_number':5693,'multiline':True]
['text':' Handle character classes that contain more than just one literal
    character. If there are exactly two characters in a positive class, see if
    they are case partners. This can be optimized to generate a caseless single
    character match (which also sets first/required code units if relevant). ','line_number':5695,'multiline':True]
['text':' Move on to class end ','line_number':5723,'multiline':True]
['text':' If a non-extended class contains a negative special such as \S, we need
    to flip the negation flag at the end, so that support for characters > 255
    works correctly (they are all included in the class). An extended class may
    need to insert specific matching or non-matching code for wide characters.
    ','line_number':5736,'multiline':True]
['text':' Extended class (xclass) will be used when characters > 255
    might match. ','line_number':5744,'multiline':True]
['text':' For XCLASS items ','line_number':5749,'multiline':True]
['text':' Save the start ','line_number':5750,'multiline':True]
['text':' For optimization purposes, we track some properties of the class:
    class_has_8bitchar will be non-zero if the class contains at least one
    character with a code point less than 256; xclass_has_prop will be TRUE if
    Unicode property checks are present in the class. ','line_number':5753,'multiline':True]
['text':' Initialize the 256-bit (32-byte) bit map to all zeros. We build the map
    in a temporary bit of memory, in case the class contains fewer than two
    8-bit characters because in that case the compiled code doesn't use the bit
    map. ','line_number':5763,'multiline':True]
['text':' Process items until META_CLASS_END is reached. ','line_number':5770,'multiline':True]
['text':' Handle POSIX classes such as [:alpha:] etc. ','line_number':5774,'multiline':True]
['text':' Note negative special ','line_number':5783,'multiline':True]
['text':' If matching is caseless, upper and lower are converted to alpha.
        This relies on the fact that the class table starts with alpha,
        lower, upper as the first 3 entries. ','line_number':5785,'multiline':True]
['text':' When PCRE2_UCP is set, some of the POSIX classes are converted to
        different escape sequences that use Unicode properties \p or \P.
        Others that are not available via \p or \P have to generate
        XCL_PROP/XCL_NOTPROP directly, which is done here. ','line_number':5792,'multiline':True]
['text':' For the other POSIX classes (ascii, xdigit) we are going to
          fall through to the non-UCP case and build a bit map for
          characters with code points less than 256. However, if we are in
          a negated POSIX class, characters with code points greater than
          255 must either all match or all not match, depending on whether
          the whole class is not or is negated. For example, for
          [[:^ascii:]... they must all match, whereas for [^[:^xdigit:]...
          they must not.

          In the special case where there are no xclass items, this is
          automatically handled by the use of OP_CLASS or OP_NCLASS, but an
          explicit range is needed for OP_XCLASS. Setting a flag here
          causes the range to be generated later when it is known that
          OP_XCLASS is required. In the 8-bit library this is relevant only in
          utf mode, since no wide characters can exist otherwise. ','line_number':5811,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':5834,'multiline':True]
['text':' In the non-UCP case, or when UCP makes no difference, we build the
        bit map for the POSIX class in a chunk of local store because we may
        be adding and subtracting from it, and we don't want to subtract bits
        that may be in the main map already. At the end we or the result into
        the bit map that is being built. ','line_number':5836,'multiline':True]
['text':' Copy in the first table (always present) ','line_number':5844,'multiline':True]
['text':' If there is a second table, add or remove it as required. ','line_number':5849,'multiline':True]
['text':' Now see if we need to remove any special characters. An option
        value of 1 removes vertical space and 2 removes underscore. ','line_number':5862,'multiline':True]
['text':' Add the POSIX table or its complement into the main table that is
        being built and we are done. ','line_number':5869,'multiline':True]
['text':' Every class contains at least one < 256 character. ','line_number':5877,'multiline':True]
['text':' End of POSIX handling ','line_number':5880,'multiline':True]
['text':' Other than POSIX classes, the only items we should encounter are
      \d-type escapes and literal characters (possibly as ranges). ','line_number':5883,'multiline':True]
['text':' Any other non-literal must be an escape ','line_number':5892,'multiline':True]
['text':' Internal error - unrecognized. ','line_number':5902,'multiline':True]
['text':' Every class contains at least one < 256 character. ','line_number':5907,'multiline':True]
['text':' Perl 5.004 onwards omitted VT from \s, but restored it at Perl
          5.18. Before PCRE 8.34, we had to preserve the VT bit if it was
          previously set by something earlier in the character class.
          Luckily, the value of CHAR_VT is 0x0b in both ASCII and EBCDIC, so
          we could just adjust the appropriate bit. From PCRE 8.34 we no
          longer treat \s and \S specially. ','line_number':5933,'multiline':True]
['text':' When adding the horizontal or vertical space lists to a class, or
          their complements, disable PCRE2_CASELESS, because it justs wastes
          time, and in the "not-x" UTF cases can create unwanted duplicates in
          the XCLASS list (provoked by characters that have more than one other
          case and by both cases being in the same "not-x" sublist). ','line_number':5950,'multiline':True]
['text':' If Unicode is not supported, \P and \p are not allowed and are
          faulted at parse time, so will never appear here. ','line_number':5976,'multiline':True]
['text':' Undo! ','line_number':5989,'multiline':True]
['text':' End handling \d-type escapes ','line_number':5996,'multiline':True]
['text':' A literal character may be followed by a range meta. At parse time
      there are checks for out-of-order characters, for ranges where the two
      characters are equal, and for hyphens that cannot indicate a range. At
      this point, therefore, no checking is needed. ','line_number':5998,'multiline':True]
['text':' Remember if \r or \n were explicitly used ','line_number':6010,'multiline':True]
['text':' Process a character range ','line_number':6014,'multiline':True]
['text':' Remember an explicit \r or \n, and add the range to the class. ','line_number':6025,'multiline':True]
['text':' In an EBCDIC environment, Perl treats alphabetic ranges specially
          because there are holes in the encoding, and simply using the range
          A-Z (for example) would include the characters in the holes. This
          applies only to literal ranges; [\xC1-\xE9] is different to [A-Z]. ','line_number':6029,'multiline':True]
['text':' Not an EBCDIC special range ','line_number':6069,'multiline':True]
['text':' Go get the next char in the class ','line_number':6073,'multiline':True]
['text':' End of range handling ','line_number':6074,'multiline':True]
['text':' Handle a single character. ','line_number':6077,'multiline':True]
['text':' Continue to the next item in the class. ','line_number':6083,'multiline':True]
['text':' If any wide characters or Unicode properties have been encountered,
      set xclass = TRUE. Then, in the pre-compile phase, accumulate the length
      of the extra data and reset the pointer. This is so that very large
      classes that contain a zillion wide characters or Unicode property tests
      do not overwrite the workspace (which is on the stack). ','line_number':6088,'multiline':True]
['text':' Needed to avoid error when not supporting wide chars ','line_number':6105,'multiline':True]
['text':' End of main class-processing loop ','line_number':6106,'multiline':True]
['text':' If this class is the first thing in the branch, there can be no first
    char setting, whatever the repeat count. Any reqcu setting must remain
    unchanged after any kind of repeat. ','line_number':6108,'multiline':True]
['text':' If there are characters with values > 255, or Unicode property settings
    (\p or \P), we have to compile an extended class, with its own opcode,
    unless there were no property settings and there was a negated special such
    as \S in the class, and PCRE2_UCP is not set, because in that case all
    characters > 255 are in or not in the class, so any that were explicitly
    given as well can be ignored.

    In the UCP case, if certain negated POSIX classes ([:^ascii:] or
    [^:xdigit:]) were present in a class, we either have to match or not match
    all wide characters (depending on whether the whole class is or is not
    negated). This requirement is indicated by match_all_or_no_wide_chars being
    true. We do this by including an explicit range, which works in both cases.
    This applies only in UTF and 16-bit and 32-bit non-UTF modes, since there
    cannot be any wide characters in 8-bit non-UTF mode.

    When there *are* properties in a positive UTF-8 or any 16-bit or 32_bit
    class where \S etc is present without PCRE2_UCP, causing an extended class
    to be compiled, we make sure that all characters > 255 are included by
    forcing match_all_or_no_wide_chars to be true.

    If, when generating an xclass, there are no characters < 256, we can omit
    the bitmap in the actual compiled code. ','line_number':6118,'multiline':True]
['text':' Defined for 16/32 bits, or 8-bit with Unicode ','line_number':6141,'multiline':True]
['text':' Will always be utf in the 8-bit library ','line_number':6155,'multiline':True]
['text':' Can only happen for the 16-bit & 32-bit libraries ','line_number':6160,'multiline':True]
['text':' Marks the end of extra data ','line_number':6171,'multiline':True]
['text':' If the map is required, move up the extra data to make room for it;
      otherwise just move the code pointer to the end of the extra data. ','line_number':6177,'multiline':True]
['text':' Using 255 ^ instead of ~ avoids clang sanitize warning. ','line_number':6187,'multiline':True]
['text':' Now fill in the complete length of the item ','line_number':6195,'multiline':True]
['text':' End of class handling ','line_number':6198,'multiline':True]
['text':' SUPPORT_WIDE_CHARS ','line_number':6200,'multiline':True]
['text':' If there are no characters > 255, or they are all to be included or
    excluded, set the opcode to OP_CLASS or OP_NCLASS, depending on whether the
    whole class was negated and whether there were negative specials such as \S
    (non-UCP) in the class. Then copy the 32-byte map into the code vector,
    negating it if necessary. ','line_number':6202,'multiline':True]
['text':' Save time in the pre-compile phase ','line_number':6209,'multiline':True]
['text':' Using 255 ^ instead of ~ avoids clang sanitize warning. ','line_number':6213,'multiline':True]
['text':' End of class processing ','line_number':6219,'multiline':True]
['text':' ===================================================================','line_number':6222,'multiline':True]
['text':' Deal with (*VERB)s. ','line_number':6223,'multiline':True]
['text':' Check for open captures before ACCEPT and close those that are within
    the same assertion level, also converting ACCEPT to ASSERT_ACCEPT in an
    assertion. In the first pass, just accumulate the length required;
    otherwise hitting (*ACCEPT) inside many nested parentheses can cause
    workspace overflow. Do not set firstcu after *ACCEPT. ','line_number':6225,'multiline':True]
['text':' Fall through ','line_number':6254,'multiline':True]
['text':' Handle verbs with arguments. Arguments can be very long, especially in
    16- and 32-bit modes, and can overflow the workspace in the first pass.
    However, the argument length is constrained to be small enough to fit in
    one code unit. This check happens in parse_regex(). In the first pass,
    instead of putting the argument into memory, we just update the length
    counter and set up an empty argument. ','line_number':6265,'multiline':True]
['text':' Fall through ','line_number':6279,'multiline':True]
['text':' The length is in characters. ','line_number':6284,'multiline':True]
['text':' Fill in the code unit length ','line_number':6306,'multiline':True]
['text':' Terminating zero ','line_number':6307,'multiline':True]
['text':' ===================================================================','line_number':6311,'multiline':True]
['text':' Handle options change. The new setting must be passed back for use in
    subsequent branches. Reset the greedy defaults and the case value for
    firstcu and reqcu. ','line_number':6312,'multiline':True]
['text':' ===================================================================','line_number':6324,'multiline':True]
['text':' Handle conditional subpatterns. The case of (?(Rdigits) is ambiguous
    because it could be a numerical check on recursion, or a name check on a
    group's being set. The pre-pass sets up META_COND_RNUMBER as a name so that
    we can handle it either way. We first try for a name; if not found, process
    the number. ','line_number':6325,'multiline':True]
['text':' (?(Rdigits) ','line_number':6331,'multiline':True]
['text':' (?(name) or (?'name') or ?(<name>) ','line_number':6332,'multiline':True]
['text':' (?(R&name) - test for recursion ','line_number':6333,'multiline':True]
['text':' In the first pass, the names generated in the pre-pass are available,
      but the main name table has not yet been created. Scan the list of names
      generated in the pre-pass in order to get a number and whether or not
      this name is duplicated. If it is not duplicated, we can handle it as a
      numerical group. ','line_number':6345,'multiline':True]
['text':' Found a duplicated name ','line_number':6364,'multiline':True]
['text':' If the name was not found we have a bad reference, unless we are
      dealing with R<digits>, which is treated as a recursion test by number.
      ','line_number':6368,'multiline':True]
['text':' (?Rdigits) treated as a recursion reference by number. A value of
        zero (which is the result of both (?R) and (?R0)) means "any", and is
        translated into RREF_ANY (which is 0xffff). ','line_number':6396,'multiline':True]
['text':' A duplicated name was found. Note that if an R<digits> name is found
      (META_COND_RNUMBER), it is a reference test, not a recursion test. ','line_number':6407,'multiline':True]
['text':' We have a duplicated name. In the compile pass we have to search the
      main table in order to get the index and count values. ','line_number':6412,'multiline':True]
['text':' Values for first pass (avoids compiler warning) ','line_number':6415,'multiline':True]
['text':' Add one to the opcode to change CREF/RREF into DNCREF/DNRREF and
      insert appropriate data values. ','line_number':6420,'multiline':True]
['text':' The DEFINE condition is always false. Its internal groups may never
    be called, so matched_char must remain false, hence the jump to
    GROUP_PROCESS rather than GROUP_PROCESS_NOTE_EMPTY. ','line_number':6430,'multiline':True]
['text':' Conditional test of a group's being set. ','line_number':6441,'multiline':True]
['text':' Point at initial ( for too many branches error ','line_number':6454,'multiline':True]
['text':' Test for the PCRE2 version. ','line_number':6460,'multiline':True]
['text':' The condition is an assertion, possibly preceded by a callout. ','line_number':6475,'multiline':True]
['text':' ===================================================================','line_number':6482,'multiline':True]
['text':' Handle all kinds of nested bracketed groups. The non-capturing,
    non-conditional cases are here; others come to GROUP_PROCESS via goto. ','line_number':6483,'multiline':True]
['text':' Optimize (?!) to (*FAIL) unless it is quantified - which is a weird
    thing to do, but Perl allows all assertions to be quantified, and when
    they contain capturing parentheses there may be a potential use for
    this feature. Not that that applies to a quantified (?!) but we allow
    it for uniformity. ','line_number':6496,'multiline':True]
['text':' Fall through ','line_number':6542,'multiline':True]
['text':' Process nested bracketed regex. The nesting depth is maintained for the
    benefit of the stackguard function. The test for too deep nesting is now
    done in parse_regex(). Assertion and DEFINE groups come to GROUP_PROCESS;
    others come to GROUP_PROCESS_NOTE_EMPTY, to indicate that we need to take
    note of whether or not they may match an empty string. ','line_number':6544,'multiline':True]
['text':' Save value before group ','line_number':6558,'multiline':True]
['text':' Initialize for pre-compile phase ','line_number':6559,'multiline':True]
['text':' The option state ','line_number':6563,'multiline':True]
['text':' Where to put code (updated) ','line_number':6564,'multiline':True]
['text':' Input pointer (updated) ','line_number':6565,'multiline':True]
['text':' Where to put an error message ','line_number':6566,'multiline':True]
['text':' Skip over bracket number ','line_number':6567,'multiline':True]
['text':' For possible first char ','line_number':6568,'multiline':True]
['text':' For possible last char ','line_number':6570,'multiline':True]
['text':' Current branch chain ','line_number':6572,'multiline':True]
['text':' Compile data block ','line_number':6573,'multiline':True]
['text':' Actual compile phase ','line_number':6574,'multiline':True]
['text':' Pre-compile phase ','line_number':6575,'multiline':True]
['text':' Error ','line_number':6577,'multiline':True]
['text':' If that was a non-conditional significant group (not an assertion, not a
    DEFINE) that matches at least one character, then the current item matches
    a character. Conditionals are handled below. ','line_number':6581,'multiline':True]
['text':' If we've just compiled an assertion, pop the assert depth. ','line_number':6588,'multiline':True]
['text':' At the end of compiling, code is still pointing to the start of the
    group, while tempcode has been updated to point past the end of the group.
    The parsed pattern pointer (pptr) is on the closing META_KET.

    If this is a conditional bracket, check that there are no more than
    two branches in the group, or just one if it's a DEFINE group. We do this
    in the real compile phase, not in the pre-pass, where the whole group may
    not be available. ','line_number':6593,'multiline':True]
['text':' A DEFINE group is never obeyed inline (the "condition" is always
      false). It must have only one branch. Having checked this, change the
      opcode to OP_FALSE. ','line_number':6613,'multiline':True]
['text':' A flag to suppress char handling below ','line_number':6626,'multiline':True]
['text':' A "normal" conditional group. If there is just one branch, we must not
      make use of its firstcu or reqcu, because this is equivalent to an
      empty second branch. Also, it may match an empty string. If there are two
      branches, this item must match a character if the group must. ','line_number':6629,'multiline':True]
['text':' In the pre-compile phase, update the length by the length of the group,
    less the brackets at either end. Then reduce the compiled code to just a
    set of non-capturing brackets so that it doesn't use much memory if it is
    duplicated by a quantifier.','line_number':6647,'multiline':True]
['text':' This already contains bravalue ','line_number':6660,'multiline':True]
['text':' No need to waste time with special character handling ','line_number':6664,'multiline':True]
['text':' Otherwise update the main code pointer to the end of the group. ','line_number':6667,'multiline':True]
['text':' For a DEFINE group, required and first character settings are not
    relevant. ','line_number':6671,'multiline':True]
['text':' Handle updating of the required and first code units for other types of
    group. Update for normal brackets of all kinds, and conditions with two
    branches (see code above). If the bracket is followed by a quantifier with
    zero repeat, we have to back off. Hence the definition of zeroreqcu and
    zerofirstcu outside the main loop so that they can be accessed for the back
    off. ','line_number':6676,'multiline':True]
['text':' Not an assertion ','line_number':6689,'multiline':True]
['text':' If we have not yet set a firstcu in this branch, take it from the
      subpattern, remembering that it was set here so that a repeat of more
      than one can replicate it as reqcu if necessary. If the subpattern has
      no firstcu, set "none" for the whole branch. In both cases, a zero
      repeat forces firstcu to "none". ','line_number':6691,'multiline':True]
['text':' If firstcu was previously set, convert the subpattern's firstcu
      into reqcu if there wasn't one, using the vary flag that was in
      existence beforehand. ','line_number':6709,'multiline':True]
['text':' If the subpattern set a required code unit (or set a first code unit
      that isn't really the first code unit - see above), set it. ','line_number':6719,'multiline':True]
['text':' For a forward assertion, we take the reqcu, if set, provided that the
    group has also set a firstcu. This can be helpful if the pattern that
    follows the assertion doesn't set a different char. For example, it's
    useful for /(?=abcde).+/. We can't set firstcu for an assertion, however
    because it leads to incorrect effect for patterns such as /(?=a)a.+/ when
    the "real" "a" would then become a reqcu instead of a firstcu. This is
    overcome by a scan at the end if there's no firstcu, looking for an
    asserted first char. A similar effect for patterns like /(?=.*X)X$/ means
    we must only take the reqcu when the group also set a firstcu. Otherwise,
    in that example, 'X' ends up set for both. ','line_number':6729,'multiline':True]
['text':' End of nested group handling ','line_number':6747,'multiline':True]
['text':' ===================================================================','line_number':6750,'multiline':True]
['text':' Handle named backreferences and recursions. ','line_number':6751,'multiline':True]
['text':' In the first pass, the names generated in the pre-pass are available,
      but the main name table has not yet been created. Scan the list of names
      generated in the pre-pass in order to get a number and whether or not
      this name is duplicated. ','line_number':6765,'multiline':True]
['text':' For a recursion, that's all that is needed. We can now go to
          the code that handles numerical recursion, applying it to the first
          group with the given name. ','line_number':6779,'multiline':True]
['text':' For a back reference, update the back reference map and the
          maximum back reference. ','line_number':6789,'multiline':True]
['text':' If the name was not found we have a bad reference. ','line_number':6798,'multiline':True]
['text':' If a back reference name is not duplicated, we can handle it as
      a numerical reference. ','line_number':6807,'multiline':True]
['text':' If a back reference name is duplicated, we generate a different
      opcode to a numerical back reference. In the second pass we must
      search for the index and count in the final name table. ','line_number':6816,'multiline':True]
['text':' Values for first pass (avoids compiler warning) ','line_number':6820,'multiline':True]
['text':' ===================================================================','line_number':6833,'multiline':True]
['text':' Handle a numerical callout. ','line_number':6834,'multiline':True]
['text':' Offset to next pattern item ','line_number':6838,'multiline':True]
['text':' Length of next pattern item ','line_number':6839,'multiline':True]
['text':' ===================================================================','line_number':6846,'multiline':True]
['text':' Handle a callout with a string argument. In the pre-pass we just compute
    the length without generating anything. The length in pptr[3] includes both
    delimiters; in the actual compile only the first one is copied, but a
    terminating zero is added. Any doubled delimiters within the string make
    this an overestimate, but it is not worth bothering about. ','line_number':6847,'multiline':True]
['text':' In the real compile we can copy the string. The starting delimiter is
     included so that the client can discover it if they want. We also pass the
     start offset to help a script language give better error messages. ','line_number':6861,'multiline':True]
['text':' Offset to next pattern item ','line_number':6873,'multiline':True]
['text':' Length of next pattern item ','line_number':6874,'multiline':True]
['text':' Offset to string in pattern ','line_number':6877,'multiline':True]
['text':' One after delimiter ','line_number':6882,'multiline':True]
['text':' The syntax of the pattern was checked in the parsing scan. The length
      includes both delimiters, but we have passed the opening one just above,
      so we reduce length before testing it. The test is for > 1 because we do
      not want to copy the final delimiter. This also ensures that pp[1] is
      accessible. ','line_number':6884,'multiline':True]
['text':' Set the length of the entire item, the advance to its end. ','line_number':6902,'multiline':True]
['text':' ===================================================================','line_number':6910,'multiline':True]
['text':' Handle repetition. The different types are all sorted out in the parsing
    pass. ','line_number':6911,'multiline':True]
['text':' Remember whether this is a variable length repeat, and default to
    single-char opcodes. ','line_number':6944,'multiline':True]
['text':' Adjust first and required code units for a zero repeat. ','line_number':6950,'multiline':True]
['text':' Note the greediness and possessiveness. ','line_number':6960,'multiline':True]
['text':' Force greedy ','line_number':6968,'multiline':True]
['text':' Save start of previous item, in case we have to move it up in order to
    insert something before it, and remember what it was. ','line_number':6986,'multiline':True]
['text':' Now handle repetition for the different types of item. If the repeat
    minimum and the repeat maximum are both 1, we can ignore the quantifier for
    non-parenthesized items, as they have only one alternative. For anything in
    parentheses, we must not ignore if {1} is possessive. ','line_number':6992,'multiline':True]
['text':' If previous was a character or negated character match, abolish the
      item and generate a repeat item instead. If a char item has a minimum of
      more than one, ensure that it is set in reqcu - it might not be if a
      sequence such as x{3} is the first thing in a branch because the x will
      have gone into firstcu instead.  ','line_number':6999,'multiline':True]
['text':' Deal with UTF characters that take up more than one code unit. ','line_number':7012,'multiline':True]
['text':' Length of UTF character ','line_number':7019,'multiline':True]
['text':' Save the char ','line_number':7020,'multiline':True]
['text':' MAYBE_UTF_MULTI ','line_number':7023,'multiline':True]
['text':' Handle the case of a single code unit - either with no UTF support, or
      with UTF disabled, or for a single-code-unit UTF character. In the latter
      case, for a repeated positive match, get the caseless flag for the
      required code unit from the previous character, because a class like [Aa]
      sets a caseless A but by now the req_caseopt flag has been reset. ','line_number':7025,'multiline':True]
['text':' Code shared with single character types ','line_number':7041,'multiline':True]
['text':' If previous was a character class or a back reference, we put the
      repeat stuff after it, but just skip the item if the repeat was {0,0}. ','line_number':7043,'multiline':True]
['text':' 2-byte encoding for max ','line_number':7073,'multiline':True]
['text':' If previous is OP_FAIL, it was generated by an empty class []
      (PCRE2_ALLOW_EMPTY_CLASS is set). The other ways in which OP_FAIL can be
      generated, that is by (*FAIL) or (?!), disallow a quantifier at parse
      time. We can just ignore this repeat. ','line_number':7078,'multiline':True]
['text':' Prior to 10.30, repeated recursions were wrapped in OP_ONCE brackets
      because pcre2_match() could not handle backtracking into recursively
      called groups. Now that this backtracking is available, we no longer need
      to do this. However, we still need to replicate recursions as we do for
      groups so as to have independent backtracking points. We can replicate
      for the minimum number of repeats directly. For optional repeats we now
      wrap the recursion in OP_BRA brackets and make use of the bracket
      repetition. ','line_number':7086,'multiline':True]
['text':' Generate unwrapped repeats for a non-zero minimum, except when the
      minimum is 1 and the maximum unlimited, because that can be handled with
      OP_BRA terminated by OP_KETRMAX/MIN. When the maximum is equal to the
      minimum, we just need to generate the appropriate additional copies.
      Otherwise we need to generate one more, to simulate the situation when
      the minimum is zero. ','line_number':7099,'multiline':True]
['text':' In the pre-compile phase, we don't actually do the replication. We
        just adjust the length as if we had. Do some paranoid checks for
        potential integer overflow. The INT64_OR_DOUBLE type is a 64-bit
        integer type when available, otherwise double. ','line_number':7111,'multiline':True]
['text':' If the number of repeats is fixed, we are done. Otherwise, adjust
        the counts and fall through. ','line_number':7137,'multiline':True]
['text':' Wrap the recursion call in OP_BRA brackets. ','line_number':7145,'multiline':True]
['text':' Set "may match empty string" ','line_number':7154,'multiline':True]
['text':' Now treat as a repeated OP_BRA. ','line_number':7156,'multiline':True]
['text':' Fall through ','line_number':7157,'multiline':True]
['text':' If previous was a bracket group, we may have to replicate it in
      certain cases. Note that at this point we can encounter only the "basic"
      bracket opcodes such as BRA and CBRA, as this is the place where they get
      converted into the more special varieties such as BRAPOS and SBRA.
      Originally, PCRE did not allow repetition of assertions, but now it does,
      for Perl compatibility. ','line_number':7159,'multiline':True]
['text':' Repeating a DEFINE group (or any group where the condition is always
        FALSE and there is only one branch) is pointless, but Perl allows the
        syntax, so we just ignore the repeat. ','line_number':7185,'multiline':True]
['text':' Perl allows all assertions to be quantified, and when they contain
        capturing parentheses and/or are optional there are potential uses for
        this feature. PCRE2 used to force the maximum quantifier to 1 on the
        invalid grounds that further repetition was never useful. This was
        always a bit pointless, since an assertion could be wrapped with a
        repeated group to achieve the effect. General repetition is now
        permitted, but if the maximum is unlimited it is set to one more than
        the minimum. ','line_number':7193,'multiline':True]
['text':' Assertion ','line_number':7202,'multiline':True]
['text':' The case of a zero minimum is special because of the need to stick
        OP_BRAZERO in front of it, and because the group appears once in the
        data, whereas in other cases it appears the minimum number of times. For
        this reason, it is simplest to treat this case separately, as otherwise
        the code gets far too messy. There are several special subcases when the
        minimum is zero. ','line_number':7207,'multiline':True]
['text':' If the maximum is also zero, we used to just omit the group from
          the output altogether, like this:

          ** if (repeat_max == 0)
          **   {
          **   code = previous;
          **   goto END_REPEAT;
          **   }

          However, that fails when a group or a subgroup within it is
          referenced as a subroutine from elsewhere in the pattern, so now we
          stick in OP_SKIPZERO in front of it so that it is skipped on
          execution. As we don't have a list of which groups are referenced, we
          cannot do this selectively.

          If the maximum is 1 or unlimited, we just have to stick in the
          BRAZERO and do no more at this point. ','line_number':7216,'multiline':True]
['text':' Save for possessive optimizing ','line_number':7243,'multiline':True]
['text':' If the maximum is greater than 1 and limited, we have to replicate
          in a nested fashion, sticking OP_BRAZERO before each set of brackets.
          The first one has to be handled carefully because it's the original
          copy, which has to be moved up. The remainder can be handled by code
          that is common with the non-zero minimum case below. We have to
          adjust the value or repeat_max, since one less copy is required. ','line_number':7247,'multiline':True]
['text':' We chain together the bracket link offset fields that have to be
            filled in later when the ends of the brackets are reached. ','line_number':7262,'multiline':True]
['text':' If the minimum is greater than zero, replicate the group as many
        times as necessary, and adjust the maximum to the number of subsequent
        copies that we need. ','line_number':7273,'multiline':True]
['text':' In the pre-compile phase, we don't actually do the replication.
            We just adjust the length as if we had. Do some paranoid checks for
            potential integer overflow. The INT64_OR_DOUBLE type is a 64-bit
            integer type when available, otherwise double. ','line_number':7281,'multiline':True]
['text':' This is compiling for real. If there is a set first code unit
            for the group, and we have not yet set a "required code unit", set
            it. ','line_number':7300,'multiline':True]
['text':' This code is common to both the zero and non-zero minimum cases. If
        the maximum is limited, it replicates the group in a nested fashion,
        remembering the bracket starts on a stack. In the case of a zero
        minimum, the first one was set up above. In all cases the repeat_max
        now specifies the number of additional copies needed. Again, we must
        remember to replicate entries on the forward reference list. ','line_number':7322,'multiline':True]
['text':' In the pre-compile phase, we don't actually do the replication. We
          just adjust the length as if we had. For each repetition we must add
          1 to the length for BRAZERO and for all but the last repetition we
          must add 2 + 2*LINKSIZE to allow for the nesting that occurs. Do some
          paranoid checks to avoid integer overflow. The INT64_OR_DOUBLE type
          is a 64-bit integer type when available, otherwise double. ','line_number':7331,'multiline':True]
['text':' Last one doesn't nest ','line_number':7341,'multiline':True]
['text':' This is compiling for real ','line_number':7353,'multiline':True]
['text':' All but the final copy start a new nesting, maintaining the
            chain of brackets outstanding. ','line_number':7359,'multiline':True]
['text':' Now chain through the pending brackets, and fill in their length
          fields (which are holding the chain links pro tem). ','line_number':7375,'multiline':True]
['text':' If the maximum is unlimited, set a repeater in the final copy. For
        SCRIPT_RUN and ONCE brackets, that's all we need to do. However,
        possessively repeated ONCE brackets can be converted into non-capturing
        brackets, as the behaviour of (?:xx)++ is the same as (?>xx)++ and this
        saves having to deal with possessive ONCEs specially.

        Otherwise, when we are doing the actual compile phase, check to see
        whether this group is one that could match an empty string. If so,
        convert the initial operator to the S form (e.g. OP_BRA -> OP_SBRA) so
        that runtime checking can be done. [This check is also applied to ONCE
        and SCRIPT_RUN groups at runtime, but in a different way.]

        Then, if the quantifier was possessive and the bracket is not a
        conditional, we convert the BRA code to the POS form, and the KET code
        to KETRPOS. (It turns out to be convenient at runtime to detect this
        kind of subpattern at both the start and at the end.) The use of
        special opcodes makes it possible to reduce greatly the stack usage in
        pcre2_match(). If the group is preceded by OP_BRAZERO, convert this to
        OP_BRAPOSZERO.

        Then, if the minimum number of matches is 1 or 0, cancel the possessive
        flag so that the default action below, of wrapping everything inside
        atomic brackets, does not happen. When the minimum is greater than 1,
        there will be earlier copies of the group, and so we still have to wrap
        the whole thing. ','line_number':7391,'multiline':True]
['text':' Convert possessive ONCE brackets to non-capturing ','line_number':7422,'multiline':True]
['text':' For non-possessive ONCE and for SCRIPT_RUN brackets, all we need
          to do is to set the KET. ','line_number':7426,'multiline':True]
['text':' Handle non-SCRIPT_RUN and non-ONCE brackets and possessive ONCEs
          (which have been converted to non-capturing above). ','line_number':7432,'multiline':True]
['text':' In the compile phase, adjust the opcode if the group can match
            an empty string. For a conditional group with only one branch, the
            value of group_return will not show "could be empty", so we must
            check that separately. ','line_number':7437,'multiline':True]
['text':' Handle possessive quantifiers. ','line_number':7449,'multiline':True]
['text':' For COND brackets, we wrap the whole thing in a possessively
              repeated non-capturing bracket, because we have not invented POS
              versions of the COND opcodes. ','line_number':7453,'multiline':True]
['text':' For non-COND brackets, we modify the BRA code and use KETRPOS. ','line_number':7469,'multiline':True]
['text':' Switch to xxxPOS opcodes ','line_number':7473,'multiline':True]
['text':' If the minimum is zero, mark it as possessive, then unset the
              possessive flag when the minimum is 0 or 1. ','line_number':7477,'multiline':True]
['text':' Non-possessive quantifier ','line_number':7484,'multiline':True]
['text':' If previous was a character type match (\d or similar), abolish it and
      create a suitable repeat item. The code is shared with single-character
      repeats by setting op_type to add a suitable offset into repeat_type.
      Note the the Unicode property types will be present only when
      SUPPORT_UNICODE is defined, but we don't wrap the little bits of code
      here because it just makes it horribly messy. ','line_number':7492,'multiline':True]
['text':' Not a character type - internal error ','line_number':7500,'multiline':True]
['text':' Use type opcodes ','line_number':7512,'multiline':True]
['text':' Not a character ','line_number':7513,'multiline':True]
['text':' Come here from just above with a character in mcbuffer/mclength. ','line_number':7522,'multiline':True]
['text':' At this point, if prop_type == prop_value == -1 we either have a
        character in mcbuffer when mclength is greater than zero, or we have
        mclength zero, in which case there is a non-property character type in
        op_previous. If prop_type/value are not negative, we have a property
        character type in op_previous. ','line_number':7527,'multiline':True]
['text':' Save where we were ','line_number':7533,'multiline':True]
['text':' Usually overwrite previous item ','line_number':7534,'multiline':True]
['text':' If the maximum is zero then the minimum must also be zero; Perl allows
        this case, so we do too - by simply omitting the item altogether. ','line_number':7536,'multiline':True]
['text':' Combine the op_type with the repeat_type ','line_number':7541,'multiline':True]
['text':' A minimum of zero is handled either as the special case * or ?, or as
        an UPTO, with the maximum given. ','line_number':7545,'multiline':True]
['text':' A repeat minimum of 1 is optimized into some special cases. If the
        maximum is unlimited, we use OP_PLUS. Otherwise, the original item is
        left in place and, if the maximum is greater than 1, we use OP_UPTO with
        one less than the maximum. ','line_number':7559,'multiline':True]
['text':' Leave previous item in place ','line_number':7570,'multiline':True]
['text':' The case {n,n} is just an EXACT, while the general case {n,m} is
        handled as an EXACT followed by an UPTO or STAR or QUERY. ','line_number':7577,'multiline':True]
['text':' NB EXACT doesn't have repeat_type ','line_number':7582,'multiline':True]
['text':' Unless repeat_max equals repeat_min, fill in the data for EXACT,
          and then generate the second opcode. For a repeated Unicode property
          match, there are two extra values that define the required property,
          and mclength is set zero to indicate this. ','line_number':7585,'multiline':True]
['text':' Now set up the following opcode ','line_number':7607,'multiline':True]
['text':' Fill in the character or character type for the final opcode. ','line_number':7627,'multiline':True]
['text':' End of switch on different op_previous values ','line_number':7645,'multiline':True]
['text':' If the character following a repeat is '+', possessive_quantifier is
    TRUE. For some opcodes, there are special alternative opcodes for this
    case. For anything else, we wrap the entire repeated item inside OP_ONCE
    brackets. Logically, the '+' notation is just syntactic sugar, taken from
    Sun's Java package, but the special opcodes can optimize it.

    Some (but not all) possessively repeated subpatterns have already been
    completely handled in the code just above. For them, possessive_quantifier
    is always FALSE at this stage. Note that the repeated item starts at
    tempcode, not at previous, which might be the first part of a string whose
    (former) last char we repeated. ','line_number':7648,'multiline':True]
['text':' Possessifying an EXACT quantifier has no effect, so we can ignore it.
      However, QUERY, STAR, or UPTO may follow (for quantifiers such as {5,6},
      {5,}, or {5,10}). We skip over an EXACT item; if the length of what
      remains is greater than zero, there's a further opcode that can be
      handled. If not, do nothing, leaving the EXACT alone. ','line_number':7664,'multiline':True]
['text':' CHAR opcodes are used for exacts whose count is 1. ','line_number':7678,'multiline':True]
['text':' For the class opcodes, the repeat operator appears at the end;
        adjust tempcode to point to it. ','line_number':7695,'multiline':True]
['text':' If tempcode is equal to code (which points to the end of the repeated
      item), it means we have skipped an EXACT item but there is no following
      QUERY, STAR, or UPTO; the value of len will be 0, and we do nothing. In
      all other cases, tempcode will be pointing to the repeat opcode, and will
      be less than code, so the value of len will be greater than 0. ','line_number':7710,'multiline':True]
['text':' There is a table for possessifying opcodes, all of which are less
        than OP_CALLOUT. A zero entry means there is no possessified version.
        ','line_number':7721,'multiline':True]
['text':' For opcode without a special possessified version, wrap the item in
        ONCE brackets. ','line_number':7728,'multiline':True]
['text':' We set the "follows varying string" flag for subsequently encountered
    reqcus if it isn't already set and we have just passed a varying length
    item. ','line_number':7744,'multiline':True]
['text':' ===================================================================','line_number':7753,'multiline':True]
['text':' Handle a 32-bit data character with a value greater than META_END. ','line_number':7754,'multiline':True]
['text':' ===============================================================','line_number':7761,'multiline':True]
['text':' Handle a back reference by number, which is the meta argument. The
    pattern offsets for back references to group numbers less than 10 are held
    in a special vector, to avoid using more than two parsed pattern elements
    in 64-bit environments. We only need the offset to the first occurrence,
    because if that doesn't fail, subsequent ones will also be OK. ','line_number':7762,'multiline':True]
['text':' Non-existent subpattern ','line_number':7775,'multiline':True]
['text':' Come here from named backref handling when the reference is to a
    single group (that is, not to a duplicated name). The back reference
    data will have already been updated. We must disable firstcu if not
    set, to cope with cases like (?=(\w+))\1: which would otherwise set ':'
    later. ','line_number':7779,'multiline':True]
['text':' Update the map of back references, and keep the highest one. We
    could do this in parse_regex() for numerical back references, but not
    for named back references, because we don't know the numbers to which
    named back references refer. So we do it all in this function. ','line_number':7790,'multiline':True]
['text':' ===============================================================','line_number':7800,'multiline':True]
['text':' Handle recursion by inserting the number of the called group (which is
    the meta argument) after OP_RECURSE. At the end of compiling the pattern is
    scanned and these numbers are replaced by offsets within the pattern. It is
    done like this to avoid problems with forward references and adjusting
    offsets when groups are duplicated and moved (as discovered in previous
    implementations). Note that a recursion does not have a set first
    character. ','line_number':7801,'multiline':True]
['text':' Non-existent subpattern ','line_number':7814,'multiline':True]
['text':' ===============================================================','line_number':7829,'multiline':True]
['text':' Handle capturing parentheses; the number is the meta argument. ','line_number':7830,'multiline':True]
['text':' ===============================================================','line_number':7840,'multiline':True]
['text':' Handle escape sequence items. For ones like \d, the ESC_values are
    arranged to be the same as the corresponding OP_values in the default case
    when PCRE2_UCP is not set (which is the only case in which they will appear
    here).

    Note: \Q and \E are never seen here, as they were dealt with in
    parse_pattern(). Neither are numerical back references or recursions, which
    were turned into META_BACKREF or META_RECURSE items, respectively. \k and
    \g, when followed by names, are turned into META_BACKREF_BYNAME or
    META_RECURSE_BYNAME. ','line_number':7841,'multiline':True]
['text':' We can test for escape sequences that consume a character because their
    values lie between ESC_b and ESC_Z; this may have to change if any new ones
    are ever created. For these sequences, we disable the setting of a first
    character if it hasn't already been set. ','line_number':7854,'multiline':True]
['text':' Set values to reset to if this is followed by a zero repeat. ','line_number':7865,'multiline':True]
['text':' If Unicode is not supported, \P and \p are not allowed and are
    faulted at parse time, so will never appear here. ','line_number':7872,'multiline':True]
['text':' The special case of \p{Any} is compiled to OP_ALLANY so as to benefit
      from the auto-anchoring code. ','line_number':7881,'multiline':True]
['text':' End META_ESCAPE ','line_number':7894,'multiline':True]
['text':' \K is forbidden in lookarounds since 10.38 because that's what Perl has
    done. However, there's an option, in case anyone was relying on it. ','line_number':7898,'multiline':True]
['text':' For the rest (including \X when Unicode is supported - if not it's
    faulted at parse time), the OP value is the escape value when PCRE2_UCP is
    not set; if it is set, these escapes do not show up here because they are
    converted into Unicode property tests in parse_regex(). Note that \b and \B
    do a one-character lookbehind, and \A also behaves as if it does. ','line_number':7908,'multiline':True]
['text':' Record ','line_number':7914,'multiline':True]
['text':' In non-UTF mode, and for both 32-bit modes, we turn \C into OP_ALLANY
    instead of OP_ANYBYTE so that it works in DFA mode and in lookbehinds. ','line_number':7919,'multiline':True]
['text':' End META_ESCAPE ','line_number':7927,'multiline':True]
['text':' ===================================================================','line_number':7930,'multiline':True]
['text':' Handle an unrecognized meta value. A parsed pattern value less than
    META_END is a literal. Otherwise we have a problem. ','line_number':7931,'multiline':True]
['text':' Internal error - unrecognized. ','line_number':7940,'multiline':True]
['text':' Handle a literal character. We come here by goto in the case of a
    32-bit, non-UTF character whose value is greater than META_END. ','line_number':7944,'multiline':True]
['text':' Get the full 32 bits ','line_number':7948,'multiline':True]
['text':' Character is already in meta ','line_number':7949,'multiline':True]
['text':' For caseless UTF or UCP mode, check whether this character has more than
    one other case. If so, generate a special OP_PROP item instead of OP_CHARI.
    ','line_number':7952,'multiline':True]
['text':' End handling this meta item ','line_number':7967,'multiline':True]
['text':' Caseful matches, or caseless and not one of the multicase characters. We
    come here by goto in the case of a positive class that contains only
    case-partners of a character with just two cases; matched_char has already
    been set TRUE and options fudged if necessary. ','line_number':7972,'multiline':True]
['text':' Get the character's code units into mcbuffer, with the length in
    mclength. When not in UTF mode, the length is always 1. ','line_number':7979,'multiline':True]
['text':' Generate the appropriate code ','line_number':7990,'multiline':True]
['text':' Remember if \r or \n were seen ','line_number':7996,'multiline':True]
['text':' Set the first and required code units appropriately. If no previous
    first code unit, set it from this character, but revert to none on a zero
    repeat. Otherwise, leave the firstcu value alone, and don't change it on
    a zero repeat. ','line_number':8001,'multiline':True]
['text':' If the character is more than one code unit long, we can set a single
      firstcu only if it is not to be matched caselessly. Multiple possible
      starting code units may be picked up later in the studying code. ','line_number':8012,'multiline':True]
['text':' firstcu was previously set; we can set reqcu only if the length is
    1 or the matching is caseful. ','line_number':8029,'multiline':True]
['text':' If caselessness was temporarily instated, reset it. ','line_number':8045,'multiline':True]
['text':' End literal character handling ','line_number':8054,'multiline':True]
['text':' End of big switch ','line_number':8055,'multiline':True]
['text':' End of big loop ','line_number':8056,'multiline':True]
['text':' Control never reaches here. ','line_number':8058,'multiline':True]
['text':'************************************************
*   Compile regex: a sequence of alternatives    *
************************************************','line_number':8063,'multiline':True]
['text':' On entry, pptr is pointing past the bracket meta, but on return it points to
the closing bracket or META_END. The code variable is pointing at the code unit
into which the BRA operator has been stored. This function is used during the
pre-compile phase when we are trying to find out the amount of memory needed,
as well as during the real compile phase. The value of lengthptr distinguishes
the two phases.

Arguments:
  options           option bits, including any changes for this subpattern
  codeptr           -> the address of the current code pointer
  pptrptr           -> the address of the current parsed pattern pointer
  errorcodeptr      -> pointer to error code variable
  skipunits         skip this many code units at start (for brackets and OP_COND)
  firstcuptr        place to put the first required code unit
  firstcuflagsptr   place to put the first code unit flags
  reqcuptr          place to put the last required code unit
  reqcuflagsptr     place to put the last required code unit flags
  bcptr             pointer to the chain of currently open branches
  cb                points to the data block with tables pointers etc.
  lengthptr         NULL during the real compile phase
                    points to length accumulator during pre-compile phase

Returns:            0 There has been an error
                   +1 Success, this group must match at least one character
                   -1 Success, this group may match an empty string
','line_number':8067,'multiline':True]
['text':' If set, call the external function that checks for stack availability. ','line_number':8116,'multiline':True]
['text':' Miscellaneous initialization ','line_number':8125,'multiline':True]
['text':' Accumulate the length for use in the pre-compile phase. Start with the
length of the BRA and KET and any extra code units that are required at the
beginning. We accumulate in a local variable to save frequent testing of
lengthptr for NULL. We cannot do this by looking at the value of 'code' at the
start and end of each alternative, because compiled items are discarded during
the pre-compile phase so that the workspace is not exceeded. ','line_number':8133,'multiline':True]
['text':' Remember if this is a lookbehind assertion, and if it is, save its length
and skip over the pattern offset. ','line_number':8142,'multiline':True]
['text':' If this is a capturing subpattern, add to the chain of open capturing items
so that we can detect them if (*ACCEPT) is encountered. Note that only OP_CBRA
need be tested here; changing this opcode to one of its variants, e.g.
OP_SCBRAPOS, happens later, after the group has been compiled. ','line_number':8156,'multiline':True]
['text':' Offset is set zero to mark that this bracket is still open ','line_number':8170,'multiline':True]
['text':' Loop for each alternative branch ','line_number':8175,'multiline':True]
['text':' Insert OP_REVERSE if this is as lookbehind assertion. ','line_number':8181,'multiline':True]
['text':' Now compile the branch; in the pre-compile phase its length gets added
  into the length. ','line_number':8190,'multiline':True]
['text':' If a branch can match an empty string, so can the whole group. ','line_number':8199,'multiline':True]
['text':' In the real compile phase, there is some post-processing to be done. ','line_number':8203,'multiline':True]
['text':' If this is the first branch, the firstcu and reqcu values for the
    branch become the values for the regex. ','line_number':8207,'multiline':True]
['text':' If this is not the first branch, the first char and reqcu have to
    match the values from all the previous branches, except that if the
    previous value for reqcu didn't have REQ_VARY set, it can still match,
    and we set REQ_VARY for the group from this branch's value. ','line_number':8218,'multiline':True]
['text':' If we previously had a firstcu, but it doesn't match the new branch,
      we have to abandon the firstcu for the regex, but if there was
      previously no reqcu, it takes on the value of the old firstcu. ','line_number':8225,'multiline':True]
['text':' If we (now or from before) have no firstcu, a firstcu from the
      branch becomes a reqcu if there isn't a branch reqcu. ','line_number':8242,'multiline':True]
['text':' Now ensure that the reqcus match ','line_number':8252,'multiline':True]
['text':' To "or" REQ_VARY if present ','line_number':8260,'multiline':True]
['text':' Handle reaching the end of the expression, either ')' or end of pattern.
  In the real compile phase, go back through the alternative branches and
  reverse the chain of offsets, with the field in the BRA item now becoming an
  offset to the first alternative. If there are no alternatives, it points to
  the end of the group. The length in the terminating ket is always the length
  of the whole bracketed item. Return leaving the pointer at the terminating
  char. ','line_number':8265,'multiline':True]
['text':' Fill in the ket ','line_number':8288,'multiline':True]
['text':' If it was a capturing subpattern, remove the block from the chain. ','line_number':8294,'multiline':True]
['text':' Set values to pass back ','line_number':8298,'multiline':True]
['text':' Another branch follows. In the pre-compile phase, we can move the code
  pointer back to where it was for the start of the first branch. (That is,
  pretend that each branch is the only one.)

  In the real compile phase, insert an ALT node. Its length field points back
  to the previous branch while the bracket remains open. At the end the chain
  is reversed. It's done like this so that the start of the bracket has a
  zero offset until it is closed, making it possible to detect recursion. ','line_number':8318,'multiline':True]
['text':' Set the lookbehind length (if not in a lookbehind the value will be zero)
  and then advance past the vertical bar. ','line_number':8340,'multiline':True]
['text':' Control never reaches here ','line_number':8346,'multiline':True]
['text':'************************************************
*          Check for anchored pattern            *
************************************************','line_number':8351,'multiline':True]
['text':' Try to find out if this is an anchored regular expression. Consider each
alternative branch. If they all start with OP_SOD or OP_CIRC, or with a bracket
all of whose alternatives start with OP_SOD or OP_CIRC (recurse ad lib), then
it's anchored. However, if this is a multiline pattern, then only OP_SOD will
be found, because ^ generates OP_CIRCM in that mode.

We can also consider a regex to be anchored if OP_SOM starts all its branches.
This is the code for \G, which means "match at start of match position, taking
into account the match offset".

A branch is also implicitly anchored if it starts with .* and DOTALL is set,
because that will try the rest of the pattern at all possible matching points,
so there is no point trying again.... er ....

.... except when the .* appears inside capturing parentheses, and there is a
subsequent back reference to those parentheses. We haven't enough information
to catch that case precisely.

At first, the best we could do was to detect when .* was in capturing brackets
and the highest back reference was greater than or equal to that level.
However, by keeping a bitmap of the first 31 back references, we can catch some
of the more common cases more precisely.

... A second exception is when the .* appears inside an atomic group, because
this prevents the number of characters it matches from being adjusted.

Arguments:
  code           points to start of the compiled pattern
  bracket_map    a bitmap of which brackets we are inside while testing; this
                   handles up to substring 31; after that we just have to take
                   the less precise approach
  cb             points to the compile data block
  atomcount      atomic group level
  inassert       TRUE if in an assertion

Returns:     TRUE or FALSE
','line_number':8355,'multiline':True]
['text':' Non-capturing brackets ','line_number':8402,'multiline':True]
['text':' Capturing brackets ','line_number':8411,'multiline':True]
['text':' Positive forward assertion ','line_number':8421,'multiline':True]
['text':' Condition. If there is no second branch, it can't be anchored. ','line_number':8428,'multiline':True]
['text':' Atomic groups ','line_number':8437,'multiline':True]
['text':' .* is not anchored unless DOTALL is set (which generates OP_ALLANY) and
   it isn't in brackets that are or may be referenced or inside an atomic
   group or an assertion. Also the pattern must not contain *PRUNE or *SKIP,
   because these break the feature. Consider, for example, /(?s).*?(*PRUNE)b/
   with the subject "aab", which matches "b", i.e. not at the start of a line.
   There is also an option that disables auto-anchoring. ','line_number':8445,'multiline':True]
['text':' Check for explicit anchoring ','line_number':8461,'multiline':True]
['text':' Loop for each alternative ','line_number':8467,'multiline':True]
['text':'************************************************
*         Check for starting with ^ or .*        *
************************************************','line_number':8473,'multiline':True]
['text':' This is called to find out if every branch starts with ^ or .* so that
"first char" processing can be done to speed things up in multiline
matching and for non-DOTALL patterns that start with .* (which must start at
the beginning or after \n). As in the case of is_anchored() (see above), we
have to take account of back references to capturing brackets that contain .*
because in that case we can't make the assumption. Also, the appearance of .*
inside atomic brackets or in an assertion, or in a pattern that contains *PRUNE
or *SKIP does not count, because once again the assumption no longer holds.

Arguments:
  code           points to start of the compiled pattern or a group
  bracket_map    a bitmap of which brackets we are inside while testing; this
                   handles up to substring 31; after that we just have to take
                   the less precise approach
  cb             points to the compile data
  atomcount      atomic group level
  inassert       TRUE if in an assertion

Returns:         TRUE or FALSE
','line_number':8477,'multiline':True]
['text':' If we are at the start of a conditional assertion group, *both* the
   conditional assertion *and* what follows the condition must satisfy the test
   for start of line. Other kinds of condition fail. Note that there may be an
   auto-callout at the start of a condition. ','line_number':8507,'multiline':True]
['text':' Assertion ','line_number':8530,'multiline':True]
['text':' Non-capturing brackets ','line_number':8540,'multiline':True]
['text':' Capturing brackets ','line_number':8549,'multiline':True]
['text':' Positive forward assertions ','line_number':8559,'multiline':True]
['text':' Atomic brackets ','line_number':8567,'multiline':True]
['text':' .* means "start at start or after \n" if it isn't in atomic brackets or
   brackets that may be referenced or an assertion, and as long as the pattern
   does not contain *PRUNE or *SKIP, because these break the feature. Consider,
   for example, /.*?a(*PRUNE)b/ with the subject "aab", which matches "ab",
   i.e. not at the start of a line. There is also an option that disables this
   optimization. ','line_number':8575,'multiline':True]
['text':' Check for explicit circumflex; anything else gives a FALSE result. Note
   in particular that this includes atomic brackets OP_ONCE because the number
   of characters matched by .* cannot be adjusted inside them. ','line_number':8590,'multiline':True]
['text':' Move on to the next alternative ','line_number':8596,'multiline':True]
['text':' Loop for each alternative ','line_number':8600,'multiline':True]
['text':'************************************************
*   Scan compiled regex for recursion reference  *
************************************************','line_number':8606,'multiline':True]
['text':' This function scans through a compiled pattern until it finds an instance of
OP_RECURSE.

Arguments:
  code        points to start of expression
  utf         TRUE in UTF mode

Returns:      pointer to the opcode for OP_RECURSE, or NULL if not found
','line_number':8610,'multiline':True]
['text':' XCLASS is used for classes that cannot be represented just by a bit map.
  This includes negated single high-valued characters. CALLOUT_STR is used for
  callouts with string arguments. In both cases the length in the table is
  zero; the actual length is stored in the compiled code. ','line_number':8629,'multiline':True]
['text':' Otherwise, we can get the item's length from the table, except that for
  repeated character types, we have to test for \p and \P, which have an extra
  two code units of parameters, and for MARK/PRUNE/SKIP/THEN with an argument,
  we must add in its length. ','line_number':8637,'multiline':True]
['text':' Add in the fixed length from the table ','line_number':8675,'multiline':True]
['text':' In UTF-8 and UTF-16 modes, opcodes that are followed by a character may
    be followed by a multi-unit character. The length in the table is a
    minimum, so we have to arrange to skip the extra units. ','line_number':8679,'multiline':True]
['text':' Keep compiler happy by referencing function argument ','line_number':8746,'multiline':True]
['text':' MAYBE_UTF_MULTI ','line_number':8747,'multiline':True]
['text':'************************************************
*    Check for asserted fixed first code unit    *
************************************************','line_number':8754,'multiline':True]
['text':' During compilation, the "first code unit" settings from forward assertions
are discarded, because they can cause conflicts with actual literals that
follow. However, if we end up without a first code unit setting for an
unanchored pattern, it is worth scanning the regex to see if there is an
initial asserted first code unit. If all branches start with the same asserted
code unit, or with a non-conditional bracket all of whose alternatives start
with the same asserted code unit (recurse ad lib), then we return that code
unit, with the flags set to zero or REQ_CASELESS; otherwise return zero with
REQ_NONE in the flags.

Arguments:
  code       points to start of compiled pattern
  flags      points to the first code unit flags
  inassert   non-zero if in an assertion

Returns:     the fixed first code unit, or 0 with REQ_NONE in flags
','line_number':8758,'multiline':True]
['text':' Fall through ','line_number':8815,'multiline':True]
['text':' Fall through ','line_number':8828,'multiline':True]
['text':' If the character is more than one code unit long, we cannot set its
     first code unit when matching caselessly. Later scanning may pick up
     multiple code units. ','line_number':8836,'multiline':True]
['text':'************************************************
*     Add an entry to the name/number table      *
************************************************','line_number':8863,'multiline':True]
['text':' This function is called between compiling passes to add an entry to the
name/number table, maintaining alphabetical order. Checking for permitted
and forbidden duplicates has already been done.

Arguments:
  cb           the compile data block
  name         the name to add
  length       the length of the name
  groupno      the group number
  tablecount   the count of names in the table so far

Returns:       nothing
','line_number':8867,'multiline':True]
['text':' Current name is a substring ','line_number':8892,'multiline':True]
['text':' Make space in the table and break the loop for an earlier name. For a
  duplicate or later name, carry on. We do this for duplicates so that in the
  simple case (when ?(| is not used) they are in order of their numbers. In all
  cases they are in the order in which they appear in the pattern. ','line_number':8894,'multiline':True]
['text':' Continue the loop for a later or duplicate name ','line_number':8906,'multiline':True]
['text':' Add a terminating zero and fill the rest of the slot with zeroes so that
the memory is all initialized. Otherwise valgrind moans about uninitialized
memory when saving serialized compiled patterns. ','line_number':8914,'multiline':True]
['text':'************************************************
*             Skip in parsed pattern             *
************************************************','line_number':8924,'multiline':True]
['text':' This function is called to skip parts of the parsed pattern when finding the
length of a lookbehind branch. It is called after (*ACCEPT) and (*FAIL) to find
the end of the branch, it is called to skip over an internal lookaround or
(DEFINE) group, and it is also called to skip to the end of a class, during
which it will never encounter nested groups (but there's no need to have
special code for that).

When called to find the end of a branch or group, pptr must point to the first
meta code inside the branch, not the branch-starting code. In other cases it
can point to the item that causes the function to be called.

Arguments:
  pptr       current pointer to skip from
  skiptype   PSKIP_CLASS when skipping to end of class
             PSKIP_ALT when META_ALT ends the skip
             PSKIP_KET when only META_KET ends the skip

Returns:     new value of pptr
             NULL if META_END is reached - should never occur
               or for an unknown meta value - likewise
','line_number':8928,'multiline':True]
['text':' Just skip over most items ','line_number':8961,'multiline':True]
['text':' Literal ','line_number':8962,'multiline':True]
['text':' This should never occur. ','line_number':8965,'multiline':True]
['text':' The data for these items is variable in length. ','line_number':8970,'multiline':True]
['text':' Offset is present only if group >= 10 ','line_number':8972,'multiline':True]
['text':' A few escapes are followed by data items. ','line_number':8976,'multiline':True]
['text':' Add the length of the name. ','line_number':8991,'multiline':True]
['text':' These are the "active" items in this loop. ','line_number':8999,'multiline':True]
['text':' The extra data item length for each meta is in a table. ','line_number':9035,'multiline':True]
['text':' Control never reaches here ','line_number':9041,'multiline':True]
['text':'************************************************
*       Find length of a parsed group            *
************************************************','line_number':9047,'multiline':True]
['text':' This is called for nested groups within a branch of a lookbehind whose
length is being computed. If all the branches in the nested group have the same
length, that is OK. On entry, the pointer must be at the first element after
the group initializing code. On exit it points to OP_KET. Caching is used to
improve processing speed when the same capturing group occurs many times.

Arguments:
  pptrptr     pointer to pointer in the parsed pattern
  isinline    FALSE if a reference or recursion; TRUE for inline group
  errcodeptr  pointer to the errorcode
  lcptr       pointer to the loop counter
  group       number of captured group or -1 for a non-capturing group
  recurses    chain of recurse_check to catch mutual recursion
  cb          pointer to the compile data

Returns:      the group length or a negative number
','line_number':9051,'multiline':True]
['text':' The cache can be used only if there is no possibility of there being two
groups with the same number. We do not need to set the end pointer for a group
that is being processed as a back reference or recursion, but we must do so for
an inline group. ','line_number':9076,'multiline':True]
['text':' Scan the group. In this case we find the end pointer of necessity. ','line_number':9092,'multiline':True]
['text':' Skip META_ALT ','line_number':9101,'multiline':True]
['text':'************************************************
*        Find length of a parsed branch          *
************************************************','line_number':9115,'multiline':True]
['text':' Return a fixed length for a branch in a lookbehind, giving an error if the
length is not fixed. On entry, *pptrptr points to the first element inside the
branch. On exit it is set to point to the ALT or KET.

Arguments:
  pptrptr     pointer to pointer in the parsed pattern
  errcodeptr  pointer to error code
  lcptr       pointer to loop counter
  recurses    chain of recurse_check to catch mutual recursion
  cb          pointer to compile block

Returns:      the length, or a negative value on error
','line_number':9119,'multiline':True]
['text':' A large and/or complex regex can take too long to process. This can happen
more often when (?| groups are present in the pattern because their length
cannot be cached. ','line_number':9144,'multiline':True]
['text':' Lookbehind is too complicated ','line_number':9150,'multiline':True]
['text':' Scan the branch, accumulating the length. ','line_number':9154,'multiline':True]
['text':' (*ACCEPT) and (*FAIL) terminate the branch, but we must skip to the
    actual termination. ','line_number':9175,'multiline':True]
['text':' Only some escapes consume a character. Of those, \R and \X are never
    allowed because they might match more than character. \C is allowed only in
    32-bit and non-UTF 8/16-bit modes. ','line_number':9229,'multiline':True]
['text':' Skip prop data ','line_number':9246,'multiline':True]
['text':' Lookaheads do not contribute to the length of this branch, but they may
    contain lookbehinds within them whose lengths need to be set. ','line_number':9250,'multiline':True]
['text':' Ignore any qualifiers that follow a lookahead assertion. ','line_number':9259,'multiline':True]
['text':' A nested lookbehind does not contribute any length to this lookbehind,
    but must itself be checked and have its lengths set. ','line_number':9286,'multiline':True]
['text':' Back references and recursions are handled by very similar code. At this
    stage, the names generated in the parsing pass are available, but the main
    name table has not yet been created. So for the named varieties, scan the
    list of names in order to get the number of the first one in the pattern,
    and whether or not this name is duplicated. ','line_number':9296,'multiline':True]
['text':' Fall through ','line_number':9305,'multiline':True]
['text':' Non-existent subpattern ','line_number':9330,'multiline':True]
['text':' A numerical back reference can be fixed length if duplicate capturing
      groups are not being used. A non-duplicate named back reference can also
      be handled. ','line_number':9335,'multiline':True]
['text':' Handle as a numbered version. ','line_number':9341,'multiline':True]
['text':' Duplicate name or number ','line_number':9343,'multiline':True]
['text':' The offset values for back references < 10 are in a separate vector
    because otherwise they would use more than two parsed pattern elements on
    64-bit systems. ','line_number':9345,'multiline':True]
['text':' Fall through ','line_number':9360,'multiline':True]
['text':' For groups >= 10 - picking up group twice does no harm. ','line_number':9361,'multiline':True]
['text':' A true recursion implies not fixed length, but a subroutine call may
    be OK. Back reference "recursions" are also failed. ','line_number':9363,'multiline':True]
['text':' Non-existent subpattern ','line_number':9374,'multiline':True]
['text':' Local recursion ','line_number':9377,'multiline':True]
['text':' We must start the search for the end of the group at the first meta code
    inside the group. Otherwise it will be treated as an enclosed group. ','line_number':9384,'multiline':True]
['text':' Local recursion ','line_number':9389,'multiline':True]
['text':' Mutual recursion ','line_number':9391,'multiline':True]
['text':' We do not need to know the position of the end of the group, that is,
    gptr is not used after the call to get_grouplength(). Setting the second
    argument FALSE stops it scanning for the end when the length can be found
    in the cache. ','line_number':9395,'multiline':True]
['text':' Error already set ','line_number':9406,'multiline':True]
['text':' A (DEFINE) group is never obeyed inline and so it does not contribute to
    the length of this branch. Skip from the following item to the next
    unpaired ket. ','line_number':9411,'multiline':True]
['text':' Check other nested groups - advance past the initial data for each type
    and then seek a fixed length with get_grouplength(). ','line_number':9419,'multiline':True]
['text':' Fall through ','line_number':9439,'multiline':True]
['text':' Exact repetition is OK; variable repetition is not. A repetition of zero
    must subtract the length that has already been added. ','line_number':9452,'multiline':True]
['text':' Check for integer overflow ','line_number':9470,'multiline':True]
['text':' Should not occur, but just in case ','line_number':9471,'multiline':True]
['text':' Integer overflow; lookbehind too big ','line_number':9474,'multiline':True]
['text':' Fall through ','line_number':9483,'multiline':True]
['text':' Any other item means this branch does not have a fixed length. ','line_number':9485,'multiline':True]
['text':' Not fixed length ','line_number':9489,'multiline':True]
['text':' Add the item length to the branchlength, checking for integer overflow and
  for the branch length exceeding the limit. ','line_number':9493,'multiline':True]
['text':' Save this item length for use if the next item is a quantifier. ','line_number':9503,'multiline':True]
['text':'************************************************
*        Set lengths in a lookbehind             *
************************************************','line_number':9519,'multiline':True]
['text':' This function is called for each lookbehind, to set the lengths in its
branches. An error occurs if any branch does not have a fixed length that is
less than the maximum (65535). On exit, the pointer must be left on the final
ket.

The function also maintains the max_lookbehind value. Any lookbehind branch
that contains a nested lookbehind may actually look further back than the
length of the branch. The additional amount is passed back from
get_branchlength() as an "extra" value.

Arguments:
  pptrptr     pointer to pointer in the parsed pattern
  errcodeptr  pointer to error code
  lcptr       pointer to loop counter
  recurses    chain of recurse_check to catch mutual recursion
  cb          pointer to compile block

Returns:      TRUE if all is well
              FALSE otherwise, with error code and offset set
','line_number':9523,'multiline':True]
['text':' Offset for error messages ','line_number':9552,'multiline':True]
['text':' The errorcode and offset may already be set from a nested lookbehind. ','line_number':9561,'multiline':True]
['text':' branchlength never more than 65535 ','line_number':9567,'multiline':True]
['text':'************************************************
*         Check parsed pattern lookbehinds       *
************************************************','line_number':9577,'multiline':True]
['text':' This function is called at the end of parsing a pattern if any lookbehinds
were encountered. It scans the parsed pattern for them, calling
set_lookbehind_lengths() for each one. At the start, the errorcode is zero and
the error offset is marked unset. The enables the functions above not to
override settings from deeper nestings.

This function is called recursively from get_branchlength() for lookaheads in
order to process any lookbehinds that they may contain. It stops when it hits a
non-nested closing parenthesis in this case, returning a pointer to it.

Arguments
  pptr      points to where to start (start of pattern or start of lookahead)
  retptr    if not NULL, return the ket pointer here
  recurses  chain of recurse_check to catch mutual recursion
  cb        points to the compile block
  lcptr     points to loop counter

Returns:    0 on success, or an errorcode (cb->erroroffset will be set)
','line_number':9581,'multiline':True]
['text':' Literal ','line_number':9612,'multiline':True]
['text':' Unrecognized meta code ','line_number':9617,'multiline':True]
['text':'************************************************
*     External function to compile a pattern     *
************************************************','line_number':9742,'multiline':True]
['text':' This function reads a regular expression in the form of a string and returns
a pointer to a block of store holding a compiled version of the expression.

Arguments:
  pattern       the regular expression
  patlen        the length of the pattern, or PCRE2_ZERO_TERMINATED
  options       option bits
  errorptr      pointer to errorcode
  erroroffset   pointer to error offset
  ccontext      points to a compile context or is NULL

Returns:        pointer to compiled data block, or NULL on error,
                with errorcode and erroroffset set
','line_number':9746,'multiline':True]
['text':' Set TRUE for UTF mode ','line_number':9765,'multiline':True]
['text':' Set TRUE for UCP mode ','line_number':9766,'multiline':True]
['text':' Set TRUE if a lookbehind is found ','line_number':9767,'multiline':True]
['text':' Set TRUE for zero-terminated pattern ','line_number':9768,'multiline':True]
['text':' What we will return ','line_number':9769,'multiline':True]
['text':' "Static" compile-time data ','line_number':9770,'multiline':True]
['text':' Char tables base pointer ','line_number':9771,'multiline':True]
['text':' Current pointer in compiled code ','line_number':9773,'multiline':True]
['text':' Start of compiled code ','line_number':9774,'multiline':True]
['text':' Current pointer in pattern ','line_number':9775,'multiline':True]
['text':' Current pointer in parsed pattern ','line_number':9776,'multiline':True]
['text':' Allow for final END opcode ','line_number':9778,'multiline':True]
['text':' Actual length used ','line_number':9779,'multiline':True]
['text':' Size of memory block ','line_number':9780,'multiline':True]
['text':' 32-bit literals >= 0x80000000 ','line_number':9781,'multiline':True]
['text':' Needed for parsed pattern ','line_number':9782,'multiline':True]
['text':' Type of first/req code unit ','line_number':9784,'multiline':True]
['text':' Value of first/req code unit ','line_number':9785,'multiline':True]
['text':' NL and BSR set flags ','line_number':9786,'multiline':True]
['text':' When checking (*UTF) etc ','line_number':9788,'multiline':True]
['text':' Unset match limits ','line_number':9790,'multiline':True]
['text':' Unset; can be set by the pattern ','line_number':9793,'multiline':True]
['text':' Unset; can be set by the pattern ','line_number':9794,'multiline':True]
['text':' Initialize to avoid compiler warn ','line_number':9795,'multiline':True]
['text':' Return from compile ','line_number':9796,'multiline':True]
['text':' Local loop counter ','line_number':9798,'multiline':True]
['text':' Comments at the head of this file explain about these variables. ','line_number':9800,'multiline':True]
['text':' The workspace is used in different ways in the different compiling phases.
It needs to be 16-bit aligned for the preliminary parsing scan. ','line_number':9806,'multiline':True]
['text':' -------------- Check arguments and set up the pattern ----------------- ','line_number':9813,'multiline':True]
['text':' There must be error code and offset pointers. ','line_number':9815,'multiline':True]
['text':' There must be a pattern! ','line_number':9821,'multiline':True]
['text':' A NULL compile context means "use a default context" ','line_number':9829,'multiline':True]
['text':' PCRE2_MATCH_INVALID_UTF implies UTF ','line_number':9834,'multiline':True]
['text':' Check that all undefined public option bits are zero. ','line_number':9838,'multiline':True]
['text':' A zero-terminated pattern is indicated by the special length value
PCRE2_ZERO_TERMINATED. Check for an overlong pattern. ','line_number':9855,'multiline':True]
['text':' From here on, all returns from this function should end up going via the
EXIT label. ','line_number':9867,'multiline':True]
['text':' ------------ Initialize the "static" compile data -------------- ','line_number':9871,'multiline':True]
['text':' Individual ','line_number':9875,'multiline':True]
['text':'   character ','line_number':9876,'multiline':True]
['text':'      tables ','line_number':9877,'multiline':True]
['text':' Maximum back reference and backref bitmap. The bitmap records up to 31 back
references to help in deciding whether (.*) can be treated as anchored or not.
','line_number':9906,'multiline':True]
['text':' Escape sequences \1 to \9 are always back references, but as they are only
two characters long, only two elements can be used in the parsed_pattern
vector. The first contains the reference, and we'd like to use the second to
record the offset in the pattern, so that forward references to non-existent
groups can be diagnosed later with an offset. However, on 64-bit systems,
PCRE2_SIZE won't fit. Instead, we have a vector of offsets for the first
occurrence of \1 to \9, indexed by the second parsed_pattern value. All other
references have enough space for the offset to be put into the parsed pattern.
','line_number':9913,'multiline':True]
['text':' --------------- Start looking at the pattern --------------- ','line_number':9926,'multiline':True]
['text':' Unless PCRE2_LITERAL is set, check for global one-time option settings at
the start of the pattern, and remember the offset to the actual regex. With
valgrind support, make the terminator of a zero-terminated pattern
inaccessible. This catches bugs that would otherwise only show up for
non-zero-terminated patterns. ','line_number':9928,'multiline':True]
['text':' Integer overflow ','line_number':9990,'multiline':True]
['text':' Out of the table scan loop ','line_number':10005,'multiline':True]
['text':' Out of pso loop ','line_number':10008,'multiline':True]
['text':' End of pattern-start options; advance to start of real regex. ','line_number':10012,'multiline':True]
['text':' Can't support UTF or UCP if PCRE2 was built without Unicode support. ','line_number':10016,'multiline':True]
['text':' Check UTF. We have the original options in 'options', with that value as
modified by (*UTF) etc in cb->external_options. The extra option
PCRE2_EXTRA_ALLOW_SURROGATE_ESCAPES is not permitted in UTF-16 mode because the
surrogate code points cannot be represented in UTF-16. ','line_number':10026,'multiline':True]
['text':' Offset was set by valid_utf() ','line_number':10041,'multiline':True]
['text':' Check UCP lockout. ','line_number':10052,'multiline':True]
['text':' Process the BSR setting. ','line_number':10061,'multiline':True]
['text':' Process the newline setting. ','line_number':10065,'multiline':True]
['text':' Pre-scan the pattern to do two things: (1) Discover the named groups and
their numerical equivalents, so that this information is always available for
the remaining processing. (2) At the same time, parse the pattern and put a
processed version into the parsed_pattern vector. This has escapes interpreted
and comments removed (amongst other things).

In all but one case, when PCRE2_AUTO_CALLOUT is not set, the number of unsigned
32-bit ints in the parsed pattern is bounded by the length of the pattern plus
one (for the terminator) plus four if PCRE2_EXTRA_WORD or PCRE2_EXTRA_LINE is
set. The exceptional case is when running in 32-bit, non-UTF mode, when literal
characters greater than META_END (0x80000000) have to be coded as two units. In
this case, therefore, we scan the pattern to check for such values. ','line_number':10105,'multiline':True]
['text':' Ensure that the parsed pattern buffer is big enough. When PCRE2_AUTO_CALLOUT
is set we have to assume a numerical callout (4 elements) for each character
plus one at the end. This is overkill, but memory is plentiful these days. For
many smaller patterns the vector on the stack (which was set up above) can be
used. ','line_number':10126,'multiline':True]
['text':' Do the parsing scan. ','line_number':10154,'multiline':True]
['text':' Workspace is needed to remember information about numbered groups: whether a
group can match an empty string and what its fixed length is. This is done to
avoid the possibility of recursive references causing very long compile times
when checking these features. Unnumbered groups do not have this exposure since
they cannot be referenced. We use an indexed vector for this purpose. If there
are sufficiently few groups, the default vector on the stack, as set up above,
can be used. Otherwise we have to get/free a special vector. The vector must be
initialized to zero. ','line_number':10159,'multiline':True]
['text':' If there were any lookbehinds, scan the parsed pattern to figure out their
lengths. ','line_number':10181,'multiline':True]
['text':' For debugging, there is a function that shows the parsed data vector. ','line_number':10191,'multiline':True]
['text':' For debugging capturing information this code can be enabled. ','line_number':10198,'multiline':True]
['text':' Pretend to compile the pattern while actually just accumulating the amount
of memory required in the 'length' variable. This behaviour is triggered by
passing a non-NULL final argument to compile_regex(). We pass a block of
workspace (cworkspace) for it to compile parts of the pattern into; the
compiled code is discarded when it is no longer needed, so hopefully this
workspace will never overflow, though there is a test for its doing so.

On error, errorcode will be set non-zero, so we don't need to look at the
result of the function. The initial options have been put into the cb block,
but we still have to pass a separate options variable (the first argument)
because the options may change as the pattern is processed. ','line_number':10211,'multiline':True]
['text':' For any subsequent errors that do not set it ','line_number':10223,'multiline':True]
['text':' Offset is in cb.erroroffset ','line_number':10231,'multiline':True]
['text':' This should be caught in compile_regex(), but just in case... ','line_number':10233,'multiline':True]
['text':' Compute the size of, and then get and initialize, the data block for storing
the compiled pattern and names table. Integer overflow should no longer be
possible because nowadays we limit the maximum value of cb.names_found and
cb.name_entry_size. ','line_number':10241,'multiline':True]
['text':' The compiler may put padding at the end of the pcre2_real_code structure in
order to round it up to a multiple of 4 or 8 bytes. This means that when a
compiled pattern is copied (for example, when serialized) undefined bytes are
read, and this annoys debuggers such as valgrind. To avoid this, we explicitly
write to the last 8 bytes of the structure before setting the fields. ','line_number':10257,'multiline':True]
['text':' The basic block is immediately followed by the name table, and the compiled
code follows after that. ','line_number':10288,'multiline':True]
['text':' Update the compile data block for the actual compile. The starting points of
the name/number translation table and of the code are passed around in the
compile data block. The start/end pattern and initial options are already set
from the pre-compile phase, as is the name_entry_size field. ','line_number':10294,'multiline':True]
['text':' If any named groups were found, create the name/number table from the list
created in the pre-pass. ','line_number':10309,'multiline':True]
['text':' Set up a starting, non-extracting bracket, then compile the expression. On
error, errorcode will be set non-zero, so we don't need to look at the result
of the function here. ','line_number':10319,'multiline':True]
['text':' Must disable after (*ACCEPT) ','line_number':10335,'multiline':True]
['text':' Disables minimum length ','line_number':10337,'multiline':True]
['text':' Fill in the final opcode and check for disastrous overflow. If no overflow,
but the estimated length exceeds the really used length, adjust the value of
re->blocksize, and if valgrind support is configured, mark the extra allocated
memory as unaddressable, so that any out-of-bound reads can be detected. ','line_number':10340,'multiline':True]
['text':' Scan the pattern for recursion/subroutine calls and convert the group
numbers into offsets. Maintain a small cache so that repeated groups containing
recursions are efficiently handled. ','line_number':10355,'multiline':True]
['text':' Group n+1 must always start to the right of group n, so we can save
        search time below when the new group number is greater than any of the
        previously found groups. ','line_number':10388,'multiline':True]
['text':' In rare debugging situations we sometimes need to look at the compiled code
at this stage. ','line_number':10414,'multiline':True]
['text':' Unless disabled, check whether any single character iterators can be
auto-possessified. The function overwrites the appropriate opcode values, so
the type of the pointer must be cast. NOTE: the intermediate variable "temp" is
used in this code because at least one compiler gives a warning about loss of
"const" attribute if the cast (PCRE2_UCHAR *)codestart is used directly in the
function call. ','line_number':10422,'multiline':True]
['text':' Failed to compile, or error while post-processing. ','line_number':10435,'multiline':True]
['text':' Successful compile. If the anchored option was not passed, set it if
we can determine that the pattern is anchored by virtue of ^ characters or \A
or anything else, such as starting with non-atomic .* when DOTALL is set and
there are no occurrences of *PRUNE or *SKIP (though there is an option to
disable this case). ','line_number':10439,'multiline':True]
['text':' Set up the first code unit or startline flag, the required code unit, and
then study the pattern. This code need not be obeyed if PCRE2_NO_START_OPTIMIZE
is set, as the data it would create will not be used. Note that a first code
unit (but not the startline flag) is useful for anchored patterns because it
can still give a quick "no match" and also avoid searching for a last code
unit. ','line_number':10449,'multiline':True]
['text':' For minimal minlength from first/required CU ','line_number':10458,'multiline':True]
['text':' If we do not have a first code unit, see if there is one that is asserted
  (these are not saved during the compile because they can cause conflicts with
  actual literals that follow). ','line_number':10460,'multiline':True]
['text':' Save the data for a first code unit. The existence of one means the
  minimum length must be at least 1. ','line_number':10467,'multiline':True]
['text':' Handle caseless first code units. ','line_number':10476,'multiline':True]
['text':' The first code unit is > 128 in UTF or UCP mode, or > 255 otherwise.
      In 8-bit UTF mode, codepoints in the range 128-255 are introductory code
      points and cannot have another case, but if UCP is set they may do. ','line_number':10485,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':10498,'multiline':True]
['text':' When there is no first code unit, for non-anchored patterns, see if we can
  set the PCRE2_STARTLINE flag. This is helpful for multiline matches when all
  branches start with ^ and also when all branches start with non-atomic .* for
  non-DOTALL matches when *PRUNE and SKIP are not present. (There is an option
  that disables this case.) ','line_number':10502,'multiline':True]
['text':' Handle the "required code unit", if one is set. In the UTF case we can
  increment the minimum minimum length only if we are sure this really is a
  different character and not a non-starting code unit of the first character,
  because the minimum length count is in characters, not code units. ','line_number':10512,'multiline':True]
['text':' Not UTF ','line_number':10520,'multiline':True]
['text':' First not set ','line_number':10521,'multiline':True]
['text':' First not surrogate ','line_number':10522,'multiline':True]
['text':' Req not low surrogate ','line_number':10523,'multiline':True]
['text':' Not UTF ','line_number':10525,'multiline':True]
['text':' First not set ','line_number':10526,'multiline':True]
['text':' First is ASCII ','line_number':10527,'multiline':True]
['text':' Req is ASCII ','line_number':10528,'multiline':True]
['text':' In the case of an anchored pattern, set up the value only if it follows
    a variable length item in the pattern. ','line_number':10534,'multiline':True]
['text':' Handle caseless required code units as for first code units (above). ','line_number':10543,'multiline':True]
['text':' SUPPORT_UNICODE ','line_number':10560,'multiline':True]
['text':' Study the compiled pattern to set up information such as a bitmap of
  starting code units and a minimum matching length. ','line_number':10565,'multiline':True]
['text':' If study() set a bitmap of starting code units, it implies a minimum
  length of at least one. ','line_number':10574,'multiline':True]
['text':' If the minimum length set (or not set) by study() is less than the minimum
  implied by required code units, override it. ','line_number':10580,'multiline':True]
['text':' End of start-of-match optimizations. ','line_number':10584,'multiline':True]
['text':' Control ends up here in all cases. When running under valgrind, make a
pattern's terminating zero defined again. If memory was obtained for the parsed
version of the pattern, free it before returning. Also free the list of named
groups if a larger one had to be obtained, and likewise the group information
vector. ','line_number':10586,'multiline':True]
['text':' Will be NULL after an error ','line_number':10602,'multiline':True]
['text':' Errors discovered in parse_regex() set the offset value in the compile
block. Errors discovered before it is called must compute it from the ptr
value. After parse_regex() is called, the offset in the compile block is set to
the end of the pattern, but certain errors in compile_regex() may reset it if
an offset is available in the parsed pattern. ','line_number':10604,'multiline':True]
['text':' End of pcre2_compile.c ','line_number':10623,'multiline':True]
