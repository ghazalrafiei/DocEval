['text':' Copyright 2019 The Bazel Authors. All rights reserved.','line_number':1,'multiline':False]
['text':'','line_number':2,'multiline':False]
['text':' Licensed under the Apache License, Version 2.0 (the "License");','line_number':3,'multiline':False]
['text':' you may not use this file except in compliance with the License.','line_number':4,'multiline':False]
['text':' You may obtain a copy of the License at','line_number':5,'multiline':False]
['text':'','line_number':6,'multiline':False]
['text':'    http://www.apache.org/licenses/LICENSE-2.0','line_number':7,'multiline':False]
['text':'','line_number':8,'multiline':False]
['text':' Unless required by applicable law or agreed to in writing, software','line_number':9,'multiline':False]
['text':' distributed under the License is distributed on an "AS IS" BASIS,','line_number':10,'multiline':False]
['text':' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.','line_number':11,'multiline':False]
['text':' See the License for the specific language governing permissions and','line_number':12,'multiline':False]
['text':' limitations under the License.','line_number':13,'multiline':False]
['text':' On Windows 7, the subprocess cannot inherit console handles via the','line_number':53,'multiline':False]
['text':' attribute list (CreateProcessW fails with ERROR_NO_SYSTEM_RESOURCES).','line_number':54,'multiline':False]
['text':' If we pass only invalid handles here, the Create method creates an','line_number':55,'multiline':False]
['text':' AutoAttributeList with 0 handles and initializes the STARTUPINFOEXW as','line_number':56,'multiline':False]
['text':' empty and disallowing handle inheritance. At the same time, CreateProcessW','line_number':57,'multiline':False]
['text':' specifies neither CREATE_NEW_CONSOLE nor DETACHED_PROCESS, so the','line_number':58,'multiline':False]
['text':' subprocess *does* inherit the console, which is exactly what we want, and','line_number':59,'multiline':False]
['text':' it works on all supported Windows versions.','line_number':60,'multiline':False]
['text':' Fixes https://github.com/bazelbuild/bazel/issues/8676','line_number':61,'multiline':False]
['text':' MDSN says that the default for job objects is that breakaway is not','line_number':106,'multiline':False]
['text':' allowed. Thus, we don't need to do any more setup here.','line_number':107,'multiline':False]
['text':' kMaxCmdline value: see lpCommandLine parameter of CreateProcessW.','line_number':154,'multiline':False]
['text':' lpApplicationName ','line_number':175,'multiline':True]
['text':' lpCommandLine ','line_number':176,'multiline':True]
['text':' lpProcessAttributes ','line_number':177,'multiline':True]
['text':' lpThreadAttributes ','line_number':178,'multiline':True]
['text':' bInheritHandles ','line_number':179,'multiline':True]
['text':' dwCreationFlags ','line_number':180,'multiline':True]
['text':' So that Ctrl-Break','line_number':182,'multiline':False]
['text':' isn't propagated','line_number':183,'multiline':False]
['text':' So that it doesn't start a new job itself','line_number':184,'multiline':False]
['text':' lpEnvironment ','line_number':186,'multiline':True]
['text':' lpCurrentDirectory ','line_number':187,'multiline':True]
['text':' lpStartupInfo ','line_number':188,'multiline':True]
['text':' lpProcessInformation ','line_number':189,'multiline':True]
['text':' Pre-Windows 8 systems don't support nested jobs, and Bazel is already','line_number':215,'multiline':False]
['text':' in a job.  We can't create nested jobs, so just revert to','line_number':216,'multiline':False]
['text':' TerminateProcess() and hope for the best. In batch mode, the launcher','line_number':217,'multiline':False]
['text':' puts Bazel in a job so that will take care of cleanup once the','line_number':218,'multiline':False]
['text':' command finishes.','line_number':219,'multiline':False]
['text':' Now that we put the process in a new job object, we can start executing','line_number':230,'multiline':False]
['text':' it','line_number':231,'multiline':False]
['text':' Any other case is an error and should be reported back to Bazel.','line_number':270,'multiline':False]
['text':' Ensure that the process is really terminated (if WaitForSingleObject','line_number':279,'multiline':False]
['text':' above timed out, we have to explicitly kill it) and that it doesn't','line_number':280,'multiline':False]
['text':' leave behind any subprocesses.','line_number':281,'multiline':False]
['text':' Wait for the job object to complete, signalling that all subprocesses','line_number':287,'multiline':False]
['text':' have exited.','line_number':288,'multiline':False]
['text':' Still waiting...','line_number':296,'multiline':False]
['text':' Fetch and store the exit code in case Bazel asks us for it later,','line_number':303,'multiline':False]
['text':' because we cannot do this anymore after we closed the handle.','line_number':304,'multiline':False]
['text':' 128 + SIGINT, like on Linux','line_number':329,'multiline':False]
['text':' If the process exited, despite TerminateProcess having failed, we're','line_number':346,'multiline':False]
['text':' still happy and just ignore the error. It might have been a race','line_number':347,'multiline':False]
['text':' where the process exited by itself just before we tried to kill it.','line_number':348,'multiline':False]
['text':' However, if the process is *still* running at this point (evidenced','line_number':349,'multiline':False]
['text':' by its exit code still being STILL_ACTIVE) then something went','line_number':350,'multiline':False]
['text':' really unexpectedly wrong and we should report that error.','line_number':351,'multiline':False]
['text':' Restore the error message from TerminateProcess - it will be much','line_number':353,'multiline':False]
['text':' more helpful for debugging in case something goes wrong here.','line_number':354,'multiline':False]
['text':' Escape arguments for CreateProcessW.','line_number':373,'multiline':False]
['text':'','line_number':374,'multiline':False]
['text':' This algorithm is based on information found in','line_number':375,'multiline':False]
['text':' http://daviddeley.com/autohotkey/parameters/parameters.htm','line_number':376,'multiline':False]
['text':'','line_number':377,'multiline':False]
['text':' The following source specifies a similar algorithm:','line_number':378,'multiline':False]
['text':' https://blogs.msdn.microsoft.com/twistylittlepassagesallalike/2011/04/23/everyone-quotes-command-line-arguments-the-wrong-way/','line_number':379,'multiline':False]
['text':' unfortunately I found this algorithm only after creating the one below, but','line_number':380,'multiline':False]
['text':' fortunately they seem to do the same.','line_number':381,'multiline':False]
['text':' Copy the segment since the last special character.','line_number':404,'multiline':False]
['text':' Handle the current special character.','line_number':410,'multiline':False]
['text':' This is a quote character. Escape it with a single backslash.','line_number':412,'multiline':False]
['text':' This is a backslash (or the first one in a run of backslashes).','line_number':415,'multiline':False]
['text':' Whether we escape it depends on whether the run ends with a quote.','line_number':416,'multiline':False]
['text':' The run of backslashes goes to the end.','line_number':424,'multiline':False]
['text':' We have to escape every backslash with another backslash.','line_number':425,'multiline':False]
['text':' The run of backslashes is terminated by a quote.','line_number':431,'multiline':False]
['text':' We have to escape every backslash with another backslash, and','line_number':432,'multiline':False]
['text':' escape the quote with one backslash.','line_number':433,'multiline':False]
['text':' 'i' is also increased in the loop iteration step','line_number':438,'multiline':False]
['text':' No quote found. Each backslash counts for itself, they must not be','line_number':440,'multiline':False]
['text':' escaped.','line_number':441,'multiline':False]
['text':' 'i' is also increased in the loop iteration step','line_number':445,'multiline':False]
['text':' This is not a special character. Start the segment if necessary.','line_number':449,'multiline':False]
['text':' Save final segment after the last special character.','line_number':455,'multiline':False]
['text':' namespace windows','line_number':463,'multiline':False]
['text':' namespace bazel','line_number':464,'multiline':False]
