['text':'!/bin/bash','line_number':1,'multiline':False]
['text':'','line_number':2,'multiline':False]
['text':' Copyright 2019 The Bazel Authors. All rights reserved.','line_number':3,'multiline':False]
['text':'','line_number':4,'multiline':False]
['text':' Licensed under the Apache License, Version 2.0 (the "License");','line_number':5,'multiline':False]
['text':' you may not use this file except in compliance with the License.','line_number':6,'multiline':False]
['text':' You may obtain a copy of the License at','line_number':7,'multiline':False]
['text':'','line_number':8,'multiline':False]
['text':'    http://www.apache.org/licenses/LICENSE-2.0','line_number':9,'multiline':False]
['text':'','line_number':10,'multiline':False]
['text':' Unless required by applicable law or agreed to in writing, software','line_number':11,'multiline':False]
['text':' distributed under the License is distributed on an "AS IS" BASIS,','line_number':12,'multiline':False]
['text':' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.','line_number':13,'multiline':False]
['text':' See the License for the specific language governing permissions and','line_number':14,'multiline':False]
['text':' limitations under the License.','line_number':15,'multiline':False]
['text':' --- begin runfiles.bash initialization ---','line_number':17,'multiline':False]
['text':' Copy-pasted from Bazel's Bash runfiles library (tools/bash/runfiles/runfiles.bash).','line_number':18,'multiline':False]
['text':' --- end runfiles.bash initialization ---','line_number':38,'multiline':False]
['text':'### HELPER FUNCTIONS ##################################################','line_number':60,'multiline':False]
['text':'!/bin/sh','line_number':130,'multiline':False]
['text':'','line_number':131,'multiline':False]
['text':' Usage: cat_unused.sh output_file unused_file input...','line_number':132,'multiline':False]
['text':' "Magic" input content values:','line_number':133,'multiline':False]
['text':' - 'unused': mark the file unused, skip its content.','line_number':134,'multiline':False]
['text':' - 'invalidUnused': produce an invalid unused file.','line_number':135,'multiline':False]
['text':'','line_number':136,'multiline':False]
['text':' ----------------------------------------------------------------------','line_number':179,'multiline':False]
['text':' HELPER FUNCTIONS','line_number':180,'multiline':False]
['text':' ----------------------------------------------------------------------','line_number':181,'multiline':False]
['text':' Checks that the unused file contains exactly the list of files passed','line_number':183,'multiline':False]
['text':' as parameters.','line_number':184,'multiline':False]
['text':' Trimmed.','line_number':192,'multiline':False]
['text':' Checks the content of the output.','line_number':197,'multiline':False]
['text':' Trimmed.','line_number':200,'multiline':False]
['text':' ----------------------------------------------------------------------','line_number':204,'multiline':False]
['text':' TESTS','line_number':205,'multiline':False]
['text':' ----------------------------------------------------------------------','line_number':206,'multiline':False]
['text':' Idea of the tests:','line_number':208,'multiline':False]
['text':' - "cat_unused.sh" cats the lists of inputs.','line_number':209,'multiline':False]
['text':' - if an input contains "unused", it is added to the "unused_list"','line_number':210,'multiline':False]
['text':' - otherwise, its content is concatenated to the output.','line_number':211,'multiline':False]
['text':' As a result, any input file that contains "unused" will be considered as','line_number':212,'multiline':False]
['text':' unused by the build system..','line_number':213,'multiline':False]
['text':'','line_number':214,'multiline':False]
['text':' Note: this is not a valid use of "unused_inputs_list" as all input files do','line_number':215,'multiline':False]
['text':' actually influence the build output, making this build rule','line_number':216,'multiline':False]
['text':' non-deterministic.','line_number':217,'multiline':False]
['text':' However, the goal of this test is to check the behavior of the build system','line_number':218,'multiline':False]
['text':' with regard to the "unused_inputs_list" attribute.','line_number':219,'multiline':False]
['text':' Typical "rebuild" scenario.','line_number':221,'multiline':False]
['text':' Initial build.','line_number':223,'multiline':False]
['text':' Mark "b" as unused.','line_number':228,'multiline':False]
['text':' Change "b" again:','line_number':234,'multiline':False]
['text':' This time it should be used. But given that it was marked "unused"','line_number':235,'multiline':False]
['text':' the build should not trigger: "b" should still be considered unused.','line_number':236,'multiline':False]
['text':' Change c:','line_number':242,'multiline':False]
['text':' The build should be triggered, and the newer version of "b" should be used.','line_number':243,'multiline':False]
['text':' Verify that the state of the local action cache survives server shutdown.','line_number':250,'multiline':False]
['text':' Mark "b" as unused + initial build','line_number':252,'multiline':False]
['text':' Shutdown.','line_number':258,'multiline':False]
['text':' Change "b" again:','line_number':261,'multiline':False]
['text':' Check that the action is still cached, although b changed.','line_number':262,'multiline':False]
['text':' Change c:','line_number':268,'multiline':False]
['text':' The build should be triggered, and the newer version of "b" should be used.','line_number':269,'multiline':False]
['text':' Verify that actually used input files stay on the set ot inputs after a server','line_number':276,'multiline':False]
['text':' shutdown.','line_number':277,'multiline':False]
['text':' Mark "b" as unused + initial build','line_number':279,'multiline':False]
['text':' Shutdown.','line_number':285,'multiline':False]
['text':' Change "c", which is used.','line_number':288,'multiline':False]
['text':' Verify that file names that are not actually inputs in the unused file are','line_number':295,'multiline':False]
['text':' ignored.','line_number':296,'multiline':False]
['text':' Mark "b" as producing an invalid unused file + initial build','line_number':298,'multiline':False]
['text':' Note: build should not fail: it is OK for unused file to contain','line_number':301,'multiline':False]
['text':' non-existing files.','line_number':302,'multiline':False]
['text':' Change "b" again:','line_number':306,'multiline':False]
['text':' It should just be picked-up, as it was not "unused".','line_number':307,'multiline':False]
['text':'!/bin/sh','line_number':316,'multiline':False]
