['text':' todo: switch function based on database','line_number':20,'multiline':False]
['text':' @ts-ignore','line_number':22,'multiline':False]
['text':' todo:','line_number':41,'multiline':False]
['text':'   return ({ qb, cn, knex, argsCount }) =>','line_number':42,'multiline':False]
['text':'     qb','line_number':43,'multiline':False]
['text':'       .clear('select')','line_number':44,'multiline':False]
['text':'       .select(','line_number':45,'multiline':False]
['text':'         knex.raw('sum(??)/(count(??)) + ?)', [cn, cn, (argsCount || 1) - 1])','line_number':46,'multiline':False]
['text':'       );','line_number':47,'multiline':False]
['text':' return '';','line_number':51,'multiline':False]
['text':' formula may include double curly brackets in previous version','line_number':65,'multiline':False]
['text':' convert to single curly bracket here for compatibility','line_number':66,'multiline':False]
['text':' todo: improve - implement a common solution for filter, sort, formula, etc','line_number':71,'multiline':False]
['text':' if (relation.type !== 'bt') continue;','line_number':106,'multiline':False]
['text':' if any of the relation in nested lookup is','line_number':188,'multiline':False]
['text':' not belongs to then ignore the sort option','line_number':189,'multiline':False]
['text':' if (relation.type !== 'bt') continue;','line_number':190,'multiline':False]
['text':'selectQb.join(
`${parentModel.title} as ${nestedAlias}`,
`${nestedAlias}.${parentColumn.title}`,
`${prevAlias}.${childColumn.title}`
);','line_number':249,'multiline':True]
['text':' selectQb.select(builder);','line_number':272,'multiline':False]
['text':' if (relation.type !== 'bt') continue;','line_number':296,'multiline':False]
['text':' if (relation.type !== 'bt') continue;','line_number':473,'multiline':False]
['text':' .select(knex.raw(`GROUP_CONCAT(??)`, [childModel?.pv?.title]))','line_number':501,'multiline':False]
['text':' getAggregateFn();','line_number':525,'multiline':False]
['text':' todo:','line_number':527,'multiline':False]
['text':' const qb = knex(childModel.title)','line_number':528,'multiline':False]
['text':'   // .select(knex.raw(`GROUP_CONCAT(??)`, [childModel?.pv?.title]))','line_number':529,'multiline':False]
['text':'   .where(','line_number':530,'multiline':False]
['text':'     `${childModel.title}.${childColumn.title}`,','line_number':531,'multiline':False]
['text':'     knex.raw(`??`, [`${parentModel.title}.${parentColumn.title}`])','line_number':532,'multiline':False]
['text':'   );','line_number':533,'multiline':False]
['text':'','line_number':534,'multiline':False]
['text':' selectQb = fn =>','line_number':535,'multiline':False]
['text':'   knex','line_number':536,'multiline':False]
['text':'     .raw(','line_number':537,'multiline':False]
['text':'       getAggregateFn(fn)({','line_number':538,'multiline':False]
['text':'         qb,','line_number':539,'multiline':False]
['text':'         knex,','line_number':540,'multiline':False]
['text':'         cn: childModel?.pv?.title','line_number':541,'multiline':False]
['text':'       })','line_number':542,'multiline':False]
['text':'     )','line_number':543,'multiline':False]
['text':'     .wrap('(', ')');','line_number':544,'multiline':False]
['text':'','line_number':545,'multiline':False]
['text':' // getAggregateFn();','line_number':546,'multiline':False]
['text':'   todo: provide unique alias','line_number':548,'multiline':False]
['text':' convert from DB timezone to UTC','line_number':599,'multiline':False]
['text':' convert from DB timezone to UTC','line_number':613,'multiline':False]
['text':' convert from DB timezone to UTC','line_number':626,'multiline':False]
['text':' sqlite3: special handling - See BinaryExpression','line_number':751,'multiline':False]
['text':' mysql2: CONCAT() returns NULL if any argument is NULL.','line_number':755,'multiline':False]
['text':' adding IFNULL to convert NULL values to empty strings','line_number':756,'multiline':False]
['text':' do nothing','line_number':759,'multiline':False]
['text':' pg / mssql: Concatenate all arguments. NULL arguments are ignored.','line_number':760,'multiline':False]
['text':' sqlite3: special handling - See BinaryExpression','line_number':761,'multiline':False]
['text':' treat `&` as shortcut for concat','line_number':779,'multiline':False]
['text':' comparing a date with empty string would throw','line_number':818,'multiline':False]
['text':' `ERROR: zero-length delimited identifier` in Postgres','line_number':819,'multiline':False]
['text':' The correct way to compare with Date should be using','line_number':824,'multiline':False]
['text':' `IS_AFTER`, `IS_BEFORE`, or `IS_SAME`','line_number':825,'multiline':False]
['text':' This is to prevent empty data returned to UI due to incorrect SQL','line_number':826,'multiline':False]
['text':' left tree value is date but right tree value is not date','line_number':834,'multiline':False]
['text':' return true if left tree value is not null, else false','line_number':835,'multiline':False]
['text':' The correct way to compare with Date should be using','line_number':843,'multiline':False]
['text':' `IS_AFTER`, `IS_BEFORE`, or `IS_SAME`','line_number':844,'multiline':False]
['text':' This is to prevent empty data returned to UI due to incorrect SQL','line_number':845,'multiline':False]
['text':' right tree value is date but left tree value is not date','line_number':853,'multiline':False]
['text':' return true if right tree value is not null, else false','line_number':854,'multiline':False]
['text':' handle date format','line_number':860,'multiline':False]
['text':' handle NULL values when calling CONCAT for sqlite3','line_number':874,'multiline':False]
['text':' register jsep curly hook once only','line_number':952,'multiline':False]
['text':' generate qb','line_number':954,'multiline':False]
['text':' dry run qb.builder to see if it will break the grid view or not','line_number':967,'multiline':False]
['text':' if so, set formula error and show empty selectQb instead','line_number':968,'multiline':False]
['text':' if column is provided, i.e. formula has been created','line_number':977,'multiline':False]
['text':' clean the previous formula error if the formula works this time','line_number':980,'multiline':False]
['text':' add formula error to show in UI','line_number':991,'multiline':False]
['text':' update cache to reflect the error in UI','line_number':995,'multiline':False]
['text':' set cache','line_number':1000,'multiline':False]
