['text':'','line_number':1,'multiline':False]
['text':'  httplib.h','line_number':2,'multiline':False]
['text':'','line_number':3,'multiline':False]
['text':'  Copyright (c) 2023 Yuji Hirose. All rights reserved.','line_number':4,'multiline':False]
['text':'  MIT License','line_number':5,'multiline':False]
['text':'','line_number':6,'multiline':False]
['text':'
 * Configuration
 ','line_number':13,'multiline':True]
['text':'
 * Headers
 ','line_number':116,'multiline':True]
['text':'_CRT_SECURE_NO_WARNINGS','line_number':123,'multiline':False]
['text':'_CRT_NONSTDC_NO_DEPRECATE','line_number':127,'multiline':False]
['text':' _MSC_VER','line_number':141,'multiline':False]
['text':' S_ISREG','line_number':145,'multiline':False]
['text':' S_ISDIR','line_number':149,'multiline':False]
['text':' NOMINMAX','line_number':153,'multiline':False]
['text':' strcasecmp','line_number':165,'multiline':False]
['text':' not _WIN32','line_number':172,'multiline':False]
['text':'_WIN32','line_number':199,'multiline':False]
['text':' these are defined in wincrypt.h and it breaks compilation if BoringSSL is','line_number':231,'multiline':False]
['text':' used','line_number':232,'multiline':False]
['text':' TARGET_OS_OSX','line_number':247,'multiline':False]
['text':' _WIN32','line_number':248,'multiline':False]
['text':'
 * Declaration
 ','line_number':279,'multiline':True]
['text':'
 * Backport std::make_unique from C++14.
 *
 * NOTE: This code came up with the following stackoverflow post:
 * https://stackoverflow.com/questions/10149840/c-arrays-and-make-unique
 *
 ','line_number':286,'multiline':True]
['text':' This is based on','line_number':317,'multiline':False]
['text':' "http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2014/n4189".','line_number':318,'multiline':False]
['text':' namespace detail','line_number':345,'multiline':False]
['text':' for server','line_number':461,'multiline':False]
['text':' for client','line_number':469,'multiline':False]
['text':' private members...','line_number':494,'multiline':False]
['text':' Redirect location','line_number':508,'multiline':False]
['text':' private members...','line_number':544,'multiline':False]
['text':' Stop all worker threads...','line_number':604,'multiline':False]
['text':' Join...','line_number':612,'multiline':False]
['text':' For internal use only','line_number':864,'multiline':False]
['text':' Response','line_number':878,'multiline':False]
['text':' Error','line_number':889,'multiline':False]
['text':' Request Headers','line_number':892,'multiline':False]
['text':' All of:','line_number':1140,'multiline':False]
['text':'   shutdown_ssl','line_number':1141,'multiline':False]
['text':'   shutdown_socket','line_number':1142,'multiline':False]
['text':'   close_socket','line_number':1143,'multiline':False]
['text':' should ONLY be called when socket_mutex_ is locked.','line_number':1144,'multiline':False]
['text':' Also, shutdown_ssl and close_socket should also NOT be called concurrently','line_number':1145,'multiline':False]
['text':' with a DIFFERENT thread sending requests using that socket.','line_number':1146,'multiline':False]
['text':' Socket endpoint information','line_number':1159,'multiline':False]
['text':' Current open socket','line_number':1164,'multiline':False]
['text':' These are all protected under socket_mutex','line_number':1169,'multiline':False]
['text':' Hostname-IP map','line_number':1174,'multiline':False]
['text':' Default headers','line_number':1177,'multiline':False]
['text':' Settings','line_number':1180,'multiline':False]
['text':' Universal interface','line_number':1272,'multiline':False]
['text':' HTTP only interface','line_number':1279,'multiline':False]
['text':' SSL','line_number':1494,'multiline':False]
['text':'
 * Implementation of template methods.
 ','line_number':1596,'multiline':True]
['text':'headers','line_number':1612,'multiline':True]
['text':'key','line_number':1613,'multiline':True]
['text':'id','line_number':1613,'multiline':True]
['text':'def','line_number':1614,'multiline':True]
['text':' namespace detail','line_number':1629,'multiline':False]
['text':'
 * Forward declarations and types that will be part of the .h file if split into
 * .h + .cc.
 ','line_number':1782,'multiline':True]
['text':'last','line_number':1891,'multiline':True]
['text':' NOTE: until the read size reaches `fixed_buffer_size`, use `fixed_buffer`','line_number':1954,'multiline':False]
['text':' to store data. The call can set memory on stack for performance.','line_number':1955,'multiline':False]
['text':' namespace detail','line_number':1975,'multiline':False]
['text':' ----------------------------------------------------------------------------','line_number':1977,'multiline':False]
['text':'
 * Implementation that will be part of the .cc file if split into .h + .cc.
 ','line_number':1979,'multiline':True]
['text':' D800 - DFFF is invalid...','line_number':2039,'multiline':False]
['text':' NOTREACHED','line_number':2054,'multiline':False]
['text':' NOTE: This code came up with the following stackoverflow post:','line_number':2058,'multiline':False]
['text':' https://stackoverflow.com/questions/180947/base64-decode-snippet-in-c','line_number':2059,'multiline':False]
['text':' Skip slash','line_number':2106,'multiline':False]
['text':' Read component','line_number':2112,'multiline':False]
['text':' Skip slash','line_number':2130,'multiline':False]
['text':' case ':': result += "%3A"; break; // ok? probably...','line_number':2172,'multiline':False]
['text':' 4 digits Unicode codes','line_number':2201,'multiline':False]
['text':' 'u0000'','line_number':2205,'multiline':False]
['text':' 2 digits hex codes','line_number':2212,'multiline':False]
['text':' '00'','line_number':2214,'multiline':False]
['text':' Get address info','line_number':2646,'multiline':False]
['text':' Ask getaddrinfo to convert IP in c-string to address','line_number':2657,'multiline':False]
['text':' Create a socket','line_number':2703,'multiline':False]
['text':'*
     * Since the WSA_FLAG_NO_HANDLE_INHERIT is only supported on Windows 7 SP1
     * and above the socket creation fails on older Windows Systems.
     *
     * Let's try to create a socket the old way in this case.
     *
     * Reference:
     * https://docs.microsoft.com/en-us/windows/win32/api/winsock2/nf-winsock2-wsasocketa
     *
     * WSA_FLAG_NO_HANDLE_INHERIT:
     * This flag is supported on Windows 7 with SP1, Windows Server 2008 R2 with
     * SP1, and later
     *
     ','line_number':2708,'multiline':True]
['text':' bind or connect','line_number':2751,'multiline':False]
['text':' equivalent to mac's IN6_IS_ADDR_UNIQUE_LOCAL','line_number':2832,'multiline':False]
['text':' __APPLE__','line_number':2973,'multiline':False]
['text':' Unsets the 6 high bits of h, therefore no overflow happens','line_number':2993,'multiline':False]
['text':' namespace udl','line_number':3009,'multiline':False]
['text':' TODO: 'Accept-Encoding' has br, not br;q=0','line_number':3172,'multiline':False]
['text':' TODO: 'Accept-Encoding' has gzip, not gzip;q=0','line_number':3178,'multiline':False]
['text':'last','line_number':3187,'multiline':True]
['text':' 15 is the value of wbits, which should be at the maximum possible value','line_number':3250,'multiline':False]
['text':' to ensure that any gzip stream can be decoded. The offset of 32 specifies','line_number':3251,'multiline':False]
['text':' that the stream type should be automatically detected either gzip or','line_number':3252,'multiline':False]
['text':' deflate.','line_number':3253,'multiline':False]
['text':' Skip trailing spaces and tabs.','line_number':3419,'multiline':False]
['text':' Check if the line ends with CRLF.','line_number':3459,'multiline':False]
['text':' Blank line indicates end of headers.','line_number':3462,'multiline':False]
['text':' Blank line indicates end of headers.','line_number':3466,'multiline':False]
['text':' Skip invalid line.','line_number':3472,'multiline':False]
['text':' Exclude line terminator','line_number':3478,'multiline':False]
['text':' Trailer','line_number':3576,'multiline':False]
['text':' Exclude line terminator','line_number':3582,'multiline':False]
['text':' namespace detail','line_number':3678,'multiline':False]
['text':' Emit chunked response header and footer for each chunk','line_number':3802,'multiline':False]
['text':' Emit chunked response header and footer for each chunk','line_number':3833,'multiline':False]
['text':' Trailer','line_number':3847,'multiline':False]
['text':' TODO: support 'filename*'','line_number':4025,'multiline':False]
['text':' Initial boundary','line_number':4034,'multiline':False]
['text':' New entry','line_number':4042,'multiline':False]
['text':' Headers','line_number':4047,'multiline':False]
['text':' Empty line','line_number':4051,'multiline':False]
['text':' Body','line_number':4082,'multiline':False]
['text':' Boundary','line_number':4105,'multiline':False]
['text':' Remove epilogue','line_number':4115,'multiline':False]
['text':' Buffer','line_number':4155,'multiline':False]
['text':' std::random_device might actually be deterministic on some','line_number':4237,'multiline':False]
['text':' platforms, but due to lack of support in the c++ standard library,','line_number':4238,'multiline':False]
['text':' doing better requires either some ugly hacks or breaking portability.','line_number':4239,'multiline':False]
['text':' Request 128 bits of entropy for initialization','line_number':4242,'multiline':False]
['text':'offset','line_number':4405,'multiline':True]
['text':' TODO: check if Content-Length is set','line_number':4446,'multiline':False]
['text':' NOTE: This code came up with the following stackoverflow post:','line_number':4495,'multiline':False]
['text':' https://stackoverflow.com/questions/9507184/can-openssl-on-windows-use-the-system-certificate-store','line_number':4496,'multiline':False]
['text':' TARGET_OS_OSX','line_number':4610,'multiline':False]
['text':' _WIN32','line_number':4611,'multiline':False]
['text':' CPPHTTPLIB_OPENSSL_SUPPORT','line_number':4612,'multiline':False]
['text':' https://stackoverflow.com/questions/440133/how-do-i-create-a-random-alpha-numeric-string-in-c/440240#answer-440240','line_number':4727,'multiline':False]
['text':' namespace detail','line_number':4755,'multiline':False]
['text':' Header utilities','line_number':4804,'multiline':False]
['text':' Request implementation','line_number':4834,'multiline':False]
['text':' Response implementation','line_number':4899,'multiline':False]
['text':' Result implementation','line_number':4976,'multiline':False]
['text':' Stream implementation','line_number':4992,'multiline':False]
['text':' Socket stream implementation','line_number':5003,'multiline':False]
['text':' Buffer stream implementation','line_number':5093,'multiline':False]
['text':'ip','line_number':5113,'multiline':True]
['text':'port','line_number':5114,'multiline':True]
['text':'ip','line_number':5116,'multiline':True]
['text':'port','line_number':5117,'multiline':True]
['text':' namespace detail','line_number':5123,'multiline':False]
['text':' HTTP server implementation','line_number':5125,'multiline':False]
['text':' Skip URL fragment','line_number':5399,'multiline':False]
['text':' Prepare additional headers','line_number':5458,'multiline':False]
['text':' Response line and headers','line_number':5484,'multiline':False]
['text':' Flush buffer','line_number':5495,'multiline':False]
['text':' Body','line_number':5500,'multiline':False]
['text':' Log','line_number':5517,'multiline':False]
['text':' Regular','line_number':5578,'multiline':False]
['text':' Multipart','line_number':5584,'multiline':False]
['text':' NOTE: should be 414?','line_number':5601,'multiline':False]
['text':'off','line_number':5636,'multiline':True]
['text':'len','line_number':5636,'multiline':True]
['text':' For debug
      size_t pos = 0;
      while (pos < n) {
        auto read_size = (std::min)<size_t>(1, n - pos);
        auto ret = multipart_form_data_parser.parse(
            buf + pos, read_size, multipart_receiver, multipart_header);
        if (!ret) { return false; }
        pos += read_size;
      }
      return true;
      ','line_number':5637,'multiline':True]
['text':'off','line_number':5652,'multiline':True]
['text':'len','line_number':5653,'multiline':True]
['text':' Prefix match','line_number':5678,'multiline':False]
['text':' Timeout','line_number':5761,'multiline':False]
['text':' The per-process limit of open file descriptors has been reached.','line_number':5772,'multiline':False]
['text':' Try to accept new connections after a short sleep.','line_number':5773,'multiline':False]
['text':' The server socket was closed by user.','line_number':5783,'multiline':False]
['text':' File handler','line_number':5831,'multiline':False]
['text':' Content reader handler','line_number':5839,'multiline':False]
['text':' Read content into `req.body`','line_number':5879,'multiline':False]
['text':' Regular handler','line_number':5883,'multiline':False]
['text':' Connection has been closed on client','line_number':6049,'multiline':False]
['text':' TODO: Increase FD_SETSIZE statically (libzmq), dynamically (MySQL).','line_number':6064,'multiline':False]
['text':' Socket file descriptor exceeded FD_SETSIZE...','line_number':6067,'multiline':False]
['text':' Check if the request URI doesn't exceed the limit','line_number':6077,'multiline':False]
['text':' Request line and headers','line_number':6085,'multiline':False]
['text':' Rounting','line_number':6134,'multiline':False]
['text':' HTTP client implementation','line_number':6197,'multiline':False]
['text':' Check is custom IP specified for host_','line_number':6272,'multiline':False]
['text':'socket','line_number':6292,'multiline':True]
['text':'shutdown_gracefully','line_number':6293,'multiline':True]
['text':' If there are any requests in flight from threads other than us, then it's','line_number':6294,'multiline':False]
['text':' a thread-unsafe race because individual ssl* objects are not thread-safe.','line_number':6295,'multiline':False]
['text':' If there are requests in flight in another thread, usually closing','line_number':6306,'multiline':False]
['text':' the socket will be fine and they will simply receive an error when','line_number':6307,'multiline':False]
['text':' using the closed socket, but it is still a bug since rarely the OS','line_number':6308,'multiline':False]
['text':' may reassign the socket id to be used for a new socket, and then','line_number':6309,'multiline':False]
['text':' suddenly they will be operating on a live socket that is different','line_number':6310,'multiline':False]
['text':' than the one they intended!','line_number':6311,'multiline':False]
['text':' It is also a bug if this happens while SSL is still active','line_number':6315,'multiline':False]
['text':' Ignore '100 Continue'','line_number':6346,'multiline':False]
['text':' CRLF','line_number':6348,'multiline':False]
['text':' next response line','line_number':6349,'multiline':False]
['text':' Set this to false immediately - if it ever gets set to true by the end of','line_number':6374,'multiline':False]
['text':' the request, we know another thread instructed us to close the socket.','line_number':6375,'multiline':False]
['text':' Attempt to avoid sigpipe by shutting down nongracefully if it seems','line_number':6382,'multiline':False]
['text':' like the other side has already closed the connection Also, there','line_number':6383,'multiline':False]
['text':' cannot be any requests in flight from other threads since we locked','line_number':6384,'multiline':False]
['text':' request_mutex_, so safe to close everything immediately','line_number':6385,'multiline':False]
['text':' TODO: refactoring','line_number':6397,'multiline':False]
['text':' Mark the current socket as being in use so that it cannot be closed by','line_number':6412,'multiline':False]
['text':' anyone else while this request is ongoing, even though we will be','line_number':6413,'multiline':False]
['text':' releasing the mutex.','line_number':6414,'multiline':False]
['text':' Briefly lock mutex in order to mark that a request is no longer ongoing','line_number':6432,'multiline':False]
['text':' TODO: Brotli support','line_number':6595,'multiline':False]
['text':' Prepare additional headers','line_number':6616,'multiline':False]
['text':' Request line and headers','line_number':6702,'multiline':False]
['text':' Flush buffer','line_number':6711,'multiline':False]
['text':' Body','line_number':6719,'multiline':False]
['text':' TODO: Brotli support','line_number':6747,'multiline':False]
['text':' Send request','line_number':6842,'multiline':False]
['text':' Receive response and headers','line_number':6859,'multiline':False]
['text':' Body','line_number':6866,'multiline':False]
['text':'off','line_number':6887,'multiline':True]
['text':'len','line_number':6888,'multiline':True]
['text':' TODO this requires a not-entirely-obvious chain of calls to be correct','line_number':6914,'multiline':False]
['text':' for this to be safe. Maybe a code refactor (such as moving this out to','line_number':6915,'multiline':False]
['text':' the send function and getting rid of the recursiveness of the mutex)','line_number':6916,'multiline':False]
['text':' could make this more obvious.','line_number':6917,'multiline':False]
['text':' This is safe to call because process_request is only called by','line_number':6919,'multiline':False]
['text':' handle_request which is only called by send, which locks the request','line_number':6920,'multiline':False]
['text':' mutex during the process. It would be a bug to call it from a different','line_number':6921,'multiline':False]
['text':' thread since it's a thread-safety issue to do these things to the socket','line_number':6922,'multiline':False]
['text':' if another thread is using the socket.','line_number':6923,'multiline':False]
['text':' Log','line_number':6930,'multiline':False]
['text':' cur_item and cur_start are copied to within the std::function and maintain','line_number':6940,'multiline':False]
['text':' state between successive calls','line_number':6941,'multiline':False]
['text':'offset','line_number':7068,'multiline':True]
['text':'total_length','line_number':7068,'multiline':True]
['text':' If there is anything ongoing right now, the ONLY thread-safe thing we can','line_number':7471,'multiline':False]
['text':' do is to shutdown_socket, so that threads using this socket suddenly','line_number':7472,'multiline':False]
['text':' discover they can't read/write any more and error out. Everything else','line_number':7473,'multiline':False]
['text':' (closing the socket, shutting ssl down) is unsafe because these actions are','line_number':7474,'multiline':False]
['text':' not thread-safe.','line_number':7475,'multiline':False]
['text':' Aside from that, we set a flag for the socket to be closed when we're','line_number':7479,'multiline':False]
['text':' done.','line_number':7480,'multiline':False]
['text':' Otherwise, still holding the mutex, we can shut everything down ourselves','line_number':7485,'multiline':False]
['text':'
 * SSL Implementation
 ','line_number':7604,'multiline':True]
['text':' sometimes we may want to skip this to try to avoid SIGPIPE if we know','line_number':7643,'multiline':False]
['text':' the remote has closed the network connection','line_number':7644,'multiline':False]
['text':' Note that it is not always possible to avoid SIGPIPE, this is merely a','line_number':7645,'multiline':False]
['text':' best-efforts.','line_number':7646,'multiline':False]
['text':' SSL socket stream implementation','line_number':7708,'multiline':False]
['text':' namespace detail','line_number':7809,'multiline':False]
['text':' SSL HTTP server implementation','line_number':7811,'multiline':False]
['text':' add default password callback before opening encrypted private key','line_number':7825,'multiline':False]
['text':'ssl2','line_number':7896,'multiline':True]
['text':' Shutdown gracefully if the result seemed successful, non-gracefully if','line_number':7910,'multiline':False]
['text':' the connection appeared to be closed.','line_number':7911,'multiline':False]
['text':' SSL HTTP client implementation','line_number':7921,'multiline':False]
['text':' Make sure to shut down SSL since shutdown_ssl will resolve to the','line_number':7971,'multiline':False]
['text':' base function rather than the derived function once we get to the','line_number':7972,'multiline':False]
['text':' base class destructor, and won't free the SSL (causing a leak).','line_number':7973,'multiline':False]
['text':' Free memory allocated for old cert and use new store `ca_cert_store`','line_number':7983,'multiline':False]
['text':' Assumes that socket_mutex_ is locked and that there are no requests in flight','line_number':8002,'multiline':False]
['text':' Thread-safe to close everything because we are assuming there are no','line_number':8015,'multiline':False]
['text':' requests in flight','line_number':8016,'multiline':False]
['text':' Thread-safe to close everything because we are assuming there are','line_number':8042,'multiline':False]
['text':' no requests in flight','line_number':8043,'multiline':False]
['text':' TARGET_OS_OSX','line_number':8083,'multiline':False]
['text':' _WIN32','line_number':8084,'multiline':False]
['text':' Quote from RFC2818 section 3.1 "Server Identity"

     If a subjectAltName extension of type dNSName is present, that MUST
     be used as the identity. Otherwise, the (most specific) Common Name
     field in the Subject field of the certificate MUST be used. Although
     the use of the Common Name is existing practice, it is deprecated and
     Certification Authorities are encouraged to use the dNSName instead.

     Matching is performed using the matching rules specified by
     [RFC2459].  If more than one identity of a given type is present in
     the certificate (e.g., more than one dNSName name, a match in any one
     of the set is considered acceptable.) Names may contain the wildcard
     character * which is considered to match any single domain name
     component or component fragment. E.g., *.a.com matches foo.a.com but
     not bar.foo.a.com. f*.com matches foo.com but not bar.com.

     In some cases, the URI is specified as an IP address rather than a
     hostname. In this case, the iPAddress subjectAltName must be present
     in the certificate and must exactly match the IP in the URI.

  ','line_number':8180,'multiline':True]
['text':' Wildcard match','line_number':8280,'multiline':False]
['text':' https://bugs.launchpad.net/ubuntu/+source/firefox-3.0/+bug/376484','line_number':8281,'multiline':False]
['text':' Universal client implementation','line_number':8305,'multiline':False]
['text':' NOTE: -1 doesn't match any of X509_V_ERR_???','line_number':8777,'multiline':False]
['text':' ----------------------------------------------------------------------------','line_number':8786,'multiline':False]
['text':' namespace httplib','line_number':8788,'multiline':False]
['text':' CPPHTTPLIB_HTTPLIB_H','line_number':8794,'multiline':False]
