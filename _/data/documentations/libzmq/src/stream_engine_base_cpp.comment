['text':' SPDX-License-Identifier: MPL-2.0 ','line_number':1,'multiline':True]['text':'  Put the socket into non-blocking mode.','line_number':111,'multiline':False]['text':' FreeBSD may return ECONNRESET on close() under load but this is not','line_number':126,'multiline':False]['text':' an error.','line_number':127,'multiline':False]['text':'  Drop reference to metadata and destroy it if we are','line_number':139,'multiline':False]['text':'  the only user.','line_number':140,'multiline':False]['text':'  Connect to session object.','line_number':158,'multiline':False]['text':'  Connect to I/O threads poller object.','line_number':164,'multiline':False]['text':'  Cancel all timers.','line_number':177,'multiline':False]['text':'  Cancel all fd subscriptions.','line_number':197,'multiline':False]['text':'  Disconnect from I/O threads poller object.','line_number':201,'multiline':False]['text':' ignore errors','line_number':215,'multiline':False]['text':'  If still handshaking, receive and process the greeting message.','line_number':224,'multiline':False]['text':'  Handshaking was successful.','line_number':227,'multiline':False]['text':'  Switch into the normal message flow.','line_number':228,'multiline':False]['text':'  If there has been an I/O error, stop polling.','line_number':246,'multiline':False]['text':' TODO or return false in this case too?','line_number':250,'multiline':False]['text':'  If there's no data to process in the buffer...','line_number':253,'multiline':False]['text':'  Retrieve the buffer and read as much data as possible.','line_number':255,'multiline':False]['text':'  Note that buffer can be arbitrarily large. However, we assume','line_number':256,'multiline':False]['text':'  the underlying TCP layer has fixed buffer size and thus the','line_number':257,'multiline':False]['text':'  number of bytes read will be always limited.','line_number':258,'multiline':False]['text':'  Adjust input size','line_number':272,'multiline':False]['text':' Adjust buffer size to received bytes','line_number':274,'multiline':False]['text':'  Tear down the connection if we have failed to decode input data','line_number':293,'multiline':False]['text':'  or the session has rejected the message.','line_number':294,'multiline':False]['text':' In cases where the src/dst have the same IP and the dst uses an ephemeral port, reconnection','line_number':297,'multiline':False]['text':' eventually results in the src and dest IP and port clashing (google tcp self connection)','line_number':298,'multiline':False]['text':' While this is a protocol_error (you have the single zmq socket handshaking with itself)','line_number':299,'multiline':False]['text':' we do not want to to stop reconnection from happening','line_number':300,'multiline':False]['text':'  If write buffer is empty, try to read new data from the encoder.','line_number':318,'multiline':False]['text':'  Even when we stop polling as soon as there is no','line_number':320,'multiline':False]['text':'  data to send, the poller may invoke out_event one','line_number':321,'multiline':False]['text':'  more time due to 'speculative write' optimisation.','line_number':322,'multiline':False]['text':'  ws_engine can cause an engine error and delete it, so','line_number':333,'multiline':False]['text':'  bail out immediately to avoid use-after-free','line_number':334,'multiline':False]['text':'  If there is no data to send, stop polling for output.','line_number':350,'multiline':False]['text':'  If there are any data to write in write buffer, write as much as','line_number':358,'multiline':False]['text':'  possible to the socket. Note that amount of data to write can be','line_number':359,'multiline':False]['text':'  arbitrarily large. However, we assume that underlying TCP layer has','line_number':360,'multiline':False]['text':'  limited transmission buffer and thus the actual number of bytes','line_number':361,'multiline':False]['text':'  written should be reasonably modest.','line_number':362,'multiline':False]['text':'  IO error has occurred. We stop waiting for output events.','line_number':365,'multiline':False]['text':'  The engine is not terminated until we detect input error;','line_number':366,'multiline':False]['text':'  this is necessary to prevent losing incoming messages.','line_number':367,'multiline':False]['text':'  If we are still handshaking and there are no data','line_number':376,'multiline':False]['text':'  to send, stop polling for output.','line_number':377,'multiline':False]['text':'  Speculative write: The assumption is that at the moment new message','line_number':393,'multiline':False]['text':'  was sent by the user the socket is probably available for writing.','line_number':394,'multiline':False]['text':'  Thus we try to write the data to socket avoiding polling for POLLOUT.','line_number':395,'multiline':False]['text':'  Consequently, the latency should be better in request/reply scenarios.','line_number':396,'multiline':False]['text':'  Speculative read.','line_number':445,'multiline':False]['text':' If the write is failing at this stage with','line_number':529,'multiline':False]['text':' an EAGAIN the pipe must be being shut down,','line_number':530,'multiline':False]['text':' so we can just bail out of the routing id set.','line_number':531,'multiline':False]['text':' If the write is failing at this stage with','line_number':543,'multiline':False]['text':' an EAGAIN the pipe must be being shut down,','line_number':544,'multiline':False]['text':' so we can just bail out of the notification.','line_number':545,'multiline':False]['text':'  Compile metadata.','line_number':558,'multiline':False]['text':'  Add ZAP properties.','line_number':562,'multiline':False]['text':'  Add ZMTP properties.','line_number':566,'multiline':False]['text':' For router sockets with disconnect notification, rollback','line_number':672,'multiline':False]['text':' any incomplete message in the pipe, and push the disconnect','line_number':673,'multiline':False]['text':' notification message.','line_number':674,'multiline':False]['text':' protocol errors have been signaled already at the point where they occurred','line_number':682,'multiline':False]['text':' special case: connecting to non-ZMTP process which immediately drops connection,','line_number':688,'multiline':False]['text':' or which never responds with greeting, should be treated as a protocol error','line_number':689,'multiline':False]['text':' (i.e. stop reconnect)','line_number':690,'multiline':False]['text':'  Private property to support deprecated SRCFD','line_number':726,'multiline':False]['text':'  handshake timer expired before handshake completed, so engine fail','line_number':739,'multiline':False]['text':' There are no other valid timer ids!','line_number':752,'multiline':False]['text':' connection closed by peer','line_number':761,'multiline':False]