['text':' SPDX-License-Identifier: MPL-2.0 ','line_number':1,'multiline':True]['text':' Acceptable temporary directory environment variables','line_number':61,'multiline':False]['text':' Sentinel','line_number':64,'multiline':False]['text':'  Setting this option result in sane behaviour when exec() functions','line_number':72,'multiline':False]['text':'  are used. Old sockets are closed and don't block TCP ports etc.','line_number':73,'multiline':False]['text':' if supported, create socket with WSA_FLAG_NO_HANDLE_INHERIT, such that','line_number':79,'multiline':False]['text':' the race condition in making it non-inheritable later is avoided','line_number':80,'multiline':False]['text':'  Socket is not yet connected so EINVAL is not a valid networking error','line_number':95,'multiline':False]['text':'  Windows and Hurd do not support IPV6_TCLASS','line_number':193,'multiline':False]['text':'  If IPv6 is not enabled ENOPROTOOPT will be returned on Linux and','line_number':198,'multiline':False]['text':'  EINVAL on OSX','line_number':199,'multiline':False]['text':'  Make sure that SIGPIPE signal is not generated when writing to a','line_number':222,'multiline':False]['text':'  connection that was already closed by the peer.','line_number':223,'multiline':False]['text':'  As per POSIX spec, EINVAL will be returned if the socket was valid but','line_number':224,'multiline':False]['text':'  the connection has been reset by the peer. Return an error so that the','line_number':225,'multiline':False]['text':'  socket can be closed and the connection retried if necessary.','line_number':226,'multiline':False]['text':'  Init PGM transport. Ensure threading and timer are enabled. Find PGM','line_number':263,'multiline':False]['text':'  protocol ID. Note that if you want to use gettimeofday and sleep for','line_number':264,'multiline':False]['text':'  openPGM timing, set environment variables PGM_TIMER to "GTOD" and','line_number':265,'multiline':False]['text':'  PGM_SLEEP to "USLEEP".','line_number':266,'multiline':False]['text':'  Invalid parameters don't set pgm_error_t','line_number':270,'multiline':False]['text':'  Failed to access RTC or HPET device.','line_number':274,'multiline':False]['text':'  PGM_ERROR_DOMAIN_ENGINE: WSAStartup errors or missing WSARecvMsg.','line_number':280,'multiline':False]['text':'  Initialise Windows sockets. Note that WSAStartup can be called multiple','line_number':286,'multiline':False]['text':'  times given that WSACleanup will be called for each WSAStartup.','line_number':287,'multiline':False]['text':'  On Windows, uninitialise socket layer.','line_number':303,'multiline':False]['text':'  Shut down the OpenPGM library.','line_number':309,'multiline':False]['text':'  Windows CE does not manage security attributes','line_number':330,'multiline':False]['text':'  This function has to be in a system-wide critical section so that','line_number':343,'multiline':False]['text':'  two instances of the library don't accidentally create signaler','line_number':344,'multiline':False]['text':'  crossing the process boundary.','line_number':345,'multiline':False]['text':'  We'll use named event object to implement the critical section.','line_number':346,'multiline':False]['text':'  Note that if the event object already exists, the CreateEvent requests','line_number':347,'multiline':False]['text':'  EVENT_ALL_ACCESS access right. If this fails, we try to open','line_number':348,'multiline':False]['text':'  the event object asking for SYNCHRONIZE access only.','line_number':349,'multiline':False]['text':'  Create critical section only if using fixed signaler port','line_number':352,'multiline':False]['text':'  Use problematic Event implementation for compatibility if using old port 5905.','line_number':353,'multiline':False]['text':'  Otherwise use Mutex implementation.','line_number':354,'multiline':False]['text':'  Windows has no 'socketpair' function. CreatePipe is no good as pipe','line_number':391,'multiline':False]['text':'  handles cannot be polled on. Here we create the socketpair by hand.','line_number':392,'multiline':False]['text':'  Create listening socket.','line_number':396,'multiline':False]['text':'  Set SO_REUSEADDR and TCP_NODELAY on listening socket.','line_number':401,'multiline':False]['text':'  Init sockaddr to signaler port.','line_number':410,'multiline':False]['text':'  Create the writer socket.','line_number':417,'multiline':False]['text':'  Enter the critical section.','line_number':422,'multiline':False]['text':'  Bind listening socket to signaler port.','line_number':427,'multiline':False]['text':'  Retrieve ephemeral port number','line_number':432,'multiline':False]['text':'  Listen for incoming connections.','line_number':438,'multiline':False]['text':'  Connect writer to the listener.','line_number':443,'multiline':False]['text':'  Accept connection from writer.','line_number':449,'multiline':False]['text':'  Set TCP_NODELAY on writer socket.','line_number':451,'multiline':False]['text':'  Send/receive large chunk to work around TCP slow start','line_number':457,'multiline':False]['text':'  This code is a workaround for #1608','line_number':458,'multiline':False]['text':'  1M to overload default receive buffer','line_number':461,'multiline':False]['text':'  Save errno if error occurred in bind/listen/connect/accept.','line_number':488,'multiline':False]['text':'  We don't need the listening socket anymore. Close it.','line_number':493,'multiline':False]['text':'  Exit the critical section.','line_number':498,'multiline':False]['text':'  Release the kernel object','line_number':506,'multiline':False]['text':'  Cleanup writer if connection failed','line_number':515,'multiline':False]['text':'  Set errno from saved value','line_number':521,'multiline':False]['text':'  Setting this option result in sane behaviour when exec() functions','line_number':532,'multiline':False]['text':'  are used. Old sockets are closed and don't block TCP ports, avoid','line_number':533,'multiline':False]['text':'  leaks, etc.','line_number':534,'multiline':False]['text':' It appears that a lack of runtime AF_UNIX support','line_number':556,'multiline':False]['text':' can fail in more than one way.','line_number':557,'multiline':False]['text':' At least: open_socket can fail or later in bind','line_number':558,'multiline':False]['text':'  Create a listening socket.','line_number':561,'multiline':False]['text':'  This may happen if the library was built on a system supporting AF_UNIX, but the system running doesn't support it.','line_number':564,'multiline':False]['text':'  Initialise the address structure.','line_number':570,'multiline':False]['text':'  Bind the socket to the file path.','line_number':576,'multiline':False]['text':' if we got here, ipc should be working,','line_number':583,'multiline':False]['text':' so raise any remaining errors','line_number':584,'multiline':False]['text':'  Listen for incoming connections.','line_number':587,'multiline':False]['text':'  Create the client socket.','line_number':598,'multiline':False]['text':'  Connect to the remote peer.','line_number':605,'multiline':False]['text':'  Close the listener socket, we don't need it anymore.','line_number':615,'multiline':False]['text':'  Cleanup temporary socket file descriptor','line_number':619,'multiline':False]['text':'  Cleanup temporary socket file descriptor','line_number':642,'multiline':False]['text':' ipc failed due to lack of AF_UNIX support, fallback on tcpip','line_number':652,'multiline':False]['text':' try to fallback to TCP/IP','line_number':661,'multiline':False]['text':' TODO: maybe remember this decision permanently?','line_number':662,'multiline':False]['text':'  Whilst OpenVMS supports socketpair - it maps to AF_INET only.  Further,','line_number':668,'multiline':False]['text':'  it does not set the socket options TCP_NODELAY and TCP_NODELACK which','line_number':669,'multiline':False]['text':'  can lead to performance problems.','line_number':670,'multiline':False]['text':'','line_number':671,'multiline':False]['text':'  The bug will be fixed in V5.6 ECO4 and beyond.  In the meantime, we'll','line_number':672,'multiline':False]['text':'  create the socket pair manually.','line_number':673,'multiline':False]['text':' All other implementations support socketpair()','line_number':762,'multiline':False]['text':'  Setting this option result in sane behaviour when exec() functions','line_number':765,'multiline':False]['text':'  are used. Old sockets are closed and don't block TCP ports, avoid','line_number':766,'multiline':False]['text':'  leaks, etc.','line_number':767,'multiline':False]['text':'  On Windows, preventing sockets to be inherited by child processes.','line_number':791,'multiline':False]['text':'  If there 's no SOCK_CLOEXEC, let's try the second best option.','line_number':797,'multiline':False]['text':'  Race condition can cause socket not to be closed (if fork happens','line_number':798,'multiline':False]['text':'  between accept and this point).','line_number':799,'multiline':False]['text':'  Check whether an error occurred','line_number':819,'multiline':False]['text':'  Assert if the error was caused by 0MQ bug.','line_number':830,'multiline':False]['text':'  Networking problems are OK. No need to assert.','line_number':831,'multiline':False]['text':'  Following code should handle both Berkeley-derived socket','line_number':843,'multiline':False]['text':'  implementations and Solaris.','line_number':844,'multiline':False]['text':' TODO or use CreateDirectoryA and specify permissions?','line_number':886,'multiline':False]['text':' If TMPDIR, TEMPDIR, or TMP are available and are directories, create','line_number':904,'multiline':False]['text':' the socket directory there.','line_number':905,'multiline':False]['text':' Confirm it is actually a directory before trying to use','line_number':911,'multiline':False]['text':' Try the next environment variable','line_number':920,'multiline':False]['text':' Append a directory name','line_number':924,'multiline':False]['text':' We need room for tmp_path + trailing NUL','line_number':927,'multiline':False]['text':' Create the directory.  POSIX requires that mkdtemp() creates the','line_number':932,'multiline':False]['text':' directory with 0700 permissions, meaning the only possible race','line_number':933,'multiline':False]['text':' with socket creation could be the same user.  However, since','line_number':934,'multiline':False]['text':' each socket is created in a directory created by mkdtemp(), and','line_number':935,'multiline':False]['text':' mkdtemp() guarantees a unique directory name, there will be no','line_number':936,'multiline':False]['text':' collision.','line_number':937,'multiline':False]