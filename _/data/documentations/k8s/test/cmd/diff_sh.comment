['text':'!/usr/bin/env bash','line_number':1,'multiline':False]['text':' Copyright 2018 The Kubernetes Authors.','line_number':3,'multiline':False]['text':'','line_number':4,'multiline':False]['text':' Licensed under the Apache License, Version 2.0 (the "License");','line_number':5,'multiline':False]['text':' you may not use this file except in compliance with the License.','line_number':6,'multiline':False]['text':' You may obtain a copy of the License at','line_number':7,'multiline':False]['text':'','line_number':8,'multiline':False]['text':'     http://www.apache.org/licenses/LICENSE-2.0','line_number':9,'multiline':False]['text':'','line_number':10,'multiline':False]['text':' Unless required by applicable law or agreed to in writing, software','line_number':11,'multiline':False]['text':' distributed under the License is distributed on an "AS IS" BASIS,','line_number':12,'multiline':False]['text':' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.','line_number':13,'multiline':False]['text':' See the License for the specific language governing permissions and','line_number':14,'multiline':False]['text':' limitations under the License.','line_number':15,'multiline':False]['text':' Runs tests for kubectl diff','line_number':21,'multiline':False]['text':' Test that it works when the live object doesn't exist','line_number':29,'multiline':False]['text':' Ensure diff only dry-runs and doesn't persist change','line_number':32,'multiline':False]['text':' Make sure that diffing the resource right after returns nothing (0 exit code).','line_number':39,'multiline':False]['text':' Ensure diff only dry-runs and doesn't persist change','line_number':42,'multiline':False]['text':' Make sure that:','line_number':46,'multiline':False]['text':' 1. the exit code for diff is 1 because it found a difference','line_number':47,'multiline':False]['text':' 2. the difference contains the changed image','line_number':48,'multiline':False]['text':' 3. the output doesn't indicate this is an error','line_number':49,'multiline':False]['text':' Ensure diff only dry-runs and doesn't persist change','line_number':54,'multiline':False]['text':' Test found diff with server-side apply','line_number':58,'multiline':False]['text':' Ensure diff --server-side only dry-runs and doesn't persist change','line_number':62,'multiline':False]['text':' Test that we have a return code bigger than 1 if there is an error when diffing','line_number':66,'multiline':False]['text':' Cleanup','line_number':69,'multiline':False]['text':' Test that kubectl diff --server-side works when the live object doesn't exist','line_number':74,'multiline':False]['text':' Ensure diff --server-side only dry-runs and doesn't persist change','line_number':77,'multiline':False]['text':' Server-side apply the Pod','line_number':80,'multiline':False]['text':' Make sure that --server-side diffing the resource right after returns nothing (0 exit code).','line_number':84,'multiline':False]['text':' Make sure that for kubectl diff --server-side:','line_number':87,'multiline':False]['text':' 1. the exit code for diff is 1 because it found a difference','line_number':88,'multiline':False]['text':' 2. the difference contains the changed image','line_number':89,'multiline':False]['text':'# kubectl diff --prune','line_number':93,'multiline':False]['text':' Make sure that kubectl diff does not return pod 'a' without prune flag','line_number':97,'multiline':False]['text':' Make sure that for kubectl diff --prune:','line_number':100,'multiline':False]['text':' 1. the exit code for diff is 1 because it found a difference','line_number':101,'multiline':False]['text':' 2. the difference contains the pruned pod','line_number':102,'multiline':False]['text':' pod 'a' should be in output, it is pruned','line_number':104,'multiline':False]['text':' apply b with namespace','line_number':106,'multiline':False]['text':' check right pod exists and wrong pod doesn't exist','line_number':108,'multiline':False]['text':' Make sure that diff --prune returns nothing (0 exit code) for 'b'.','line_number':110,'multiline':False]['text':' Cleanup','line_number':113,'multiline':False]['text':'# kubectl diff --prune with label selector','line_number':118,'multiline':False]['text':' Make sure that kubectl diff does not return either pod 'b' or pod 'c' without prune flag','line_number':160,'multiline':False]['text':' the exit code for diff is 1 because pod 'b' is found in the given label selector but not 'c'','line_number':190,'multiline':False]['text':' pod 'b' should be in output, it is pruned. On the other hand, 'c' should not be, it's label selector is different','line_number':192,'multiline':False]['text':' Cleanup','line_number':196,'multiline':False]