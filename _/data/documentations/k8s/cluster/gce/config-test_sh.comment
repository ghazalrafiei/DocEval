['text':'!/usr/bin/env bash','line_number':1,'multiline':False]['text':' Copyright 2014 The Kubernetes Authors.','line_number':3,'multiline':False]['text':'','line_number':4,'multiline':False]['text':' Licensed under the Apache License, Version 2.0 (the "License");','line_number':5,'multiline':False]['text':' you may not use this file except in compliance with the License.','line_number':6,'multiline':False]['text':' You may obtain a copy of the License at','line_number':7,'multiline':False]['text':'','line_number':8,'multiline':False]['text':'     http://www.apache.org/licenses/LICENSE-2.0','line_number':9,'multiline':False]['text':'','line_number':10,'multiline':False]['text':' Unless required by applicable law or agreed to in writing, software','line_number':11,'multiline':False]['text':' distributed under the License is distributed on an "AS IS" BASIS,','line_number':12,'multiline':False]['text':' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.','line_number':13,'multiline':False]['text':' See the License for the specific language governing permissions and','line_number':14,'multiline':False]['text':' limitations under the License.','line_number':15,'multiline':False]['text':' TODO(jbeda): Provide a way to override project','line_number':17,'multiline':False]['text':' gcloud multiplexing for shared GCE/GKE tests.','line_number':18,'multiline':False]['text':' Specifying KUBE_GCE_API_ENDPOINT will override the default GCE Compute API endpoint (https://www.googleapis.com/compute/v1/).','line_number':22,'multiline':False]['text':' This endpoint has to be pointing to v1 api. For example, https://www.googleapis.com/compute/staging_v1/','line_number':23,'multiline':False]['text':' TODO: Migrate to e2-standard machine family.','line_number':29,'multiline':False]['text':' TODO: Migrate to e2-standard machine family.','line_number':33,'multiline':False]['text':' To allow choosing better architectures.','line_number':35,'multiline':False]['text':' Turning GRPC based Konnectivity testing on id advance of','line_number':45,'multiline':False]['text':' removing the SSHTunnel code.','line_number':46,'multiline':False]['text':' KUBE_CREATE_NODES can be used to avoid creating nodes, while master will be sized for NUM_NODES nodes.','line_number':53,'multiline':False]['text':' Firewalls and node templates are still created.','line_number':54,'multiline':False]['text':' An extension to local SSDs allowing users to specify block/fs and SCSI/NVMe devices','line_number':57,'multiline':False]['text':' Format of this variable will be "#,scsi/nvme,block/fs" you can specify multiple','line_number':58,'multiline':False]['text':' configurations by separating them by a semi-colon ex. "2,scsi,fs;1,nvme,block"','line_number':59,'multiline':False]['text':' is a request for 2 SCSI formatted and mounted SSDs and 1 NVMe block device SSD.','line_number':60,'multiline':False]['text':' Increase initial delay for the apiserver liveness probe, to avoid prematurely tearing it down','line_number':65,'multiline':False]['text':' Also increase the initial delay for etcd just to be safe','line_number':67,'multiline':False]['text':' GPUs supported in GCE do not have compatible drivers in Debian 7.','line_number':88,'multiline':False]['text':' To avoid failing large tests due to some flakes in starting nodes, allow','line_number':93,'multiline':False]['text':' for a small percentage of nodes to not start during cluster startup.','line_number':94,'multiline':False]['text':' By default a cluster will be started with the master and nodes','line_number':97,'multiline':False]['text':' on Container-optimized OS (cos, previously known as gci). If','line_number':98,'multiline':False]['text':' you are updating the os image versions, update this variable.','line_number':99,'multiline':False]['text':' Also please update corresponding image for node e2e at:','line_number':100,'multiline':False]['text':' https://github.com/kubernetes/kubernetes/blob/master/test/e2e_node/jenkins/image-config.yaml','line_number':101,'multiline':False]['text':'','line_number':102,'multiline':False]['text':' By default, the latest image from the image family will be used unless an','line_number':103,'multiline':False]['text':' explicit image will be set.','line_number':104,'multiline':False]['text':' Ability to inject custom versions (Ubuntu OS images ONLY)','line_number':123,'multiline':False]['text':' if KUBE_UBUNTU_INSTALL_CONTAINERD_VERSION or KUBE_UBUNTU_INSTALL_RUNC_VERSION','line_number':124,'multiline':False]['text':' is set to empty then we do not override the version(s) and just','line_number':125,'multiline':False]['text':' use whatever is in the default installation of containerd package','line_number':126,'multiline':False]['text':' MASTER_EXTRA_METADATA is the extra instance metadata on master instance separated by commas.','line_number':130,'multiline':False]['text':' MASTER_EXTRA_METADATA is the extra instance metadata on node instance separated by commas.','line_number':132,'multiline':False]['text':' NODE_IP_RANGE is used when ENABLE_IP_ALIASES=true or CREATE_CUSTOM_NETWORK=true.','line_number':149,'multiline':False]['text':' It is the primary range in the subnet and is the range used for node instance IPs.','line_number':150,'multiline':False]['text':' By default disable gkenetworkparamset controller in CCM','line_number':160,'multiline':False]['text':' Optional: set feature gates','line_number':163,'multiline':False]['text':' shellcheck disable=SC2034 # Variables sourced in other scripts.','line_number':164,'multiline':False]['text':' Extra docker options for nodes.','line_number':169,'multiline':False]['text':' Enable the docker debug mode.','line_number':172,'multiline':False]['text':' formerly PORTAL_NET','line_number':175,'multiline':False]['text':' When set to true, Docker Cache is enabled by default as part of the cluster bring up.','line_number':177,'multiline':False]['text':' Optional: Deploy a L7 loadbalancer controller to fulfill Ingress requests:','line_number':180,'multiline':False]['text':'   glbc           - CE L7 Load Balancer Controller','line_number':181,'multiline':False]['text':' Optional: Enable Metrics Server. Metrics Server should be enable everywhere,','line_number':184,'multiline':False]['text':' since it's a critical component, but in the first release we need a way to disable','line_number':185,'multiline':False]['text':' this in case of stability issues.','line_number':186,'multiline':False]['text':' TODO(piosz) remove this option once Metrics Server became a stable thing.','line_number':187,'multiline':False]['text':' Optional: Metadata agent to setup as part of the cluster bring up:','line_number':190,'multiline':False]['text':'   none        - No metadata agent','line_number':191,'multiline':False]['text':'   stackdriver - Stackdriver metadata agent','line_number':192,'multiline':False]['text':' Metadata agent is a daemon set that provides metadata of kubernetes objects','line_number':193,'multiline':False]['text':' running on the same node for exporting metrics and logs.','line_number':194,'multiline':False]['text':' One special node out of NUM_NODES would be created of this type if specified.','line_number':197,'multiline':False]['text':' Useful for scheduling heapster in large clusters with nodes of small size.','line_number':198,'multiline':False]['text':' Optional: Additional nodes would be created if their type and number is specified.','line_number':201,'multiline':False]['text':' NUM_NODES would be lowered respectively.','line_number':202,'multiline':False]['text':' Useful for running cluster-level addons that needs more resources than would fit','line_number':203,'multiline':False]['text':' on small nodes, like network plugins.','line_number':204,'multiline':False]['text':' Set etcd image (e.g. registry.k8s.io/etcd) and version (e.g. v3.5.1-0) if you need','line_number':208,'multiline':False]['text':' non-default version.','line_number':209,'multiline':False]['text':' Default Log level for all components in test clusters and variables to override it in specific components.','line_number':214,'multiline':False]['text':' ContentType used by all components to communicate with apiserver.','line_number':229,'multiline':False]['text':' Enable debug handlers (port forwarding, exec, container logs, etc.).','line_number':232,'multiline':False]['text':' NON_MASTER_NODE_LABELS are labels will only be applied on non-master nodes.','line_number':249,'multiline':False]['text':' Optional: Enable netd.','line_number':261,'multiline':False]['text':' To avoid running netd on a node that is not configured appropriately,','line_number':267,'multiline':False]['text':' label each Node so that the DaemonSet can run the Pods only on ready Nodes.','line_number':268,'multiline':False]['text':' Windows nodes do not support netd.','line_number':269,'multiline':False]['text':' To avoid running Calico on a node that is not configured appropriately,','line_number':276,'multiline':False]['text':' label each Node so that the DaemonSet can run the Pods only on ready Nodes.','line_number':277,'multiline':False]['text':' Windows nodes do not support Calico.','line_number':278,'multiline':False]['text':' Enable metadata concealment by firewalling pod traffic to the metadata server','line_number':283,'multiline':False]['text':' and run a proxy daemonset on nodes.','line_number':284,'multiline':False]['text':' true, false','line_number':285,'multiline':False]['text':' true, false','line_number':286,'multiline':False]['text':' Put the necessary label on the node so the daemonset gets scheduled.','line_number':288,'multiline':False]['text':' Add to the provider custom variables.','line_number':290,'multiline':False]['text':' Optional: Enable node logging.','line_number':294,'multiline':False]['text':' options: gcp','line_number':296,'multiline':False]['text':' Optional: When set to true, Elasticsearch and Kibana will be setup as part of the cluster bring up.','line_number':298,'multiline':False]['text':' Optional: Don't require https for registries in our local RFC1918 network','line_number':302,'multiline':False]['text':' List of the set of feature gates recognized by the GCP CCM','line_number':313,'multiline':False]['text':' Optional: Install cluster DNS.','line_number':316,'multiline':False]['text':' Set CLUSTER_DNS_CORE_DNS to 'false' to install kube-dns instead of CoreDNS.','line_number':317,'multiline':False]['text':' Optional: Enable DNS horizontal autoscaler','line_number':325,'multiline':False]['text':' Optional: Install node problem detector.','line_number':328,'multiline':False]['text':'   none           - Not run node problem detector.','line_number':329,'multiline':False]['text':'   daemonset      - Run node problem detector as daemonset.','line_number':330,'multiline':False]['text':'   standalone     - Run node problem detector as standalone system daemon.','line_number':331,'multiline':False]['text':' Optional: Create autoscaler for cluster's nodes.','line_number':342,'multiline':False]['text':' Optional: Enable allocation of pod IPs using IP aliases.','line_number':351,'multiline':False]['text':'','line_number':352,'multiline':False]['text':' BETA FEATURE.','line_number':353,'multiline':False]['text':'','line_number':354,'multiline':False]['text':' IP_ALIAS_SIZE is the size of the podCIDR allocated to a node.','line_number':355,'multiline':False]['text':' IP_ALIAS_SUBNETWORK is the subnetwork to allocate from. If empty, a','line_number':356,'multiline':False]['text':'   new subnetwork will be created for the cluster.','line_number':357,'multiline':False]['text':' Number of Pods that can run on this node.','line_number':361,'multiline':False]['text':' Size of ranges allocated to each node.','line_number':363,'multiline':False]['text':' If we're using custom network, use the subnet we already create for it as the one for ip-alias.','line_number':366,'multiline':False]['text':' Note that this means SUBNETWORK would override KUBE_GCE_IP_ALIAS_SUBNETWORK in case of custom network.','line_number':367,'multiline':False]['text':' Reserve the services IP space to avoid being allocated for other GCP resources.','line_number':373,'multiline':False]['text':' Add to the provider custom variables.','line_number':377,'multiline':False]['text':' Should not have MAX_PODS_PER_NODE set for route-based clusters.','line_number':383,'multiline':False]['text':' Enable GCE Alpha features.','line_number':393,'multiline':False]['text':' Disable Docker live-restore.','line_number':398,'multiline':False]['text':' Override default GLBC image','line_number':403,'multiline':False]['text':' ResourceQuota must come last, or a creation is recorded, but the pod may be forbidden.','line_number':411,'multiline':False]['text':' Optional: if set to true kube-up will automatically check for existing resources and clean them up.','line_number':419,'multiline':False]['text':' Optional: setting it to true denotes this is a testing cluster,','line_number':422,'multiline':False]['text':' so that we can use pulled kubernetes binaries, even if binaries','line_number':423,'multiline':False]['text':' are pre-installed in the image. Note that currently this logic','line_number':424,'multiline':False]['text':' is only supported in trusty or GCI.','line_number':425,'multiline':False]['text':' Storage backend. 'etcd2' and 'etcd3' are supported.','line_number':428,'multiline':False]['text':' Storage media type: application/json and application/vnd.kubernetes.protobuf are supported.','line_number':430,'multiline':False]['text':' none, kubenet','line_number':433,'multiline':False]['text':' Network Policy plugin specific settings.','line_number':435,'multiline':False]['text':' calico','line_number':436,'multiline':False]['text':' How should the kubelet configure hairpin mode?','line_number':440,'multiline':False]['text':' promiscuous-bridge, hairpin-veth, none','line_number':441,'multiline':False]['text':' Optional: if set to true, kube-up will configure the cluster to run e2e tests.','line_number':443,'multiline':False]['text':' Evict pods whenever compute resource availability on the nodes gets below a threshold.','line_number':446,'multiline':False]['text':' Optional: custom scheduling algorithm','line_number':449,'multiline':False]['text':' Optional: install a default StorageClass','line_number':452,'multiline':False]['text':' Optional: install volume snapshot CRDs','line_number':455,'multiline':False]['text':' Optional: Enable legacy ABAC policy that makes all service accounts superusers.','line_number':458,'multiline':False]['text':' Disabling this by default in tests ensures default RBAC policies are sufficient from 1.6+','line_number':459,'multiline':False]['text':' Upgrade test jobs that go from a version < 1.6 to a version >= 1.6 should override this to be true.','line_number':460,'multiline':False]['text':' true, false','line_number':461,'multiline':False]['text':' Enable a simple "AdvancedAuditing" setup for testing.','line_number':463,'multiline':False]['text':' true, false','line_number':464,'multiline':False]['text':' batch, blocking','line_number':465,'multiline':False]['text':' Optional: Enable log rotation for k8s services','line_number':469,'multiline':False]['text':' Optional: Enable log rotation for pod logs','line_number':479,'multiline':False]['text':' Fluentd requirements','line_number':491,'multiline':False]['text':' YAML exists to trigger a configuration refresh when changes are made.','line_number':492,'multiline':False]['text':' Heapster requirements','line_number':499,'multiline':False]['text':' Default Stackdriver resources version exported by Fluentd-gcp addon','line_number':505,'multiline':False]['text':' Adding to PROVIDER_VARS, since this is GCP-specific.','line_number':508,'multiline':False]['text':' Fluentd configuration for node-journal','line_number':511,'multiline':False]['text':' prometheus-to-sd configuration','line_number':514,'multiline':False]['text':' TODO(#51292): Make kube-proxy Daemonset default and remove the configuration here.','line_number':519,'multiline':False]['text':' Optional: [Experiment Only] Run kube-proxy as a DaemonSet if set to true, run as static pods otherwise.','line_number':520,'multiline':False]['text':' true, false','line_number':521,'multiline':False]['text':' Control whether the startup scripts manage the lifecycle of kube-proxy','line_number':523,'multiline':False]['text':' When true, the startup scripts do not enable kube-proxy either as a daemonset addon or as a static pod','line_number':524,'multiline':False]['text':' regardless of the value of KUBE_PROXY_DAEMONSET.','line_number':525,'multiline':False]['text':' When false, the value of KUBE_PROXY_DAEMONSET controls whether kube-proxy comes up as a static pod or','line_number':526,'multiline':False]['text':' as an addon daemonset.','line_number':527,'multiline':False]['text':' true, false','line_number':528,'multiline':False]['text':' Optional: Change the kube-proxy implementation. Choices are [iptables, ipvs].','line_number':530,'multiline':False]['text':' Will be passed into the kube-proxy via `--detect-local-mode`','line_number':533,'multiline':False]['text':' Optional: duration of cluster signed certificates.','line_number':536,'multiline':False]['text':' Optional: enable certificate rotation of the kubelet certificates.','line_number':539,'multiline':False]['text':' The number of services that are allowed to sync concurrently. Will be passed','line_number':542,'multiline':False]['text':' into kube-controller-manager via `--concurrent-service-syncs`','line_number':543,'multiline':False]['text':' The value kubernetes.default.svc.cluster.local is only usable for full','line_number':546,'multiline':False]['text':' OIDC discovery flows in Pods in the same cluster. For some providers','line_number':547,'multiline':False]['text':' with configurations that support non-traditional KSA authentication methods,','line_number':548,'multiline':False]['text':' this value may make sense, but if the expectation is traditional OIDC, don't','line_number':549,'multiline':False]['text':' use this value in production. If you do use it, the FQDN is preferred to','line_number':550,'multiline':False]['text':' kubernetes.default.svc, to avoid something outside the cluster attempting','line_number':551,'multiline':False]['text':' to resolve the partially qualified name.','line_number':552,'multiline':False]['text':' Taint Windows nodes by default to prevent Linux workloads from being','line_number':555,'multiline':False]['text':' scheduled onto them.','line_number':556,'multiline':False]['text':' Whether to set up a private GCE cluster, i.e. a cluster where nodes have only private IPs.','line_number':559,'multiline':False]['text':' Optoinal: Enable Windows CSI-Proxy','line_number':567,'multiline':False]['text':' KUBE_APISERVER_HEALTHCHECK_ON_HOST_IP decides whether','line_number':570,'multiline':False]['text':' kube-apiserver is healthchecked on host IP instead of 127.0.0.1.','line_number':571,'multiline':False]['text':' ETCD_PROGRESS_NOTIFY_INTERVAL defines the interval for etcd watch progress notify events.','line_number':574,'multiline':False]['text':' Optional: Install Pigz on Windows.','line_number':577,'multiline':False]['text':' Pigz is a multi-core optimized version of unzip.exe.','line_number':578,'multiline':False]['text':' It improves container image pull performance since most time is spent','line_number':579,'multiline':False]['text':' unzipping the image layers to disk.','line_number':580,'multiline':False]['text':' Enable Windows DSR (Direct Server Return)','line_number':583,'multiline':False]['text':' Install Node Problem Detector (NPD) on Windows nodes.','line_number':586,'multiline':False]['text':' NPD analyzes the host for problems that can disrupt workloads.','line_number':587,'multiline':False]['text':' TLS_CIPHER_SUITES defines cipher suites allowed to be used by kube-apiserver.','line_number':591,'multiline':False]['text':' If this variable is unset or empty, kube-apiserver will allow its default set of cipher suites.','line_number':592,'multiline':False]['text':' CLOUD_PROVIDER_FLAG defines the cloud-provider value presented to KCM, apiserver,','line_number':595,'multiline':False]['text':' and kubelet','line_number':596,'multiline':False]['text':' Don't run the node-ipam-controller on the KCM if cloud-provider external','line_number':599,'multiline':False]['text':' When ENABLE_AUTH_PROVIDER_GCP is set, following flags for out-of-tree credential provider for GCP','line_number':604,'multiline':False]['text':' are presented to kubelet:','line_number':605,'multiline':False]['text':' --image-credential-provider-config=${path-to-config}','line_number':606,'multiline':False]['text':' --image-credential-provider-bin-dir=${path-to-auth-provider-binary}','line_number':607,'multiline':False]['text':' Also, it is required that DisableKubeletCloudCredentialProviders and KubeletCredentialProviders','line_number':608,'multiline':False]['text':' feature gates are set to true for kubelet to use external credential provider.','line_number':609,'multiline':False]