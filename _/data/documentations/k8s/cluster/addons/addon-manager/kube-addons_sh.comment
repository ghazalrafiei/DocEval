['text':'!/usr/bin/env bash','line_number':1,'multiline':False]['text':' Copyright 2014 The Kubernetes Authors.','line_number':3,'multiline':False]['text':'','line_number':4,'multiline':False]['text':' Licensed under the Apache License, Version 2.0 (the "License");','line_number':5,'multiline':False]['text':' you may not use this file except in compliance with the License.','line_number':6,'multiline':False]['text':' You may obtain a copy of the License at','line_number':7,'multiline':False]['text':'','line_number':8,'multiline':False]['text':'     http://www.apache.org/licenses/LICENSE-2.0','line_number':9,'multiline':False]['text':'','line_number':10,'multiline':False]['text':' Unless required by applicable law or agreed to in writing, software','line_number':11,'multiline':False]['text':' distributed under the License is distributed on an "AS IS" BASIS,','line_number':12,'multiline':False]['text':' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.','line_number':13,'multiline':False]['text':' See the License for the specific language governing permissions and','line_number':14,'multiline':False]['text':' limitations under the License.','line_number':15,'multiline':False]['text':' LIMITATIONS','line_number':17,'multiline':False]['text':' 1. Exit code is probably not always correct.','line_number':18,'multiline':False]['text':' 2. There are no unittests.','line_number':19,'multiline':False]['text':' 3. Will not work if the total length of paths to addons is greater than','line_number':20,'multiline':False]['text':'    bash can handle. Probably it is not a problem: ARG_MAX=2097152 on GCE.','line_number':21,'multiline':False]['text':' cosmetic improvements to be done','line_number':23,'multiline':False]['text':' 1. Improve the log function; add timestamp, file name, etc.','line_number':24,'multiline':False]['text':' 2. Logging doesn't work from files that print things out.','line_number':25,'multiline':False]['text':' 3. Kubectl prints the output to stderr (the output should be captured and then','line_number':26,'multiline':False]['text':'    logged)','line_number':27,'multiline':False]['text':' KUBECTL_PRUNE_WHITELIST is a list of resources whitelisted by default.','line_number':31,'multiline':False]['text':' This is currently the same with the default in:','line_number':32,'multiline':False]['text':' https://github.com/kubernetes/kubectl/blob/master/pkg/cmd/apply/prune.go.','line_number':33,'multiline':False]['text':' To override the default list with other values, set','line_number':34,'multiline':False]['text':' KUBECTL_PRUNE_WHITELIST_OVERRIDE environment variable to space-separated','line_number':35,'multiline':False]['text':' names of resources to whitelist.','line_number':36,'multiline':False]['text':' This variable is unused in this file, but not in those that source it.','line_number':60,'multiline':False]['text':' shellcheck disable=SC2034','line_number':61,'multiline':False]['text':' This variable is unused in this file, but not in those that source it.','line_number':65,'multiline':False]['text':' shellcheck disable=SC2034','line_number':66,'multiline':False]['text':' Addons could use this label with two modes:','line_number':69,'multiline':False]['text':' - ADDON_MANAGER_LABEL=Reconcile','line_number':70,'multiline':False]['text':' - ADDON_MANAGER_LABEL=EnsureExists','line_number':71,'multiline':False]['text':' This label is deprecated (only for Addon Manager). In future release','line_number':73,'multiline':False]['text':' addon-manager may not respect it anymore. Addons with','line_number':74,'multiline':False]['text':' CLUSTER_SERVICE_LABEL=true and without ADDON_MANAGER_LABEL=EnsureExists','line_number':75,'multiline':False]['text':' will be reconciled for now.','line_number':76,'multiline':False]['text':' Whether only one addon manager should be running in a multi-master setup.','line_number':79,'multiline':False]['text':' Disabling this flag will force all addon managers to assume they are the','line_number':80,'multiline':False]['text':' leaders.','line_number':81,'multiline':False]['text':' Remember that you can't log from functions that print some output (because','line_number':84,'multiline':False]['text':' logs are also printed on stdout).','line_number':85,'multiline':False]['text':' $1 level','line_number':86,'multiline':False]['text':' $2 message','line_number':87,'multiline':False]['text':' manage log levels manually here','line_number':89,'multiline':False]['text':' add the timestamp if you find it useful','line_number':91,'multiline':False]['text':'        echo "$1: $2"','line_number':94,'multiline':False]['text':'        echo "$1: $2"','line_number':97,'multiline':False]['text':'        echo "$1: $2"','line_number':100,'multiline':False]['text':' Generate kubectl prune-allowlist flags from provided resource list.','line_number':117,'multiline':False]['text':' Check if $resource isn't composed just of whitespaces by replacing ' '','line_number':121,'multiline':False]['text':' with '' and checking whether the resulting string is not empty.','line_number':122,'multiline':False]['text':' KUBECTL_EXTRA_PRUNE_WHITELIST is a list of extra allowed resources','line_number':129,'multiline':False]['text':' besides the default ones.','line_number':130,'multiline':False]['text':' $1 filename of addon to start.','line_number':140,'multiline':False]['text':' $2 count of tries to start the addon.','line_number':141,'multiline':False]['text':' $3 delay in seconds between two consecutive tries','line_number':142,'multiline':False]['text':' $4 namespace','line_number':143,'multiline':False]['text':' $1 string with json or yaml.','line_number':153,'multiline':False]['text':' $2 count of tries to start the addon.','line_number':154,'multiline':False]['text':' $3 delay in seconds between two consecutive tries','line_number':155,'multiline':False]['text':' $4 name of this object to use when logging about it.','line_number':156,'multiline':False]['text':' $5 namespace for this object','line_number':157,'multiline':False]['text':' Creates resources with addon mode Reconcile for create_resource_from_string.','line_number':175,'multiline':False]['text':' Does not perform pruning.','line_number':176,'multiline':False]['text':' $1 string with json or yaml.','line_number':177,'multiline':False]['text':' $2 name of this object for logging','line_number':178,'multiline':False]['text':' $3 namespace for the object','line_number':179,'multiline':False]['text':' kubectl_output must be declared ahead of time to allow capturing kubectl's exit code and not local's exit code.','line_number':185,'multiline':False]['text':' shellcheck disable=SC2086','line_number':187,'multiline':False]['text':' Disabling because "${KUBECTL_OPTS}" needs to allow for expansion here','line_number':188,'multiline':False]['text':' Nothing to do.','line_number':194,'multiline':False]['text':' for visibility of errors','line_number':197,'multiline':False]['text':' Creates resources with addon mode EnsureExists for create_resource_from_string.','line_number':201,'multiline':False]['text':' Does not perform pruning.','line_number':202,'multiline':False]['text':' $1 string with json or yaml.','line_number':203,'multiline':False]['text':' $2 name of this object for logging','line_number':204,'multiline':False]['text':' $3 namespace for the object','line_number':205,'multiline':False]['text':' Resources that are set to the addon mode EnsureExists should not be overwritten if they already exist.','line_number':211,'multiline':False]['text':' shellcheck disable=SC2086','line_number':213,'multiline':False]['text':' Disabling because "${KUBECTL_OPTS}" needs to allow for expansion here','line_number':214,'multiline':False]['text':' Detect an already exists failure for creating EnsureExists resources.','line_number':219,'multiline':False]['text':' All other errors should result in a retry.','line_number':220,'multiline':False]['text':' Nothing to do.','line_number':225,'multiline':False]['text':' for visibility of errors','line_number':228,'multiline':False]['text':' TODO: Remove the first command in future release.','line_number':233,'multiline':False]['text':' Adding this for backward compatibility. Old addons have CLUSTER_SERVICE_LABEL=true and don't have','line_number':234,'multiline':False]['text':' ADDON_MANAGER_LABEL=EnsureExists will still be reconciled.','line_number':235,'multiline':False]['text':' Filter out `configured` message to not noisily log.','line_number':236,'multiline':False]['text':' `created`, `pruned` and errors will be logged.','line_number':237,'multiline':False]['text':' shellcheck disable=SC2086','line_number':239,'multiline':False]['text':' Disabling because "${KUBECTL_OPTS}" needs to allow for expansion here','line_number':240,'multiline':False]['text':' shellcheck disable=SC2086','line_number':246,'multiline':False]['text':' Disabling because "${KUBECTL_OPTS}" needs to allow for expansion here','line_number':247,'multiline':False]['text':' Create objects already exist should fail.','line_number':256,'multiline':False]['text':' Filter out `AlreadyExists` message to not noisily log.','line_number':257,'multiline':False]['text':' shellcheck disable=SC2086','line_number':258,'multiline':False]['text':' Disabling because "${KUBECTL_OPTS}" needs to allow for expansion here','line_number':259,'multiline':False]['text':' In multi-master setup, only one addon manager should be running. We use','line_number':267,'multiline':False]['text':' existing leader election in kube-controller-manager instead of implementing','line_number':268,'multiline':False]['text':' a separate mechanism here.','line_number':269,'multiline':False]['text':' shellcheck disable=SC2086','line_number':274,'multiline':False]['text':' Disabling because "${KUBECTL_OPTS}" needs to allow for expansion here','line_number':275,'multiline':False]