['text':'
Copyright 2017 The Kubernetes Authors.

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
','line_number':1,'multiline':True]['text':' StaticEstimatedCostLimit represents the largest-allowed static CEL cost on a per-expression basis.','line_number':58,'multiline':False]['text':' StaticEstimatedCRDCostLimit represents the largest-allowed total cost for the x-kubernetes-validations rules of a CRD.','line_number':60,'multiline':False]['text':' ValidateCustomResourceDefinition statically validates','line_number':71,'multiline':False]['text':' context is passed for supporting context cancellation during cel validation when validating defaults','line_number':72,'multiline':False]['text':' validationOptions groups several validation options, to avoid passing multiple bool parameters to methods','line_number':105,'multiline':False]['text':' allowDefaults permits the validation schema to contain default attributes','line_number':107,'multiline':False]['text':' disallowDefaultsReason gives a reason as to why allowDefaults is false (for better user feedback)','line_number':109,'multiline':False]['text':' requireRecognizedConversionReviewVersion requires accepted webhook conversion versions to contain a recognized version','line_number':111,'multiline':False]['text':' requireImmutableNames disables changing spec.names','line_number':113,'multiline':False]['text':' requireOpenAPISchema requires an openapi V3 schema be specified','line_number':115,'multiline':False]['text':' requireValidPropertyType requires property types specified in the validation schema to be valid openapi v3 types','line_number':117,'multiline':False]['text':' requireStructuralSchema indicates that any schemas present must be structural','line_number':119,'multiline':False]['text':' requirePrunedDefaults indicates that defaults must be pruned','line_number':121,'multiline':False]['text':' requireAtomicSetType indicates that the items type for a x-kubernetes-list-type=set list must be atomic.','line_number':123,'multiline':False]['text':' requireMapListKeysMapSetValidation indicates that:','line_number':125,'multiline':False]['text':' 1. For x-kubernetes-list-type=map list, key fields are not nullable, and are required or have a default','line_number':126,'multiline':False]['text':' 2. For x-kubernetes-list-type=map or x-kubernetes-list-type=set list, the whole item must not be nullable.','line_number':127,'multiline':False]['text':' preexistingExpressions tracks which CEL expressions existed in an object before an update. May be nil for create.','line_number':129,'multiline':False]['text':' versionsWithUnchangedSchemas tracks schemas of which versions are unchanged when updating a CRD.','line_number':131,'multiline':False]['text':' Does not apply to creation or deletion.','line_number':132,'multiline':False]['text':' Some checks use this to avoid rejecting previously accepted versions due to a control plane upgrade/downgrade.','line_number':133,'multiline':False]['text':' suppressPerExpressionCost indicates whether CEL per-expression cost limit should be suppressed.','line_number':135,'multiline':False]['text':' It will be automatically set during Versions validation if the version is in versionsWithUnchangedSchemas.','line_number':136,'multiline':False]['text':' findVersionsWithUnchangedSchemas finds each version that is in the new CRD object and differs from that of the old CRD object.','line_number':186,'multiline':False]['text':' It returns a set of the names of mutated versions.','line_number':187,'multiline':False]['text':' This function does not check for duplicated versions, top-level version not in versions, or coexistence of','line_number':188,'multiline':False]['text':' top-level and per-version schemas, as further validations will check for these problems.','line_number':189,'multiline':False]['text':' suppressExpressionCostForUnchangedSchema returns a copy of opts with suppressPerExpressionCost set to true if','line_number':208,'multiline':False]['text':' the specified version's schema is unchanged.','line_number':209,'multiline':False]['text':' ValidateCustomResourceDefinitionUpdate statically validates','line_number':217,'multiline':False]['text':' context is passed for supporting context cancellation during cel validation when validating defaults','line_number':218,'multiline':False]['text':' ValidateCustomResourceDefinitionStoredVersions statically validates','line_number':247,'multiline':False]['text':' ValidateUpdateCustomResourceDefinitionStatus statically validates','line_number':274,'multiline':False]['text':' validateCustomResourceDefinitionVersion statically validates.','line_number':281,'multiline':False]['text':' context is passed for supporting context cancellation during cel validation when validating defaults','line_number':282,'multiline':False]['text':' context is passed for supporting context cancellation during cel validation when validating defaults','line_number':327,'multiline':False]['text':' enabling pruning requires structural schemas','line_number':341,'multiline':False]['text':' check that either a global schema or versioned schemas are set in all versions','line_number':347,'multiline':False]['text':' check that either a global schema or versioned schemas are set in served versions','line_number':356,'multiline':False]['text':' The top-level and per-version fields are mutual exclusive','line_number':395,'multiline':False]['text':' Per-version fields may not all be set to identical values (top-level field should be used instead)','line_number':406,'multiline':False]['text':' in addition to the basic name restrictions, some names are required for spec, but not for status','line_number':432,'multiline':False]['text':' AcceptedConversionReviewVersions contains the list of ConversionReview versions the *prior* version of the API server understands.','line_number':479,'multiline':False]['text':' 1.15: server understands v1beta1; accepted versions are ["v1beta1"]','line_number':480,'multiline':False]['text':' 1.16: server understands v1, v1beta1; accepted versions are ["v1beta1"]','line_number':481,'multiline':False]['text':' 1.17+: server understands v1, v1beta1; accepted versions are ["v1","v1beta1"]','line_number':482,'multiline':False]['text':' hasValidConversionReviewVersion return true if there is a valid version or if the list is empty.','line_number':519,'multiline':False]['text':' ValidateCustomResourceConversion statically validates','line_number':532,'multiline':False]['text':' validateCustomResourceDefinitionSpecUpdate statically validates','line_number':569,'multiline':False]['text':' context is passed for supporting context cancellation during cel validation when validating defaults','line_number':570,'multiline':False]['text':' these effect the storage and cannot be changed therefore','line_number':575,'multiline':False]['text':' these affects the resource name, which is always immutable, so this can't be updated.','line_number':580,'multiline':False]['text':' getSubresourcesForVersion returns the subresources for given version in given CRD spec.','line_number':587,'multiline':False]['text':' NOTE That this function assumes version always exist since it's used by the validation process','line_number':588,'multiline':False]['text':' that iterates through the existing versions.','line_number':589,'multiline':False]['text':' hasAnyStatusEnabled returns true if given CRD spec has at least one Status Subresource set','line_number':602,'multiline':False]['text':' among the top-level and per-version Subresources.','line_number':603,'multiline':False]['text':' hasStatusEnabled returns true if given CRD Subresources has non-nil Status set.','line_number':616,'multiline':False]['text':' hasPerVersionSchema returns true if a CRD uses per-version schema.','line_number':624,'multiline':False]['text':' hasPerVersionSubresources returns true if a CRD uses per-version subresources.','line_number':634,'multiline':False]['text':' hasPerVersionColumns returns true if a CRD uses per-version columns.','line_number':644,'multiline':False]['text':' hasIdenticalPerVersionSchema returns true if a CRD sets identical non-nil values','line_number':654,'multiline':False]['text':' to all per-version schemas','line_number':655,'multiline':False]['text':' hasIdenticalPerVersionSubresources returns true if a CRD sets identical non-nil values','line_number':669,'multiline':False]['text':' to all per-version subresources','line_number':670,'multiline':False]['text':' hasIdenticalPerVersionColumns returns true if a CRD sets identical non-nil values','line_number':684,'multiline':False]['text':' to all per-version columns','line_number':685,'multiline':False]['text':' ValidateCustomResourceDefinitionStatus statically validates','line_number':699,'multiline':False]['text':' ValidateCustomResourceDefinitionNames statically validates','line_number':706,'multiline':False]['text':' kind and listKind may not be the same or parsing become ambiguous','line_number':728,'multiline':False]['text':' ValidateCustomResourceColumnDefinition statically validates a printer column.','line_number':742,'multiline':False]['text':' specStandardValidator applies validations for different OpenAPI specification versions.','line_number':769,'multiline':False]['text':' insideResourceMeta returns true when validating either TypeMeta or ObjectMeta, from an embedded resource or on the top-level.','line_number':774,'multiline':False]['text':' forbidOldSelfValidations returns the path to the first ancestor of the visited path that can't be safely correlated between two revisions of an object, or nil if there is no such path','line_number':778,'multiline':False]['text':' validateCustomResourceDefinitionValidation statically validates','line_number':783,'multiline':False]['text':' context is passed for supporting context cancellation during cel validation when validating defaults','line_number':784,'multiline':False]['text':' if the status subresource is enabled, only certain fields are allowed inside the root schema.','line_number':793,'multiline':False]['text':' these fields are chosen such that, if status is extracted as properties["status"], it's validation is not lost.','line_number':794,'multiline':False]['text':' skip zero values','line_number':798,'multiline':False]['text':' only "object" type is valid at root of the schema since validation schema for status is extracted as properties["status"]','line_number':805,'multiline':False]['text':' These validation errors overlap with  OpenAPISchema validation errors so we keep track of them','line_number':835,'multiline':False]['text':' separately and only show them if OpenAPISchema validation does not report any errors.','line_number':836,'multiline':False]['text':' this should never happen','line_number':841,'multiline':False]['text':' Only initialize CEL rule validation context if the structural schemas are valid.','line_number':846,'multiline':False]['text':' A nil CELSchemaContext indicates that no CEL validation should be attempted.','line_number':847,'multiline':False]['text':' Structural schema initialization errors overlap with OpenAPISchema validation errors so we only show them','line_number':854,'multiline':False]['text':' if there are no OpenAPISchema validation errors.','line_number':855,'multiline':False]['text':' if validation passed otherwise, make sure we can actually construct a schema validator from this custom resource validation.','line_number':872,'multiline':False]['text':' OpenAPISchemaErrorList tracks all validation errors reported ValidateCustomResourceDefinitionOpenAPISchema','line_number':883,'multiline':False]['text':' with CEL related errors kept separate from schema related errors.','line_number':884,'multiline':False]['text':' AppendErrors appends all errors in the provided list with the errors of this list.','line_number':890,'multiline':False]['text':' AllErrors returns a list containing both schema and CEL errors.','line_number':899,'multiline':False]['text':' ValidateCustomResourceDefinitionOpenAPISchema statically validates','line_number':907,'multiline':False]['text':' additionalProperties and properties are mutual exclusive because otherwise they','line_number':920,'multiline':False]['text':' contradict Kubernetes' API convention to ignore unknown fields.','line_number':921,'multiline':False]['text':'','line_number':922,'multiline':False]['text':' In other words:','line_number':923,'multiline':False]['text':' - properties are for structs,','line_number':924,'multiline':False]['text':' - additionalProperties are for map[string]interface{}','line_number':925,'multiline':False]['text':'','line_number':926,'multiline':False]['text':' Note: when patternProperties is added to OpenAPI some day, this will have to be','line_number':927,'multiline':False]['text':'       restricted like additionalProperties.','line_number':928,'multiline':False]['text':' Note: we forbid additionalProperties at resource root, both embedded and top-level.','line_number':935,'multiline':False]['text':'       But further inside, additionalProperites is possible, e.g. for labels or annotations.','line_number':936,'multiline':False]['text':' we have to forbid defaults inside additionalProperties because pruning without actual value is ambiguous','line_number':939,'multiline':False]['text':' we recurse into the schema that applies to ObjectMeta.','line_number':954,'multiline':False]['text':' we can only correlate old/new items for "map" and "set" lists, and correlation of','line_number':998,'multiline':False]['text':' "set" elements by identity is not supported for cel (x-kubernetes-validations)','line_number':999,'multiline':False]['text':' rules. an unset list type defaults to "atomic".','line_number':1000,'multiline':False]['text':' by structural schema items are present','line_number':1042,'multiline':False]['text':' atomic is the implicit default behaviour if unset, hence != atomic is wrong','line_number':1046,'multiline':False]['text':' granular is the implicit default behaviour if unset, hence nil and != atomic are wrong','line_number':1050,'multiline':False]['text':' If any schema related validation errors have been found at this level or deeper, skip CEL expression validation.','line_number':1141,'multiline':False]['text':' Invalid OpenAPISchemas are not always possible to convert into valid CEL DeclTypes, and can lead to CEL','line_number':1142,'multiline':False]['text':' validation error messages that are not actionable (will go away once the schema errors are resolved) and that','line_number':1143,'multiline':False]['text':' are difficult for CEL expression authors to understand.','line_number':1144,'multiline':False]['text':' To avoid duplicated code and better maintain, using ValidaFieldPath func to check if the path is valid','line_number':1202,'multiline':False]['text':' multiplyWithOverflowGuard returns the product of baseCost and cardinality unless that product','line_number':1210,'multiline':False]['text':' would exceed math.MaxUint, in which case math.MaxUint is returned.','line_number':1211,'multiline':False]['text':' an empty rule can return 0, so guard for that here','line_number':1214,'multiline':False]['text':' if exceedFactor is greater than 2 orders of magnitude, the rule is likely O(n^2) or worse','line_number':1233,'multiline':False]['text':' and will probably never validate without some set limits','line_number':1234,'multiline':False]['text':' also in such cases the cost estimation is generally large enough to not add any value','line_number':1235,'multiline':False]['text':' avoid reporting "exceeds budge by a factor of 1.0x"','line_number':1238,'multiline':False]['text':' valid newline chars in CEL grammar','line_number':1245,'multiline':False]['text':' set and map list items cannot be nullable','line_number':1263,'multiline':False]['text':' ensure all map keys are required or have a default','line_number':1270,'multiline':False]['text':' we validate that all XListMapKeys are existing properties in ValidateCustomResourceDefinitionOpenAPISchema, so skipping here is ok','line_number':1279,'multiline':False]['text':' no other set-specific validation','line_number':1292,'multiline':False]['text':' oldSelf validations are already forbidden. preserve the highest-level path','line_number':1325,'multiline':False]['text':' causing oldSelf validations to be forbidden','line_number':1326,'multiline':False]['text':' validate validates against OpenAPI Schema v3.','line_number':1338,'multiline':False]['text':'','line_number':1346,'multiline':False]['text':' WARNING: if anything new is allowed below, NewStructural must be adapted to support it.','line_number':1347,'multiline':False]['text':'','line_number':1348,'multiline':False]['text':' ValidateCustomResourceDefinitionSubresources statically validates','line_number':1401,'multiline':False]['text':' should be constrained json path under .spec','line_number':1413,'multiline':False]['text':' should be constrained json path under .status','line_number':1424,'multiline':False]['text':' if labelSelectorPath is present, it should be a constrained json path under .status','line_number':1432,'multiline':False]['text':' requireOpenAPISchema returns true if the request group version requires a schema','line_number':1473,'multiline':False]['text':' don't tighten validation on existing persisted data','line_number':1476,'multiline':False]['text':' SchemaHas recursively traverses the Schema and calls the `pred`','line_number':1531,'multiline':False]['text':' predicate to see if the schema contains specific values.','line_number':1532,'multiline':False]['text':'','line_number':1533,'multiline':False]['text':' The predicate MUST NOT keep a copy of the json schema NOR modify the','line_number':1534,'multiline':False]['text':' schema.','line_number':1535,'multiline':False]['text':' requireStructuralSchema returns true if schemas specified must be structural','line_number':1625,'multiline':False]['text':' don't tighten validation on existing persisted data','line_number':1628,'multiline':False]['text':' requirePrunedDefaults returns false if there are any unpruned default in oldCRDSpec, and true otherwise.','line_number':1656,'multiline':False]['text':' requireAtomicSetType returns true if the old CRD spec as at least one x-kubernetes-list-type=set with non-atomic items type.','line_number':1691,'multiline':False]['text':' hasNonAtomicSetType recurses over the schema and returns whether any list of type "set" as non-atomic item types.','line_number':1696,'multiline':False]['text':' we don't support schema.Items.JSONSchemas','line_number':1699,'multiline':False]['text':' atomic is the implicit default behaviour if unset, hence != atomic is wrong','line_number':1703,'multiline':False]['text':' granular is the implicit default behaviour if unset, hence nil and != atomic are wrong','line_number':1705,'multiline':False]['text':' scalar types are always atomic','line_number':1707,'multiline':False]['text':' requireValidPropertyType returns true if valid openapi v3 types should be required for the given API version','line_number':1724,'multiline':False]['text':' don't tighten validation on existing persisted data','line_number':1727,'multiline':False]['text':' validateAPIApproval returns a list of errors if the API approval annotation isn't valid','line_number':1733,'multiline':False]['text':' check to see if we need confirm API approval for kube group.','line_number':1735,'multiline':False]['text':' no-op for non-protected groups','line_number':1737,'multiline':False]['text':' default to a state that allows missing values to continue to be missing','line_number':1741,'multiline':False]['text':' +k8s:verify-mutation:reason=clone','line_number':1745,'multiline':False]['text':' if the approval state hasn't changed, never fail on approval validation','line_number':1749,'multiline':False]['text':' this is allowed so that a v1 client that is simply updating spec and not mutating this value doesn't get rejected.  Imagine a controller controlling a CRD spec.','line_number':1750,'multiline':False]['text':' in v1, we require valid approval strings','line_number':1755,'multiline':False]['text':' success','line_number':1762,'multiline':False]['text':' no-op for compatibility with existing data','line_number':1771,'multiline':False]['text':' disallow changing spec.preserveUnknownFields=false to spec.preserveUnknownFields=true','line_number':1777,'multiline':False]['text':' SchemaHasInvalidTypes returns true if it contains invalid offending openapi-v3 specification.','line_number':1795,'multiline':False]