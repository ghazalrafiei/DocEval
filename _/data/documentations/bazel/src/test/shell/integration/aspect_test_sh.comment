['text':'!/bin/bash','line_number':1,'multiline':False]['text':'','line_number':2,'multiline':False]['text':' Copyright 2019 The Bazel Authors. All rights reserved.','line_number':3,'multiline':False]['text':'','line_number':4,'multiline':False]['text':' Licensed under the Apache License, Version 2.0 (the "License");','line_number':5,'multiline':False]['text':' you may not use this file except in compliance with the License.','line_number':6,'multiline':False]['text':' You may obtain a copy of the License at','line_number':7,'multiline':False]['text':'','line_number':8,'multiline':False]['text':'    http://www.apache.org/licenses/LICENSE-2.0','line_number':9,'multiline':False]['text':'','line_number':10,'multiline':False]['text':' Unless required by applicable law or agreed to in writing, software','line_number':11,'multiline':False]['text':' distributed under the License is distributed on an "AS IS" BASIS,','line_number':12,'multiline':False]['text':' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.','line_number':13,'multiline':False]['text':' See the License for the specific language governing permissions and','line_number':14,'multiline':False]['text':' limitations under the License.','line_number':15,'multiline':False]['text':'','line_number':16,'multiline':False]['text':' --- begin runfiles.bash initialization ---','line_number':18,'multiline':False]['text':' --- end runfiles.bash initialization ---','line_number':38,'multiline':False]['text':' Tests in this file do not actually start a Python interpreter, but plug in a','line_number':60,'multiline':False]['text':' fake stub executable to serve as the "interpreter".','line_number':61,'multiline':False]['text':'### TESTS #############################################################','line_number':65,'multiline':False]['text':' Tests that a cycle reached via a command-line aspect does not crash.','line_number':67,'multiline':False]['text':' Does not crash deterministically, because if the configured target's cycle is','line_number':68,'multiline':False]['text':' reported first, the aspect loading key's cycle is suppressed.','line_number':69,'multiline':False]['text':' No flag, use the default from the rule.','line_number':81,'multiline':False]['text':' When a target is broken, report an error in the target, not the aspect.','line_number':92,'multiline':False]['text':' This test would be flaky if errors were non-deterministically reported during','line_number':93,'multiline':False]['text':' target and aspect analysis, and would fail outright if aspect failures were','line_number':94,'multiline':False]['text':' preferred.','line_number':95,'multiline':False]['text':' without using --incompatible_top_level_aspects_require_providers, aspect_a','line_number':167,'multiline':False]['text':' and aspect_b should attempt to run on top level target: target_with_a and','line_number':168,'multiline':False]['text':' propagate to its dependencies where they will run based on the dependencies','line_number':169,'multiline':False]['text':' advertised providers.','line_number':170,'multiline':False]['text':' Only aspect_a is applied on target_with_a because its "provided" providers','line_number':176,'multiline':False]['text':' do not macth aspect_b required providers.','line_number':177,'multiline':False]['text':' Only aspect_a can run on target_with_a_indeps','line_number':181,'multiline':False]['text':' Only aspect_b can run on target_with_bc','line_number':185,'multiline':False]['text':' using --incompatible_top_level_aspects_require_providers, the top level','line_number':189,'multiline':False]['text':' target rule's advertised providers will be checked and only aspect_a will be','line_number':190,'multiline':False]['text':' applied on target_with_a and propagated to its dependencies.','line_number':191,'multiline':False]['text':' Only aspect_a is applied on target_with_a','line_number':198,'multiline':False]['text':' Only aspect_a can run on target_with_a_indeps','line_number':202,'multiline':False]['text':' rule_with_bc advertised provides only match the required providers for','line_number':206,'multiline':False]['text':' aspect_b, but aspect_b is not propagated from target_with_a','line_number':207,'multiline':False]['text':' my_aspect does not require any providers so it will be applied to all the','line_number':269,'multiline':False]['text':' dependencies of main target','line_number':270,'multiline':False]['text':' my_aspect will only be applied on target_with_ab and','line_number':352,'multiline':False]['text':' target_with_ab_indeps_reached since their rule (rule_with_ab) is the only','line_number':353,'multiline':False]['text':' rule that advertises the aspect required providers.','line_number':354,'multiline':False]['text':' my_aspect cannot be propagated to target_with_ab_indeps_not_reached','line_number':361,'multiline':False]['text':' because it was not applied to its parent (target_with_a)','line_number':362,'multiline':False]['text':' my_aspect will only be applied on target_with_ab, target_wtih_c and','line_number':453,'multiline':False]['text':' target_with_c_indeps_reached because their rules (rule_with_ab and','line_number':454,'multiline':False]['text':' rule_with_c) are the only rules advertising the aspect required providers','line_number':455,'multiline':False]['text':' my_aspect cannot be propagated to target_with_c_indeps_not_reached because it was','line_number':463,'multiline':False]['text':' not applied to its parent (target_with_a)','line_number':464,'multiline':False]['text':' base_aspect will run on dep_target_without_providers,','line_number':535,'multiline':False]['text':' dep_target_without_providers_1 and dep_target_with_prov_a but','line_number':536,'multiline':False]['text':' required_aspect will only run on dep_target_with_prov_a because','line_number':537,'multiline':False]['text':' it satisfies its required providers','line_number':538,'multiline':False]['text':'include "${package}/x.h"','line_number':588,'multiline':False]['text':' Check that aspects: aspect_a, aspect_b, aspect_c were propagated to the','line_number':615,'multiline':False]['text':' dependencies of target test: t and x when only aspect_a is specified','line_number':616,'multiline':False]['text':' in the rule definition','line_number':617,'multiline':False]['text':'include "${package}/bar.h"','line_number':793,'multiline':False]['text':'include "${package}/foo.h"','line_number':797,'multiline':False]['text':'include "${package}/bar.h"','line_number':798,'multiline':False]['text':' test that although a required aspect runs once on a target, it can still keep','line_number':884,'multiline':False]['text':' propagating while inheriting its main aspect attr_aspects','line_number':885,'multiline':False]['text':' aspect_a is propagated from command line on top level target main_target with','line_number':1033,'multiline':False]['text':' value p_v1 for its parameter p. It is also propagated from main_target rule','line_number':1034,'multiline':False]['text':' with value p_v2 to its parameter p. So aspect_a should run twice on dependency','line_number':1035,'multiline':False]['text':' dep_target, once with each parameter value.','line_number':1036,'multiline':False]['text':' aspect b(p=3) is propagated to t2 and t3 from t1','line_number':1241,'multiline':False]['text':' aspect a from command-line runs on t2 and t3 with basekeys = [b(p=4)]','line_number':1242,'multiline':False]['text':' so the aspects path propagating to t3 is [b(p=3), b(p=4), a]','line_number':1243,'multiline':False]['text':' aspect b(p=4) is propagated from t2 to t3','line_number':1249,'multiline':False]['text':' the aspects path propagating to t3 will be [b(p=4), b(p=3), b(p=4), a]','line_number':1250,'multiline':False]['text':' after aspects deduplicating the aspects path will be [b(p=4), b(p=3), a]','line_number':1251,'multiline':False]['text':' check that aspect_a runs only once on t3 with the aspect path ordered as','line_number':1265,'multiline':False]['text':' [aspect_b(p=3), aspect_b(p=4), aspect_a]','line_number':1266,'multiline':False]['text':' exec_gp not declared','line_number':1417,'multiline':False]['text':' the underlying aspect (aspect_b) can propagate to its main aspect dependencies','line_number':1586,'multiline':False]['text':' the main aspect (aspect_a) can propagate to its underlying aspects','line_number':1588,'multiline':False]['text':' dependencies','line_number':1589,'multiline':False]['text':' change configuration on the dependency //test:t2, my_aspect should be reevaluated on //test:t1','line_number':1671,'multiline':False]['text':' in aspect_a, `ctx.attr._tool` gets its value from the main aspect (aspect_a)','line_number':1802,'multiline':False]['text':' `ctx.rule.attr._tool` gets its value from the rule (r1) attribute with that name','line_number':1803,'multiline':False]['text':' `ctx.rule.attr._base_aspects_tool` is not there in the rule (r1) attributes so it','line_number':1804,'multiline':False]['text':' gets its value from the first aspect that has it in the aspects path','line_number':1805,'multiline':False]['text':' which is aspect_c.','line_number':1806,'multiline':False]