['text':' vi:set ts=8 sts=4 sw=4 noet:
 *
 * VIM - Vi IMproved	by Bram Moolenaar
 *
 * Do ":help uganda"  in Vim to read copying and usage conditions.
 * Do ":help credits" in Vim to see a list of people who contributed.
 * See README.txt for an overview of the Vim source code.
 ','line_number':1,'multiline':True]['text':'
 * drawscreen.c: Code for updating all the windows on the screen.
 * This is the top level, drawline.c is the middle and screen.c the lower
 * level.
 *
 * update_screen() is the function that updates all windows and status lines.
 * It is called form the main loop when must_redraw is non-zero.  It may be
 * called from other places when an immediate screen update is needed.
 *
 * The part of the buffer that is displayed in a window is set with:
 * - w_topline (first buffer line in window)
 * - w_topfill (filler lines above the first line)
 * - w_leftcol (leftmost window cell in window),
 * - w_skipcol (skipped window cells of first line)
 *
 * Commands that only move the cursor around in a window, do not need to take
 * action to update the display.  The main loop will check if w_topline is
 * valid and update it (scroll the window) when needed.
 *
 * Commands that scroll a window change w_topline and must call
 * check_cursor() to move the cursor into the visible part of the window, and
 * call redraw_later(UPD_VALID) to have the window displayed by update_screen()
 * later.
 *
 * Commands that change text in the buffer must call changed_bytes() or
 * changed_lines() to mark the area that changed and will require updating
 * later.  The main loop will call update_screen(), which will update each
 * window that shows the changed buffer.  This assumes text above the change
 * can remain displayed as it is.  Text after the change may need updating for
 * scrolling, folding and syntax highlighting.
 *
 * Commands that change how a window is displayed (e.g., setting 'list') or
 * invalidate the contents of a window in another way (e.g., change fold
 * settings), must call redraw_later(UPD_NOT_VALID) to have the whole window
 * redisplayed by update_screen() later.
 *
 * Commands that change how a buffer is displayed (e.g., setting 'tabstop')
 * must call redraw_curbuf_later(UPD_NOT_VALID) to have all the windows for the
 * buffer redisplayed by update_screen() later.
 *
 * Commands that change highlighting and possibly cause a scroll too must call
 * redraw_later(UPD_SOME_VALID) to update the whole window but still use
 * scrolling to avoid redrawing everything.  But the length of displayed lines
 * must not change, use UPD_NOT_VALID then.
 *
 * Commands that move the window position must call redraw_later(UPD_NOT_VALID).
 * TODO: should minimize redrawing by scrolling when possible.
 *
 * Commands that change everything (e.g., resizing the screen) must call
 * redraw_all_later(UPD_NOT_VALID) or redraw_all_later(UPD_CLEAR).
 *
 * Things that are handled indirectly:
 * - When messages scroll the screen up, msg_scrolled will be set and
 *   update_screen() called to redraw.
 ','line_number':10,'multiline':True]['text':'
 * Based on the current value of curwin->w_topline, transfer a screenfull
 * of stuff from Filemem to ScreenLines[], and update curwin->w_botline.
 * Return OK when the screen was updated, FAIL if it was not done.
 ','line_number':76,'multiline':True]['text':' Don't do anything if the screen structures are (not yet) valid.','line_number':96,'multiline':False]['text':' Before updating the screen, notify any listeners of changed text.','line_number':110,'multiline':False]['text':' May have postponed updating diffs.','line_number':117,'multiline':False]['text':' use maximal type','line_number':124,'multiline':False]['text':' must_redraw is reset here, so that when we run into some weird','line_number':127,'multiline':False]['text':' reason to redraw while busy redrawing (e.g., asynchronous','line_number':128,'multiline':False]['text':' scrolling), or update_topline() in win_update() will cause a','line_number':129,'multiline':False]['text':' scroll, the screen will be redrawn later or in win_update().','line_number':130,'multiline':False]['text':' May need to update w_lines[].','line_number':134,'multiline':False]['text':' Postpone the redrawing when it's not needed and when being called','line_number':142,'multiline':False]['text':' recursively.','line_number':143,'multiline':False]['text':' remember type for next time','line_number':146,'multiline':False]['text':' don't use w_lines[].wl_size now','line_number':149,'multiline':False]['text':' Update popup_mask if needed.  This may set w_redraw_top and w_redraw_bot','line_number':155,'multiline':False]['text':' in some windows.','line_number':156,'multiline':False]['text':' let syntax code know we're in a next round of','line_number':161,'multiline':False]['text':' display updating','line_number':162,'multiline':False]['text':' if the screen was scrolled up when displaying a message, scroll it down','line_number':167,'multiline':False]['text':' redrawing is faster','line_number':173,'multiline':False]['text':' reset cmdline_row now (may have been changed temporarily)','line_number':217,'multiline':False]['text':' Check for changed highlighting','line_number':220,'multiline':False]['text':' first clear screen','line_number':224,'multiline':False]['text':' will reset clear_cmdline','line_number':226,'multiline':False]['text':' must_redraw may be set indirectly, avoid another redraw later','line_number':228,'multiline':False]['text':' going to clear cmdline (done below)','line_number':232,'multiline':False]['text':' Force redraw when width of 'number' or 'relativenumber' column','line_number':236,'multiline':False]['text':' changes.','line_number':237,'multiline':False]['text':' Only start redrawing if there is really something to do.','line_number':244,'multiline':False]['text':' Redraw the tab pages line if needed.','line_number':264,'multiline':False]['text':' Correct stored syntax highlighting info for changes in each displayed','line_number':269,'multiline':False]['text':' buffer.  Each buffer must only be done once.','line_number':270,'multiline':False]['text':' Check if we already did this buffer.','line_number':277,'multiline':False]['text':' Avoid flicker if the popup menu is going to be redrawn in the same','line_number':288,'multiline':False]['text':' position.','line_number':289,'multiline':False]['text':' Go from top to bottom through the windows, redrawing the ones that need','line_number':292,'multiline':False]['text':' it.','line_number':293,'multiline':False]['text':' Remove the cursor before starting to do anything, because','line_number':310,'multiline':False]['text':' scrolling may make it difficult to redraw the text under','line_number':311,'multiline':False]['text':' it.','line_number':312,'multiline':False]['text':' Also remove the cursor if it needs to be hidden due to an','line_number':313,'multiline':False]['text':' ongoing cursor-less sleep.','line_number':314,'multiline':False]['text':' redraw status line after the window to minimize cursor movement','line_number':327,'multiline':False]['text':' any popup menu will be redrawn below','line_number':331,'multiline':False]['text':' May need to redraw the popup menu.','line_number':338,'multiline':False]['text':' Reset b_mod_set flags.  Going through all windows is probably faster','line_number':342,'multiline':False]['text':' than going through all buffers (there could be many buffers).','line_number':343,'multiline':False]['text':' Display popup windows on top of the windows and command line.','line_number':348,'multiline':False]['text':' If this window contains a terminal, after redrawing all windows, the','line_number':354,'multiline':False]['text':' dirty row range can be reset.','line_number':355,'multiline':False]['text':' Clear or redraw the command line.  Done last, because scrolling may','line_number':361,'multiline':False]['text':' mess up the command line.','line_number':362,'multiline':False]['text':' May put up an introductory message when not editing a file','line_number':369,'multiline':False]['text':' Redraw the cursor and update the scrollbars when all screen updating is','line_number':375,'multiline':False]['text':' done.','line_number':376,'multiline':False]['text':' required before updating the cursor','line_number':382,'multiline':False]['text':' Put the GUI position where the cursor was, gui_update_cursor()','line_number':385,'multiline':False]['text':' uses that.','line_number':386,'multiline':False]['text':'
 * Return the row for drawing the statusline and the ruler of window "wp".
 ','line_number':403,'multiline':True]['text':' If the window is really zero height the winbar isn't displayed.','line_number':410,'multiline':False]['text':'
 * Redraw the status line of window wp.
 *
 * If inversion is possible we use it. Else '=' characters are used.
 * If "ignore_pum" is TRUE, also redraw statusline when the popup menu is
 * displayed.
 ','line_number':417,'multiline':True]['text':' It's possible to get here recursively when 'statusline' (indirectly)','line_number':435,'multiline':False]['text':' invokes ":redrawstatus".  Simply ignore the call then.','line_number':436,'multiline':False]['text':' no status line, can only be last window','line_number':446,'multiline':False]['text':' don't update status line when popup menu is visible and may be','line_number':450,'multiline':False]['text':' drawn over it, unless it will be redrawn later','line_number':451,'multiline':False]['text':' Don't redraw right now, do it later.','line_number':454,'multiline':False]['text':' redraw custom status line','line_number':460,'multiline':False]['text':' No room for file name!','line_number':508,'multiline':False]['text':' Count total number of display cells.','line_number':515,'multiline':False]['text':' Find first character that will fit.','line_number':518,'multiline':False]['text':' Going from start to end is much faster for DBCS.','line_number':519,'multiline':False]['text':' Draw the 'showcmd' information if 'showcmdloc' == "statusline".','line_number':550,'multiline':False]['text':'
     * May need to draw the character below the vertical separator.
     ','line_number':561,'multiline':True]['text':'
 * Redraw the status line according to 'statusline' and take care of any
 * errors encountered.
 ','line_number':576,'multiline':True]['text':' When called recursively return.  This can happen when the statusline','line_number':585,'multiline':False]['text':' contains an expression that triggers a redraw.','line_number':586,'multiline':False]['text':'
 * Show current status info in ruler and various other places
 * If always is FALSE, only show ruler if position has changed.
 ','line_number':596,'multiline':True]['text':' Don't redraw right now, do it later.','line_number':607,'multiline':False]['text':' Redraw the tab pages line if needed.','line_number':626,'multiline':False]['text':' If 'ruler' off don't do anything','line_number':648,'multiline':False]['text':'
     * Check if cursor.lnum is valid, since win_redr_ruler() may be called
     * after deleting lines, before cursor.lnum is corrected.
     ','line_number':652,'multiline':True]['text':' Don't draw the ruler while doing insert-completion, it might overwrite','line_number':659,'multiline':False]['text':' the (long) mode message.','line_number':660,'multiline':False]['text':' Don't draw the ruler when the popup menu is visible, it may overlap.','line_number':664,'multiline':False]['text':' Except when the popup menu will be redrawn anyway.','line_number':665,'multiline':False]['text':'
     * Check if not in Insert mode and the line is empty (will show "0-1").
     ','line_number':677,'multiline':True]['text':'
     * Only draw the ruler when something changed.
     ','line_number':684,'multiline':True]['text':' In list mode virtcol needs to be recomputed','line_number':718,'multiline':False]['text':'
	 * Some sprintfs return the length, some return a pointer.
	 * To avoid portability problems we use strlen() here.
	 ','line_number':727,'multiline':True]['text':'
	 * Add a "50%" if there is room for it.
	 * On the last line, don't print in the last column (scrolls the
	 * screen up on some terminals).
	 ','line_number':740,'multiline':True]['text':' can't use last char of screen','line_number':748,'multiline':False]['text':' Never use more than half the window/screen width, leave the other','line_number':753,'multiline':False]['text':' half for the filename.','line_number':754,'multiline':False]['text':' need at least 3 chars left for get_rel_pos() + NUL','line_number':759,'multiline':False]['text':' Truncate at window boundary.','line_number':770,'multiline':False]['text':' don't redraw the cmdline because of showing the ruler','line_number':793,'multiline':False]['text':'
 * To be called when "updating_screen" was set before and now the postponed
 * side effects may take place.
 ','line_number':806,'multiline':True]['text':' If handle_drop() was called while updating_screen was TRUE need to','line_number':823,'multiline':False]['text':' handle the drop now.','line_number':824,'multiline':False]['text':'
 * Update all windows that are editing the current buffer.
 ','line_number':829,'multiline':True]['text':'
 * Copy "text" to ScreenLines using "attr".
 * Returns the next screen column.
 ','line_number':840,'multiline':True]['text':' previous Arabic character','line_number':858,'multiline':False]['text':' first composing char for prev_c','line_number':859,'multiline':False]['text':' Store multibyte characters in ScreenLines[] et al. correctly.','line_number':869,'multiline':False]['text':' Do Arabic shaping.','line_number':896,'multiline':False]['text':' The idea of what is the previous and next','line_number':901,'multiline':False]['text':' character depends on 'rightleft'.','line_number':902,'multiline':False]['text':' Non-BMP character: display as ? or fullwidth ?.','line_number':925,'multiline':False]['text':' double-byte single width character','line_number':938,'multiline':False]['text':' double-width character','line_number':941,'multiline':False]['text':'
 * Draw the window toolbar.
 ','line_number':970,'multiline':True]['text':' TODO: use fewer spaces if there is not enough room','line_number':990,'multiline':False]['text':' end marker','line_number':1029,'multiline':False]['text':'
 * Copy "buf[len]" to ScreenLines["off"] and set attributes to "attr".
 ','line_number':1036,'multiline':True]['text':'
 * Display one folded line.
 ','line_number':1055,'multiline':True]['text':' Max value of 'foldcolumn' is 12 and maximum number of bytes in a','line_number':1066,'multiline':False]['text':' multi-byte character is MAX_MCO.','line_number':1067,'multiline':False]['text':' Build the fold line:','line_number':1079,'multiline':False]['text':' 1. Add the cmdwin_type for the command-line window','line_number':1080,'multiline':False]['text':' 2. Add the 'foldcolumn'','line_number':1081,'multiline':False]['text':' 3. Add the 'number' or 'relativenumber' column','line_number':1082,'multiline':False]['text':' 4. Compose the text','line_number':1083,'multiline':False]['text':' 5. Add the text','line_number':1084,'multiline':False]['text':' 6. set highlighting for the Visual area an other text','line_number':1085,'multiline':False]['text':' 1. Add the cmdwin_type for the command-line window','line_number':1088,'multiline':False]['text':' Ignores 'rightleft', this window is never right-left.','line_number':1089,'multiline':False]['text':' 2. Add the 'foldcolumn'','line_number':1117,'multiline':False]['text':'    Reduce the width when there is not enough space.','line_number':1118,'multiline':False]['text':' Set all attributes of the 'number' or 'relativenumber' column and the','line_number':1164,'multiline':False]['text':' text','line_number':1165,'multiline':False]['text':' If signs are being displayed, add two spaces.','line_number':1169,'multiline':False]['text':' the line number isn't reversed','line_number':1179,'multiline':False]['text':' 3. Add the 'number' or 'relativenumber' column','line_number':1190,'multiline':False]['text':' 'number' + 'norelativenumber'','line_number':1204,'multiline':False]['text':' 'relativenumber', don't use negative numbers','line_number':1208,'multiline':False]['text':' 'number' + 'relativenumber': cursor line shows absolute','line_number':1212,'multiline':False]['text':' line number','line_number':1213,'multiline':False]['text':' the line number isn't reversed','line_number':1222,'multiline':False]['text':' 4. Compose the folded-line string with 'foldtext', if set.','line_number':1232,'multiline':False]['text':' remember where text starts','line_number':1235,'multiline':False]['text':' 5. move the text to current_ScreenLine.  Fill up with "fold" from','line_number':1237,'multiline':False]['text':'    'fillchars'.','line_number':1238,'multiline':False]['text':'    Right-left text is put in columns 0 - number-col, normal text is put','line_number':1239,'multiline':False]['text':'    in columns number-col - window-width.','line_number':1240,'multiline':False]['text':' Fill the rest of the line with the fold filler','line_number':1243,'multiline':False]['text':' avoid storing zero','line_number':1262,'multiline':False]['text':' 6. set highlighting for the Visual area an other text.','line_number':1278,'multiline':False]['text':' If all folded lines are in the Visual area, highlight the line.','line_number':1279,'multiline':False]['text':' Visual is after curwin->w_cursor','line_number':1284,'multiline':False]['text':' Visual is before curwin->w_cursor','line_number':1290,'multiline':False]['text':' Visual block mode: highlight the chars part of the block','line_number':1307,'multiline':False]['text':' Set all attributes of the text','line_number':1322,'multiline':False]['text':' Show colorcolumn in the fold line, but let cursorcolumn override it.','line_number':1329,'multiline':False]['text':' Show 'cursorcolumn' in the fold line.','line_number':1351,'multiline':False]['text':' Update w_cline_height and w_cline_folded if the cursor line was','line_number':1368,'multiline':False]['text':' updated (saves a call to plines() later).','line_number':1369,'multiline':False]['text':' When the line was not folded w_wrow may have been set, recompute it.','line_number':1381,'multiline':False]['text':'
 * Update a single window.
 *
 * This may cause the windows below it also to be redrawn (when clearing the
 * screen or scrolling lines).
 *
 * How the window is redrawn depends on wp->w_redr_type.  Each type also
 * implies the one below it.
 * UPD_NOT_VALID	redraw the whole window
 * UPD_SOME_VALID	redraw the whole window but do scroll when possible
 * UPD_REDRAW_TOP	redraw the top w_upd_rows window lines, otherwise like
 *			UPD_VALID
 * UPD_INVERTED		redraw the changed part of the Visual area
 * UPD_INVERTED_ALL	redraw the whole Visual area
 * UPD_VALID	1. scroll up/down to adjust for a changed w_topline
 *		2. update lines at the top when scrolled down
 *		3. redraw changed text:
 *		   - if wp->w_buffer->b_mod_set set, update lines between
 *		     b_mod_top and b_mod_bot.
 *		   - if wp->w_redraw_top non-zero, redraw lines between
 *		     wp->w_redraw_top and wp->w_redr_bot.
 *		   - continue redrawing when syntax status is invalid.
 *		4. if scrolled up, update lines at the bottom.
 * This results in three areas that may need updating:
 * top:	from first row to top_end (when scrolled down)
 * mid: from mid_start to mid_end (update inversion or changed text)
 * bot: from bot_start to last row (when scrolled up)
 ','line_number':1391,'multiline':True]['text':' Below last row of the top area that needs','line_number':1424,'multiline':False]['text':' updating.  0 when no top area updating.','line_number':1425,'multiline':False]['text':' first row of the mid area that needs','line_number':1426,'multiline':False]['text':' updating.  999 when no mid area updating.','line_number':1427,'multiline':False]['text':' Below last row of the mid area that needs','line_number':1428,'multiline':False]['text':' updating.  0 when no mid area updating.','line_number':1429,'multiline':False]['text':' first row of the bot area that needs','line_number':1430,'multiline':False]['text':' updating.  999 when no bot area updating','line_number':1431,'multiline':False]['text':' TRUE when scrolled down when','line_number':1432,'multiline':False]['text':' w_topline got smaller a bit','line_number':1433,'multiline':False]['text':' redraw above mod_top','line_number':1435,'multiline':False]['text':' current window row to display','line_number':1438,'multiline':False]['text':' current buffer lnum to display','line_number':1439,'multiline':False]['text':' current index in w_lines[]','line_number':1440,'multiline':False]['text':' starting row of the current line','line_number':1441,'multiline':False]['text':' if TRUE, we hit the end of the file','line_number':1443,'multiline':False]['text':' if TRUE, we finished the last line','line_number':1444,'multiline':False]['text':' being called recursively','line_number':1447,'multiline':False]['text':' remember what happened to the previous line, to know if','line_number':1457,'multiline':False]['text':' check_visual_highlight() can be used','line_number':1458,'multiline':False]['text':' didn't update a line','line_number':1459,'multiline':False]['text':' updated a normal line','line_number':1460,'multiline':False]['text':' updated a folded line','line_number':1461,'multiline':False]['text':' last parsed text line','line_number':1463,'multiline':False]['text':' This needs to be done only for the first window when update_screen() is','line_number':1472,'multiline':False]['text':' called.','line_number':1473,'multiline':False]['text':' When Visual area changed, may have to update selection.','line_number':1481,'multiline':False]['text':' Window frame is zero-height: nothing to draw.','line_number':1498,'multiline':False]['text':' Window is zero-width: Only need to draw the separator.','line_number':1510,'multiline':False]['text':' draw the vertical separator right of this window','line_number':1513,'multiline':False]['text':' If this window contains a terminal, redraw works completely differently.','line_number':1520,'multiline':False]['text':' Draw the window toolbar, if there is one.','line_number':1525,'multiline':False]['text':' Make sure skipcol is valid, it depends on various options and the window','line_number':1538,'multiline':False]['text':' width.','line_number':1539,'multiline':False]['text':' always round down, the higher value may not be valid','line_number':1554,'multiline':False]['text':' Force redraw when width of 'number' or 'relativenumber' column','line_number':1559,'multiline':False]['text':' changes.','line_number':1560,'multiline':False]['text':' When there are both inserted/deleted lines and specific lines to be','line_number':1572,'multiline':False]['text':' redrawn, w_redraw_top and w_redraw_bot may be invalid, just redraw','line_number':1573,'multiline':False]['text':' everything (only happens when redrawing is off for while).','line_number':1574,'multiline':False]['text':' Set mod_top to the first line that needs displaying because of','line_number':1579,'multiline':False]['text':' changes.  Set mod_bot to the first line after the changes.','line_number':1580,'multiline':False]['text':' Need to redraw lines above the change that may be included','line_number':1592,'multiline':False]['text':' in a pattern match.','line_number':1593,'multiline':False]['text':' When 'hlsearch' is on and using a multi-line search pattern, a','line_number':1606,'multiline':False]['text':' change in one line may make the Search highlighting in a','line_number':1607,'multiline':False]['text':' previous line invalid.  Simple solution: redraw all visible','line_number':1608,'multiline':False]['text':' lines above the change.','line_number':1609,'multiline':False]['text':' Same for a match pattern.','line_number':1610,'multiline':False]['text':' CurSearch was used last time, need to redraw the line with it to','line_number':1635,'multiline':False]['text':' avoid having two matches highlighted with CurSearch.','line_number':1636,'multiline':False]['text':' A change in a line can cause lines above it to become folded or','line_number':1649,'multiline':False]['text':' unfolded.  Find the top most buffer line that may be affected.','line_number':1650,'multiline':False]['text':' If the line was previously folded and displayed, get the first','line_number':1651,'multiline':False]['text':' line of that fold.  If the line is folded now, get the first','line_number':1652,'multiline':False]['text':' folded line.  Use the minimum of these two.','line_number':1653,'multiline':False]['text':' Find last valid w_lines[] entry above mod_top.  Set lnumt to','line_number':1655,'multiline':False]['text':' the line below it.  If there is no valid entry, use w_topline.','line_number':1656,'multiline':False]['text':' Find the first valid w_lines[] entry below mod_bot.  Set lnumb','line_number':1657,'multiline':False]['text':' to this line.  If there is no valid entry, use MAXLNUM.','line_number':1658,'multiline':False]['text':' When there is a fold column it might need updating','line_number':1669,'multiline':False]['text':' in the next line ("J" just above an open fold).','line_number':1670,'multiline':False]['text':' Now do the same for the bottom line (one above mod_bot).','line_number':1680,'multiline':False]['text':' When a change starts above w_topline and the end is below','line_number':1689,'multiline':False]['text':' w_topline, start redrawing at w_topline.','line_number':1690,'multiline':False]['text':' If the end of the change is above w_topline: do like no change was','line_number':1691,'multiline':False]['text':' made, but redraw the first line to find changes in syntax.','line_number':1692,'multiline':False]['text':' When line numbers are displayed need to redraw all lines below','line_number':1703,'multiline':False]['text':' inserted/deleted lines.','line_number':1704,'multiline':False]['text':' reset for next time','line_number':1708,'multiline':False]['text':' When only displaying the lines at the top, set top_end.  Used when','line_number':1715,'multiline':False]['text':' window has scrolled down for msg_scrolled.','line_number':1716,'multiline':False]['text':' not found (cannot happen?): redraw everything','line_number':1730,'multiline':False]['text':' top area defined, the rest is UPD_VALID','line_number':1733,'multiline':False]['text':' Trick: we want to avoid clearing the screen twice.  screenclear() will','line_number':1737,'multiline':False]['text':' set "screen_cleared" to TRUE.  The special value MAYBE (which is still','line_number':1738,'multiline':False]['text':' non-zero and thus not FALSE) will indicate that screenclear() was not','line_number':1739,'multiline':False]['text':' called.','line_number':1740,'multiline':False]['text':' If there are no changes on the screen that require a complete redraw,','line_number':1744,'multiline':False]['text':' handle three cases:','line_number':1745,'multiline':False]['text':' 1: we are off the top of the screen by a few lines: scroll down','line_number':1746,'multiline':False]['text':' 2: wp->w_topline is below wp->w_lines[0].wl_lnum: may scroll up','line_number':1747,'multiline':False]['text':' 3: wp->w_topline is wp->w_lines[0].wl_lnum: find first entry in','line_number':1748,'multiline':False]['text':'    w_lines[] that needs updating.','line_number':1749,'multiline':False]['text':' w_topline is the first changed line and window is not scrolled,','line_number':1762,'multiline':False]['text':' the scrolling from changed lines will be done further down.','line_number':1763,'multiline':False]['text':' New topline is above old topline: May scroll down.','line_number':1773,'multiline':False]['text':' count the number of lines we are off, counting a sequence','line_number':1779,'multiline':False]['text':' of folded lines as one','line_number':1780,'multiline':False]['text':' not too far off','line_number':1793,'multiline':False]['text':' insert extra lines for previously invisible filler lines','line_number':1798,'multiline':False]['text':' less than a screen off','line_number':1803,'multiline':False]['text':' Try to insert the correct number of lines.','line_number':1805,'multiline':False]['text':' If not the last window, delete the lines at the bottom.','line_number':1806,'multiline':False]['text':' win_ins_lines may fail when the terminal can't do it.','line_number':1807,'multiline':False]['text':' Need to update rows that are new, stop at the','line_number':1814,'multiline':False]['text':' first one that scrolled down.','line_number':1815,'multiline':False]['text':' Move the entries that were scrolled, disable','line_number':1819,'multiline':False]['text':' the entries for the lines to be redrawn.','line_number':1820,'multiline':False]['text':' redraw all lines','line_number':1830,'multiline':False]['text':' redraw all lines','line_number':1833,'multiline':False]['text':' redraw all lines','line_number':1836,'multiline':False]['text':' New topline is at or below old topline: May scroll up.','line_number':1840,'multiline':False]['text':' When topline didn't change, find first entry in w_lines[] that','line_number':1841,'multiline':False]['text':' needs updating.','line_number':1842,'multiline':False]['text':' Try to find wp->w_topline in wp->w_lines[].wl_lnum.  The check','line_number':1844,'multiline':False]['text':' for "Rows" is in case "wl_size" is incorrect somehow.','line_number':1845,'multiline':False]['text':' if wp->w_topline is not in wp->w_lines[].wl_lnum redraw all','line_number':1860,'multiline':False]['text':' lines','line_number':1861,'multiline':False]['text':' Try to delete the correct number of lines.','line_number':1866,'multiline':False]['text':' wp->w_topline is at wp->w_lines[i].wl_lnum.','line_number':1867,'multiline':False]['text':' If the topline didn't change, delete old filler lines,','line_number':1869,'multiline':False]['text':' otherwise delete filler lines of the new topline...','line_number':1870,'multiline':False]['text':' ... but don't delete new filler lines.','line_number':1875,'multiline':False]['text':' just in case','line_number':1878,'multiline':False]['text':' redraw all lines','line_number':1887,'multiline':False]['text':' Skip the lines (below the deleted lines) that are still','line_number':1891,'multiline':False]['text':' valid and don't need redrawing.	Copy their info','line_number':1892,'multiline':False]['text':' upwards, to compensate for the deleted lines.  Set','line_number':1893,'multiline':False]['text':' bot_start to the first row that needs redrawing.','line_number':1894,'multiline':False]['text':' stop at line that didn't fit, unless it is still','line_number':1900,'multiline':False]['text':' valid (no lines deleted)','line_number':1901,'multiline':False]['text':' stop at the last valid entry in w_lines[].wl_size','line_number':1910,'multiline':False]['text':' Correct the first entry for filler lines at the top','line_number':1918,'multiline':False]['text':' when it won't get updated below.','line_number':1919,'multiline':False]['text':' When starting redraw in the first line, redraw all lines.','line_number':1929,'multiline':False]['text':' When win_del_lines() or win_ins_lines() caused the screen to be','line_number':1933,'multiline':False]['text':' cleared (only happens for the first window) or when screenclear()','line_number':1934,'multiline':False]['text':' was called directly above, "must_redraw" will have been set to','line_number':1935,'multiline':False]['text':' UPD_NOT_VALID, need to reset it here to avoid redrawing twice.','line_number':1936,'multiline':False]['text':' Not UPD_VALID or UPD_INVERTED: redraw all lines.','line_number':1942,'multiline':False]['text':' UPD_SOME_VALID: redraw all lines.','line_number':1949,'multiline':False]['text':' check if we are updating or removing the inverted part','line_number':1955,'multiline':False]['text':' If the type of Visual selection changed, redraw the whole','line_number':1966,'multiline':False]['text':' selection.  Also when the ownership of the X selection is','line_number':1967,'multiline':False]['text':' gained or lost.','line_number':1968,'multiline':False]['text':' redraw more when the cursor moved as well','line_number':1979,'multiline':False]['text':' Find the line numbers that need to be updated: The lines','line_number':1991,'multiline':False]['text':' between the old cursor position and the current cursor','line_number':1992,'multiline':False]['text':' position.  Also check if the Visual position changed.','line_number':1993,'multiline':False]['text':' Visual mode just started','line_number':2003,'multiline':False]['text':' If in block mode and changed column or curwin->w_curswant:','line_number':2022,'multiline':False]['text':' update all lines.','line_number':2023,'multiline':False]['text':' First compute the actual start and end column.','line_number':2024,'multiline':False]['text':' Highlight to the end of the line, unless 'virtualedit' has','line_number':2039,'multiline':False]['text':' "block".','line_number':2040,'multiline':False]['text':' Need to find the longest line.','line_number':2049,'multiline':False]['text':' Use the line numbers of the old Visual area.','line_number':2085,'multiline':False]['text':' There is no need to update lines above the top of the window.','line_number':2098,'multiline':False]['text':' If we know the value of w_botline, use it to restrict the update to','line_number':2102,'multiline':False]['text':' the lines that are visible in the window.','line_number':2103,'multiline':False]['text':' Find the minimal part to be updated.','line_number':2112,'multiline':False]['text':' Watch out for scrolling that made entries in w_lines[] invalid.','line_number':2113,'multiline':False]['text':' E.g., CTRL-U makes the first half of w_lines[] invalid and sets','line_number':2114,'multiline':False]['text':' top_end; need to redraw from top_end to the "to" line.','line_number':2115,'multiline':False]['text':' A middle mouse click with a Visual selection may change the text','line_number':2116,'multiline':False]['text':' above the Visual area and reset wl_valid, do count these for','line_number':2117,'multiline':False]['text':' mid_end (in srow).','line_number':2118,'multiline':False]['text':' find start','line_number':2128,'multiline':False]['text':' find end','line_number':2144,'multiline':False]['text':' Only update until first row of this line','line_number':2149,'multiline':False]['text':' reset got_int, otherwise regexp won't work','line_number':2175,'multiline':False]['text':' Set the time limit to 'redrawtime'.','line_number':2180,'multiline':False]['text':' Draw the window toolbar, if there is one.','line_number':2189,'multiline':False]['text':' TODO: only when needed.','line_number':2190,'multiline':False]['text':' first line shown in window','line_number':2195,'multiline':False]['text':' Initialize spell related variables for the first drawn line.','line_number':2199,'multiline':False]['text':' Update all the window rows.','line_number':2208,'multiline':False]['text':' first entry in w_lines[].wl_size','line_number':2209,'multiline':False]['text':' stop updating when reached the end of the window (check for _past_','line_number':2214,'multiline':False]['text':' the end of the window is at the end of the loop)','line_number':2215,'multiline':False]['text':' stop updating when hit the end of the file','line_number':2222,'multiline':False]['text':' Remember the starting row of the line that is going to be dealt','line_number':2229,'multiline':False]['text':' with.  It is used further down when the line doesn't fit.','line_number':2230,'multiline':False]['text':' Update a line when it is in an area that needs updating, when it','line_number':2233,'multiline':False]['text':' has changes or w_lines[idx] is invalid.','line_number':2234,'multiline':False]['text':' "bot_start" may be halfway a wrapped line after using','line_number':2235,'multiline':False]['text':' win_del_lines(), check if the current line includes it.','line_number':2236,'multiline':False]['text':' When syntax folding is being used, the saved syntax states will','line_number':2237,'multiline':False]['text':' already have been updated, we can't see where the syntax state is','line_number':2238,'multiline':False]['text':' the same again, just update until the end of the window.','line_number':2239,'multiline':False]['text':' match in fixed position might need redraw','line_number':2263,'multiline':False]['text':' if lines were inserted or deleted','line_number':2264,'multiline':False]['text':' When at start of changed lines: May scroll following lines','line_number':2280,'multiline':False]['text':' up or down to minimize redrawing.','line_number':2281,'multiline':False]['text':' Don't do this when the change continues until the end.','line_number':2282,'multiline':False]['text':' Don't scroll when dollar_vcol >= 0, keep the "$".','line_number':2283,'multiline':False]['text':' Don't scroll when redrawing the top, scrolled already above.','line_number':2284,'multiline':False]['text':' Count the old number of window rows, using w_lines[], which','line_number':2295,'multiline':False]['text':' should still contain the sizes for the lines as they are','line_number':2296,'multiline':False]['text':' currently displayed.','line_number':2297,'multiline':False]['text':' Only valid lines have a meaningful wl_lnum.  Invalid','line_number':2300,'multiline':False]['text':' lines are part of the changed area.','line_number':2301,'multiline':False]['text':' Must have found the last valid entry above mod_bot.','line_number':2310,'multiline':False]['text':' Add following invalid entries.','line_number':2311,'multiline':False]['text':' We can't find a valid line below the changed lines,','line_number':2323,'multiline':False]['text':' need to redraw until the end of the window.','line_number':2324,'multiline':False]['text':' Inserting/deleting lines has no use.','line_number':2325,'multiline':False]['text':' Able to count old number of rows: Count new window','line_number':2330,'multiline':False]['text':' rows, and may insert/delete lines','line_number':2331,'multiline':False]['text':' it's getting too much, must redraw the rest','line_number':2358,'multiline':False]['text':' May scroll text up.  If there is not enough','line_number':2366,'multiline':False]['text':' remaining text or scrolling fails, must redraw the','line_number':2367,'multiline':False]['text':' rest.  If scrolling works, must redraw the text','line_number':2368,'multiline':False]['text':' below the scrolled text.','line_number':2369,'multiline':False]['text':' May scroll text down.  If there is not enough','line_number':2384,'multiline':False]['text':' remaining text of scrolling fails, must redraw the','line_number':2385,'multiline':False]['text':' rest.','line_number':2386,'multiline':False]['text':' Scrolled the part at the top that requires','line_number':2396,'multiline':False]['text':' updating down.','line_number':2397,'multiline':False]['text':' When not updating the rest, may need to move w_lines[]','line_number':2402,'multiline':False]['text':' entries.','line_number':2403,'multiline':False]['text':' move entries in w_lines[] upwards','line_number':2410,'multiline':False]['text':' stop at last valid entry in w_lines[]','line_number':2413,'multiline':False]['text':' stop at a line that won't fit','line_number':2420,'multiline':False]['text':' j > i','line_number':2433,'multiline':False]['text':' move entries in w_lines[] downwards','line_number':2435,'multiline':False]['text':' The w_lines[] entries for inserted lines are','line_number':2443,'multiline':False]['text':' now invalid, but wl_size may be used above.','line_number':2444,'multiline':False]['text':' Reset to zero.','line_number':2445,'multiline':False]['text':' When lines are folded, display one line for all of them.','line_number':2457,'multiline':False]['text':' Otherwise, display normally (can be several display lines when','line_number':2458,'multiline':False]['text':' 'wrap' is on).','line_number':2459,'multiline':False]['text':' This line is not going to fit.  Don't draw anything here,','line_number':2489,'multiline':False]['text':' will draw "@  " lines below.','line_number':2490,'multiline':False]['text':' Let the syntax stuff know we skipped a few lines.','line_number':2499,'multiline':False]['text':' Display one line.','line_number':2505,'multiline':False]['text':' Past end of the window or end of the screen. Note that after','line_number':2521,'multiline':False]['text':' resizing wp->w_height may be end up too big. That's a problem','line_number':2522,'multiline':False]['text':' elsewhere, but prevent a crash here.','line_number':2523,'multiline':False]['text':' we may need the size of that too long line later on','line_number':2526,'multiline':False]['text':' 'relativenumber' set and the cursor moved vertically: The','line_number':2546,'multiline':False]['text':' text doesn't need to be drawn, but the number column does.','line_number':2547,'multiline':False]['text':' This line does not need to be drawn, advance to the next one.','line_number':2556,'multiline':False]['text':' past end of screen','line_number':2558,'multiline':False]['text':' Safety check: if any of the wl_size values is wrong we might go over','line_number':2579,'multiline':False]['text':' the end of w_lines[].','line_number':2580,'multiline':False]['text':' End of loop over all window lines.','line_number':2585,'multiline':False]['text':' Now that the window has been redrawn with the old and new cursor line,','line_number':2588,'multiline':False]['text':' update w_last_cursorline.','line_number':2589,'multiline':False]['text':' Rewrite the character at the end of the screen line.','line_number':2595,'multiline':False]['text':' See the version that was fixed.','line_number':2596,'multiline':False]['text':' Let the syntax stuff know we stop parsing here.','line_number':2617,'multiline':False]['text':' If we didn't hit the end of the file, and we didn't finish the last','line_number':2622,'multiline':False]['text':' line we were working on, then the line didn't fit.','line_number':2623,'multiline':False]['text':' Single line that does not fit!','line_number':2632,'multiline':False]['text':' Don't overwrite it, it can be edited.','line_number':2633,'multiline':False]['text':' Window ends in filler lines.','line_number':2639,'multiline':False]['text':' popup line that doesn't fit is left as-is','line_number':2647,'multiline':False]['text':' 'display' has "truncate"','line_number':2651,'multiline':False]['text':' 2 characters of 6 bytes','line_number':2656,'multiline':False]['text':' Last line isn't finished: Display "@@@" in the last screen line.','line_number':2661,'multiline':False]['text':' 'display' has "lastline"','line_number':2671,'multiline':False]['text':' Last line isn't finished: Display "@@@" at the end.','line_number':2676,'multiline':False]['text':' we hit the end of the file','line_number':2695,'multiline':False]['text':' Display filler lines at the end of the file.','line_number':2702,'multiline':False]['text':' Make sure the rest of the screen is blank.','line_number':2717,'multiline':False]['text':' write the "eob" character from 'fillchars' to rows that aren't part','line_number':2718,'multiline':False]['text':' of the file.','line_number':2719,'multiline':False]['text':' Reset the type of redrawing required, the window has been updated.','line_number':2732,'multiline':False]['text':' There is a trick with w_botline.  If we invalidate it on each','line_number':2741,'multiline':False]['text':' change that might modify it, this will cause a lot of expensive','line_number':2742,'multiline':False]['text':' calls to plines() in update_topline() each time.  Therefore the','line_number':2743,'multiline':False]['text':' value of w_botline is often approximated, and this value is used to','line_number':2744,'multiline':False]['text':' compute the value of w_topline.  If the value of w_botline was','line_number':2745,'multiline':False]['text':' wrong, check that the value of w_topline is correct (cursor is on','line_number':2746,'multiline':False]['text':' the visible part of the text).  If it's not, we need to redraw','line_number':2747,'multiline':False]['text':' again.  Mostly this just means scrolling up a few lines, so it','line_number':2748,'multiline':False]['text':' doesn't look too bad.  Only do this for the current window (where','line_number':2749,'multiline':False]['text':' changes are relevant).','line_number':2750,'multiline':False]['text':' may invalidate w_botline again','line_number':2761,'multiline':False]['text':' A win_line() call applied a fix to screen cursor column to','line_number':2767,'multiline':False]['text':' accommodate concealment of cursor line, but in this call to','line_number':2768,'multiline':False]['text':' update_topline() the cursor's row or column got invalidated.','line_number':2769,'multiline':False]['text':' If they are left invalid, setcursor() will recompute them','line_number':2770,'multiline':False]['text':' but there won't be any further win_line() call to re-fix the','line_number':2771,'multiline':False]['text':' column and the cursor will end up misplaced.  So we call','line_number':2772,'multiline':False]['text':' cursor validation now and reapply the fix again (or call','line_number':2773,'multiline':False]['text':' win_line() to do it for us).','line_number':2774,'multiline':False]['text':' New redraw either due to updated topline or due to wcol fix.','line_number':2783,'multiline':False]['text':' Don't update for changes in buffer again.','line_number':2786,'multiline':False]['text':' Other windows might have w_redr_type raised in update_topline().','line_number':2795,'multiline':False]['text':' restore got_int, unless CTRL-C was hit while redrawing','line_number':2805,'multiline':False]['text':'
 * Prepare for updating one or more windows.
 * Caller must check for "updating_screen" already set to avoid recursiveness.
 ','line_number':2812,'multiline':True]['text':' Remove the cursor before starting to do anything, because scrolling may','line_number':2822,'multiline':False]['text':' make it difficult to redraw the text under it.','line_number':2823,'multiline':False]['text':' Update popup_mask if needed.','line_number':2831,'multiline':False]['text':'
 * Finish updating one or more windows.
 ','line_number':2836,'multiline':True]['text':' Redraw the cursor and update the scrollbars when all screen updating is','line_number':2852,'multiline':False]['text':' done.','line_number':2853,'multiline':False]['text':' update/delete a specific sign','line_number':2874,'multiline':False]['text':' check if it resulted in the need to redraw a window','line_number':2877,'multiline':False]['text':' Return when there is nothing to do, screen updating is already','line_number':2882,'multiline':False]['text':' happening (recursive call), messages on the screen or still starting up.','line_number':2883,'multiline':False]['text':' update all windows that need updating','line_number':2893,'multiline':False]['text':'
 * Update a single window, its status line and maybe the command line msg.
 * Used for the GUI scrollbar.
 ','line_number':2909,'multiline':True]['text':' return if already busy updating','line_number':2916,'multiline':False]['text':' When Visual area changed, may have to update selection.','line_number':2923,'multiline':False]['text':' When the screen was cleared redraw the tab pages line.','line_number':2932,'multiline':False]['text':' Display popup windows on top of everything.','line_number':2944,'multiline':False]['text':'
 * Redraw as soon as possible.  When the command line is not scrolled redraw
 * right away and restore what was on the command line.
 * Return a code indicating what happened.
 ','line_number':2952,'multiline':True]['text':' copy from ScreenLines[]','line_number':2964,'multiline':False]['text':' copy from ScreenAttrs[]','line_number':2965,'multiline':False]['text':' copy from ScreenLinesUC[]','line_number':2967,'multiline':False]['text':' copy from ScreenLinesC[][]','line_number':2968,'multiline':False]['text':' copy from ScreenLines2[]','line_number':2969,'multiline':False]['text':' Allocate space to save the text displayed in the command line area.','line_number':2977,'multiline':False]['text':' Save the text displayed in the command line area.','line_number':3004,'multiline':False]['text':' Restore the text displayed in the command line area.','line_number':3036,'multiline':False]['text':' Show the intro message when appropriate.','line_number':3076,'multiline':False]['text':'
 * Invoked after an asynchronous callback is called.
 * If an echo command was used the cursor needs to be put back where
 * it belongs. If highlighting was changed a redraw is needed.
 * If "call_update_screen" is FALSE don't call update_screen() when at the
 * command line.
 * If "redraw_message" is TRUE.
 ','line_number':3084,'multiline':True]['text':' Don't redraw when in prompt_for_number().','line_number':3109,'multiline':False]['text':' Redrawing only works when the screen didn't scroll. Don't clear','line_number':3112,'multiline':False]['text':' wildmenu entries.','line_number':3113,'multiline':False]['text':' Redraw in the same position, so that the user can continue','line_number':3119,'multiline':False]['text':' editing the command.','line_number':3120,'multiline':False]['text':' keep the command line if possible','line_number':3129,'multiline':False]['text':' don't want a hit-enter prompt when something else is displayed','line_number':3135,'multiline':False]['text':' Don't update the cursor when it is blinking and off to avoid','line_number':3143,'multiline':False]['text':' flicker.','line_number':3144,'multiline':False]['text':'
 * Redraw the current window later, with update_screen(type).
 * Set must_redraw only if not already set to a higher value.
 * E.g. if must_redraw is UPD_CLEAR, type UPD_NOT_VALID will do nothing.
 ','line_number':3153,'multiline':True]['text':' must_redraw is the maximum of all windows','line_number':3174,'multiline':False]['text':'
 * Force a complete redraw later.  Also resets the highlighting.  To be used
 * after executing a shell command that messes up the screen.
 ','line_number':3179,'multiline':True]['text':'
 * Mark all windows to be redrawn later.  Except popup windows.
 ','line_number':3190,'multiline':True]['text':' This may be needed when switching tabs.','line_number':3200,'multiline':False]['text':' not actually used yet, it probably should','line_number':3204,'multiline':False]['text':'
 * Mark all windows, including popup windows, to be redrawn.
 ','line_number':3205,'multiline':True]['text':' redraw all popup windows','line_number':3213,'multiline':False]['text':'
 * Set "must_redraw" to "type" unless it already has a higher value
 * or it is currently not allowed.
 ','line_number':3218,'multiline':True]['text':'
 * Mark all windows that are editing the current buffer to be updated later.
 ','line_number':3229,'multiline':True]['text':' terminal in popup window is not in list of windows','line_number':3249,'multiline':False]['text':' Don't redraw while the command line completion is displayed, it','line_number':3275,'multiline':False]['text':' would disappear.','line_number':3276,'multiline':False]['text':'
 * mark all status lines for redraw; used after first :cd
 ','line_number':3289,'multiline':True]['text':'
 * mark all status lines of the current buffer for redraw
 ','line_number':3305,'multiline':True]['text':'
 * Redraw all status lines that need to be redrawn.
 ','line_number':3321,'multiline':True]['text':'
 * Redraw all status lines at the bottom of frame "frp".
 ','line_number':3336,'multiline':True]['text':' frp->fr_layout == FR_COL','line_number':3349,'multiline':False]['text':'
 * Changed something in the current window, at buffer line "lnum", that
 * requires that line and possibly other lines to be redrawn.
 * Used when entering/leaving Insert mode with the cursor on a folded line.
 * Used to remove the "$" from a change command.
 * Note that when also inserting/deleting lines w_redraw_top and w_redraw_bot
 * may become invalid and the whole window will have to be redrawn.
 ','line_number':3358,'multiline':True]