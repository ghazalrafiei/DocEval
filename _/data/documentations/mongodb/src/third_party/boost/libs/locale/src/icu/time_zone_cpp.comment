['text':'','line_number':1,'multiline':False]['text':'  Copyright (c) 2009-2011 Artyom Beilis (Tonkikh)','line_number':2,'multiline':False]['text':'','line_number':3,'multiline':False]['text':'  Distributed under the Boost Software License, Version 1.0. (See','line_number':4,'multiline':False]['text':'  accompanying file LICENSE_1_0.txt or copy at','line_number':5,'multiline':False]['text':'  http://www.boost.org/LICENSE_1_0.txt)','line_number':6,'multiline':False]['text':'','line_number':7,'multiline':False]['text':'','line_number':11,'multiline':False]['text':' Bug - when ICU tries to find a file that is equivalent to /etc/localtime it finds /usr/share/zoneinfo/localtime','line_number':12,'multiline':False]['text':' that is just a symbolic link to /etc/localtime.','line_number':13,'multiline':False]['text':'','line_number':14,'multiline':False]['text':' It started in 4.0 and was fixed in version 4.6, also the fix was backported to the 4.4 branch so it should be','line_number':15,'multiline':False]['text':' available from 4.4.3... So we test if the workaround is required','line_number':16,'multiline':False]['text':'','line_number':17,'multiline':False]['text':' It is also relevant only for Linux, BSD and Apple (as I see in ICU code)','line_number':18,'multiline':False]['text':'','line_number':19,'multiline':False]['text':' This is normal behavior','line_number':46,'multiline':False]['text':'','line_number':61,'multiline':False]['text':' This is a workaround for an ICU timezone detection bug.','line_number':62,'multiline':False]['text':' It is \b very ICU specific and should not be used ','line_number':63,'multiline':False]['text':' in general. It is also designed to work only on','line_number':64,'multiline':False]['text':' specific patforms: Linux, BSD and Apple, where this bug may actually','line_number':65,'multiline':False]['text':' occur','line_number':66,'multiline':False]['text':' ','line_number':67,'multiline':False]['text':' Under BSD, Linux and Mac OS X dirent has normal size','line_number':70,'multiline':False]['text':' so no issues with readdir_r','line_number':71,'multiline':False]['text':' This actually emulates ICU's search','line_number':159,'multiline':False]['text':' algorithm... just it ignores localtime','line_number':160,'multiline':False]['text':'','line_number':180,'multiline':False]['text':' Using pthread as:','line_number':181,'multiline':False]['text':' - This bug is relevant for only Linux, BSD, Mac OS X and','line_number':182,'multiline':False]['text':'  pthreads are native threading API','line_number':183,'multiline':False]['text':' - The dependency on boost.thread may be removed when using','line_number':184,'multiline':False]['text':'   more recent ICU versions (so TLS would not be needed)','line_number':185,'multiline':False]['text':'','line_number':186,'multiline':False]['text':' This the dependency on Boost.Thread is eliminated','line_number':187,'multiline':False]['text':'','line_number':188,'multiline':False]['text':' namespace','line_number':210,'multiline':False]['text':' Check if there is a bug?','line_number':221,'multiline':False]['text':' Now let's deal with the bug and run the fixed','line_number':224,'multiline':False]['text':' search loop as that of ICU','line_number':225,'multiline':False]['text':' if we failed fallback to ICU's time zone','line_number':228,'multiline':False]['text':' bug workaround','line_number':233,'multiline':False]['text':' vim: tabstop=4 expandtab shiftwidth=4 softtabstop=4','line_number':239,'multiline':False]