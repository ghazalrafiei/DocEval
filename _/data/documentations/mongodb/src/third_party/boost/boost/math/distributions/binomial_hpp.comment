['text':' boost\math\distributions\binomial.hpp','line_number':1,'multiline':False]['text':' Copyright John Maddock 2006.','line_number':3,'multiline':False]['text':' Copyright Paul A. Bristow 2007.','line_number':4,'multiline':False]['text':' Use, modification and distribution are subject to the','line_number':6,'multiline':False]['text':' Boost Software License, Version 1.0.','line_number':7,'multiline':False]['text':' (See accompanying file LICENSE_1_0.txt','line_number':8,'multiline':False]['text':' or copy at http://www.boost.org/LICENSE_1_0.txt)','line_number':9,'multiline':False]['text':' http://en.wikipedia.org/wiki/binomial_distribution','line_number':11,'multiline':False]['text':' Binomial distribution is the discrete probability distribution of','line_number':13,'multiline':False]['text':' the number (k) of successes, in a sequence of','line_number':14,'multiline':False]['text':' n independent (yes or no, success or failure) Bernoulli trials.','line_number':15,'multiline':False]['text':' It expresses the probability of a number of events occurring in a fixed time','line_number':17,'multiline':False]['text':' if these events occur with a known average rate (probability of success),','line_number':18,'multiline':False]['text':' and are independent of the time since the last event.','line_number':19,'multiline':False]['text':' The number of cars that pass through a certain point on a road during a given period of time.','line_number':21,'multiline':False]['text':' The number of spelling mistakes a secretary makes while typing a single page.','line_number':22,'multiline':False]['text':' The number of phone calls at a call center per minute.','line_number':23,'multiline':False]['text':' The number of times a web server is accessed per minute.','line_number':24,'multiline':False]['text':' The number of light bulbs that burn out in a certain amount of time.','line_number':25,'multiline':False]['text':' The number of roadkill found per unit length of road','line_number':26,'multiline':False]['text':' http://en.wikipedia.org/wiki/binomial_distribution','line_number':28,'multiline':False]['text':' Given a sample of N measured values k[i],','line_number':30,'multiline':False]['text':' we wish to estimate the value of the parameter x (mean)','line_number':31,'multiline':False]['text':' of the binomial population from which the sample was drawn.','line_number':32,'multiline':False]['text':' To calculate the maximum likelihood value = 1/N sum i = 1 to N of k[i]','line_number':33,'multiline':False]['text':' Also may want a function for EXACTLY k.','line_number':35,'multiline':False]['text':' And probability that there are EXACTLY k occurrences is','line_number':37,'multiline':False]['text':' exp(-x) * pow(x, k) / factorial(k)','line_number':38,'multiline':False]['text':' where x is expected occurrences (mean) during the given interval.','line_number':39,'multiline':False]['text':' For example, if events occur, on average, every 4 min,','line_number':40,'multiline':False]['text':' and we are interested in number of events occurring in 10 min,','line_number':41,'multiline':False]['text':' then x = 10/4 = 2.5','line_number':42,'multiline':False]['text':' http://www.itl.nist.gov/div898/handbook/eda/section3/eda366i.htm','line_number':44,'multiline':False]['text':' The binomial distribution is used when there are','line_number':46,'multiline':False]['text':' exactly two mutually exclusive outcomes of a trial.','line_number':47,'multiline':False]['text':' These outcomes are appropriately labeled "success" and "failure".','line_number':48,'multiline':False]['text':' The binomial distribution is used to obtain','line_number':49,'multiline':False]['text':' the probability of observing x successes in N trials,','line_number':50,'multiline':False]['text':' with the probability of success on a single trial denoted by p.','line_number':51,'multiline':False]['text':' The binomial distribution assumes that p is fixed for all trials.','line_number':52,'multiline':False]['text':' P(x, p, n) = n!/(x! * (n-x)!) * p^x * (1-p)^(n-x)','line_number':54,'multiline':False]['text':' http://mathworld.wolfram.com/BinomialCoefficient.html','line_number':56,'multiline':False]['text':' The binomial coefficient (n; k) is the number of ways of picking','line_number':58,'multiline':False]['text':' k unordered outcomes from n possibilities,','line_number':59,'multiline':False]['text':' also known as a combination or combinatorial number.','line_number':60,'multiline':False]['text':' The symbols _nC_k and (n; k) are used to denote a binomial coefficient,','line_number':61,'multiline':False]['text':' and are sometimes read as "n choose k."','line_number':62,'multiline':False]['text':' (n; k) therefore gives the number of k-subsets  possible out of a set of n distinct items.','line_number':63,'multiline':False]['text':' For example:','line_number':65,'multiline':False]['text':'  The 2-subsets of {1,2,3,4} are the six pairs {1,2}, {1,3}, {1,4}, {2,3}, {2,4}, and {3,4}, so (4; 2)==6.','line_number':66,'multiline':False]['text':' http://functions.wolfram.com/GammaBetaErf/Binomial/ for evaluation.','line_number':68,'multiline':False]['text':' But note that the binomial distribution','line_number':70,'multiline':False]['text':' (like others including the poisson, negative binomial & Bernoulli)','line_number':71,'multiline':False]['text':' is strictly defined as a discrete function: only integral values of k are envisaged.','line_number':72,'multiline':False]['text':' However because of the method of calculation using a continuous gamma function,','line_number':73,'multiline':False]['text':' it is convenient to treat it as if a continuous function,','line_number':74,'multiline':False]['text':' and permit non-integral values of k.','line_number':75,'multiline':False]['text':' To enforce the strict mathematical model, users should use floor or ceil functions','line_number':76,'multiline':False]['text':' on k outside this function to ensure that k is integral.','line_number':77,'multiline':False]['text':' for incomplete beta.','line_number':83,'multiline':False]['text':' complements','line_number':84,'multiline':False]['text':' error checks','line_number':85,'multiline':False]['text':' error checks','line_number':86,'multiline':False]['text':' isnan.','line_number':87,'multiline':False]['text':' for root finding.','line_number':88,'multiline':False]['text':' common error checking routines for binomial distribution functions:','line_number':101,'multiline':False]['text':' mean:','line_number':167,'multiline':False]['text':' standard deviation:','line_number':169,'multiline':False]['text':' skewness','line_number':171,'multiline':False]['text':' kurtosis:','line_number':173,'multiline':False]['text':' T k = (1 - 6 * sf * (1 - sf) ) / (n * sf * (1 - sf));','line_number':174,'multiline':False]['text':' Get the inverse of a std normal distribution:','line_number':175,'multiline':False]['text':' Set the sign:','line_number':177,'multiline':False]['text':' w is correction term due to skewness','line_number':181,'multiline':False]['text':'
            // Add on correction due to kurtosis.
            // Disabled for now, seems to make things worse?
            //
            if(n >= 10)
               w += k * x * (x2 - 3) / 24 + sk * sk * x * (2 * x2 - 5) / -36;
               ','line_number':183,'multiline':True]['text':' Quantile or Percent Point Binomial function.','line_number':200,'multiline':False]['text':' Return the number of expected successes k,','line_number':201,'multiline':False]['text':' for a given probability p.','line_number':202,'multiline':False]['text':'','line_number':203,'multiline':False]['text':' Error checks:','line_number':204,'multiline':False]['text':' ADL of std names','line_number':205,'multiline':False]['text':' Special cases:','line_number':219,'multiline':False]['text':'','line_number':220,'multiline':False]['text':' There may actually be no answer to this question,','line_number':222,'multiline':False]['text':' since the probability of zero successes may be non-zero,','line_number':223,'multiline':False]['text':' but zero is the best we can do:','line_number':224,'multiline':False]['text':' Probability of n or fewer successes is always one,','line_number':228,'multiline':False]['text':' so n is the most sensible answer here:','line_number':229,'multiline':False]['text':' p <= pdf(dist, 0) == cdf(dist, 0)','line_number':233,'multiline':False]['text':' So the only reasonable result is zero.','line_number':234,'multiline':False]['text':' And root finder would fail otherwise.','line_number':235,'multiline':False]['text':' our formulae break down in this case:','line_number':237,'multiline':False]['text':' Solve for quantile numerically:','line_number':241,'multiline':False]['text':'','line_number':242,'multiline':False]['text':' guess is pretty accurate','line_number':246,'multiline':False]['text':' less accurate but OK.','line_number':248,'multiline':False]['text':' pretty inaccurate guess in this area:','line_number':251,'multiline':False]['text':' trials largish, but in far tails.','line_number':261,'multiline':False]['text':' quantile','line_number':274,'multiline':False]['text':' Default n = 1 is the Bernoulli distribution','line_number':286,'multiline':False]['text':' with equal probability of 'heads' or 'tails.','line_number':287,'multiline':False]['text':' binomial_distribution constructor.','line_number':294,'multiline':False]['text':' Probability.','line_number':297,'multiline':False]['text':' Total number of trials.','line_number':301,'multiline':False]['text':'','line_number':310,'multiline':False]['text':' Estimation of the success fraction parameter.','line_number':311,'multiline':False]['text':' The best estimate is actually simply successes/trials,','line_number':312,'multiline':False]['text':' these functions are used','line_number':313,'multiline':False]['text':' to obtain confidence intervals for the success fraction.','line_number':314,'multiline':False]['text':'','line_number':315,'multiline':False]['text':' Error checks:','line_number':323,'multiline':False]['text':' NOTE!!! The Clopper Pearson formula uses "successes" not','line_number':335,'multiline':False]['text':' "successes+1" as usual to get the lower bound,','line_number':336,'multiline':False]['text':' see http://www.itl.nist.gov/div898/handbook/prc/section2/prc241.htm','line_number':337,'multiline':False]['text':' Error checks:','line_number':348,'multiline':False]['text':' Estimate number of trials parameter:','line_number':363,'multiline':False]['text':'','line_number':364,'multiline':False]['text':' "How many trials do I need to be P% sure of seeing k events?"','line_number':365,'multiline':False]['text':'    or','line_number':366,'multiline':False]['text':' "How many trials can I have to be P% sure of seeing fewer than k events?"','line_number':367,'multiline':False]['text':'','line_number':368,'multiline':False]['text':' number of events','line_number':370,'multiline':False]['text':' success fraction','line_number':371,'multiline':False]['text':' risk level','line_number':372,'multiline':False]['text':' Error checks:','line_number':375,'multiline':False]['text':' returns n - k','line_number':384,'multiline':False]['text':' number of events','line_number':389,'multiline':False]['text':' success fraction','line_number':390,'multiline':False]['text':' risk level','line_number':391,'multiline':False]['text':' Error checks:','line_number':394,'multiline':False]['text':' returns n - k','line_number':403,'multiline':False]['text':' Not sure if this shouldn't be an int?','line_number':408,'multiline':False]['text':' success_fraction','line_number':409,'multiline':False]['text':' template <class RealType, class Policy> class binomial_distribution','line_number':410,'multiline':False]['text':' typedef binomial_distribution<double> binomial;','line_number':413,'multiline':False]['text':' IS now included since no longer a name clash with function binomial.','line_number':414,'multiline':False]['text':'typedef binomial_distribution<double> binomial; // Reserved name of type double.','line_number':415,'multiline':False]['text':' Range of permissible values for random variable k.','line_number':426,'multiline':False]['text':' Range of supported values for random variable k.','line_number':433,'multiline':False]['text':' This is range where cdf rises from 0 to 1, and outside it, the pdf is zero.','line_number':434,'multiline':False]['text':' Mean of Binomial distribution = np.','line_number':440,'multiline':False]['text':' mean','line_number':442,'multiline':False]['text':' Variance of Binomial distribution = np(1-p).','line_number':446,'multiline':False]['text':' variance','line_number':448,'multiline':False]['text':' Probability Density/Mass Function.','line_number':452,'multiline':False]['text':' for ADL of std functions','line_number':455,'multiline':False]['text':' Error check:','line_number':459,'multiline':False]['text':' initialization silences some compiler warnings','line_number':460,'multiline':False]['text':' Special cases of success_fraction, regardless of k successes and regardless of n trials.','line_number':471,'multiline':False]['text':' probability of zero successes is 1:','line_number':473,'multiline':False]['text':' probability of n successes is 1:','line_number':477,'multiline':False]['text':' k argument may be integral, signed, or unsigned, or floating point.','line_number':480,'multiline':False]['text':' If necessary, it has already been promoted from an integral type.','line_number':481,'multiline':False]['text':' Probability = 1 = certainty.','line_number':484,'multiline':False]['text':' binomial coeffic (n 0) = 1,','line_number':487,'multiline':False]['text':' n ^ 0 = 1','line_number':488,'multiline':False]['text':' binomial coeffic (n n) = 1,','line_number':492,'multiline':False]['text':' n ^ 0 = 1','line_number':493,'multiline':False]['text':' * pow((1 - dist.success_fraction()), (n - k)) = 1','line_number':494,'multiline':False]['text':' Probability of getting exactly k successes','line_number':497,'multiline':False]['text':' if C(n, k) is the binomial coefficient then:','line_number':498,'multiline':False]['text':'','line_number':499,'multiline':False]['text':' f(k; n,p) = C(n, k) * p^k * (1-p)^(n-k)','line_number':500,'multiline':False]['text':'           = (n!/(k!(n-k)!)) * p^k * (1-p)^(n-k)','line_number':501,'multiline':False]['text':'           = (tgamma(n+1) / (tgamma(k+1)*tgamma(n-k+1))) * p^k * (1-p)^(n-k)','line_number':502,'multiline':False]['text':'           = p^k (1-p)^(n-k) / (beta(k+1, n-k+1) * (n+1))','line_number':503,'multiline':False]['text':'           = ibeta_derivative(k+1, n-k+1, p) / (n+1)','line_number':504,'multiline':False]['text':'','line_number':505,'multiline':False]['text':' a, b, x','line_number':506,'multiline':False]['text':' pdf','line_number':509,'multiline':False]['text':' Cumulative Distribution Function Binomial.','line_number':513,'multiline':False]['text':' The random variate k is the number of successes in n trials.','line_number':514,'multiline':False]['text':' k argument may be integral, signed, or unsigned, or floating point.','line_number':515,'multiline':False]['text':' If necessary, it has already been promoted from an integral type.','line_number':516,'multiline':False]['text':' Returns the sum of the terms 0 through k of the Binomial Probability Density/Mass:','line_number':518,'multiline':False]['text':'','line_number':519,'multiline':False]['text':'   i=k','line_number':520,'multiline':False]['text':'   --  ( n )   i      n-i','line_number':521,'multiline':False]['text':'   >   |   |  p  (1-p)','line_number':522,'multiline':False]['text':'   --  ( i )','line_number':523,'multiline':False]['text':'   i=0','line_number':524,'multiline':False]['text':' The terms are not summed directly instead','line_number':526,'multiline':False]['text':' the incomplete beta integral is employed,','line_number':527,'multiline':False]['text':' according to the formula:','line_number':528,'multiline':False]['text':' P = I[1-p]( n-k, k+1).','line_number':529,'multiline':False]['text':'   = 1 - I[p](k + 1, n - k)','line_number':530,'multiline':False]['text':' for ADL of std functions','line_number':532,'multiline':False]['text':' Error check:','line_number':537,'multiline':False]['text':' Special cases, regardless of k.','line_number':553,'multiline':False]['text':' This need explanation:','line_number':555,'multiline':False]['text':' the pdf is zero for all cases except when k == 0.','line_number':556,'multiline':False]['text':' For zero p the probability of zero successes is one.','line_number':557,'multiline':False]['text':' Therefore the cdf is always 1:','line_number':558,'multiline':False]['text':' the probability of k or *fewer* successes is always 1','line_number':559,'multiline':False]['text':' if there are never any successes!','line_number':560,'multiline':False]['text':' This is correct but needs explanation:','line_number':564,'multiline':False]['text':' when k = 1','line_number':565,'multiline':False]['text':' all the cdf and pdf values are zero *except* when k == n,','line_number':566,'multiline':False]['text':' and that case has been handled above already.','line_number':567,'multiline':False]['text':'','line_number':570,'multiline':False]['text':' P = I[1-p](n - k, k + 1)','line_number':571,'multiline':False]['text':'   = 1 - I[p](k + 1, n - k)','line_number':572,'multiline':False]['text':' Use of ibetac here prevents cancellation errors in calculating','line_number':573,'multiline':False]['text':' 1-p if p is very small, perhaps smaller than machine epsilon.','line_number':574,'multiline':False]['text':'','line_number':575,'multiline':False]['text':' Note that we do not use a finite sum here, since the incomplete','line_number':576,'multiline':False]['text':' beta uses a finite sum internally for integer arguments, so','line_number':577,'multiline':False]['text':' we'll just let it take care of the necessary logic.','line_number':578,'multiline':False]['text':'','line_number':579,'multiline':False]['text':' binomial cdf','line_number':581,'multiline':False]['text':' Complemented Cumulative Distribution Function Binomial.','line_number':585,'multiline':False]['text':' The random variate k is the number of successes in n trials.','line_number':586,'multiline':False]['text':' k argument may be integral, signed, or unsigned, or floating point.','line_number':587,'multiline':False]['text':' If necessary, it has already been promoted from an integral type.','line_number':588,'multiline':False]['text':' Returns the sum of the terms k+1 through n of the Binomial Probability Density/Mass:','line_number':590,'multiline':False]['text':'','line_number':591,'multiline':False]['text':'   i=n','line_number':592,'multiline':False]['text':'   --  ( n )   i      n-i','line_number':593,'multiline':False]['text':'   >   |   |  p  (1-p)','line_number':594,'multiline':False]['text':'   --  ( i )','line_number':595,'multiline':False]['text':'   i=k+1','line_number':596,'multiline':False]['text':' The terms are not summed directly instead','line_number':598,'multiline':False]['text':' the incomplete beta integral is employed,','line_number':599,'multiline':False]['text':' according to the formula:','line_number':600,'multiline':False]['text':' Q = 1 -I[1-p]( n-k, k+1).','line_number':601,'multiline':False]['text':'   = I[p](k + 1, n - k)','line_number':602,'multiline':False]['text':' for ADL of std functions','line_number':604,'multiline':False]['text':' Error checks:','line_number':611,'multiline':False]['text':' Probability of greater than n successes is necessarily zero:','line_number':624,'multiline':False]['text':' Special cases, regardless of k.','line_number':628,'multiline':False]['text':' This need explanation: the pdf is zero for all','line_number':631,'multiline':False]['text':' cases except when k == 0.  For zero p the probability','line_number':632,'multiline':False]['text':' of zero successes is one.  Therefore the cdf is always','line_number':633,'multiline':False]['text':' 1: the probability of *more than* k successes is always 0','line_number':634,'multiline':False]['text':' if there are never any successes!','line_number':635,'multiline':False]['text':' This needs explanation, when p = 1','line_number':640,'multiline':False]['text':' we always have n successes, so the probability','line_number':641,'multiline':False]['text':' of more than k successes is 1 as long as k < n.','line_number':642,'multiline':False]['text':' The k == n case has already been handled above.','line_number':643,'multiline':False]['text':'','line_number':646,'multiline':False]['text':' Calculate cdf binomial using the incomplete beta function.','line_number':647,'multiline':False]['text':' Q = 1 -I[1-p](n - k, k + 1)','line_number':648,'multiline':False]['text':'   = I[p](k + 1, n - k)','line_number':649,'multiline':False]['text':' Use of ibeta here prevents cancellation errors in calculating','line_number':650,'multiline':False]['text':' 1-p if p is very small, perhaps smaller than machine epsilon.','line_number':651,'multiline':False]['text':'','line_number':652,'multiline':False]['text':' Note that we do not use a finite sum here, since the incomplete','line_number':653,'multiline':False]['text':' beta uses a finite sum internally for integer arguments, so','line_number':654,'multiline':False]['text':' we'll just let it take care of the necessary logic.','line_number':655,'multiline':False]['text':'','line_number':656,'multiline':False]['text':' binomial cdf','line_number':658,'multiline':False]['text':' quantile','line_number':664,'multiline':False]['text':' quantile','line_number':670,'multiline':False]['text':' ADL of std functions.','line_number':675,'multiline':False]['text':' Bounds for the median of the negative binomial distribution','line_number':683,'multiline':False]['text':' VAN DE VEN R. ; WEBER N. C. ;','line_number':684,'multiline':False]['text':' Univ. Sydney, school mathematics statistics, Sydney N.S.W. 2006, AUSTRALIE','line_number':685,'multiline':False]['text':' Metrika  (Metrika)  ISSN 0026-1335   CODEN MTRKA8','line_number':686,'multiline':False]['text':' 1993, vol. 40, no3-4, pp. 185-189 (4 ref.)','line_number':687,'multiline':False]['text':' Bounds for median and 50 percentage point of binomial and negative binomial distribution','line_number':689,'multiline':False]['text':' Metrika, ISSN   0026-1335 (Print) 1435-926X (Online)','line_number':690,'multiline':False]['text':' Volume 41, Number 1 / December, 1994, DOI   10.1007/BF01895303','line_number':691,'multiline':False]['text':' ADL of std functions.','line_number':692,'multiline':False]['text':' Wikipedia says one of floor(np) -1, floor (np), floor(np) +1','line_number':695,'multiline':False]['text':' Chose the middle value.','line_number':696,'multiline':False]['text':' ADL of std functions.','line_number':702,'multiline':False]['text':' namespace math','line_number':725,'multiline':False]['text':' namespace boost','line_number':726,'multiline':False]['text':' This include must be at the end, *after* the accessors','line_number':728,'multiline':False]['text':' for this distribution have been defined, in order to','line_number':729,'multiline':False]['text':' keep compilers that support two-phase lookup happy.','line_number':730,'multiline':False]['text':' BOOST_MATH_SPECIAL_BINOMIAL_HPP','line_number':733,'multiline':False]