['text':' Â© 2016 and later: Unicode, Inc. and others.','line_number':1,'multiline':False]['text':' License & terms of use: http://www.unicode.org/copyright.html','line_number':2,'multiline':False]['text':'
***************************************************************************
* Copyright (C) 2008-2013, International Business Machines Corporation
* and others. All Rights Reserved.
***************************************************************************
*
*  uspoof_impl.h
*
*    Implemenation header for spoof detection
*
','line_number':3,'multiline':True]['text':' The maximium length (in UTF-16 UChars) of the skeleton replacement string resulting from','line_number':34,'multiline':False]['text':'   a single input code point.  This is function of the unicode.org data.','line_number':35,'multiline':False]['text':' The default stack buffer size for copies or conversions or normalizations','line_number':38,'multiline':False]['text':' of input strings being checked.  (Used in multiple places.)','line_number':39,'multiline':False]['text':' Magic number for sanity checking spoof data.','line_number':42,'multiline':False]['text':' Magic number for sanity checking spoof checkers.','line_number':45,'multiline':False]['text':'*
  *  Class SpoofImpl corresponds directly to the plain C API opaque type
  *  USpoofChecker.  One can be cast to the other.
  ','line_number':53,'multiline':True]['text':'* Copy constructor, used by the user level uspoof_clone() function.
     ','line_number':66,'multiline':True]['text':'* Set and Get AllowedLocales, implementations of the corresponding API ','line_number':74,'multiline':True]['text':' Add (union) to the UnicodeSet all of the characters for the scripts used for','line_number':78,'multiline':False]['text':' the specified locale.  Part of the implementation of setAllowedLocales.','line_number':79,'multiline':False]['text':' Functions implementing the features of UTS 39 section 5.','line_number':82,'multiline':False]['text':'* parse a hex number.  Untility used by the builders.   ','line_number':92,'multiline':True]['text':'','line_number':98,'multiline':False]['text':' Data Members','line_number':99,'multiline':False]['text':'','line_number':100,'multiline':False]['text':' Bit vector of checks to perform.','line_number':102,'multiline':False]['text':' The UnicodeSet of allowed characters.','line_number':106,'multiline':False]['text':'   for this Spoof Checker.  Defaults to all chars.','line_number':107,'multiline':False]['text':' The list of allowed locales.','line_number':109,'multiline':False]['text':' The maximum restriction level for an acceptable identifier.','line_number':110,'multiline':False]['text':'*
 *  Class CheckResult corresponds directly to the plain C API opaque type
 *  USpoofCheckResult.  One can be cast to the other.
 ','line_number':113,'multiline':True]['text':' Used to convert this CheckResult to the older int32_t return value API','line_number':129,'multiline':False]['text':' Data Members','line_number':132,'multiline':False]['text':' Bit vector of checks that were failed.','line_number':133,'multiline':False]['text':' Set of numerics found in the string.','line_number':134,'multiline':False]['text':' The restriction level of the string.','line_number':135,'multiline':False]['text':'','line_number':139,'multiline':False]['text':'  Confusable Mappings Data Structures, version 2.0','line_number':140,'multiline':False]['text':'','line_number':141,'multiline':False]['text':'    For the confusable data, we are essentially implementing a map,','line_number':142,'multiline':False]['text':'       key:    a code point','line_number':143,'multiline':False]['text':'       value:  a string.  Most commonly one char in length, but can be more.','line_number':144,'multiline':False]['text':'','line_number':145,'multiline':False]['text':'    The keys are stored as a sorted array of 32 bit ints.','line_number':146,'multiline':False]['text':'             bits 0-23    a code point value','line_number':147,'multiline':False]['text':'             bits 24-31   length of value string, in UChars (between 1 and 256 UChars).','line_number':148,'multiline':False]['text':'        The key table is sorted in ascending code point order.  (not on the','line_number':149,'multiline':False]['text':'        32 bit int value, the flag bits do not participate in the sorting.)','line_number':150,'multiline':False]['text':'','line_number':151,'multiline':False]['text':'        Lookup is done by means of a binary search in the key table.','line_number':152,'multiline':False]['text':'','line_number':153,'multiline':False]['text':'    The corresponding values are kept in a parallel array of 16 bit ints.','line_number':154,'multiline':False]['text':'        If the value string is of length 1, it is literally in the value array.','line_number':155,'multiline':False]['text':'        For longer strings, the value array contains an index into the strings table.','line_number':156,'multiline':False]['text':'','line_number':157,'multiline':False]['text':'    String Table:','line_number':158,'multiline':False]['text':'       The strings table contains all of the value strings (those of length two or greater)','line_number':159,'multiline':False]['text':'       concatenated together into one long UChar (UTF-16) array.','line_number':160,'multiline':False]['text':'','line_number':161,'multiline':False]['text':'       There is no nul character or other mark between adjacent strings.','line_number':162,'multiline':False]['text':'','line_number':163,'multiline':False]['text':'----------------------------------------------------------------------------','line_number':164,'multiline':False]['text':'','line_number':165,'multiline':False]['text':'  Changes from format version 1 to format version 2:','line_number':166,'multiline':False]['text':'      1) Removal of the whole-script confusable data tables.','line_number':167,'multiline':False]['text':'      2) Removal of the SL/SA/ML/MA and multi-table flags in the key bitmask.','line_number':168,'multiline':False]['text':'      3) Expansion of string length value in the key bitmask from 2 bits to 8 bits.','line_number':169,'multiline':False]['text':'      4) Removal of the string lengths table since 8 bits is sufficient for the','line_number':170,'multiline':False]['text':'         lengths of all entries in confusables.txt.','line_number':171,'multiline':False]['text':' Internal functions for manipulating confusable data table keys','line_number':175,'multiline':False]['text':' version for ICU 58','line_number':176,'multiline':False]['text':'-------------------------------------------------------------------------------------','line_number':193,'multiline':False]['text':'','line_number':194,'multiline':False]['text':'  SpoofData','line_number':195,'multiline':False]['text':'','line_number':196,'multiline':False]['text':'    A small class that wraps the raw (usually memory mapped) spoof data.','line_number':197,'multiline':False]['text':'    Serves two primary functions:','line_number':198,'multiline':False]['text':'      1.  Convenience.  Contains real pointers to the data, to avoid dealing with','line_number':199,'multiline':False]['text':'          the offsets in the raw data.','line_number':200,'multiline':False]['text':'      2.  Reference counting.  When a spoof checker is cloned, the raw data is shared','line_number':201,'multiline':False]['text':'          and must be retained until all checkers using the data are closed.','line_number':202,'multiline':False]['text':'    Nothing in this struct includes state that is specific to any particular','line_number':203,'multiline':False]['text':'    USpoofDetector object.','line_number':204,'multiline':False]['text':'','line_number':205,'multiline':False]['text':'---------------------------------------------------------------------------------------','line_number':206,'multiline':False]['text':' Get standard ICU spoof data.','line_number':209,'multiline':False]['text':' Cleanup reference to default spoof data.','line_number':210,'multiline':False]['text':' Create new spoof data wrapper.','line_number':212,'multiline':False]['text':' Only used when building new data from rules.','line_number':213,'multiline':False]['text':' Constructor for use when creating from prebuilt default data.','line_number':215,'multiline':False]['text':'   A UDataMemory is what the ICU internal data loading functions provide.','line_number':216,'multiline':False]['text':'   The udm is adopted by the SpoofData.','line_number':217,'multiline':False]['text':' Constructor for use when creating from serialized data.','line_number':220,'multiline':False]['text':'','line_number':221,'multiline':False]['text':'  Check raw Spoof Data Version compatibility.','line_number':224,'multiline':False]['text':'  Return true it looks good.','line_number':225,'multiline':False]['text':' Destructor not normally used.','line_number':228,'multiline':False]['text':' Use removeReference() instead.','line_number':229,'multiline':False]['text':' Reference Counting functions.','line_number':230,'multiline':False]['text':'    Clone of a user-level spoof detector increments the ref count on the data.','line_number':231,'multiline':False]['text':'    Close of a user-level spoof detector decrements the ref count.','line_number':232,'multiline':False]['text':'    If the data is owned by us, it will be deleted when count goes to zero.','line_number':233,'multiline':False]['text':' Reset all fields to an initial state.','line_number':237,'multiline':False]['text':' Called from the top of all constructors.','line_number':238,'multiline':False]['text':' Copy this instance's raw data buffer to the specified address.','line_number':241,'multiline':False]['text':' Get the total number of bytes of data backed by this SpoofData.','line_number':244,'multiline':False]['text':' Not to be confused with length, which returns the number of confusable entries.','line_number':245,'multiline':False]['text':' Get the confusable skeleton transform for a single code point.','line_number':248,'multiline':False]['text':' The result is a string with a length between 1 and 18 as of Unicode 9.','line_number':249,'multiline':False]['text':' This is the main public endpoint for this class.','line_number':250,'multiline':False]['text':' @return   The length in UTF-16 code units of the substition string.','line_number':251,'multiline':False]['text':' Get the number of confusable entries in this SpoofData.','line_number':254,'multiline':False]['text':' Get the code point (key) at the specified index.','line_number':257,'multiline':False]['text':' Get the confusable skeleton (value) at the specified index.','line_number':260,'multiline':False]['text':' Append it to the specified UnicodeString&.','line_number':261,'multiline':False]['text':' @return   The length in UTF-16 code units of the skeleton string.','line_number':262,'multiline':False]['text':' Reserve space in the raw data.  For use by builder when putting together a','line_number':266,'multiline':False]['text':'   new set of data.  Init the new storage to zero, to prevent inconsistent','line_number':267,'multiline':False]['text':'   results if it is not all otherwise set by the requester.','line_number':268,'multiline':False]['text':'  Return:','line_number':269,'multiline':False]['text':'    pointer to the new space that was added by this function.','line_number':270,'multiline':False]['text':' initialize the pointers from this object to the raw data.','line_number':273,'multiline':False]['text':' Ptr to the raw memory-mapped data','line_number':276,'multiline':False]['text':' True if the raw data is owned, and needs','line_number':277,'multiline':False]['text':'  to be deleted when refcount goes to zero.','line_number':278,'multiline':False]['text':' If not NULL, our data came from a','line_number':279,'multiline':False]['text':'   UDataMemory, which we must close when','line_number':280,'multiline':False]['text':'   we are done.','line_number':281,'multiline':False]['text':' Limit of available raw data space','line_number':283,'multiline':False]['text':' Confusable data','line_number':286,'multiline':False]['text':'---------------------------------------------------------------------------------------','line_number':294,'multiline':False]['text':'','line_number':295,'multiline':False]['text':'  Raw Binary Data Formats, as loaded from the ICU data file,','line_number':296,'multiline':False]['text':'    or as built by the builder.','line_number':297,'multiline':False]['text':'','line_number':298,'multiline':False]['text':'---------------------------------------------------------------------------------------','line_number':299,'multiline':False]['text':' (0x3845fdef)','line_number':301,'multiline':False]['text':' Data Format. Same as the value in struct UDataInfo','line_number':302,'multiline':False]['text':'   if there is one associated with this data.','line_number':303,'multiline':False]['text':' Total lenght in bytes of this spoof data,','line_number':304,'multiline':False]['text':'   including all sections, not just the header.','line_number':305,'multiline':False]['text':' The following four sections refer to data representing the confusable data','line_number':307,'multiline':False]['text':'   from the Unicode.org data from "confusables.txt"','line_number':308,'multiline':False]['text':' byte offset to Keys table (from SpoofDataHeader *)','line_number':310,'multiline':False]['text':' number of entries in keys table  (32 bits each)','line_number':311,'multiline':False]['text':' TODO: change name to fCFUValues, for consistency.','line_number':313,'multiline':False]['text':' byte offset to String Indexes table','line_number':314,'multiline':False]['text':' number of entries in String Indexes table (16 bits each)','line_number':315,'multiline':False]['text':'     (number of entries must be same as in Keys table','line_number':316,'multiline':False]['text':' byte offset of String table','line_number':318,'multiline':False]['text':' length of string table (in 16 bit UChars)','line_number':319,'multiline':False]['text':' The following sections are for data from xidmodifications.txt','line_number':321,'multiline':False]['text':' Padding, Room for Expansion','line_number':323,'multiline':False]['text':' __cplusplus ','line_number':329,'multiline':True]['text':'*
  * Endianness swap function for binary spoof data.
  * @internal
  ','line_number':331,'multiline':True]['text':' USPOOFIM_H ','line_number':342,'multiline':True]