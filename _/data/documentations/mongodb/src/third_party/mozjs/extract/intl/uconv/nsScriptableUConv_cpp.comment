['text':' -*- Mode: C++; tab-width: 2; indent-tabs-mode: nil; c-basic-offset: 2 -*- ','line_number':2,'multiline':True]['text':' This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. ','line_number':3,'multiline':True]['text':' Implementation file ','line_number':15,'multiline':True]['text':' We can compute the length without replacement, because the','line_number':28,'multiline':False]['text':' the replacement is only one byte long and a mappable character','line_number':29,'multiline':False]['text':' would always output something, i.e. at least one byte.','line_number':30,'multiline':False]['text':' When encoding to ISO-2022-JP, unmappables shouldn't be able','line_number':31,'multiline':False]['text':' to cause more escape sequences to be emitted than the mappable','line_number':32,'multiline':False]['text':' worst case where every input character causes an escape into','line_number':33,'multiline':False]['text':' a different state.','line_number':34,'multiline':False]['text':' The documentation for this method says it should be called after','line_number':76,'multiline':False]['text':' ConvertFromUnicode(). However, our own tests called it after','line_number':77,'multiline':False]['text':' convertFromByteArray(), i.e. when *decoding*.','line_number':78,'multiline':False]['text':' Assuming that there exists extensions that similarly call','line_number':79,'multiline':False]['text':' this at the wrong time, let's deal. In general, it is a design','line_number':80,'multiline':False]['text':' error for this class to handle conversions in both directions.','line_number':81,'multiline':False]['text':' If we are encoding to ISO-2022-JP, potentially','line_number':87,'multiline':False]['text':' transition back to the ASCII state. The buffer','line_number':88,'multiline':False]['text':' needs to be large enough for an additional NCR,','line_number':89,'multiline':False]['text':' though.','line_number':90,'multiline':False]['text':' The UTF-8 decoder used to throw regardless of the error behavior.','line_number':133,'multiline':False]['text':' Simulating the old behavior for compatibility with legacy callers.','line_number':134,'multiline':False]['text':' If callers want control over the behavior, they should switch to','line_number':135,'multiline':False]['text':' TextDecoder.','line_number':136,'multiline':False]['text':' There's always room for one byte in the case of','line_number':183,'multiline':False]['text':' an unmappable character, because otherwise','line_number':184,'multiline':False]['text':' we'd have gotten `kOutputFull`.','line_number':185,'multiline':False]