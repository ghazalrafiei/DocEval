['text':' -*- Mode: C++; tab-width: 8; indent-tabs-mode: nil; c-basic-offset: 2 -*- ','line_number':1,'multiline':True]['text':' vim: set ts=8 sts=2 et sw=2 tw=80: ','line_number':2,'multiline':True]['text':' This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at http://mozilla.org/MPL/2.0/. ','line_number':3,'multiline':True]['text':' Temporarily instead of handling the signal, we crash intentionally and','line_number':28,'multiline':False]['text':' send some diagnostic information to find out why the signal is received.','line_number':29,'multiline':False]['text':' The address is inside the buffer, handle the failure.','line_number':32,'multiline':False]['text':' This signal is not caused by accessing region protected by MmapAccessScope.','line_number':36,'multiline':False]['text':' Forward the signal to the next handler.','line_number':37,'multiline':False]['text':' There is no next handler. Uninstalling our handler and returning will','line_number':42,'multiline':False]['text':' cause a crash.','line_number':43,'multiline':False]['text':' This function is called from MmapAccessScope's constructor because there is','line_number':54,'multiline':False]['text':' no single point where we could install the handler during startup. This','line_number':55,'multiline':False]['text':' means that it's called quite often, so to minimize using of the mutex we','line_number':56,'multiline':False]['text':' first check the atomic variable outside the lock.','line_number':57,'multiline':False]['text':' Just spin lock here. It should not take a substantial amount','line_number':76,'multiline':False]['text':' of time, so a mutex would likely be a spin lock anyway, and','line_number':77,'multiline':False]['text':' this avoids the need to new up a static mutex from within','line_number':78,'multiline':False]['text':' mozglue/misc, which complicates things with','line_number':79,'multiline':False]['text':' check_vanilla_allocations.py','line_number':80,'multiline':False]['text':' Install signal handler if it wasn't installed yet.','line_number':88,'multiline':False]['text':' We'll handle the signal only if the crashing address is inside this buffer.','line_number':91,'multiline':False]['text':' mJmpBuf is set outside of this classs for reasons mentioned in the header','line_number':105,'multiline':False]['text':' file, but we need to initialize the member here too to make Coverity happy.','line_number':106,'multiline':False]['text':' If MmapAccessScopes are nested, save the previous one and restore it in','line_number':109,'multiline':False]['text':' the destructor.','line_number':110,'multiline':False]['text':' MmapAccessScope is now set up (except mJmpBuf for reasons mentioned in the','line_number':113,'multiline':False]['text':' header file). Store the pointer in a thread-local variable sMmapAccessScope','line_number':114,'multiline':False]['text':' so we can use it in the handler if the signal is triggered.','line_number':115,'multiline':False]['text':' All we have is the buffer and the crashing address.','line_number':124,'multiline':False]