['text':'!/usr/bin/env python','line_number':1,'multiline':False]['text':'','line_number':2,'multiline':False]['text':' Public Domain 2014-present MongoDB, Inc.','line_number':3,'multiline':False]['text':' Public Domain 2008-2014 WiredTiger, Inc.','line_number':4,'multiline':False]['text':'','line_number':5,'multiline':False]['text':' This is free and unencumbered software released into the public domain.','line_number':6,'multiline':False]['text':'','line_number':7,'multiline':False]['text':' Anyone is free to copy, modify, publish, use, compile, sell, or','line_number':8,'multiline':False]['text':' distribute this software, either in source code form or as a compiled','line_number':9,'multiline':False]['text':' binary, for any purpose, commercial or non-commercial, and by any','line_number':10,'multiline':False]['text':' means.','line_number':11,'multiline':False]['text':'','line_number':12,'multiline':False]['text':' In jurisdictions that recognize copyright laws, the author or authors','line_number':13,'multiline':False]['text':' of this software dedicate any and all copyright interest in the','line_number':14,'multiline':False]['text':' software to the public domain. We make this dedication for the benefit','line_number':15,'multiline':False]['text':' of the public at large and to the detriment of our heirs and','line_number':16,'multiline':False]['text':' successors. We intend this dedication to be an overt act of','line_number':17,'multiline':False]['text':' relinquishment in perpetuity of all present and future rights to this','line_number':18,'multiline':False]['text':' software under copyright law.','line_number':19,'multiline':False]['text':'','line_number':20,'multiline':False]['text':' THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,','line_number':21,'multiline':False]['text':' EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF','line_number':22,'multiline':False]['text':' MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.','line_number':23,'multiline':False]['text':' IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR','line_number':24,'multiline':False]['text':' OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,','line_number':25,'multiline':False]['text':' ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR','line_number':26,'multiline':False]['text':' OTHER DEALINGS IN THE SOFTWARE.','line_number':27,'multiline':False]['text':'','line_number':28,'multiline':False]['text':' test_timestamp04.py','line_number':29,'multiline':False]['text':'   Timestamps: Test that rollback_to_stable obeys expected visibility rules.','line_number':30,'multiline':False]['text':'','line_number':31,'multiline':False]['text':' Minimum cache_size requirement of lsm is 31MB.','line_number':53,'multiline':False]['text':' FLCS does not yet work in a timestamp world.','line_number':55,'multiline':False]['text':' Check that a cursor (optionally started in a new transaction), sees the','line_number':66,'multiline':False]['text':' expected values.','line_number':67,'multiline':False]['text':' Search for the expected items as well as iterating.','line_number':79,'multiline':False]['text':' Fixed-length column-store rows always exist.','line_number':87,'multiline':False]['text':' This test varies the cache size and so needs to set up its own connection.','line_number':95,'multiline':False]['text':' Override the standard methods.','line_number':96,'multiline':False]['text':' Configure small page sizes to ensure eviction comes through and we','line_number':115,'multiline':False]['text':' have a somewhat complex tree.','line_number':116,'multiline':False]['text':'','line_number':119,'multiline':False]['text':' Open four tables:','line_number':120,'multiline':False]['text':' 1. Table is logged and uses timestamps.','line_number':121,'multiline':False]['text':' 2. Table is not logged and uses timestamps.','line_number':122,'multiline':False]['text':' 3. Table is logged and does not use timestamps.','line_number':123,'multiline':False]['text':' 4. Table is not logged and does not use timestamps.','line_number':124,'multiline':False]['text':'','line_number':125,'multiline':False]['text':' Insert keys each with timestamp=key, in some order.','line_number':135,'multiline':False]['text':' Set keys 1-key_range to value 1.','line_number':139,'multiline':False]['text':' Setup an oldest timestamp to ensure state remains in cache.','line_number':147,'multiline':False]['text':' Scenario: 1','line_number':155,'multiline':False]['text':' Check that we see all the inserted values(i.e 1) in all tables','line_number':156,'multiline':False]['text':' Scenario: 2','line_number':167,'multiline':False]['text':' Roll back half timestamps.','line_number':168,'multiline':False]['text':' We're about to test rollback-to-stable which requires a checkpoint to which we can roll back.','line_number':172,'multiline':False]['text':' Check that we see the inserted value (i.e. 1) for all the keys in','line_number':185,'multiline':False]['text':' non-timestamp tables.','line_number':186,'multiline':False]['text':' For non-logged tables the behavior is consistent across connections','line_number':192,'multiline':False]['text':' with or without log enabled.','line_number':193,'multiline':False]['text':' Check that we see the inserted value (i.e. 1) for the keys in a','line_number':194,'multiline':False]['text':' timestamped table until the stable_timestamp only.','line_number':195,'multiline':False]['text':' For logged tables, the behavior of rollback_to_stable changes based on','line_number':201,'multiline':False]['text':' whether connection level logging is enabled or not.','line_number':202,'multiline':False]['text':' When the log is enabled, none of the keys will be rolled back.','line_number':204,'multiline':False]['text':' Check that we see all the keys.','line_number':205,'multiline':False]['text':' When the log is disabled, the keys will be rolled back until stable_timestamp.','line_number':209,'multiline':False]['text':' Check that we see the insertions are rolled back in timestamped tables','line_number':210,'multiline':False]['text':' until the stable_timestamp.','line_number':211,'multiline':False]['text':' Bump the oldest timestamp, we're not going back.','line_number':217,'multiline':False]['text':' Update the values again in preparation for rolling back more.','line_number':220,'multiline':False]['text':' Scenario: 3','line_number':237,'multiline':False]['text':' Check that we see all values updated (i.e 2) in all tables.','line_number':238,'multiline':False]['text':' Scenario: 4','line_number':249,'multiline':False]['text':' Advance the stable_timestamp by a quarter range and rollback.','line_number':250,'multiline':False]['text':' Three-fourths of the later timestamps will be rolled back.','line_number':251,'multiline':False]['text':'','line_number':264,'multiline':False]['text':' We rolled back half on the earlier call and now three-quarters on','line_number':265,'multiline':False]['text':' this call, which is one and one quarter of all keys rolled back.','line_number':266,'multiline':False]['text':'','line_number':267,'multiline':False]['text':' Check that we see the updated value (i.e. 2) for all the keys in','line_number':270,'multiline':False]['text':' non-timestamped tables.','line_number':271,'multiline':False]['text':' For non-logged tables the behavior is consistent across connections','line_number':276,'multiline':False]['text':' with or without log enabled.','line_number':277,'multiline':False]['text':' Check that we see only half key ranges in timestamp tables. We see','line_number':278,'multiline':False]['text':' the updated value (i.e. 2) for the first quarter keys and old values','line_number':279,'multiline':False]['text':' (i.e. 1) for the second quarter keys.','line_number':280,'multiline':False]['text':' For logged tables behavior changes for rollback_to_stable based on','line_number':287,'multiline':False]['text':' whether connection level logging is enabled or not.','line_number':288,'multiline':False]['text':' When log is enabled, none of the keys will be rolled back.','line_number':290,'multiline':False]['text':' Check that we see all the keys.','line_number':291,'multiline':False]['text':' When log is disabled, keys will be rolled back until the stable_timestamp.','line_number':295,'multiline':False]['text':' Check that we see only half the key ranges in timestamped tables. We see','line_number':296,'multiline':False]['text':' the updated value (i.e. 2) for the first quarter keys and old values','line_number':297,'multiline':False]['text':' (i.e. 1) for the second quarter keys.','line_number':298,'multiline':False]