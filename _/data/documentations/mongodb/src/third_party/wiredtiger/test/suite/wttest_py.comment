['text':'!/usr/bin/env python','line_number':1,'multiline':False]['text':'','line_number':2,'multiline':False]['text':' Public Domain 2014-present MongoDB, Inc.','line_number':3,'multiline':False]['text':' Public Domain 2008-2014 WiredTiger, Inc.','line_number':4,'multiline':False]['text':'','line_number':5,'multiline':False]['text':' This is free and unencumbered software released into the public domain.','line_number':6,'multiline':False]['text':'','line_number':7,'multiline':False]['text':' Anyone is free to copy, modify, publish, use, compile, sell, or','line_number':8,'multiline':False]['text':' distribute this software, either in source code form or as a compiled','line_number':9,'multiline':False]['text':' binary, for any purpose, commercial or non-commercial, and by any','line_number':10,'multiline':False]['text':' means.','line_number':11,'multiline':False]['text':'','line_number':12,'multiline':False]['text':' In jurisdictions that recognize copyright laws, the author or authors','line_number':13,'multiline':False]['text':' of this software dedicate any and all copyright interest in the','line_number':14,'multiline':False]['text':' software to the public domain. We make this dedication for the benefit','line_number':15,'multiline':False]['text':' of the public at large and to the detriment of our heirs and','line_number':16,'multiline':False]['text':' successors. We intend this dedication to be an overt act of','line_number':17,'multiline':False]['text':' relinquishment in perpetuity of all present and future rights to this','line_number':18,'multiline':False]['text':' software under copyright law.','line_number':19,'multiline':False]['text':'','line_number':20,'multiline':False]['text':' THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,','line_number':21,'multiline':False]['text':' EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF','line_number':22,'multiline':False]['text':' MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.','line_number':23,'multiline':False]['text':' IN NO EVENT SHALL THE AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR','line_number':24,'multiline':False]['text':' OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,','line_number':25,'multiline':False]['text':' ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR','line_number':26,'multiline':False]['text':' OTHER DEALINGS IN THE SOFTWARE.','line_number':27,'multiline':False]['text':'','line_number':28,'multiline':False]['text':' [TEST_TAGS]','line_number':29,'multiline':False]['text':' ignored_file','line_number':30,'multiline':False]['text':' [END_TAGS]','line_number':31,'multiline':False]['text':'','line_number':32,'multiline':False]['text':' WiredTigerTestCase','line_number':33,'multiline':False]['text':'   parent class for all test cases','line_number':34,'multiline':False]['text':'','line_number':35,'multiline':False]['text':' Use as "with timeout(seconds): ....". Argument of 0 means no timeout,','line_number':44,'multiline':False]['text':' and only available (with non-zero argument) on Unix systems.','line_number':45,'multiline':False]['text':' This will fail on non-Unix systems.','line_number':57,'multiline':False]['text':' This will fail on non-Unix systems.','line_number':66,'multiline':False]['text':' Proxy everything except what we explicitly define to the','line_number':82,'multiline':False]['text':' wrapped connection','line_number':83,'multiline':False]['text':' Just like a list of strings, but with a convenience function','line_number':90,'multiline':False]['text':' We store the current test case in thread local storage.  There are','line_number':101,'multiline':False]['text':' certain odd cases where this is useful, like hooks, where we don't','line_number':102,'multiline':False]['text':' have any notion of the current test case.','line_number':103,'multiline':False]['text':' rollbacks_allowed can be overridden to permit more or fewer retries on rollback errors.','line_number':106,'multiline':False]['text':' We retry tests that get rollback errors in a way that is mostly invisible.','line_number':107,'multiline':False]['text':' There is a visible difference in that the rollback error's stack trace is recorded','line_number':108,'multiline':False]['text':' in the results.txt .  If a single test fails more than self.rollbacks_allowed,','line_number':109,'multiline':False]['text':' we raise an error, and the test fails.','line_number':110,'multiline':False]['text':' conn_config can be overridden to add to basic connection configuration.','line_number':113,'multiline':False]['text':' Can be a string or a callable function or lambda expression.','line_number':114,'multiline':False]['text':' session_config can be overridden to add to basic session configuration.','line_number':117,'multiline':False]['text':' Can be a string or a callable function or lambda expression.','line_number':118,'multiline':False]['text':' conn_extensions can be overridden to add a list of extensions to load.','line_number':121,'multiline':False]['text':' Each entry is a string (directory and extension name) and optional config.','line_number':122,'multiline':False]['text':' Example:','line_number':123,'multiline':False]['text':'    conn_extensions = ('extractors/csv_extractor',','line_number':124,'multiline':False]['text':'                       'test/fail_fs={allow_writes=100}')','line_number':125,'multiline':False]['text':' We retry tests that get rollback errors in a way that is mostly invisible.','line_number':158,'multiline':False]['text':' self.rollbacks_allowed makes sure a single test doesn't rollback too many times.','line_number':159,'multiline':False]['text':' We also want to report an error if the total number of retries in the entire run gets','line_number':160,'multiline':False]['text':' above a threshold, we use 1%.  To prevent a shorter run (say 50 tests) from tripping','line_number':161,'multiline':False]['text':' over this if it happens to have 1 or 2 hits, we won't fail unless there's an absolute','line_number':162,'multiline':False]['text':' quantity of failures above 3.','line_number':163,'multiline':False]['text':' Platform specific functions (may be overridden by hooks):','line_number':182,'multiline':False]['text':' Return true if file(s) for the table with the given base name exist in the file system.','line_number':184,'multiline':False]['text':' This may have a different implementation when running under certain hooks.','line_number':185,'multiline':False]['text':' The first filename for this URI.  In the tiered storage','line_number':189,'multiline':False]['text':' world, this makes a difference, every flush tier creates a','line_number':190,'multiline':False]['text':' This may have a different implementation when running under certain hooks.','line_number':191,'multiline':False]['text':' Return the WiredTigerTimestamp for this testcase, or None if there is none.','line_number':195,'multiline':False]['text':' Return the tier share percent for this testcase, or 0 if there is none.','line_number':199,'multiline':False]['text':' Return the tier cache percent for this testcase, or 0 if there is none.','line_number':203,'multiline':False]['text':' Return the tier storage source for this testcase, or 'dir_store' if there is none.','line_number':207,'multiline':False]['text':' Return the tier storage source configuration for this testcase, or None.','line_number':211,'multiline':False]['text':' Overridden from unittest.  Run the method, but retry rollback errors, up to a point.','line_number':222,'multiline':False]['text':' Note that this method first appears in Python 3.7.  When running with an older Python,','line_number':223,'multiline':False]['text':' this method does not override anything.  The test method is called a different way,','line_number':224,'multiline':False]['text':' and we will not get any retry behavior.','line_number':225,'multiline':False]['text':' Construct the expected filename for an extension library and return','line_number':249,'multiline':False]['text':' the name if the file exists.','line_number':250,'multiline':False]['text':' When scanning for the extension library, we need to account for','line_number':254,'multiline':False]['text':' the binary paths produced by libtool and CMake. Libtool will export','line_number':255,'multiline':False]['text':' the library under '.libs'.','line_number':256,'multiline':False]['text':' Return the wiredtiger_open extension argument for','line_number':270,'multiline':False]['text':' any needed shared library.','line_number':271,'multiline':False]['text':' Can be overridden, but first consider setting self.conn_config','line_number':319,'multiline':False]['text':' or self.conn_extensions','line_number':320,'multiline':False]['text':' Collect all statistics for Python tests by default unless configured otherwise.','line_number':328,'multiline':False]['text':' Enable statistics logging if we haven't already.','line_number':332,'multiline':False]['text':' In case the open starts additional threads, flush first to','line_number':337,'multiline':False]['text':' avoid confusion.','line_number':338,'multiline':False]['text':' Replacement for wiredtiger.wiredtiger_open that returns','line_number':343,'multiline':False]['text':' a proxied connection that knows to close it itself at the','line_number':344,'multiline':False]['text':' end of the run, unless it was already closed.','line_number':345,'multiline':False]['text':' Can be overridden, but first consider setting self.session_config','line_number':350,'multiline':False]['text':' Can be overridden','line_number':357,'multiline':False]['text':' We want to have a unique execution directory name for each test.','line_number':412,'multiline':False]['text':' When a test fails, or with the -p option, we want to preserve the','line_number':413,'multiline':False]['text':' directory.  For the non concurrent case, this is easy, we use the','line_number':414,'multiline':False]['text':' class name (like test_base02) and append a class-specific counter.','line_number':415,'multiline':False]['text':' This is short, somewhat descriptive, and unique.','line_number':416,'multiline':False]['text':'','line_number':417,'multiline':False]['text':' Class-specific counters won't work for the concurrent case. To','line_number':418,'multiline':False]['text':' get uniqueness we use a sanitized "short" identifier.  Despite its name,','line_number':419,'multiline':False]['text':' this is not short (with scenarios at least), but it is descriptive','line_number':420,'multiline':False]['text':' and unique.','line_number':421,'multiline':False]['text':' tearDown needs connections list, set it here in case the open fails.','line_number':431,'multiline':False]['text':' set to True/False during teardown.','line_number':433,'multiline':False]['text':' tearDown needs a conn field, set it here in case the open fails.','line_number':449,'multiline':False]['text':' Used as part of tearDown determining if there is an error.','line_number':458,'multiline':False]['text':' Make sure any read-only files or directories left behind','line_number':480,'multiline':False]['text':' are made writeable in preparation for removal.','line_number':481,'multiline':False]['text':' Return value of each action should be a tuple with the first value an integer (non-zero to indicate','line_number':489,'multiline':False]['text':' failure), and the second value a string suitable for printing when the test fails.','line_number':490,'multiline':False]['text':' Download the files from the bucket for tiered tests if the test fails or preserve is','line_number':521,'multiline':False]['text':' turned on.','line_number':522,'multiline':False]['text':' Close all connections that weren't explicitly closed.','line_number':534,'multiline':False]['text':' Connections left open (as a result of a test failure)','line_number':535,'multiline':False]['text':' can result in cascading errors.  We also make sure','line_number':536,'multiline':False]['text':' self.conn is on the list of active connections.','line_number':537,'multiline':False]['text':' always get back to original directory','line_number':552,'multiline':False]['text':' Clean up unless there's a failure','line_number':558,'multiline':False]['text':' Returns None if testcase is running.  If during (or after) tearDown,','line_number':583,'multiline':False]['text':' will return True or False depending if the test case failed.','line_number':584,'multiline':False]['text':' Match either a pattern or an exact string.','line_number':685,'multiline':False]['text':' Some tests do table drops as a means to perform some test repeatedly in a loop.','line_number':722,'multiline':False]['text':' These tests require that a name be completely removed before the next iteration','line_number':723,'multiline':False]['text':' can begin.  However, tiered storage does not always provide a way to remove or','line_number':724,'multiline':False]['text':' rename objects that have been stored to the cloud, as doing that is not the normal','line_number':725,'multiline':False]['text':' part of a workflow (at this writing, GC is not yet implemented). Most storage sources','line_number':726,'multiline':False]['text':' return ENOTSUP when asked to remove a cloud object, so we really don't have a way to','line_number':727,'multiline':False]['text':' clear out the name space, and so we skip these tests under tiered storage.','line_number':728,'multiline':False]['text':'','line_number':729,'multiline':False]['text':' Note: as part of PM-3389, we may end up with unique names for every cloud object.','line_number':730,'multiline':False]['text':' If so, we could remove this restriction.','line_number':731,'multiline':False]['text':' Most test cases consider a drop, and especially a 'drop until success',','line_number':746,'multiline':False]['text':' to completely remove a file's artifacts, so that the name can be reused.','line_number':747,'multiline':False]['text':' Require this behavior.','line_number':748,'multiline':False]['text':' Override a test's setUp function to instead skip and report the reason for skipping','line_number':926,'multiline':False]['text':' We have to override the ThreadsafeForwardingResult implementation of tags so it gets set immediately','line_number':943,'multiline':False]['text':' which allows us to set the pid of the process on our output stream to make debugging easier.','line_number':944,'multiline':False]['text':' We use this technique to override the method instead of extending the class as it allows for less changes.','line_number':949,'multiline':False]['text':' This should not happen for regular test errors, unittest should catch everything','line_number':973,'multiline':False]