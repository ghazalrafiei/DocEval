['text':'*
 *    Copyright (C) 2018-present MongoDB, Inc.
 *
 *    This program is free software: you can redistribute it and/or modify
 *    it under the terms of the Server Side Public License, version 1,
 *    as published by MongoDB, Inc.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    Server Side Public License for more details.
 *
 *    You should have received a copy of the Server Side Public License
 *    along with this program. If not, see
 *    <http://www.mongodb.com/licensing/server-side-public-license>.
 *
 *    As a special exception, the copyright holders give permission to link the
 *    code of portions of this program with the OpenSSL library under certain
 *    conditions as described in each individual source file and distribute
 *    linked combinations including the program with the OpenSSL library. You
 *    must comply with the Server Side Public License in all respects for
 *    all of the code used other than as permitted herein. If you modify file(s)
 *    with this exception, you may extend this exception to your version of the
 *    file(s), but you are not obligated to do so. If you do not wish to do so,
 *    delete this exception statement from your version. If you delete this
 *    exception statement from all source files in the program, then also delete
 *    it in the license file.
 ','line_number':1,'multiline':True]['text':' IWYU pragma: no_include "ext/alloc_traits.h"','line_number':33,'multiline':False]['text':' x >= 0 values are untargetable','line_number':97,'multiline':False]['text':' This failpoint is to skip running the useTwoPhaseWriteProtocol check which expects the Grid','line_number':157,'multiline':False]['text':' to be initialized. With the feature flag on, the helper always returns false, which signifies','line_number':158,'multiline':False]['text':' that we have a targetable write op.','line_number':159,'multiline':False]['text':' For BatchWriteOp, all writes in the batch should share the same endpoint since they','line_number':166,'multiline':False]['text':' target the same shard and namespace. So we just use the endpoint from the first write.','line_number':167,'multiline':False]['text':' Do single-target, single doc batch write op','line_number':181,'multiline':False]['text':' Do single-target, single doc batch write op','line_number':215,'multiline':False]['text':' Do untargetable delete op','line_number':255,'multiline':False]['text':' Record targeting failures','line_number':269,'multiline':False]['text':' Write concern error test - we should pass write concern to sub-batches, and pass up the write','line_number':281,'multiline':False]['text':' concern error if one occurs.','line_number':282,'multiline':False]['text':' First stale response comes back, we should retry','line_number':314,'multiline':False]['text':' Single-op stale version test. We should retry the same batch until we're not stale.','line_number':326,'multiline':False]['text':' First stale response comes back, we should retry','line_number':361,'multiline':False]['text':' Respond again with a stale response','line_number':368,'multiline':False]['text':' Respond with a ShardCannotRefreshDueToLocksHeld error; the batch should still be retriable.','line_number':372,'multiline':False]['text':' Respond with an 'ok' response','line_number':382,'multiline':False]['text':'','line_number':398,'multiline':False]['text':' Multi-operation batches','line_number':399,'multiline':False]['text':'','line_number':400,'multiline':False]['text':' Multi-op targeting test (ordered)','line_number':402,'multiline':False]['text':' Do single-target, multi-doc batch write op','line_number':411,'multiline':False]['text':' Multi-op targeting test (unordered)','line_number':440,'multiline':False]['text':' Do single-target, multi-doc batch write op','line_number':449,'multiline':False]['text':' Multi-op, multi-endpoing targeting test (ordered). There should be two sets of single batches','line_number':483,'multiline':False]['text':' (one to each shard, one-by-one)','line_number':484,'multiline':False]['text':' Do multi-target, multi-doc batch write op','line_number':496,'multiline':False]['text':' Respond to first targeted batch','line_number':515,'multiline':False]['text':' Respond to second targeted batch','line_number':527,'multiline':False]['text':' 'expected' contains each ShardId that was expected to be targeted and the size of the batch','line_number':539,'multiline':False]['text':' that was expected to be targeted to it.','line_number':540,'multiline':False]['text':' We check that each ShardId in 'targeted' corresponds to one in 'expected', in that it','line_number':541,'multiline':False]['text':' contains a batch of the correct size.','line_number':542,'multiline':False]['text':' Finally, we ensure that no additional ShardIds are present in 'targeted' than 'expected'.','line_number':543,'multiline':False]['text':' Multi-op, multi-endpoint targeting test (unordered). There should be one set of two batches (one','line_number':554,'multiline':False]['text':' to each shard).','line_number':555,'multiline':False]['text':' Do multi-target, multi-doc batch write op','line_number':567,'multiline':False]['text':' Respond to both targeted batches','line_number':590,'multiline':False]['text':' Multi-op (ordered) targeting test where each op goes to both shards. There should be two sets of','line_number':603,'multiline':False]['text':' two batches to each shard (two for each delete op).','line_number':604,'multiline':False]['text':' Do multi-target, multi-doc batch write op','line_number':616,'multiline':False]['text':' Respond to both targeted batches for first multi-delete','line_number':635,'multiline':False]['text':' Respond to second targeted batches for second multi-delete','line_number':649,'multiline':False]['text':' Multi-op (unaordered) targeting test where each op goes to both shards. There should be one set','line_number':662,'multiline':False]['text':' of two batches to each shard (containing writes for both ops).','line_number':663,'multiline':False]['text':' Do multi-target, multi-doc batch write op','line_number':675,'multiline':False]['text':' Respond to both targeted batches, each containing two ops','line_number':699,'multiline':False]['text':' Multi-op (ordered) targeting test where first two ops go to one shard, second two ops go to two','line_number':712,'multiline':False]['text':' shards. Should batch the first two ops, then second ops should be batched separately, then last','line_number':713,'multiline':False]['text':' ops should be batched together.','line_number':714,'multiline':False]['text':' These go to the same shard','line_number':729,'multiline':False]['text':' These go to both shards','line_number':732,'multiline':False]['text':' These go to the same shard','line_number':735,'multiline':False]['text':' Emulate one-write-per-delete-per-host','line_number':752,'multiline':False]['text':' Respond to first targeted batch containing the two single-host deletes','line_number':755,'multiline':False]['text':' Emulate one-write-per-delete-per-host','line_number':766,'multiline':False]['text':' Respond to two targeted batches for first multi-delete','line_number':769,'multiline':False]['text':' Respond to two targeted batches for second multi-delete','line_number':783,'multiline':False]['text':' Emulate one-write-per-delete-per-host','line_number':798,'multiline':False]['text':' Respond to final targeted batch containing the last two single-host deletes','line_number':801,'multiline':False]['text':' Multi-op (unordered) targeting test where first two ops go to one shard, second two ops go to two','line_number':811,'multiline':False]['text':' shards. Should batch all the ops together into two batches of four ops for each shard.','line_number':812,'multiline':False]['text':' These go to the same shard','line_number':831,'multiline':False]['text':' These go to both shards','line_number':834,'multiline':False]['text':' These go to the same shard','line_number':837,'multiline':False]['text':' Emulate one-write-per-delete-per-host','line_number':852,'multiline':False]['text':' Respond to first targeted batch containing the two single-host deletes','line_number':855,'multiline':False]['text':' Multi-op (unordered) targeting test where first two ops go to one shard, second two ops go to two','line_number':868,'multiline':False]['text':' shards and the last two ops go to the other shard. Multi-target ops will override the endpoint to','line_number':869,'multiline':False]['text':' have ignored placement version. If a shard is already targeted with a different shardVersion, a','line_number':870,'multiline':False]['text':' new batch is required. So this test should result in three batches:','line_number':871,'multiline':False]['text':' 1. shardA: [op1, op2]','line_number':872,'multiline':False]['text':' 2. shardA: [op3, op4], shardB: [op3, op4]','line_number':873,'multiline':False]['text':' 3. shardB: [op5, op6]','line_number':874,'multiline':False]['text':' These go to the same shard','line_number':903,'multiline':False]['text':' These go to both shards','line_number':906,'multiline':False]['text':' These go to the same shard','line_number':909,'multiline':False]['text':' First batch: shardA: [op1, op2].','line_number':918,'multiline':False]['text':' Second batch: shardA: [op3, op4], shardB: [op3, op4].','line_number':926,'multiline':False]['text':' Third batch: shardB: [op5, op6].','line_number':937,'multiline':False]['text':' Multi-op targeting test where two ops go to two separate shards and there's an error on one op on','line_number':945,'multiline':False]['text':' one shard. There should be one set of two batches to each shard and an error reported.','line_number':946,'multiline':False]['text':' Respond to batches.','line_number':980,'multiline':False]['text':' No error on first shard','line_number':983,'multiline':False]['text':' Error on second write on second shard','line_number':990,'multiline':False]['text':' Multi-op targeting test where two ops go to two separate shards and there's an error on each op','line_number':1009,'multiline':False]['text':' on each shard. There should be one set of two batches to each shard and and two errors reported.','line_number':1010,'multiline':False]['text':' Error on first write on first shard and second write on second shard.','line_number':1045,'multiline':False]['text':' Multi-op targeting test where each op goes to both shards and there's an error on one op on one','line_number':1070,'multiline':False]['text':' shard. There should be one set of two batches to each shard and an error reported.','line_number':1071,'multiline':False]['text':' Respond to batches.','line_number':1103,'multiline':False]['text':' No errors on first shard','line_number':1109,'multiline':False]['text':' Error on second write on second shard','line_number':1116,'multiline':False]['text':' Multi-op targeting test where each op goes to both shards and there's an error on one op on one','line_number':1135,'multiline':False]['text':' shard. There should be one set of two batches to each shard and an error reported, the second op','line_number':1136,'multiline':False]['text':' should not get run.','line_number':1137,'multiline':False]['text':' Respond to batches.','line_number':1164,'multiline':False]['text':' No errors on first shard','line_number':1170,'multiline':False]['text':' Error on second write on second shard','line_number':1177,'multiline':False]['text':'','line_number':1196,'multiline':False]['text':' Tests of edge-case functionality, lifecycle is assumed to be behaving normally','line_number':1197,'multiline':False]['text':'','line_number':1198,'multiline':False]['text':' Multi-op (unordered) error and write concern error test.','line_number':1200,'multiline':False]['text':' First stale response comes back, we should retry','line_number':1231,'multiline':False]['text':' Unordered reports write concern error','line_number':1235,'multiline':False]['text':' Single-op (ordered) error and write concern error test.','line_number':1244,'multiline':False]['text':' Respond to batches.','line_number':1273,'multiline':False]['text':' First response comes back with write concern error','line_number':1280,'multiline':False]['text':' Second response comes back with write error','line_number':1287,'multiline':False]['text':' Ordered reports write concern error.','line_number':1293,'multiline':False]['text':' Targeting failure on second op in batch op (ordered)','line_number':1303,'multiline':False]['text':' Do single-target, multi-doc batch write op','line_number':1318,'multiline':False]['text':' First targeting round fails since we may be stale','line_number':1325,'multiline':False]['text':' Second targeting round is ok, but should stop at first write','line_number':1331,'multiline':False]['text':' First response ok','line_number':1339,'multiline':False]['text':' Second targeting round results in an error which finishes the batch','line_number':1346,'multiline':False]['text':' Targeting failure on second op in batch op (unordered)','line_number':1359,'multiline':False]['text':' Do single-target, multi-doc batch write op','line_number':1379,'multiline':False]['text':' First targeting round fails since we may be stale','line_number':1386,'multiline':False]['text':' Second targeting round is ok, and should record an error','line_number':1392,'multiline':False]['text':' Response is ok for first and third write','line_number':1400,'multiline':False]['text':' Batch failure (ok : 0) reported in a multi-op batch (ordered). Expect this gets translated down','line_number':1413,'multiline':False]['text':' into write errors for first affected write.','line_number':1414,'multiline':False]['text':' First shard batch is ok','line_number':1440,'multiline':False]['text':' Second shard batch fails','line_number':1449,'multiline':False]['text':' We should have recorded an error for the second write','line_number':1453,'multiline':False]['text':' Batch failure (ok : 0) reported in a multi-op batch (unordered). Expect this gets translated down','line_number':1464,'multiline':False]['text':' into write errors for all affected writes.','line_number':1465,'multiline':False]['text':' Respond to batches.','line_number':1493,'multiline':False]['text':' First shard batch is ok','line_number':1499,'multiline':False]['text':' Second shard batch fails','line_number':1505,'multiline':False]['text':' We should have recorded an error for the second and third write','line_number':1511,'multiline':False]['text':' Batch aborted (ordered). Expect this gets translated down into write error for first affected','line_number':1524,'multiline':False]['text':' write.','line_number':1525,'multiline':False]['text':' First shard batch is ok','line_number':1551,'multiline':False]['text':' We should have recorded an error for the second write','line_number':1559,'multiline':False]['text':' Batch aborted (unordered). Expect this gets translated down into write errors for all affected','line_number':1571,'multiline':False]['text':' writes.','line_number':1572,'multiline':False]['text':' We should have recorded an error for the first and second write','line_number':1601,'multiline':False]['text':' Multi-op targeting test where each op goes to both shards and both return a write concern error','line_number':1616,'multiline':False]['text':' First shard write write concern fails.','line_number':1644,'multiline':False]['text':' Second shard write write concern fails.','line_number':1651,'multiline':False]['text':' Verify that when the command is not running in a session, the targeted batched command','line_number':1698,'multiline':False]['text':' request does not have stmtIds attached to it.','line_number':1699,'multiline':False]['text':' Verify that when the command is running in a session but not as retryable writes or in a','line_number':1705,'multiline':False]['text':' retryable internal transaction, the targeted batched command request does not have','line_number':1706,'multiline':False]['text':' stmtIds to it.','line_number':1707,'multiline':False]['text':' Verify that when the command is running in a session as retryable writes, the targeted','line_number':1716,'multiline':False]['text':' batched command request has stmtIds attached to it.','line_number':1717,'multiline':False]['text':' Verify that when the command is running in a transaction, the targeted batched command','line_number':1729,'multiline':False]['text':' request has stmtIds attached to it if and only if the transaction is a retryable internal','line_number':1730,'multiline':False]['text':' transaction.','line_number':1731,'multiline':False]['text':'','line_number':1748,'multiline':False]['text':' Tests of batch size limit functionality','line_number':1749,'multiline':False]['text':'','line_number':1750,'multiline':False]['text':' Big single operation test - should go through','line_number':1754,'multiline':False]['text':' Create a BSONObj (slightly) bigger than the maximum size by including a max-size string','line_number':1763,'multiline':False]['text':' Do single-target, single doc batch write op','line_number':1766,'multiline':False]['text':' Big doc with smaller additional doc - should go through as two batches','line_number':1791,'multiline':False]['text':' Create a BSONObj (slightly) bigger than the maximum size by including a max-size string','line_number':1800,'multiline':False]['text':' Untargetable delete op.','line_number':1870,'multiline':False]['text':' Untargetable update op.','line_number':1899,'multiline':False]['text':' Do single-target, single doc batch write op','line_number':1943,'multiline':False]['text':' Do single-target, multi doc batch write op','line_number':1961,'multiline':False]['text':' Respond to first targeted batch','line_number':1986,'multiline':False]['text':' Respond to second targeted batch','line_number':2001,'multiline':False]['text':' Do single-target, multi doc batch write op','line_number':2009,'multiline':False]['text':' Respond to first targeted batch','line_number':2034,'multiline':False]['text':' Respond to second targeted batch','line_number':2049,'multiline':False]['text':' Do single-target, single doc batch write op','line_number':2057,'multiline':False]['text':' Do single-target, multi doc batch write op','line_number':2076,'multiline':False]['text':' Respond to first targeted batch','line_number':2101,'multiline':False]['text':' Respond to second targeted batch','line_number':2115,'multiline':False]['text':' Do single-target, multi doc batch write op','line_number':2123,'multiline':False]['text':' Respond to first targeted batch','line_number':2148,'multiline':False]['text':' Respond to second targeted batch','line_number':2162,'multiline':False]['text':'','line_number':2169,'multiline':False]['text':' Tests targeting for retryable time-series updates.','line_number':2170,'multiline':False]['text':'','line_number':2171,'multiline':False]['text':' Sets up for retryable writes.','line_number':2198,'multiline':False]['text':' Do single-target, single doc batch write op.','line_number':2202,'multiline':False]['text':' Sets up for retryable writes.','line_number':2220,'multiline':False]['text':' Do single-target, single doc batch write op.','line_number':2224,'multiline':False]['text':' Sets up for retryable writes.','line_number':2242,'multiline':False]['text':' Do single-target, multi doc batch write op.','line_number':2246,'multiline':False]['text':' Respond to first targeted batch.','line_number':2271,'multiline':False]['text':' Respond to second targeted batch.','line_number':2284,'multiline':False]['text':' Sets up for retryable writes.','line_number':2290,'multiline':False]['text':' Do single-target, multi doc batch write op.','line_number':2294,'multiline':False]['text':' Respond to first targeted batch.','line_number':2319,'multiline':False]['text':' Respond to second targeted batch.','line_number':2332,'multiline':False]['text':' Replacement style update.','line_number':2396,'multiline':False]['text':' Op style update.','line_number':2420,'multiline':False]['text':' Respond to first targeted batch.','line_number':2450,'multiline':False]['text':' Op style update.','line_number':2464,'multiline':False]['text':' Respond to first targeted batch.','line_number':2495,'multiline':False]['text':' Respond to second targeted batch.','line_number':2504,'multiline':False]['text':' Op style update.','line_number':2520,'multiline':False]['text':' Respond to first targeted batch.','line_number':2550,'multiline':False]['text':' Respond to second targeted batch.','line_number':2558,'multiline':False]['text':' Op style update.','line_number':2574,'multiline':False]['text':' Respond to first targeted batch.','line_number':2605,'multiline':False]['text':' Respond to second targeted batch.','line_number':2613,'multiline':False]['text':' Op style update.','line_number':2629,'multiline':False]['text':' Respond to first targeted batch.','line_number':2673,'multiline':False]['text':' Respond to second targeted batch.','line_number':2684,'multiline':False]['text':' Op style update.','line_number':2699,'multiline':False]['text':' Respond to first targeted batch.','line_number':2744,'multiline':False]['text':' Respond to second targeted batch.','line_number':2754,'multiline':False]['text':' Op style update.','line_number':2767,'multiline':False]['text':' Respond to first targeted batch.','line_number':2794,'multiline':False]['text':' Respond to second targeted batch.','line_number':2805,'multiline':False]['text':' Op style update.','line_number':2820,'multiline':False]['text':' This should still be a broadcast','line_number':2856,'multiline':False]['text':' namespace','line_number':2862,'multiline':False]['text':' namespace mongo','line_number':2863,'multiline':False]