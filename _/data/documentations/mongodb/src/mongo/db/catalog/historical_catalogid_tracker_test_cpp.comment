['text':'*
 *    Copyright (C) 2023-present MongoDB, Inc.
 *
 *    This program is free software: you can redistribute it and/or modify
 *    it under the terms of the Server Side Public License, version 1,
 *    as published by MongoDB, Inc.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    Server Side Public License for more details.
 *
 *    You should have received a copy of the Server Side Public License
 *    along with this program. If not, see
 *    <http://www.mongodb.com/licensing/server-side-public-license>.
 *
 *    As a special exception, the copyright holders give permission to link the
 *    code of portions of this program with the OpenSSL library under certain
 *    conditions as described in each individual source file and distribute
 *    linked combinations including the program with the OpenSSL library. You
 *    must comply with the Server Side Public License in all respects for
 *    all of the code used other than as permitted herein. If you modify file(s)
 *    with this exception, you may extend this exception to your version of the
 *    file(s), but you are not obligated to do so. If you do not wish to do so,
 *    delete this exception statement from your version. If you delete this
 *    exception statement from all source files in the program, then also delete
 *    it in the license file.
 ','line_number':1,'multiline':True]['text':' Initialize the oldest timestamp to (1, 1)','line_number':47,'multiline':False]['text':' Create entry','line_number':50,'multiline':False]['text':' Lookup without timestamp returns latest catalogId','line_number':53,'multiline':False]['text':' Lookup before create returns unknown if looking before oldest','line_number':56,'multiline':False]['text':' Lookup before create returns not exists if looking after oldest','line_number':61,'multiline':False]['text':' Lookup at create returns catalogId','line_number':66,'multiline':False]['text':' Lookup after create returns catalogId','line_number':69,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':79,'multiline':False]['text':' Create and drop collection. We have a time window where the namespace exists','line_number':82,'multiline':False]['text':' Lookup without timestamp returns none','line_number':86,'multiline':False]['text':' Lookup before create and oldest returns unknown','line_number':91,'multiline':False]['text':' Lookup before create returns not exists','line_number':96,'multiline':False]['text':' Lookup at create returns catalogId','line_number':101,'multiline':False]['text':' Lookup after create returns catalogId','line_number':104,'multiline':False]['text':' Lookup at drop returns none','line_number':107,'multiline':False]['text':' Lookup after drop returns none','line_number':112,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':125,'multiline':False]['text':' Create and rename collection. We have two windows where the collection exists but for','line_number':128,'multiline':False]['text':' different namespaces','line_number':129,'multiline':False]['text':' Lookup without timestamp on 'from' returns none. By 'uuid' returns catalogId','line_number':133,'multiline':False]['text':' Lookup before create and oldest returns unknown','line_number':137,'multiline':False]['text':' Lookup before create returns not exists','line_number':142,'multiline':False]['text':' Lookup at create returns catalogId','line_number':147,'multiline':False]['text':' Lookup after create returns catalogId','line_number':150,'multiline':False]['text':' Lookup at rename on 'from' returns none. By 'uuid' returns catalogId','line_number':153,'multiline':False]['text':' Lookup after rename on 'from' returns none. By 'uuid' returns catalogId','line_number':157,'multiline':False]['text':' Lookup without timestamp on 'to' returns catalogId','line_number':162,'multiline':False]['text':' Lookup before rename and oldest on 'to' returns unknown','line_number':165,'multiline':False]['text':' Lookup before rename on 'to' returns not exists. By 'uuid' returns catalogId','line_number':170,'multiline':False]['text':' Lookup at rename on 'to' returns catalogId','line_number':174,'multiline':False]['text':' Lookup after rename on 'to' returns catalogId','line_number':177,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':190,'multiline':False]['text':' Create collections. The 'to' namespace will exist for one collection from Timestamp(1, 6)','line_number':193,'multiline':False]['text':' until it is dropped by the rename at Timestamp(1, 10), after which the 'to' namespace will','line_number':194,'multiline':False]['text':' correspond to the renamed collection.','line_number':195,'multiline':False]['text':' Drop and rename with the same timestamp, this is the same as dropTarget=true','line_number':198,'multiline':False]['text':' Lookup without timestamp on 'to' and 'uuid' returns latest catalog id. By 'originalUUID'','line_number':202,'multiline':False]['text':' returns not exists as the target was dropped.','line_number':203,'multiline':False]['text':' Lookup before rename and oldest on 'to' returns unknown','line_number':208,'multiline':False]['text':' Lookup before rename on 'to' returns the original rid','line_number':217,'multiline':False]['text':' Lookup before rename on 'from' returns the rid','line_number':220,'multiline':False]['text':' Lookup at rename timestamp on 'to' and 'uuid' returns catalogId','line_number':223,'multiline':False]['text':' Lookup at rename timestamp on 'originalUUID' returns not exists as it was dropped during the','line_number':226,'multiline':False]['text':' rename.','line_number':227,'multiline':False]['text':' Lookup after rename on 'to' and 'uuid' returns catalogId','line_number':230,'multiline':False]['text':' Lookup after rename timestamp on 'originalUUID' returns not exists as it was dropped during','line_number':233,'multiline':False]['text':' the rename.','line_number':234,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':246,'multiline':False]['text':' Create, drop and recreate collection on the same namespace. We have different catalogId.','line_number':249,'multiline':False]['text':' Lookup without timestamp returns latest catalogId','line_number':254,'multiline':False]['text':' Lookup before first create returns not exists','line_number':259,'multiline':False]['text':' Lookup at first create returns first catalogId','line_number':268,'multiline':False]['text':' Lookup after first create returns first catalogId','line_number':273,'multiline':False]['text':' Lookup at drop returns none','line_number':278,'multiline':False]['text':' Lookup after drop returns none','line_number':287,'multiline':False]['text':' Lookup at second create returns second catalogId','line_number':296,'multiline':False]['text':' Lookup after second create returns second catalogId','line_number':301,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':315,'multiline':False]['text':' Create collection and verify we have nothing to cleanup','line_number':318,'multiline':False]['text':' Drop collection and verify we have nothing to cleanup as long as the oldest timestamp is','line_number':322,'multiline':False]['text':' before the drop','line_number':323,'multiline':False]['text':' Create new collection and nothing changed with answers to needsCleanupForOldestTimestamp.','line_number':329,'multiline':False]['text':' We can lookup the old catalogId before we advance the oldest timestamp and cleanup','line_number':336,'multiline':False]['text':' Cleanup at drop timestamp, advance the oldest timestamp','line_number':344,'multiline':False]['text':' After cleanup, we cannot find the old catalogId anymore. Also verify that we don't need','line_number':347,'multiline':False]['text':' anymore cleanup','line_number':348,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':373,'multiline':False]['text':' Create collection and verify we have nothing to cleanup','line_number':376,'multiline':False]['text':' Drop collection and verify we have nothing to cleanup as long as the oldest timestamp is','line_number':380,'multiline':False]['text':' before the drop','line_number':381,'multiline':False]['text':' Create new collection and nothing changed with answers to needsCleanupForOldestTimestamp.','line_number':387,'multiline':False]['text':' We can lookup the old catalogId before we advance the oldest timestamp and cleanup','line_number':394,'multiline':False]['text':' Cleanup after the drop timestamp','line_number':402,'multiline':False]['text':' After cleanup, we cannot find the old catalogId anymore. Also verify that we don't need','line_number':405,'multiline':False]['text':' anymore cleanup','line_number':406,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':431,'multiline':False]['text':' Create collection and verify we have nothing to cleanup','line_number':434,'multiline':False]['text':' Drop collection and verify we have nothing to cleanup as long as the oldest timestamp is','line_number':438,'multiline':False]['text':' before the drop','line_number':439,'multiline':False]['text':' Create new collection and nothing changed with answers to needsCleanupForOldestTimestamp.','line_number':445,'multiline':False]['text':' We can lookup the old catalogId before we advance the oldest timestamp and cleanup','line_number':452,'multiline':False]['text':' Cleanup after the recreate timestamp','line_number':460,'multiline':False]['text':' After cleanup, we cannot find the old catalogId anymore. Also verify that we don't need','line_number':463,'multiline':False]['text':' anymore cleanup','line_number':464,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':493,'multiline':False]['text':' Create and drop multiple namespace on the same namespace','line_number':496,'multiline':False]['text':' Lookup can find all four collections','line_number':506,'multiline':False]['text':' Cleanup oldest','line_number':524,'multiline':False]['text':' Lookup can find the three remaining collections','line_number':527,'multiline':False]['text':' Cleanup','line_number':545,'multiline':False]['text':' Lookup can find the two remaining collections','line_number':548,'multiline':False]['text':' Cleanup','line_number':566,'multiline':False]['text':' Lookup can find the last remaining collections','line_number':569,'multiline':False]['text':' Cleanup','line_number':587,'multiline':False]['text':' Lookup now result in unknown as the oldest timestamp has advanced where mapping has been','line_number':590,'multiline':False]['text':' removed','line_number':591,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':621,'multiline':False]['text':' Create and drop multiple namespace on the same namespace','line_number':624,'multiline':False]['text':' Lookup can find all four collections','line_number':634,'multiline':False]['text':' Cleanup all','line_number':652,'multiline':False]['text':' Lookup now result in unknown as the oldest timestamp has advanced where mapping has been','line_number':655,'multiline':False]['text':' removed','line_number':656,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':695,'multiline':False]['text':' Create and drop multiple namespace on the same namespace','line_number':698,'multiline':False]['text':' Rollback to Timestamp(1, 8)','line_number':708,'multiline':False]['text':' Simulate startup where we have a range [oldest, stable] by initializing the oldest timestamp','line_number':742,'multiline':False]['text':' to something high and then insert mappings behind it where the range is unknown.','line_number':743,'multiline':False]['text':' Record that the collection is known to exist','line_number':746,'multiline':False]['text':' Lookups before the inserted timestamp is still unknown','line_number':749,'multiline':False]['text':' Lookups at or after the inserted timestamp is found','line_number':755,'multiline':False]['text':' Record that the collection is known to exist at an even earlier timestamp','line_number':775,'multiline':False]['text':' We should now have extended the range from Timestamp(1, 17) to Timestamp(1, 12)','line_number':778,'multiline':False]['text':' Record that the collection is unknown to exist at an later timestamp','line_number':810,'multiline':False]['text':' Check the entries, most didn't change','line_number':814,'multiline':False]['text':' At Timestamp(1, 25) we now return kNotExists','line_number':833,'multiline':False]['text':' But next timestamp returns unknown','line_number':838,'multiline':False]['text':' Record that the collection is unknown to exist at the timestamp','line_number':844,'multiline':False]['text':' We should not have re-written the existing entry at Timestamp(1, 26)','line_number':848,'multiline':False]['text':' At Timestamp(1, 25) we now return kNotExists','line_number':867,'multiline':False]['text':' But next timestamp returns unknown','line_number':872,'multiline':False]['text':' Clean up, check so we are back to the original state','line_number':882,'multiline':False]['text':' Simulate startup where we have a range [oldest, stable] by initializing the oldest timestamp','line_number':895,'multiline':False]['text':' to something high and then insert mappings behind it where the range is unknown.','line_number':896,'multiline':False]['text':' Reading before the oldest is unknown','line_number':899,'multiline':False]['text':' Record that the collection is unknown to exist at the timestamp','line_number':905,'multiline':False]['text':' Lookup should now be not existing','line_number':909,'multiline':False]['text':' Lookup should now be not existing','line_number':912,'multiline':False]['text':' Create a collection on the namespace and confirm that we can lookup','line_number':924,'multiline':False]['text':' Drop the collection and confirm it is also removed from mapping','line_number':931,'multiline':False]['text':' Create a collection on the namespace and confirm that we can lookup','line_number':947,'multiline':False]['text':' Rename the collection and check lookup behavior','line_number':956,'multiline':False]['text':' Drop the collection and confirm it is also removed from mapping','line_number':966,'multiline':False]['text':' Create collections on the namespaces and confirm that we can lookup','line_number':986,'multiline':False]['text':' Rename the collection and check lookup behavior','line_number':998,'multiline':False]['text':' Verify that the the recordId on b is now what was on a. We performed a rename with','line_number':1007,'multiline':False]['text':' dropTarget=true.','line_number':1008,'multiline':False]['text':' Drop the collection and confirm it is also removed from mapping','line_number':1011,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':1030,'multiline':False]['text':' Create and drop collection with timestamp, this leaves a history that may be cleaned up at','line_number':1033,'multiline':False]['text':' the drop timestamp','line_number':1034,'multiline':False]['text':' Re-create and drop without timestamp','line_number':1038,'multiline':False]['text':' Try and cleanup for the namespace that was previously marked for needing cleanup','line_number':1042,'multiline':False]['text':' Initialize the oldest timestamp to (1, 1)','line_number':1055,'multiline':False]['text':' Create and drop collection with timestamp, this leaves a history that may be cleaned up at','line_number':1058,'multiline':False]['text':' the drop timestamp','line_number':1059,'multiline':False]['text':' Re-create and drop without timestamp','line_number':1063,'multiline':False]['text':' Create namespace again, will have a single entry and must therefore not require cleanup','line_number':1067,'multiline':False]['text':' Try and cleanup for the namespace that was previously marked for needing cleanup','line_number':1070,'multiline':False]['text':' namespace','line_number':1073,'multiline':False]['text':' namespace mongo','line_number':1074,'multiline':False]