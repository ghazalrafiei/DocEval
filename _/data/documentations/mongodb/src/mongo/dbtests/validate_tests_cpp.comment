['text':'*
 *    Copyright (C) 2018-present MongoDB, Inc.
 *
 *    This program is free software: you can redistribute it and/or modify
 *    it under the terms of the Server Side Public License, version 1,
 *    as published by MongoDB, Inc.
 *
 *    This program is distributed in the hope that it will be useful,
 *    but WITHOUT ANY WARRANTY; without even the implied warranty of
 *    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *    Server Side Public License for more details.
 *
 *    You should have received a copy of the Server Side Public License
 *    along with this program. If not, see
 *    <http://www.mongodb.com/licensing/server-side-public-license>.
 *
 *    As a special exception, the copyright holders give permission to link the
 *    code of portions of this program with the OpenSSL library under certain
 *    conditions as described in each individual source file and distribute
 *    linked combinations including the program with the OpenSSL library. You
 *    must comply with the Server Side Public License in all respects for
 *    all of the code used other than as permitted herein. If you modify file(s)
 *    with this exception, you may extend this exception to your version of the
 *    file(s), but you are not obligated to do so. If you do not wish to do so,
 *    delete this exception statement from your version. If you delete this
 *    exception statement from all source files in the program, then also delete
 *    it in the license file.
 ','line_number':1,'multiline':True]['text':' IWYU pragma: no_include "boost/intrusive/detail/iterator.hpp"','line_number':33,'multiline':False]['text':' IWYU pragma: no_include "boost/move/algo/detail/set_difference.hpp"','line_number':34,'multiline':False]['text':' IWYU pragma: keep','line_number':96,'multiline':False]['text':' namespace','line_number':129,'multiline':False]['text':'*
 * Test fixture for a write locked test using collection _ns.  Includes functionality to
 * partially construct a new IndexDetails in a manner that supports proper cleanup in
 * dropCollection().
 ','line_number':133,'multiline':True]['text':'clustered=','line_number':168,'multiline':True]['text':' Helper to refetch the Collection from the catalog in order to see any changes made to it','line_number':182,'multiline':False]['text':' Checkpoint all of the data.','line_number':191,'multiline':False]['text':' validate() will set a kProvided read source. Callers continue to do operations after','line_number':197,'multiline':False]['text':' running validate, so we must reset the read source back to normal before returning.','line_number':198,'multiline':False]['text':'additionalOptions=','line_number':220,'multiline':True]['text':'  Check if errors are reported if and only if valid is set to false.','line_number':225,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':299,'multiline':False]['text':' checkpoints.','line_number':300,'multiline':False]['text':' Create a new collection, insert records {_id: 1} and {_id: 2} and check it's valid.','line_number':305,'multiline':False]['text':' Remove {_id: 1} from the record store, so we get more _id entries than records.','line_number':328,'multiline':False]['text':' Insert records {_id: 0} and {_id: 1} , so we get too few _id entries, and verify','line_number':339,'multiline':False]['text':' validate fails.','line_number':340,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':359,'multiline':False]['text':' checkpoints.','line_number':360,'multiline':False]['text':' Create a new collection, insert two documents.','line_number':365,'multiline':False]['text':' Remove a record, so we get more _id entries than records, and verify validate fails.','line_number':395,'multiline':False]['text':' Insert two more records, so we get too few entries for a non-sparse index, and','line_number':406,'multiline':False]['text':' verify validate fails.','line_number':407,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':426,'multiline':False]['text':' checkpoints.','line_number':427,'multiline':False]['text':' Create a new collection, insert three records.','line_number':432,'multiline':False]['text':' Update {a: 1} to {a: 9} without updating the index, so we get inconsistent values','line_number':464,'multiline':False]['text':' between the index and the document. Verify validate fails.','line_number':465,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':485,'multiline':False]['text':' checkpoints.','line_number':486,'multiline':False]['text':' Create a new collection, insert records {_id: 1} and {_id: 2} and check it's valid.','line_number':491,'multiline':False]['text':' Update {_id: 1} to {_id: 9} without updating the index, so we get inconsistent values','line_number':513,'multiline':False]['text':' between the index and the document. Verify validate fails.','line_number':514,'multiline':False]['text':' Revert {_id: 9} to {_id: 1} and verify that validate succeeds.','line_number':527,'multiline':False]['text':' Remove the {_id: 1} document and insert a new document without an index entry, so there','line_number':540,'multiline':False]['text':' will still be the same number of index entries and documents, but one document will not','line_number':541,'multiline':False]['text':' have an index entry.','line_number':542,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':562,'multiline':False]['text':' checkpoints.','line_number':563,'multiline':False]['text':' Create a new collection, insert three records and check it's valid.','line_number':568,'multiline':False]['text':' {a: [b: 1, c: 2]}, {a: [b: 2, c: 2]}, {a: [b: 1, c: 1]}','line_number':572,'multiline':False]['text':' {a: [b: 2]}','line_number':577,'multiline':False]['text':' {a: [c: 1]}','line_number':579,'multiline':False]['text':' Create multi-key index.','line_number':601,'multiline':False]['text':' Update a document's indexed field without updating the index.','line_number':616,'multiline':False]['text':' Update a document's non-indexed field without updating the index.','line_number':628,'multiline':False]['text':' Index validation should still be valid.','line_number':629,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':647,'multiline':False]['text':' checkpoints.','line_number':648,'multiline':False]['text':' Create a new collection, insert three records and check it's valid.','line_number':653,'multiline':False]['text':' Create a sparse index.','line_number':672,'multiline':False]['text':' Update a document's indexed field without updating the index.','line_number':689,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':708,'multiline':False]['text':' checkpoints.','line_number':709,'multiline':False]['text':' Create a new collection, insert three records and check it's valid.','line_number':714,'multiline':False]['text':' Explicitly test that multi-key partial indexes containing documents that','line_number':728,'multiline':False]['text':' don't match the filter expression are handled correctly.','line_number':729,'multiline':False]['text':' Create a partial index.','line_number':739,'multiline':False]['text':' Update an unindexed document without updating the index.','line_number':757,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':776,'multiline':False]['text':' checkpoints.','line_number':777,'multiline':False]['text':' Create a new collection and insert a record that has a non-indexable value on the indexed','line_number':782,'multiline':False]['text':' field.','line_number':783,'multiline':False]['text':' Create a partial geo index that indexes the document. This should return an error.','line_number':801,'multiline':False]['text':' Create a partial geo index that does not index the document.','line_number':813,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':836,'multiline':False]['text':' checkpoints.','line_number':837,'multiline':False]['text':' Create a new collection, insert five records and check it's valid.','line_number':842,'multiline':False]['text':' Create two compound indexes, one forward and one reverse, to test','line_number':874,'multiline':False]['text':' validate()'s index direction parsing.','line_number':875,'multiline':False]['text':' Update a document's indexed field without updating the index.','line_number':898,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':917,'multiline':False]['text':' checkpoints.','line_number':918,'multiline':False]['text':' Create a new collection, insert three records and check it's valid.','line_number':926,'multiline':False]['text':' Replace a correct index entry with a bad one and check it's invalid.','line_number':959,'multiline':False]['text':'full=','line_number':1010,'multiline':True]['text':'background=','line_number':1010,'multiline':True]['text':' Create an index with bad index specs.','line_number':1016,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':1039,'multiline':False]['text':' checkpoints.','line_number':1040,'multiline':False]['text':' Create a new collection.','line_number':1045,'multiline':False]['text':' Create a $** index.','line_number':1055,'multiline':False]['text':' Insert non-multikey documents.','line_number':1065,'multiline':False]['text':' Insert multikey documents.','line_number':1087,'multiline':False]['text':' Insert additional multikey path metadata index keys.','line_number':1108,'multiline':False]['text':' dupsAllowed ','line_number':1126,'multiline':True]['text':' An index whose set of multikey metadata paths is a superset of collection multikey','line_number':1131,'multiline':False]['text':' metadata paths is valid.','line_number':1132,'multiline':False]['text':' Remove the multikey path metadata index key for a path that exists and is multikey in the','line_number':1136,'multiline':False]['text':' collection.','line_number':1137,'multiline':False]['text':' dupsAllowed ','line_number':1148,'multiline':True]['text':' An index that is missing one or more multikey metadata fields that exist in the','line_number':1152,'multiline':False]['text':' collection is not valid.','line_number':1153,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':1165,'multiline':False]['text':' checkpoints.','line_number':1166,'multiline':False]['text':' Create a new collection.','line_number':1171,'multiline':False]['text':' Create a $** index with a projection on "a".','line_number':1181,'multiline':False]['text':' Insert documents with indexed and not-indexed paths.','line_number':1191,'multiline':False]['text':' Removing a multikey metadata path for a path included in the projection causes validate','line_number':1239,'multiline':False]['text':' to fail.','line_number':1240,'multiline':False]['text':' dupsAllowed ','line_number':1253,'multiline':True]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':1267,'multiline':False]['text':' checkpoints.','line_number':1268,'multiline':False]['text':' Create a new collection.','line_number':1273,'multiline':False]['text':' Create an index.','line_number':1283,'multiline':False]['text':' Insert documents.','line_number':1293,'multiline':False]['text':' Updating a document without updating the index entry should cause us to have a missing','line_number':1313,'multiline':False]['text':' index entry and an extra index entry.','line_number':1314,'multiline':False]['text':'additionalOptions=','line_number':1334,'multiline':True]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':1361,'multiline':False]['text':' checkpoints.','line_number':1362,'multiline':False]['text':' Create a new collection.','line_number':1370,'multiline':False]['text':' Create an index.','line_number':1380,'multiline':False]['text':' Insert documents.','line_number':1390,'multiline':False]['text':' Removing an index entry without removing the document should cause us to have a missing','line_number':1408,'multiline':False]['text':' index entry.','line_number':1409,'multiline':False]['text':'additionalOptions=','line_number':1455,'multiline':True]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':1482,'multiline':False]['text':' checkpoints.','line_number':1483,'multiline':False]['text':' Create a new collection.','line_number':1488,'multiline':False]['text':' Create an index.','line_number':1498,'multiline':False]['text':' Insert documents.','line_number':1508,'multiline':False]['text':' Removing a document without removing the index entries should cause us to have extra','line_number':1526,'multiline':False]['text':' index entries.','line_number':1527,'multiline':False]['text':'additionalOptions=','line_number':1547,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':1570,'multiline':False]['text':' validation.','line_number':1571,'multiline':False]['text':'full=','line_number':1573,'multiline':True]['text':'background=','line_number':1573,'multiline':True]['text':' Create a new collection.','line_number':1576,'multiline':False]['text':' Create index "a".','line_number':1586,'multiline':False]['text':' Create index "b".','line_number':1595,'multiline':False]['text':' Insert documents.','line_number':1604,'multiline':False]['text':' Updating documents without updating the index entries should cause us to have missing and','line_number':1635,'multiline':False]['text':' extra index entries.','line_number':1636,'multiline':False]['text':' Confirm missing and extra index entries are detected.','line_number':1653,'multiline':False]['text':'additionalOptions=','line_number':1663,'multiline':True]['text':' Run validate with repair, expect extra index entries are removed and missing index','line_number':1682,'multiline':False]['text':' entries are inserted.','line_number':1683,'multiline':False]['text':'additionalOptions=','line_number':1693,'multiline':True]['text':' Confirm repair worked such that results is now valid and no errors were suppressed by','line_number':1719,'multiline':False]['text':' repair.','line_number':1720,'multiline':False]['text':'additionalOptions=','line_number':1730,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':1756,'multiline':False]['text':' validation.','line_number':1757,'multiline':False]['text':'full=','line_number':1758,'multiline':True]['text':'background=','line_number':1758,'multiline':True]['text':' Create a new collection.','line_number':1764,'multiline':False]['text':' Create an index.','line_number':1774,'multiline':False]['text':' Insert documents.','line_number':1784,'multiline':False]['text':' Removing an index entry without removing the document should cause us to have a missing','line_number':1802,'multiline':False]['text':' index entry.','line_number':1803,'multiline':False]['text':' Confirm validate detects missing index entries.','line_number':1840,'multiline':False]['text':'additionalOptions=','line_number':1850,'multiline':True]['text':' Run validate with repair, expect missing index entries are inserted.','line_number':1872,'multiline':False]['text':'additionalOptions=','line_number':1882,'multiline':True]['text':' Confirm missing index entries have been inserted such that results are valid and no','line_number':1904,'multiline':False]['text':' errors were suppressed by repair.','line_number':1905,'multiline':False]['text':'additionalOptions=','line_number':1915,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':1941,'multiline':False]['text':' validation.','line_number':1942,'multiline':False]['text':'full=','line_number':1943,'multiline':True]['text':'background=','line_number':1943,'multiline':True]['text':' Create a new collection.','line_number':1946,'multiline':False]['text':' Create an index.','line_number':1956,'multiline':False]['text':' Insert documents.','line_number':1966,'multiline':False]['text':' Removing a document without removing the index entries should cause us to have extra','line_number':1984,'multiline':False]['text':' index entries.','line_number':1985,'multiline':False]['text':' Confirm validation detects extra index entries error.','line_number':1996,'multiline':False]['text':'additionalOptions=','line_number':2006,'multiline':True]['text':' Run validate with repair, expect extra index entries are removed.','line_number':2028,'multiline':False]['text':'additionalOptions=','line_number':2038,'multiline':True]['text':' Confirm extra index entries are removed such that results are valid.','line_number':2060,'multiline':False]['text':'additionalOptions=','line_number':2070,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':2096,'multiline':False]['text':' validation.','line_number':2097,'multiline':False]['text':'full=','line_number':2099,'multiline':True]['text':'background=','line_number':2099,'multiline':True]['text':' Create a new collection and insert a document.','line_number':2105,'multiline':False]['text':' Create a unique index.','line_number':2118,'multiline':False]['text':' Confirm that inserting a document with the same value for "a" fails, verifying the','line_number':2130,'multiline':False]['text':' uniqueness constraint.','line_number':2131,'multiline':False]['text':' Insert a document with a duplicate key for "a" but do not insert key into index a.','line_number':2141,'multiline':False]['text':' Insert a record and its keys separately. We do this to bypass duplicate constraint','line_number':2153,'multiline':False]['text':' checking. Inserting a record and its keys ensures that validation fails','line_number':2154,'multiline':False]['text':' because there are duplicate keys, and not just because there are keys without','line_number':2155,'multiline':False]['text':' corresponding records.','line_number':2156,'multiline':False]['text':' Insert the key on _id.','line_number':2164,'multiline':False]['text':' Confirm validation detects missing index entry.','line_number':2214,'multiline':False]['text':'additionalOptions=','line_number':2224,'multiline':True]['text':' Run validate with repair, expect missing index entry of duplicate document is removed','line_number':2244,'multiline':False]['text':' from record store and results are valid.','line_number':2245,'multiline':False]['text':'additionalOptions=','line_number':2255,'multiline':True]['text':' Verify the older duplicate document appears in the lost-and-found as expected.','line_number':2277,'multiline':False]['text':' Verify the newer duplicate document still appears in the collection as expected.','line_number':2287,'multiline':False]['text':' Confirm duplicate document of missing index entries are removed such that results are','line_number':2298,'multiline':False]['text':' valid.','line_number':2299,'multiline':False]['text':'additionalOptions=','line_number':2309,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':2338,'multiline':False]['text':' validation.','line_number':2339,'multiline':False]['text':'full=','line_number':2341,'multiline':True]['text':'background=','line_number':2341,'multiline':True]['text':' Create a new collection and insert a document.','line_number':2347,'multiline':False]['text':' Create unique indexes.','line_number':2364,'multiline':False]['text':' Confirm that inserting a document with the same value for "a" and "b" fails, verifying','line_number':2388,'multiline':False]['text':' the uniqueness constraint.','line_number':2389,'multiline':False]['text':' Insert a document with a duplicate key for "a" and "b" but do not insert into respective','line_number':2400,'multiline':False]['text':' indexes.','line_number':2401,'multiline':False]['text':' Insert a record and its keys separately. We do this to bypass duplicate constraint','line_number':2413,'multiline':False]['text':' checking. Inserting a record without inserting keys results in the duplicate record','line_number':2414,'multiline':False]['text':' to be missing from both unique indexes.','line_number':2415,'multiline':False]['text':' Insert the key on _id.','line_number':2423,'multiline':False]['text':' Confirm validation detects missing index entries.','line_number':2473,'multiline':False]['text':'additionalOptions=','line_number':2483,'multiline':True]['text':' Run validate with repair, expect missing index entry document is removed from record','line_number':2503,'multiline':False]['text':' store and no action is taken on outdated missing index entry.','line_number':2504,'multiline':False]['text':' Results will not be valid because IndexInfo.numKeys is not subtracted from when','line_number':2505,'multiline':False]['text':' deleteDocument is called. TODO SERVER-62257: Update test to expect valid results when','line_number':2506,'multiline':False]['text':' numKeys can be correctly updated.','line_number':2507,'multiline':False]['text':'additionalOptions=','line_number':2517,'multiline':True]['text':' Verify the older document appears in the lost-and-found as expected.','line_number':2541,'multiline':False]['text':' Verify the newer duplicate document still appears in the collection as expected.','line_number':2551,'multiline':False]['text':' Confirm extra index entries are removed such that results are valid.','line_number':2562,'multiline':False]['text':'additionalOptions=','line_number':2572,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':2603,'multiline':False]['text':' validation.','line_number':2604,'multiline':False]['text':'full=','line_number':2606,'multiline':True]['text':'background=','line_number':2606,'multiline':True]['text':' Create a new collection and insert a document.','line_number':2612,'multiline':False]['text':' Create unique indexes.','line_number':2631,'multiline':False]['text':' Confirm that inserting a document with the same value for "a" and "b" fails, verifying','line_number':2655,'multiline':False]['text':' the uniqueness constraint.','line_number':2656,'multiline':False]['text':' Remove index entry of first document from index b to make it a missing index entry.','line_number':2666,'multiline':False]['text':' Insert a document with a duplicate key for "a" and "b".','line_number':2710,'multiline':False]['text':' Insert a record and its keys separately. We do this to bypass duplicate constraint','line_number':2722,'multiline':False]['text':' checking. Inserting a record and all of its keys ensures that validation fails','line_number':2723,'multiline':False]['text':' because there are duplicate keys, and not just because there are keys without','line_number':2724,'multiline':False]['text':' corresponding records.','line_number':2725,'multiline':False]['text':' Insert the key on _id.','line_number':2733,'multiline':False]['text':' Insert the key on b.','line_number':2780,'multiline':False]['text':' Confirm validation detects missing index entries.','line_number':2830,'multiline':False]['text':'additionalOptions=','line_number':2840,'multiline':True]['text':' Run validate with repair, expect duplicate missing index entry document is removed from','line_number':2860,'multiline':False]['text':' record store and missing index entry is inserted into index. Results should be valid.','line_number':2861,'multiline':False]['text':'additionalOptions=','line_number':2871,'multiline':True]['text':' Verify the older duplicate document appears in the lost-and-found as expected.','line_number':2895,'multiline':False]['text':' Verify the newer duplicate document still appears in the collection as expected.','line_number':2905,'multiline':False]['text':' Confirm extra index entries are removed such that results are valid.','line_number':2916,'multiline':False]['text':'additionalOptions=','line_number':2926,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':2957,'multiline':False]['text':' validation.','line_number':2958,'multiline':False]['text':'full=','line_number':2960,'multiline':True]['text':'background=','line_number':2960,'multiline':True]['text':' Create a new collection and insert non-multikey document.','line_number':2966,'multiline':False]['text':' Create non-multikey index.','line_number':2983,'multiline':False]['text':' Set up a non-multikey index with multikey document.','line_number':2995,'multiline':False]['text':' Remove non-multikey index entry.','line_number':3004,'multiline':False]['text':' Update non-multikey document with multikey document.   {a: 1}   ->   {a: [2, 3]}','line_number':3033,'multiline':False]['text':' Not inserting keys into index should create missing multikey entries.','line_number':3043,'multiline':False]['text':' Confirm missing multikey document found on non-multikey index error detected by validate.','line_number':3047,'multiline':False]['text':'additionalOptions=','line_number':3056,'multiline':True]['text':' Run validate in repair mode.','line_number':3078,'multiline':False]['text':'additionalOptions=','line_number':3088,'multiline':True]['text':' Confirm index updated as multikey and missing index entries are inserted such that valid','line_number':3110,'multiline':False]['text':' is true.','line_number':3111,'multiline':False]['text':'additionalOptions=','line_number':3121,'multiline':True]['text':'full=','line_number':3147,'multiline':True]['text':'background=','line_number':3147,'multiline':True]['text':' Create a new collection.','line_number':3153,'multiline':False]['text':' Create two identical indexes only differing by key pattern and name.','line_number':3163,'multiline':False]['text':' Insert a document.','line_number':3186,'multiline':False]['text':' Remove the index entry for index "a".','line_number':3204,'multiline':False]['text':' Remove the index entry for index "b".','line_number':3242,'multiline':False]['text':' Now we have two missing index entries with the keys { : 1 } since the KeyStrings','line_number':3281,'multiline':False]['text':' aren't hydrated with their field names.','line_number':3282,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':3294,'multiline':False]['text':' checkpoints.','line_number':3295,'multiline':False]['text':' Create a new collection.','line_number':3303,'multiline':False]['text':' Create a unique index.','line_number':3313,'multiline':False]['text':' Insert a document.','line_number':3325,'multiline':False]['text':' Confirm that inserting a document with the same value for "a" fails, verifying the','line_number':3335,'multiline':False]['text':' uniqueness constraint.','line_number':3336,'multiline':False]['text':' Insert a document with a duplicate key for "a".','line_number':3346,'multiline':False]['text':' Insert a record and its keys separately. We do this to bypass duplicate constraint','line_number':3357,'multiline':False]['text':' checking. Inserting a record and all of its keys ensures that validation fails','line_number':3358,'multiline':False]['text':' because there are duplicate keys, and not just because there are keys without','line_number':3359,'multiline':False]['text':' corresponding records.','line_number':3360,'multiline':False]['text':' Insert the key on _id.','line_number':3367,'multiline':False]['text':' Insert the key on "a".','line_number':3414,'multiline':False]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':3487,'multiline':False]['text':' checkpoints.','line_number':3488,'multiline':False]['text':' Create a new collection.','line_number':3493,'multiline':False]['text':' Encode an invalid BSON Object with an invalid type, x90 and insert record','line_number':3503,'multiline':False]['text':' validate() will set a kProvided read source. Callers continue to do operations','line_number':3525,'multiline':False]['text':' after running validate, so we must reset the read source back to normal before','line_number':3526,'multiline':False]['text':' returning.','line_number':3527,'multiline':False]['text':'additionalOptions=','line_number':3538,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':3562,'multiline':False]['text':' validation.','line_number':3563,'multiline':False]['text':'full=','line_number':3564,'multiline':True]['text':'background=','line_number':3564,'multiline':True]['text':' Create a new collection.','line_number':3567,'multiline':False]['text':' Encode BSON Objects with invalid type x90, size less than 5 bytes, and BSON length and','line_number':3577,'multiline':False]['text':' object size mismatch, respectively. Insert invalid BSON objects into record store.','line_number':3578,'multiline':False]['text':' Confirm all of the different corrupt records previously inserted are detected by','line_number':3596,'multiline':False]['text':' validate.','line_number':3597,'multiline':False]['text':'additionalOptions=','line_number':3607,'multiline':True]['text':' Run validate with repair, expect corrupted records are removed.','line_number':3629,'multiline':False]['text':'additionalOptions=','line_number':3639,'multiline':True]['text':' Check that the corrupted records have been removed from the record store.','line_number':3658,'multiline':False]['text':' Confirm corrupt records have been removed such that repair does not need to run and','line_number':3664,'multiline':False]['text':' results are valid.','line_number':3665,'multiline':False]['text':'additionalOptions=','line_number':3675,'multiline':True]['text':' Confirm repair mode does not silently suppress validation errors.','line_number':3697,'multiline':False]['text':'additionalOptions=','line_number':3707,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':3733,'multiline':False]['text':' validation.','line_number':3734,'multiline':False]['text':'full=','line_number':3735,'multiline':True]['text':'background=','line_number':3735,'multiline':True]['text':' Create a new collection and insert non-multikey document.','line_number':3741,'multiline':False]['text':' Create non-multikey index.','line_number':3758,'multiline':False]['text':' Set up a non-multikey index with multikey document.','line_number':3770,'multiline':False]['text':' Remove non-multikey index entry.','line_number':3779,'multiline':False]['text':' Update non-multikey document with multikey document.   {a: 1}   ->   {a: [2, 3]}','line_number':3808,'multiline':False]['text':' Insert index entries which satisfy the new multikey document.','line_number':3818,'multiline':False]['text':' Insert index keys one at a time in order to avoid marking index as multikey','line_number':3838,'multiline':False]['text':' and allows us to pass in an empty set of MultikeyPaths.','line_number':3839,'multiline':False]['text':' Confirm multikey document found on non-multikey index error detected by validate.','line_number':3872,'multiline':False]['text':'additionalOptions=','line_number':3881,'multiline':True]['text':' Run validate in repair mode.','line_number':3901,'multiline':False]['text':'additionalOptions=','line_number':3911,'multiline':True]['text':' Confirm index updated as multikey and multikey paths added such that index does not have','line_number':3931,'multiline':False]['text':' to be rebuilt.','line_number':3932,'multiline':False]['text':'additionalOptions=','line_number':3942,'multiline':True]['text':' No need to test with background validation as repair mode is not supported in background','line_number':3966,'multiline':False]['text':' validation.','line_number':3967,'multiline':False]['text':'full=','line_number':3968,'multiline':True]['text':'background=','line_number':3968,'multiline':True]['text':' Create a new collection and insert multikey document.','line_number':3974,'multiline':False]['text':' Create a multikey index.','line_number':3992,'multiline':False]['text':' Add a multikey document such that the multikey index's multikey paths do not cover it.','line_number':4004,'multiline':False]['text':' Remove index keys for original document.','line_number':4014,'multiline':False]['text':' Update multikey document with a different multikey documents (not covered by multikey','line_number':4044,'multiline':False]['text':' paths).   {a: [1, 2], b: 1}   ->   {a: 1, b: [4, 5]}','line_number':4045,'multiline':False]['text':' We are using the multikeyPaths of the old document and passing them to this insert','line_number':4055,'multiline':False]['text':' call (to avoid changing the multikey state).','line_number':4056,'multiline':False]['text':' Confirm multikey paths' insufficient coverage of multikey document detected by validate.','line_number':4092,'multiline':False]['text':'additionalOptions=','line_number':4102,'multiline':True]['text':' Run validate in repair mode.','line_number':4122,'multiline':False]['text':'additionalOptions=','line_number':4132,'multiline':True]['text':' Confirm repair mode does not silently suppress validation errors.','line_number':4152,'multiline':False]['text':'additionalOptions=','line_number':4162,'multiline':True]['text':' Tests that multikey paths can be added to an index for the first time.','line_number':4184,'multiline':False]['text':' No need to test with background validation as repair mode is not supported in background','line_number':4187,'multiline':False]['text':' validation.','line_number':4188,'multiline':False]['text':'full=','line_number':4189,'multiline':True]['text':'background=','line_number':4189,'multiline':True]['text':' Create a new collection and create an index.','line_number':4193,'multiline':False]['text':' Remove the multikeyPaths from the index catalog entry. This simulates the catalog state','line_number':4212,'multiline':False]['text':' of a pre-3.4 index.','line_number':4213,'multiline':False]['text':' Reload the index from the modified catalog.','line_number':4229,'multiline':False]['text':' Insert a multikey document. The multikeyPaths should not get updated in this old','line_number':4242,'multiline':False]['text':' state.','line_number':4243,'multiline':False]['text':' Confirm multikeyPaths are added by validate.','line_number':4263,'multiline':False]['text':'additionalOptions=','line_number':4273,'multiline':True]['text':' Confirm validate does not make changes when run a second time.','line_number':4297,'multiline':False]['text':'additionalOptions=','line_number':4307,'multiline':True]['text':'full=','line_number':4336,'multiline':True]['text':'clustered=','line_number':4336,'multiline':True]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':4339,'multiline':False]['text':' checkpoints.','line_number':4340,'multiline':False]['text':' Encode an invalid BSON Object with an invalid type, x90 and insert record','line_number':4348,'multiline':False]['text':' validate() will set a kProvided read source. Callers continue to do operations','line_number':4368,'multiline':False]['text':' after running validate, so we must reset the read source back to normal before','line_number':4369,'multiline':False]['text':' returning.','line_number':4370,'multiline':False]['text':'additionalOptions=','line_number':4381,'multiline':True]['text':'full=','line_number':4408,'multiline':True]['text':'clustered=','line_number':4408,'multiline':True]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':4411,'multiline':False]['text':' checkpoints.','line_number':4412,'multiline':False]['text':' Create an index.','line_number':4420,'multiline':False]['text':' Insert documents.','line_number':4430,'multiline':False]['text':' Updating a document without updating the index entry will cause validation to detect a','line_number':4465,'multiline':False]['text':' missing index entry and an extra index entry.','line_number':4466,'multiline':False]['text':' validate() will set a kProvided read source. Callers continue to do operations','line_number':4483,'multiline':False]['text':' after running validate, so we must reset the read source back to normal before','line_number':4484,'multiline':False]['text':' returning.','line_number':4485,'multiline':False]['text':'additionalOptions=','line_number':4496,'multiline':True]['text':'full=','line_number':4520,'multiline':True]['text':'background=','line_number':4520,'multiline':True]['text':'clustered=','line_number':4520,'multiline':True]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':4523,'multiline':False]['text':' checkpoints.','line_number':4524,'multiline':False]['text':' Create an index.','line_number':4532,'multiline':False]['text':' Insert documents.','line_number':4542,'multiline':False]['text':' Updating a document without updating the index entry will cause validation to detect a','line_number':4577,'multiline':False]['text':' missing index entry and an extra index entry.','line_number':4578,'multiline':False]['text':' validate() will set a kProvided read source. Callers continue to do operations','line_number':4595,'multiline':False]['text':' after running validate, so we must reset the read source back to normal before','line_number':4596,'multiline':False]['text':' returning.','line_number':4597,'multiline':False]['text':'additionalOptions=','line_number':4608,'multiline':True]['text':' Run validate with repair, expect that extra index entries are removed and missing index','line_number':4627,'multiline':False]['text':' entries are inserted.','line_number':4628,'multiline':False]['text':' validate() will set a kProvided read source. Callers continue to do operations','line_number':4636,'multiline':False]['text':' after running validate, so we must reset the read source back to normal before','line_number':4637,'multiline':False]['text':' returning.','line_number':4638,'multiline':False]['text':'additionalOptions=','line_number':4649,'multiline':True]['text':'*
 * Validate the detection of inconsistent RecordId's in a clustered collection.
 * Covered scenarios: a document with missing _id and a Record whose
 * RecordId doesn't match the document _id.
 ','line_number':4674,'multiline':True]['text':'full=','line_number':4683,'multiline':True]['text':'background=','line_number':4683,'multiline':True]['text':'clustered=','line_number':4683,'multiline':True]['text':' Cannot run validate with {background:true} if the storage engine does not support','line_number':4687,'multiline':False]['text':' checkpoints.','line_number':4688,'multiline':False]['text':' Create index on {a: 1}','line_number':4697,'multiline':False]['text':' Insert documents','line_number':4708,'multiline':False]['text':' Corrupt the first record in the RecordStore by dropping the document's _id field.','line_number':4739,'multiline':False]['text':' Corrupt the second record in the RecordStore by having the RecordId not match the _id','line_number':4740,'multiline':False]['text':' field. Leave the third record untocuhed.','line_number':4741,'multiline':False]['text':' Verify that validate() detects the two corrupt records.','line_number':4767,'multiline':False]['text':'additionalOptions=','line_number':4777,'multiline':True]['text':' TODO SERVER-83593: re-enable background validation tests.','line_number':4809,'multiline':False]['text':' Add tests for both full validate and non-full validate.','line_number':4811,'multiline':False]['text':' add<ValidateIdIndexCount<false, true>>();','line_number':4814,'multiline':False]['text':' add<ValidateSecondaryIndexCount<false, true>>();','line_number':4817,'multiline':False]['text':' These tests are only needed for non-full validate.','line_number':4819,'multiline':False]['text':' add<ValidateIdIndex<false, true>>();','line_number':4821,'multiline':False]['text':' add<ValidateSecondaryIndex<false, true>>();','line_number':4823,'multiline':False]['text':' add<ValidateMultiKeyIndex<false, true>>();','line_number':4825,'multiline':False]['text':' add<ValidateSparseIndex<false, true>>();','line_number':4827,'multiline':False]['text':' add<ValidateCompoundIndex<false, true>>();','line_number':4829,'multiline':False]['text':' add<ValidatePartialIndex<false, true>>();','line_number':4831,'multiline':False]['text':' add<ValidatePartialIndexOnCollectionWithNonIndexableFields<false, true>>();','line_number':4833,'multiline':False]['text':' add<ValidateWildCardIndex<false, true>>();','line_number':4835,'multiline':False]['text':' add<ValidateWildCardIndexWithProjection<false, true>>();','line_number':4837,'multiline':False]['text':' Tests for index validation.','line_number':4839,'multiline':False]['text':' add<ValidateIndexEntry<false, true>>();','line_number':4841,'multiline':False]['text':' Tests that the 'missingIndexEntries' and 'extraIndexEntries' field are populated','line_number':4844,'multiline':False]['text':' correctly.','line_number':4845,'multiline':False]['text':' add<ValidateDuplicateKeysUniqueIndex<false, true>>();','line_number':4861,'multiline':False]['text':' add<ValidateInvalidBSONResults<false, true>>();','line_number':4864,'multiline':False]['text':' Tests that validation works on clustered collections.','line_number':4872,'multiline':False]['text':' add<ValidateInvalidBSONOnClusteredCollection<true>>();','line_number':4874,'multiline':False]['text':' add<ValidateReportInfoOnClusteredCollection<true>>();','line_number':4876,'multiline':False]['text':'withSecondaryIndex','line_number':4879,'multiline':True]['text':'withSecondaryIndex','line_number':4880,'multiline':True]['text':' add<ValidateInvalidRecordIdOnClusteredCollection<true>>(false /*withSecondaryIndex*/);','line_number':4881,'multiline':False]['text':' add<ValidateInvalidRecordIdOnClusteredCollection<true>>(true /*withSecondaryIndex*/);','line_number':4882,'multiline':False]['text':' namespace ValidateTests','line_number':4888,'multiline':False]['text':' namespace mongo','line_number':4889,'multiline':False]