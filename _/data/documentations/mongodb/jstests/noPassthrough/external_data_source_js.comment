['text':'*
 * Tests $_externalDataSources aggregate command option.
 *
 * @tags: [
 * # This test file requires multi-threading for writers and tends to fail on small machines due to
 * # thread resource shortage
 * requires_external_data_source
 * ]
 ','line_number':1,'multiline':True]['text':' Runs tests on a standalone mongod.','line_number':12,'multiline':False]['text':' Create two random pipe names to avoid collisions with tests running concurrently on the same box.','line_number':22,'multiline':False]['text':' 0-999,999,999','line_number':23,'multiline':False]['text':' Empty option','line_number':27,'multiline':False]['text':' No external file metadata','line_number':32,'multiline':False]['text':' No file type','line_number':38,'multiline':False]['text':' Unknown file type','line_number':48,'multiline':False]['text':' No storage type','line_number':59,'multiline':False]['text':' Unknown storage type','line_number':68,'multiline':False]['text':' No url','line_number':79,'multiline':False]['text':' Invalid url #1: Unsupported protocol for 'pipe'','line_number':87,'multiline':False]['text':' Invalid url #2: '..' in the url','line_number':97,'multiline':False]['text':' The source namespace is not an external data source','line_number':108,'multiline':False]['text':' Verifies that an external data source cannot be used for the $merge / $out pipeline stages.','line_number':132,'multiline':False]['text':'','line_number':171,'multiline':False]['text':' Named Pipes success test cases follow.','line_number':172,'multiline':False]['text':'','line_number':173,'multiline':False]['text':'//////////////////////////////////////////////////////////////////////////////////////////////////','line_number':175,'multiline':False]['text':' Test production code for MultiBsonStreamCursor and below, plus the shell pipe writer and reader','line_number':176,'multiline':False]['text':' functions, separately from $_externalDataSources to help narrow down the source of any failures.','line_number':177,'multiline':False]['text':'//////////////////////////////////////////////////////////////////////////////////////////////////','line_number':178,'multiline':False]['text':' "objects" first field contains the count of objects read','line_number':188,'multiline':False]['text':'//////////////////////////////////////////////////////////////////////////////////////////////','line_number':193,'multiline':False]['text':' Test that $_externalDataSource can read and aggregate multiple named pipes.','line_number':194,'multiline':False]['text':'//////////////////////////////////////////////////////////////////////////////////////////////','line_number':195,'multiline':False]['text':' shell puts agg result in "_batch"[0] field of a wrapper obj','line_number':214,'multiline':False]['text':'//////////////////////////////////////////////////////////////////////////////////////////////','line_number':218,'multiline':False]['text':' Test correctness by verifying reading from the pipes returns the same objects written to','line_number':219,'multiline':False]['text':' them.','line_number':220,'multiline':False]['text':'//////////////////////////////////////////////////////////////////////////////////////////////','line_number':221,'multiline':False]['text':' The following objects are also in BSON file external_data_source.bson in the same order.','line_number':222,'multiline':False]['text':' number of pipes to write','line_number':223,'multiline':False]['text':' number of different objects for round-robin','line_number':233,'multiline':False]['text':' Verify the objects read from the pipes match what was written to them.','line_number':248,'multiline':False]['text':'//////////////////////////////////////////////////////////////////////////////////////////////','line_number':258,'multiline':False]['text':' Test _writeTestPipeBsonFile() correctness by verifying it writes objects from','line_number':259,'multiline':False]['text':' external_data_source.bson correctly as read back via $_externalDataSources. This is the same','line_number':260,'multiline':False]['text':' as prior test except for using _writeTestPipeBsonFile() instead of _writeTestPipeObjects().','line_number':261,'multiline':False]['text':'//////////////////////////////////////////////////////////////////////////////////////////////','line_number':262,'multiline':False]['text':' Verify the objects read from the pipes match what was written to them.','line_number':279,'multiline':False]['text':' Prepares data for $match / $group / $unionWith / spill test cases.','line_number':289,'multiline':False]['text':' 10 groups','line_number':298,'multiline':False]['text':' Computes {$group: {_id: "$g", c: {$count: {}}} manually.','line_number':327,'multiline':False]['text':' Makes sure that both classic/SBE $group spill data.','line_number':401,'multiline':False]['text':' Verifies that 'killCursors' command works over external data sources while the server keeps','line_number':441,'multiline':False]['text':' reading data from a named pipe. Reading external data sources should be interruptible.','line_number':442,'multiline':False]['text':' Prepares a large dataset.','line_number':446,'multiline':False]['text':' 10 groups','line_number':452,'multiline':False]['text':' We read 2 collections using $unionWith so that the result set cannot be fit into one','line_number':457,'multiline':False]['text':' result batch for the 'getMore' request.','line_number':458,'multiline':False]['text':' 250K docs almost reaches 16MB BSONObj size limit.','line_number':462,'multiline':False]['text':' Has 'getMore' command issued to the server since the default batch size is 101 documents.','line_number':481,'multiline':False]['text':' Has 'killCursors' command issued to the server while the server is reading more data from','line_number':486,'multiline':False]['text':' named pipes to send the next batch. If this fails, an exception will be thrown.','line_number':487,'multiline':False]['text':' The 'externalPipeDir' is effective only on POSIX-like system.','line_number':497,'multiline':False]['text':' Verfies that 'externalPipeDir' server parameter works with the same test cases.','line_number':499,'multiline':False]['text':' Verifies that 'externalPipeDir' with '..' is rejected.','line_number':516,'multiline':False]