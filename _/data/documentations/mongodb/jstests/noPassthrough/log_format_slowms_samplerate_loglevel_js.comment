['text':'*
 * Confirms that log output for each operation adheres to the expected, consistent format, including
 * query/write metrics where applicable, on both mongoD and mongoS.
 * @tags: [
 *   requires_replication,
 *   requires_sharding,
 * ]
 ','line_number':1,'multiline':True]['text':' This test looks for exact matches in log output, which does not account for implicit','line_number':10,'multiline':False]['text':' sessions.','line_number':11,'multiline':False]['text':' Prevent the mongo shell from gossiping its cluster time, since this will increase the amount','line_number':17,'multiline':False]['text':' of data logged for each op. For some of the testcases below, including the cluster time would','line_number':18,'multiline':False]['text':' cause them to be truncated at the 512-byte RamLog limit, and some of the fields we need to','line_number':19,'multiline':False]['text':' check would be lost.','line_number':20,'multiline':False]['text':' Set up a 2-shard single-node replicaset cluster.','line_number':23,'multiline':False]['text':' Obtain one mongoS connection and a second direct to the shard.','line_number':31,'multiline':False]['text':' Ensure that the primary shard for the test database is shard0.','line_number':40,'multiline':False]['text':' Drops and re-shards the test collection, then splits at {_id: 0} and moves the upper chunk to','line_number':44,'multiline':False]['text':' the second shard.','line_number':45,'multiline':False]['text':' Configures logging parameters on the target environment, constructs a list of test operations','line_number':51,'multiline':False]['text':' depending on the deployment type, runs each of these in turn, and searches the logs for the','line_number':52,'multiline':False]['text':' corresponding output. Returns a pair of arrays [testsRun, logLines]; the former is the set of','line_number':53,'multiline':False]['text':' test cases that were run, while the latter contains the logline for each test, or null if no','line_number':54,'multiline':False]['text':' such logline was found.','line_number':55,'multiline':False]['text':' Build a string that identifies the parameters of this test run. Individual ops will','line_number':71,'multiline':False]['text':' use this string as their comment where applicable, and we also print it to the logs.','line_number':72,'multiline':False]['text':' Set all logging parameters. If slowMs is null, we set a high threshold here so that','line_number':77,'multiline':False]['text':' logLevel can be tested in cases where operations should not otherwise be logged.','line_number':78,'multiline':False]['text':' Certain fields in the log lines on mongoD are not applicable in their counterparts on','line_number':84,'multiline':False]['text':' mongoS, and vice-versa. Ignore these fields when examining the logs of an instance on','line_number':85,'multiline':False]['text':' which we do not expect them to appear.','line_number':86,'multiline':False]['text':' Clear the log before running the test, to guarantee that we do not match against any','line_number':94,'multiline':False]['text':' similar tests which may have run previously.','line_number':95,'multiline':False]['text':' Run the given command in order to generate a log line. If slowMs is non-null and','line_number':98,'multiline':False]['text':' greater than 0, apply that slowMs to every second test.','line_number':99,'multiline':False]['text':' Confirm whether the operation was logged or not.','line_number':105,'multiline':False]['text':'','line_number':110,'multiline':False]['text':' Defines the set of test operations and associated log output fields.','line_number':111,'multiline':False]['text':'','line_number':112,'multiline':False]['text':' TODO SERVER-34208: display FAM update metrics in mongoS logs.','line_number':196,'multiline':False]['text':' Confirm log content for getMore on both find and aggregate cursors.','line_number':372,'multiline':False]['text':' Make sure queryHash field is present of getMore logs following a find command.','line_number':382,'multiline':False]['text':' Run each of the test in the array, recording the log line found for each.','line_number':402,'multiline':False]['text':'','line_number':409,'multiline':False]['text':' Helper functions.','line_number':410,'multiline':False]['text':'','line_number':411,'multiline':False]['text':' In cases where some tests were not logged, this helper will identify and return them.','line_number':413,'multiline':False]['text':'','line_number':418,'multiline':False]['text':' Test cases for varying values of logLevel, slowms, and sampleRate.','line_number':419,'multiline':False]['text':'','line_number':420,'multiline':False]['text':' Test that all operations are logged when slowMs is < 0 and sampleRate is 1 at the','line_number':423,'multiline':False]['text':' default logLevel.','line_number':424,'multiline':False]['text':' Test that only some operations are logged when sampleRate is < 1 at the default','line_number':430,'multiline':False]['text':' logLevel, even when slowMs is < 0. The actual sample rate is probabilistic, and may','line_number':431,'multiline':False]['text':' therefore vary quite significantly from 0.5. However, we have already established','line_number':432,'multiline':False]['text':' that with sampleRate 1 *all* ops are logged, so here it is sufficient to confirm that','line_number':433,'multiline':False]['text':' some ops are not. We repeat the test 5 times to minimize the odds of failure.','line_number':434,'multiline':False]['text':' Test that only operations which exceed slowMs are logged when slowMs > 0 and','line_number':445,'multiline':False]['text':' sampleRate is 1, at the default logLevel. The given value of slowMs will be applied','line_number':446,'multiline':False]['text':' to every second op in the test, so only half of the ops should be logged.','line_number':447,'multiline':False]['text':' Test that all operations are logged when logLevel is 1, regardless of sampleRate and','line_number':453,'multiline':False]['text':' slowMs. We pass 'null' for slowMs to signify that a high threshold should be set','line_number':454,'multiline':False]['text':' (such that, at logLevel 0, no operations would be logged) and that this value should','line_number':455,'multiline':False]['text':' be applied for all operations, rather than for every second op as in the case of the','line_number':456,'multiline':False]['text':' slowMs test.','line_number':457,'multiline':False]