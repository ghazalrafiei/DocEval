['text':'*
 * Tests the updateOne command on time-series collections in multi-document transactions.
 *
 * @tags: [
 *   requires_replication,
 *   requires_timeseries,
 *   featureFlagTimeseriesUpdatesSupport,
 * ]
 ','line_number':1,'multiline':True]['text':' Insert test documents.','line_number':38,'multiline':False]['text':' 1. Update one document from the collection in a transaction.','line_number':42,'multiline':False]['text':' Expect one updated document with updated: 1.','line_number':55,'multiline':False]['text':' 2. updateOne should not have visible changes when the transaction is aborted.','line_number':59,'multiline':False]['text':' The transaction was aborted so no documents should have been updated.','line_number':72,'multiline':False]['text':' 3. Run a few updateOnes in a single transaction.','line_number':76,'multiline':False]['text':' Expect all documents with {meta: 0} to be updated.','line_number':93,'multiline':False]['text':' 4. Tests performing updateOnes in and out of a transaction on abort.','line_number':97,'multiline':False]['text':' Update all documents for meta values 0, 1.','line_number':106,'multiline':False]['text':' Outside of the session and transaction, perform an updateOne.','line_number':114,'multiline':False]['text':' The aborted transaction should not have updated any documents.','line_number':120,'multiline':False]['text':' The update outside of the transaction should have succeeded.','line_number':124,'multiline':False]['text':' 5. Tests performing updateOnes in and out of a transaction on commit.','line_number':128,'multiline':False]['text':' Within the transaction.','line_number':138,'multiline':False]['text':' Outside of the session and transaction, perform updateOne.','line_number':144,'multiline':False]['text':' Expect all documents to have been updated.','line_number':152,'multiline':False]['text':' 6. Tests a race to update the same document in and out of a transaction.','line_number':156,'multiline':False]['text':' Within the transaction, perform an updateOne.','line_number':165,'multiline':False]['text':' Note: there is a change the parallel shell runs after the transaction is committed and that','line_number':169,'multiline':False]['text':' is fine as both interleavings should succeed.','line_number':170,'multiline':False]['text':' Outside of the session and transaction, perform updateOne.','line_number':176,'multiline':False]['text':' Allow non-transactional updateOne to finish.','line_number':183,'multiline':False]['text':' 7. Tests a transactional updateOne on a document which gets visible after the transaction','line_number':188,'multiline':False]['text':' starts.','line_number':189,'multiline':False]['text':' Ensure the document does not exist within the snapshot of the newly started transaction.','line_number':198,'multiline':False]['text':' Outside of the session and transaction, update document.','line_number':201,'multiline':False]['text':' Double check the document is still not visible from within the transaction.','line_number':205,'multiline':False]['text':' Within the transaction, perform updateOne.','line_number':208,'multiline':False]['text':' The newly updated document should not be updated even though the transaction commits after','line_number':215,'multiline':False]['text':' the write performed outside.','line_number':216,'multiline':False]['text':' 8. Tests two side-by-side transactional updateOnes on the same document.','line_number':220,'multiline':False]['text':' Start transactions on different sessions.','line_number':232,'multiline':False]['text':' Ensure the document exists in the snapshot of both transactions.','line_number':236,'multiline':False]['text':' Perform updateOne on transaction A.','line_number':240,'multiline':False]['text':' We expect the updateOne on transaction B to fail, causing the transaction to abort.','line_number':252,'multiline':False]['text':' Sidenote: avoiding the updateOne method from 'crud_api.js' because it throws.','line_number':253,'multiline':False]['text':' Ensure the document is updated in the snapshot of transaction A.','line_number':259,'multiline':False]['text':' Since transaction A has not committed yet, the document should still not be updated outside','line_number':261,'multiline':False]['text':' of the transaction.','line_number':262,'multiline':False]['text':' Ensure the document has been successfully updated after transaction A commits.','line_number':265,'multiline':False]