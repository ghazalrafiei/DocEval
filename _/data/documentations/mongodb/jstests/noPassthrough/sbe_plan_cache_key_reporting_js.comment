['text':'*
 * Confirms that the SBE and classic engines use the correct format to report 'queryHash' and
 * 'planCacheKey' values across a variety of commands and outputs.
 *
 * @tags: [
 *   requires_profiling,
 *   requires_sbe
 * ]
 ','line_number':1,'multiline':True]['text':' Drop and recreates a test collection along with two indexes: {a: 1} and {a: 1, b: 1}.','line_number':21,'multiline':False]['text':' Runs the given 'testToRun' twice using the SBE and classic engine and returns the result of each','line_number':27,'multiline':False]['text':' run as an array with two elements: first for SBE, second for classic.','line_number':28,'multiline':False]['text':'','line_number':29,'multiline':False]['text':' Calls 'setupCollection' before each run.','line_number':30,'multiline':False]['text':' Verifies and asserts that the two objects 'sbe' and 'classic', which represent the result of','line_number':40,'multiline':False]['text':' execution of some command agains the SBE and classic engine respectively, contain the 'queryHash'','line_number':41,'multiline':False]['text':' and 'planCacheKey' attributes, and the values of those attribuets are different.','line_number':42,'multiline':False]['text':'','line_number':43,'multiline':False]['text':' The purpose of this assertion is to ensure that the SBE and classic engines use the correct','line_number':44,'multiline':False]['text':' 'queryHash' and 'planCacheKey' formats, which are different between the two engines.','line_number':45,'multiline':False]['text':' Validate the the 'queryHash' and 'planCacheKey' are correctly reported in the system.profile','line_number':62,'multiline':False]['text':' collection.','line_number':63,'multiline':False]['text':' Set db profiling level to collect data for all operations.','line_number':66,'multiline':False]['text':' We need to run the query twice in order to recover the plan from the cache and report','line_number':70,'multiline':False]['text':' the 'planCacheKey'.','line_number':71,'multiline':False]['text':' Disable profiling and find the matching profiler entry for the command above.','line_number':75,'multiline':False]['text':' Validate the the 'queryHash' and 'planCacheKey' are correctly reported in explain output.','line_number':88,'multiline':False]['text':' Validate the the 'queryHash' and 'planCacheKey' are correctly reported in $planCacheStats','line_number':102,'multiline':False]['text':' output.','line_number':103,'multiline':False]['text':' Run the test command once. We're not interested whether the cached entry is active or','line_number':107,'multiline':False]['text':' not, but rather if it's present in the cache.','line_number':108,'multiline':False]['text':' Validate the the 'queryHash' and 'planCacheKey' are correctly reported in log output for slow','line_number':126,'multiline':False]['text':' queries.','line_number':127,'multiline':False]['text':' Set all logging parameters: disable profiling and log all operations at the default','line_number':130,'multiline':False]['text':' logLevel.','line_number':131,'multiline':False]['text':' Clear the log before running the test, to guarantee that we do not match against any','line_number':135,'multiline':False]['text':' similar tests which may have run previously.','line_number':136,'multiline':False]['text':' Run an aggregate command in order to generate a log line.','line_number':139,'multiline':False]['text':' Confirm whether the operation was logged or not.','line_number':144,'multiline':False]['text':' Validate that a query with pushed down $lookup stage uses classic plan cache key encoding.','line_number':158,'multiline':False]['text':' The query hashes and the plan cache keys ('the keys') are different now because','line_number':185,'multiline':False]['text':' 'internalQueryFrameworkControl' flag is encoded into query shape, once this','line_number':186,'multiline':False]['text':' flag is removed from the query shape encoding the keys will be different.','line_number':187,'multiline':False]['text':' Validate that a query with pushed down $group stage uses classic plan cache key encoding.','line_number':191,'multiline':False]['text':' The query hashes and the plan cache keys ('the keys') are different now because','line_number':210,'multiline':False]['text':' 'internalQueryFrameworkControl' flag is encoded into query shape, once this','line_number':211,'multiline':False]['text':' flag is removed from the query shape encoding the keys will be different.','line_number':212,'multiline':False]