['text':' Test basic multi-statement transaction abort.','line_number':1,'multiline':False]['text':'','line_number':2,'multiline':False]['text':' @tags: [','line_number':3,'multiline':False]['text':'   # The test runs commands that are not allowed with security token: endSession.','line_number':4,'multiline':False]['text':'   not_allowed_with_signed_security_token,','line_number':5,'multiline':False]['text':'   uses_transactions,','line_number':6,'multiline':False]['text':'   uses_snapshot_read_concern','line_number':7,'multiline':False]['text':' ]','line_number':8,'multiline':False]['text':' TODO (SERVER-39704): Remove the following load after SERVER-39704 is completed','line_number':10,'multiline':False]['text':' Insert a doc within the transaction.','line_number':31,'multiline':False]['text':' TODO (SERVER-39704): We use the retryOnceOnTransientOnMongos','line_number':33,'multiline':False]['text':' function to handle how MongoS will propagate a StaleShardVersion error as a','line_number':34,'multiline':False]['text':' TransientTransactionError. After SERVER-39704 is completed the','line_number':35,'multiline':False]['text':' retryOnceOnTransientOnMongos can be removed','line_number':36,'multiline':False]['text':' Insert a doc within a transaction.','line_number':48,'multiline':False]['text':' Cannot read with default read concern.','line_number':56,'multiline':False]['text':' Cannot read with default read concern.','line_number':58,'multiline':False]['text':' abortTransaction can only be run on the admin database.','line_number':61,'multiline':False]['text':' Read with default read concern cannot see the aborted transaction.','line_number':69,'multiline':False]['text':' Insert a doc with the same _id in a new transaction should work.','line_number':75,'multiline':False]['text':' commitTransaction can only be called on the admin database.','line_number':85,'multiline':False]['text':' Read with default read concern sees the committed transaction.','line_number':92,'multiline':False]['text':' abortTransaction can only be called on the admin database.','line_number':98,'multiline':False]['text':' The first insert works well.','line_number':112,'multiline':False]['text':' But the second insert throws duplicated index key error.','line_number':121,'multiline':False]['text':' DuplicateKey is not a transient error.','line_number':129,'multiline':False]['text':' The error aborts the transaction.','line_number':132,'multiline':False]['text':' commitTransaction can only be called on the admin database.','line_number':133,'multiline':False]['text':' Verify the documents are the same.','line_number':141,'multiline':False]['text':' Insert a doc from session 1.','line_number':150,'multiline':False]['text':' Insert a doc from session 2 that doesn't conflict with session 1.','line_number':160,'multiline':False]['text':' Insert a doc from session 2 that conflicts with session 1.','line_number':169,'multiline':False]['text':' Session 1 isn't affected.','line_number':179,'multiline':False]['text':' commitTransaction can only be called on the admin database.','line_number':180,'multiline':False]['text':' Transaction on session 2 is aborted.','line_number':187,'multiline':False]['text':' Verify the documents only reflect the first transaction.','line_number':195,'multiline':False]['text':' A higher txnNumber aborts the old and inserts the same document.','line_number':209,'multiline':False]['text':' commitTransaction can only be called on the admin database.','line_number':219,'multiline':False]['text':' Read with default read concern sees the committed transaction but cannot see the aborted one.','line_number':226,'multiline':False]['text':' Perform a snapshot read under a new transaction.','line_number':235,'multiline':False]['text':' The cursor has not been exhausted.','line_number':245,'multiline':False]['text':' Perform a second snapshot read under a new transaction.','line_number':250,'multiline':False]['text':' The cursor has been exhausted.','line_number':259,'multiline':False]['text':' commitTransaction can only be called on the admin database.','line_number':262,'multiline':False]