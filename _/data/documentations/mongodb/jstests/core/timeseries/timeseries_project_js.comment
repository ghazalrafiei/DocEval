['text':'*
 * Test the behavior of $project on time-series collections.
 *
 * @tags: [
 *   # We need a timeseries collection.
 *   requires_timeseries,
 *   requires_fcv_62,
 *   # Aggregation with explain may return incomplete results if interrupted by a stepdown.
 *   does_not_support_stepdowns,
 *   # "Explain of a resolved view must be executed by mongos"
 *   directly_against_shardsvrs_incompatible,
 * ]
 ','line_number':1,'multiline':True]['text':' A $project stage that immediately follows unpacking might be incorporated into the unpacking','line_number':24,'multiline':False]['text':' stage. Test that the unpacking stage correctly hides the fields that are dropped by the project,','line_number':25,'multiline':False]['text':' whether that's a meta, a time or a measurement field.','line_number':26,'multiline':False]['text':' The $replaceRoot stage itself isn't incorporated into unpacking but it causes the unpack','line_number':88,'multiline':False]['text':' stage to include no fields, as if everything was projected away. It should still unpack the','line_number':89,'multiline':False]['text':' correct _number_ of events. In SBE we rely on the 'timeField' to do this, but the field','line_number':90,'multiline':False]['text':' shouldn't be visible to the rest of the query.','line_number':91,'multiline':False]['text':' With no filters the unpack stage would include no fields.','line_number':102,'multiline':False]['text':' A 'metaField' filter is pushed below unpacking so the unpack stage would include no fields.','line_number':108,'multiline':False]['text':' With a trivially "false" event filter the unpack stage would still include no fields.','line_number':115,'multiline':False]['text':' A non-trivial event filter would cause the unpack stage to include the field for the filter.','line_number':121,'multiline':False]['text':' Test that when $project redefines a field name, the unpacking stage does not overwrite it.','line_number':132,'multiline':False]['text':' Check that measurements being unpacked don't overwrite metadata projection pushdown fields.','line_number':144,'multiline':False]['text':' Same as above, but keep the rest of the document.','line_number':153,'multiline':False]['text':' Check that nested meta project is not overwritten by the unpacked value.','line_number':157,'multiline':False]['text':' Check that meta project pushed down writes to each value in an array.','line_number':161,'multiline':False]['text':' Replace meta field with unpacked field.','line_number':165,'multiline':False]['text':' Replace meta field with time field.','line_number':169,'multiline':False]['text':' Replace meta field with constant.','line_number':173,'multiline':False]['text':' Make sure the time field can be overwritten by the meta field correctly.','line_number':177,'multiline':False]['text':' Check that the time field can be overwritten by the an unpacked field correctly.','line_number':181,'multiline':False]['text':' Make sure the time field can be overwritten by a constant correctly.','line_number':185,'multiline':False]['text':' Test that a pushed down meta field projection can correctly be excluded.','line_number':189,'multiline':False]['text':' Exclude behavior for time field.','line_number':193,'multiline':False]['text':' Exclude behavior for consecutive projects.','line_number':197,'multiline':False]['text':' Test that an exclude does not overwrite meta field pushdown.','line_number':201,'multiline':False]['text':' Test that a field reference in a $project stage refers to the stage's input document rather than','line_number':206,'multiline':False]['text':' the newly defined field with the same name.','line_number':207,'multiline':False]['text':' Redefining and using the top-level 'metaField' in the same stage should use the field from','line_number':224,'multiline':False]['text':' the upstream (unpack) stage.','line_number':225,'multiline':False]['text':' Redefining and using the 'timeField' in the same stage should use the field from the upstream','line_number':229,'multiline':False]['text':' (unpack) stage.','line_number':230,'multiline':False]['text':' Redefining and using a top-level measurement field in the same stage should use the field','line_number':234,'multiline':False]['text':' from the upstream (unpack) stage.','line_number':235,'multiline':False]['text':' Redefining and using a sub-measurement field in the same stage should use the field from the','line_number':239,'multiline':False]['text':' upstream (unpack) stage.','line_number':240,'multiline':False]['text':' Redefining and using a measurement field in an expression in the same stage should use the','line_number':244,'multiline':False]['text':' field from the upstream (unpack) stage.','line_number':245,'multiline':False]['text':' Test that a field reference in a $addFields stage refers to the stage's input document rather','line_number':250,'multiline':False]['text':' than the newly defined field with the same name.','line_number':251,'multiline':False]['text':' Redefining and using the top-level 'metaField' in the same stage should use the field from','line_number':267,'multiline':False]['text':' the upstream (unpack) stage.','line_number':268,'multiline':False]['text':' Redefining and using the 'timeField' in the same stage should use the field from the upstream','line_number':272,'multiline':False]['text':' (unpack) stage.','line_number':273,'multiline':False]['text':' Redefining and using a top-level measurement field in the same stage should use the field','line_number':277,'multiline':False]['text':' from the upstream (unpack) stage.','line_number':278,'multiline':False]['text':' Redefining and using a measurement field in an expression in the same stage should use the','line_number':282,'multiline':False]['text':' field from the upstream (unpack) stage.','line_number':283,'multiline':False]