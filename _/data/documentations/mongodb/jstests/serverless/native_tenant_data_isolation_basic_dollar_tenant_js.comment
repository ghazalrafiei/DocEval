['text':' Test basic db operations in multitenancy using $tenant.','line_number':1,'multiline':False]['text':' needed for health log entries check.','line_number':12,'multiline':False]['text':' Prepare a user for testing pass tenant via $tenant.','line_number':22,'multiline':False]['text':' Must be authenticated as a user with ActionType::useTenant in order to use $tenant.','line_number':23,'multiline':False]['text':' In this jstest, the collection (defined by kCollName) and the document "{_id: 0, a: 1, b: 1}"','line_number':37,'multiline':False]['text':' for the tenant (defined by kTenant) will be reused by all command tests. So, any test which','line_number':38,'multiline':False]['text':' changes the collection name or document should reset it.','line_number':39,'multiline':False]['text':' Test create and listCollections commands, plus $listCatalog aggregate, on collection.','line_number':41,'multiline':False]['text':' Create a collection for the tenant kTenant, and then create a view on the collection.','line_number':45,'multiline':False]['text':' Get catalog without specifying target collection (collectionless).','line_number':64,'multiline':False]['text':' Check that the resulting array of catalog entries contains our target databases and','line_number':69,'multiline':False]['text':' namespaces.','line_number':70,'multiline':False]['text':' Also check that the resulting array contains views specific to our target database.','line_number':74,'multiline':False]['text':' Get catalog when specifying our target collection, which should only return one result.','line_number':80,'multiline':False]['text':' Check that the resulting array of catalog entries contains our target database and','line_number':89,'multiline':False]['text':' namespace.','line_number':90,'multiline':False]['text':' These collections should not be accessed with a different tenant.','line_number':95,'multiline':False]['text':' Test listDatabases command.','line_number':103,'multiline':False]['text':' Create databases for kTenant. A new database is implicitly created when a collection is','line_number':105,'multiline':False]['text':' created.','line_number':106,'multiline':False]['text':' The 'admin' database is not expected because we do not create a tenant user in this test.','line_number':114,'multiline':False]['text':' These databases should not be accessed with a different tenant.','line_number':118,'multiline':False]['text':' List all databases without $tenant. The tenant prefix is expected in response.','line_number':123,'multiline':False]['text':' List all databases with tenant perfix filter. The tenant prefix is expected in response.','line_number':131,'multiline':False]['text':' Test insert, agg, find, getMore, and explain commands.','line_number':143,'multiline':False]['text':' Check that find only returns documents from the correct tenant','line_number':153,'multiline':False]['text':' Test that getMore only works on a tenant's own cursor','line_number':168,'multiline':False]['text':' Test that aggregate only finds a tenant's own document.','line_number':182,'multiline':False]['text':' Test that explain works correctly.','line_number':201,'multiline':False]['text':' Test insert and findAndModify command.','line_number':213,'multiline':False]['text':' This document should not be accessed with a different tenant.','line_number':228,'multiline':False]['text':' Test count and distinct command.','line_number':238,'multiline':False]['text':' Test count command.','line_number':243,'multiline':False]['text':' Test Distict command.','line_number':251,'multiline':False]['text':' Test count on view collection.','line_number':260,'multiline':False]['text':' Test renameCollection command.','line_number':267,'multiline':False]['text':' Verify the the renamed collection by findAndModify existing documents.','line_number':274,'multiline':False]['text':' This collection should not be accessed with a different tenant.','line_number':283,'multiline':False]['text':' Reset the collection to be used below','line_number':289,'multiline':False]['text':' Test the dropCollection and dropDatabase commands.','line_number':294,'multiline':False]['text':' Another tenant shouldn't be able to drop the collection or database.','line_number':296,'multiline':False]['text':' Now, drop the collection using the original tenantId.','line_number':311,'multiline':False]['text':' Now, drop the database using the original tenantId.','line_number':319,'multiline':False]['text':' Reset the collection so other test cases can still access this collection with kCollName','line_number':326,'multiline':False]['text':' after this test.','line_number':327,'multiline':False]['text':' Test that transactions can be run successfully.','line_number':332,'multiline':False]['text':' Reset the collection so other test cases can still access this collection with kCollName','line_number':355,'multiline':False]['text':' after this test.','line_number':356,'multiline':False]['text':' Test createIndexes, listIndexes and dropIndexes command.','line_number':361,'multiline':False]['text':' These indexes should not be accessed with a different tenant.','line_number':393,'multiline':False]['text':' Drop those new created indexes.','line_number':402,'multiline':False]['text':' Test collMod','line_number':412,'multiline':False]['text':' Create the index used for collMod','line_number':414,'multiline':False]['text':' Modifying the index without the tenantId should not work.','line_number':422,'multiline':False]['text':'"TenantId must be set"','line_number':427,'multiline':True]['text':' Modify the index with the tenantId','line_number':429,'multiline':False]['text':' Drop the index created','line_number':438,'multiline':False]['text':' Test the applyOps command','line_number':443,'multiline':False]['text':' Check applyOp inserted the document.','line_number':450,'multiline':False]['text':' Test the validate command.','line_number':457,'multiline':False]['text':' Test dbCheck command and health log.','line_number':464,'multiline':False]['text':' dbCheckStart and dbCheckStop have tenantId as well','line_number':476,'multiline':False]['text':' only dbCheckBatch has tenantId','line_number':481,'multiline':False]['text':' fail server-side javascript commands/stages, all unsupported in serverless','line_number':488,'multiline':False]['text':' Create a number of collections and entries used to test agg stages','line_number':490,'multiline':False]['text':' $where expression','line_number':503,'multiline':False]['text':' $function aggregate stage','line_number':515,'multiline':False]['text':' $accumulator operator','line_number':536,'multiline':False]['text':' mapReduce command','line_number':558,'multiline':False]['text':' Test the fail command failpoint with $tenant.','line_number':575,'multiline':False]['text':' We should not pass $tenant in the data field. Here it is passed twice.','line_number':577,'multiline':False]['text':' We should not pass $tenant in the data field.','line_number':590,'multiline':False]['text':' enable the failCommand failpoint for kTenant on myDb.myColl for the find command.','line_number':602,'multiline':False]['text':' same tenant and same namespace should fail.','line_number':614,'multiline':False]['text':' same tenant different namespace.','line_number':618,'multiline':False]['text':' different tenant passed and same namespace.','line_number':621,'multiline':False]['text':' different tenant passed and different namespace.','line_number':624,'multiline':False]['text':' disable the failCommand failpoint.','line_number':627,'multiline':False]