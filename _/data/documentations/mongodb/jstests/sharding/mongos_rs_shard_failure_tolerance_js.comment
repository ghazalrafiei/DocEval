['text':'','line_number':1,'multiline':False]['text':' Tests mongos's failure tolerance for replica set shards and read preference queries','line_number':2,'multiline':False]['text':'','line_number':3,'multiline':False]['text':' Sets up a cluster with three shards, the first shard of which has an unsharded collection and','line_number':4,'multiline':False]['text':' half a sharded collection.  The second shard has the second half of the sharded collection, and','line_number':5,'multiline':False]['text':' the third shard has nothing.  Progressively shuts down the primary of each shard to see the','line_number':6,'multiline':False]['text':' impact on the cluster.','line_number':7,'multiline':False]['text':'','line_number':8,'multiline':False]['text':' Three different connection states are tested - active (connection is active through whole','line_number':9,'multiline':False]['text':' sequence), idle (connection is connected but not used before a shard change), and new','line_number':10,'multiline':False]['text':' (connection connected after shard change).','line_number':11,'multiline':False]['text':' Checking UUID and index consistency involves talking to shard primaries, but by the end of this','line_number':13,'multiline':False]['text':' test, one shard does not have a primary.','line_number':14,'multiline':False]['text':' The routing table consistency check runs with 'snapshot' level readConcern. This readConcern','line_number':20,'multiline':False]['text':' level cannot be satisfied without a replica set primary, which we won't have because this test','line_number':21,'multiline':False]['text':' removes the replica set primary from a shard.','line_number':22,'multiline':False]['text':' Create the unsharded database','line_number':35,'multiline':False]['text':' Create the sharded database','line_number':41,'multiline':False]['text':' Secondaries do not refresh their in-memory routing table until a request with a higher','line_number':50,'multiline':False]['text':' version is received, and refreshing requires communication with the primary to obtain the','line_number':51,'multiline':False]['text':' newest version. Read from the secondaries once before taking down primaries to ensure they','line_number':52,'multiline':False]['text':' have loaded the routing table into memory.','line_number':53,'multiline':False]['text':' Clean up connections','line_number':58,'multiline':False]['text':'','line_number':62,'multiline':False]['text':' Setup is complete','line_number':63,'multiline':False]['text':'','line_number':64,'multiline':False]['text':' Clean up new connections','line_number':120,'multiline':False]['text':' Need to save this node for later','line_number':126,'multiline':False]['text':' Reads with read prefs','line_number':133,'multiline':False]['text':' Ensure read prefs override slaveOK','line_number':147,'multiline':False]['text':' Writes','line_number':177,'multiline':False]['text':' Writes','line_number':184,'multiline':False]['text':' Reads with read prefs','line_number':189,'multiline':False]['text':' Ensure read prefs override slaveOK','line_number':203,'multiline':False]['text':' Reads with read prefs','line_number':235,'multiline':False]['text':' Clean up new connections incrementally to compensate for slow win32 machine.','line_number':246,'multiline':False]['text':' Clean up new connections incrementally to compensate for slow win32 machine.','line_number':260,'multiline':False]['text':' Ensure read prefs override slaveok','line_number':262,'multiline':False]['text':' Clean up new connections incrementally to compensate for slow win32 machine.','line_number':278,'multiline':False]['text':' Clean up new connections incrementally to compensate for slow win32 machine.','line_number':290,'multiline':False]['text':' Clean up new connections incrementally to compensate for slow win32 machine.','line_number':302,'multiline':False]['text':' Clean up new connections incrementally to compensate for slow win32 machine.','line_number':314,'multiline':False]['text':' Clean up new connections incrementally to compensate for slow win32 machine.','line_number':326,'multiline':False]['text':' Writes','line_number':328,'multiline':False]['text':' Clean up new connections','line_number':336,'multiline':False]['text':' Clean up new connections','line_number':385,'multiline':False]['text':' Clean up new connections','line_number':429,'multiline':False]