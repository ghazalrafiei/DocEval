['text':'*
 * Exercises the coordinator commands logic by simulating a basic two phase commit and basic two
 * phase abort.
 *
 * @tags: [uses_transactions, uses_prepare_transaction, uses_multi_shard_transaction]
 ','line_number':1,'multiline':True]['text':' Create a sharded collection with a chunk on each shard:','line_number':109,'multiline':False]['text':' shard0: [-inf, 0)','line_number':110,'multiline':False]['text':' shard1: [0, 10)','line_number':111,'multiline':False]['text':' shard2: [10, +inf)','line_number':112,'multiline':False]['text':' These forced refreshes are not strictly necessary; they just prevent extra TXN log lines','line_number':123,'multiline':False]['text':' from the shards starting, aborting, and restarting the transaction due to needing to','line_number':124,'multiline':False]['text':' refresh after the transaction has started.','line_number':125,'multiline':False]['text':' Start a new transaction by inserting a document onto each shard.','line_number':131,'multiline':False]['text':' Manually abort the transaction on one of the participants, so that the participant','line_number':151,'multiline':False]['text':' fails to prepare.','line_number':152,'multiline':False]['text':' Turn on failpoints so that the coordinator hangs after each write it does, so that the','line_number':166,'multiline':False]['text':' test can check that the write happened correctly.','line_number':167,'multiline':False]['text':' Run commitTransaction through a parallel shell.','line_number':174,'multiline':False]['text':' Check that the coordinator wrote the participant list.','line_number':182,'multiline':False]['text':' Check that the coordinator wrote the decision.','line_number':187,'multiline':False]['text':' Check that the coordinator deleted its persisted state.','line_number':193,'multiline':False]['text':' Check that the transaction committed or aborted as expected.','line_number':203,'multiline':False]['text':' Use assert.soon(), because although coordinateCommitTransaction currently blocks','line_number':209,'multiline':False]['text':' until the commit process is fully complete, it will eventually be changed to only','line_number':210,'multiline':False]['text':' block until the decision is *written*, so the documents may not be visible','line_number':211,'multiline':False]['text':' immediately.','line_number':212,'multiline':False]['text':' test abort ','line_number':221,'multiline':True]['text':' no network failures ','line_number':221,'multiline':True]['text':' test commit ','line_number':222,'multiline':True]['text':' no network failures ','line_number':222,'multiline':True]['text':' test abort ','line_number':223,'multiline':True]['text':' with network failures ','line_number':223,'multiline':True]['text':' test commit ','line_number':224,'multiline':True]['text':' with network failures ','line_number':224,'multiline':True]