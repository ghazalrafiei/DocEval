['text':'*
 * Tests that the analyzeShardKey command and the configureQueryAnalyzer command fail with expected
 * errors if the collection is dropped, renamed, recreated or emptied while they are running.
 *
 * @tags: [requires_fcv_70]
 ','line_number':1,'multiline':True]['text':' The sampling-based initial split policy needs 10 samples per split point so','line_number':15,'multiline':False]['text':' 10 * analyzeShardKeyNumRanges is the minimum number of distinct shard key values that the','line_number':16,'multiline':False]['text':' collection must have for the command to not fail to generate split points (i.e. fail with the','line_number':17,'multiline':False]['text':' error code 4952606).','line_number':18,'multiline':False]['text':' Given the number of documents defined above, the error code 4952606 is only expected because of','line_number':21,'multiline':False]['text':' the deletes that will occur as part of renaming, dropping, recreating and emptying the','line_number':22,'multiline':False]['text':' collection.','line_number':23,'multiline':False]['text':' The shard key does not have enough cardinality for generating split points because','line_number':28,'multiline':False]['text':' documents are being deleted.','line_number':29,'multiline':False]['text':' The collection becomes empty during the $collStats step.','line_number':31,'multiline':False]['text':' The collection becomes empty during the step for calculating the monotonicity metrics.','line_number':33,'multiline':False]['text':' The collection becomes empty during the step for calculating the cardinality and frequency','line_number':35,'multiline':False]['text':' metrics.','line_number':36,'multiline':False]['text':' Test DDL operations after each step below.','line_number':49,'multiline':False]['text':' mode ','line_number':133,'multiline':True]['text':' samplesPerSecond ','line_number':133,'multiline':True]['text':' The configureQueryAnalyzer command is serialized with DDL commands. In addition, on a','line_number':142,'multiline':False]['text':' sharded cluster, dropping a collection causes its config.queryAnalyzers document to','line_number':143,'multiline':False]['text':' get deleted. So if there is config.queryAnalyzers document for this collection after','line_number':144,'multiline':False]['text':' it is dropped and recreated, the configureQueryAnalyzer command must have run after','line_number':145,'multiline':False]['text':' the collection has been recreated so it must have the new collection uuid.','line_number':146,'multiline':False]['text':' (SERVER-76443): Make sure that dropCollection on replica set delete the','line_number':150,'multiline':False]['text':' config.queryAnalyzers doc for the collection being dropped.','line_number':151,'multiline':False]['text':' Verify that running the configureQueryAnalyzer command after the DDL operation does not','line_number':157,'multiline':False]['text':' lead to a crash.','line_number':158,'multiline':False]['text':' mode ','line_number':161,'multiline':True]['text':' samplesPerSecond ','line_number':161,'multiline':True]['text':' mode ','line_number':164,'multiline':True]['text':' TODO: SERVER-80318 Remove block','line_number':195,'multiline':False]