['text':' Test that the 'cloneCatalogData' command works correctly.','line_number':1,'multiline':False]['text':' Eventually, _shardsvrMovePrimary will use this command.','line_number':2,'multiline':False]['text':' Do not check metadata consistency as unsharded collections are cloned to non-primary shards for','line_number':5,'multiline':False]['text':' testing purposes.','line_number':6,'multiline':False]['text':' Enable sharding on the test DB.','line_number':20,'multiline':False]['text':' Create two collections with non-default options.','line_number':23,'multiline':False]['text':' Create some test documents and put them in each collection.','line_number':30,'multiline':False]['text':' Create indexes on each collection.','line_number':36,'multiline':False]['text':' Shard coll2, but leave coll1 unsharded.','line_number':50,'multiline':False]['text':' Wait for the write to config.collections to be visible in the majority snapshot on all config','line_number':53,'multiline':False]['text':' secondaries, since the test directly talks to shards and so does not gossip the configOpTime','line_number':54,'multiline':False]['text':' to those shards.','line_number':55,'multiline':False]['text':' Get the primary shard, and the non-primary shard.','line_number':58,'multiline':False]['text':' Have the other shard clone the DB from the primary.','line_number':69,'multiline':False]['text':' Ask the shard that just called _shardsvrCloneCatalogData for the collections.','line_number':73,'multiline':False]['text':' There should be 2 collections: coll1, coll2','line_number':79,'multiline':False]['text':' c1 should be coll1.','line_number':103,'multiline':False]['text':' c2 should be coll2.','line_number':107,'multiline':False]['text':' For each unsharded collection, there should be a total of 3 indexes - one for the _id','line_number':118,'multiline':False]['text':' field and the other two that we have created. However, in the case of sharded','line_number':119,'multiline':False]['text':' collections, only the _id index is present. When cloning sharded collections, indexes are','line_number':120,'multiline':False]['text':' not copied.','line_number':121,'multiline':False]['text':'shardedColl','line_number':139,'multiline':True]['text':'shardedColl','line_number':140,'multiline':True]['text':' Verify that the data from the unsharded collections resides on the new primary shard, and was','line_number':142,'multiline':False]['text':' copied as part of the clone.','line_number':143,'multiline':False]['text':' Check that the command fails without writeConcern majority.','line_number':155,'multiline':False]['text':' Check that the command fails when attempting to clone the admin database.','line_number':162,'multiline':False]['text':' The config server is a shard and already has collections for the database.','line_number':171,'multiline':False]['text':' The config server is dedicated but supports config shard mode, so it can accept sharded','line_number':179,'multiline':False]['text':' commands.','line_number':180,'multiline':False]['text':' Check that the command fails when failing to specify a source.','line_number':188,'multiline':False]['text':' Check that clone errors when the collection already exists on the destination.','line_number':194,'multiline':False]