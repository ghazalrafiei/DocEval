['text':' Inserts some interesting data into a sharded collection, enables the balancer, and tests that','line_number':1,'multiline':False]['text':' various kinds of aggregations return the expected results.','line_number':2,'multiline':False]['text':' Test combining results in mongos for operations that sub-aggregate on shards.','line_number':13,'multiline':False]['text':'','line_number':14,'multiline':False]['text':' The unusual operators here are $avg, $pushToSet, $push. In the case of $avg, the shard pipeline','line_number':15,'multiline':False]['text':' produces an object with the current subtotal and item count so that these can be combined in','line_number':16,'multiline':False]['text':' mongos by totalling the subtotals counts before performing the final division. For $pushToSet and','line_number':17,'multiline':False]['text':' $push, the shard pipelines produce arrays, but in mongos these are combined rather than simply','line_number':18,'multiline':False]['text':' being added as arrays within arrays.','line_number':19,'multiline':False]['text':' Generate one chunk for each 1000 documents so the balancer is kept busy throughout the','line_number':33,'multiline':False]['text':' execution of the test','line_number':34,'multiline':False]['text':' make shard -> mongos intermediate results less than 16MB','line_number':113,'multiline':False]['text':' control','line_number':122,'multiline':False]['text':' test sort + limit (using random to pull from both shards)','line_number':131,'multiline':False]['text':' $stdDevPop can vary slightly between runs if a migration occurs. This is why we use','line_number':152,'multiline':False]['text':' assert.close below.','line_number':153,'multiline':False]['text':' http://en.wikipedia.org/wiki/Arithmetic_progression#Sum','line_number':163,'multiline':False]['text':'decimal places','line_number':165,'multiline':True]['text':' http://en.wikipedia.org/wiki/Arithmetic_progression#Standard_deviation','line_number':167,'multiline':False]['text':'decimal places','line_number':169,'multiline':True]['text':' Make sure we error out if $out collection is sharded','line_number':194,'multiline':False]['text':' Point query.','line_number':215,'multiline':False]['text':' Normal pipeline.','line_number':219,'multiline':False]['text':' With $out.','line_number':221,'multiline':False]['text':' Range query.','line_number':227,'multiline':False]['text':' Normal pipeline.','line_number':239,'multiline':False]['text':' With $out.','line_number':241,'multiline':False]