['text':'*
 * Test $merge and exchange with explain.
 *
 * @tags: [requires_sharding]
 ','line_number':1,'multiline':True]['text':' Shard the input collection.','line_number':58,'multiline':False]['text':' Insert some data to the input collection.','line_number':61,'multiline':False]['text':' Shard the output collections.','line_number':68,'multiline':False]['text':' Run the explain. We expect to see the range based exchange here.','line_number':73,'multiline':False]['text':' Make sure we see the exchange in the explain output.','line_number':76,'multiline':False]['text':' Run the real query.','line_number':82,'multiline':False]['text':' Rerun the same query with the hash based exchange.','line_number':87,'multiline':False]['text':' Make sure we see the exchange in the explain output.','line_number':90,'multiline':False]['text':' Run the real query.','line_number':96,'multiline':False]['text':' This should fail because the "on" field ('b' in this case, the shard key of the target','line_number':101,'multiline':False]['text':' collection) cannot be an array.','line_number':102,'multiline':False]['text':' Turn off the exchange and rerun the query.','line_number':116,'multiline':False]['text':' Make sure there is no exchange.','line_number':120,'multiline':False]['text':' This should fail similar to before even if we are not running the exchange.','line_number':125,'multiline':False]['text':' SERVER-38349 Make sure mongos rejects specifying exchange directly.','line_number':139,'multiline':False]