['text':' Tests behaviour of the preimage remover where initially the primary and secondary are on','line_number':1,'multiline':False]['text':' different binary versions, and the behaviour after upgrading to latest.','line_number':2,'multiline':False]['text':'','line_number':3,'multiline':False]['text':' @tags: [','line_number':4,'multiline':False]['text':'  requires_fcv_72,','line_number':5,'multiline':False]['text':'  requires_replication,','line_number':6,'multiline':False]['text':' ]','line_number':7,'multiline':False]['text':' Reduce period of removal job to speed up test.','line_number':20,'multiline':False]['text':' Allow test cases to have complete control over which node is primary.','line_number':34,'multiline':False]['text':' Wait until at least 1 complete cycle of pre-image removal job is completed.','line_number':48,'multiline':False]['text':' Verify that at some point in time, all expired pre-images will be deleted.','line_number':54,'multiline':False]['text':' Await for primary to replicate deletes, in case it does not use unreplicated','line_number':71,'multiline':False]['text':' truncates.','line_number':72,'multiline':False]['text':' Enable time-based pre-image expiration and configure the 'expireAfterSeconds'.','line_number':79,'multiline':False]['text':' Test case: primary using truncate deletes, secondary with replicated deletes.','line_number':86,'multiline':False]['text':' The secondary is expected to not delete anything because the primary is not replicating deletes.','line_number':87,'multiline':False]['text':' The situation should be resolved on upgrading the node.','line_number':88,'multiline':False]['text':' Fix wall time used by pre image remover.','line_number':99,'multiline':False]['text':' Verify that when time-based pre-image expiration disabled, no pre-images are not deleted.','line_number':103,'multiline':False]['text':' Enable time based expiration.','line_number':106,'multiline':False]['text':' The secondary is expected to not have removed any documents.','line_number':109,'multiline':False]['text':' After upgrading the secondary to a version with truncate deletes, the preImages should be','line_number':112,'multiline':False]['text':' deleted.','line_number':113,'multiline':False]['text':' With shouldTruncateAllAfterUpgrade there's no need to simulate the current time given','line_number':116,'multiline':False]['text':' the low value for expireAfterSeconds (and that we want all documents to be truncated).','line_number':117,'multiline':False]['text':' On the other hand, if we expect some documents to survive, we need to re-enable the','line_number':119,'multiline':False]['text':' failpoint to simulate the time to force expiration.','line_number':120,'multiline':False]['text':' Test case: primary using replicated deletes, secondary using truncate deletes.','line_number':130,'multiline':False]['text':' The secondary might try to delete the same document both with truncate and by applying the','line_number':131,'multiline':False]['text':' replicated delete. This should be fine.','line_number':132,'multiline':False]['text':' Fix wall time used by pre image remover.','line_number':142,'multiline':False]['text':' Verify that when time-based pre-image expiration disabled, no pre-images are not deleted.','line_number':146,'multiline':False]['text':' Enable time based expiration.','line_number':149,'multiline':False]['text':' Both primary and secondary should remove expired documents.','line_number':152,'multiline':False]['text':' After upgrading the secondary to a version with truncate deletes, the preImages should be','line_number':155,'multiline':False]['text':' deleted.','line_number':156,'multiline':False]['text':'shouldTruncateAllAfterUpgrade=','line_number':165,'multiline':True]['text':'shouldTruncateAllAfterUpgrade=','line_number':166,'multiline':True]['text':'shouldTruncateAllAfterUpgrade=','line_number':168,'multiline':True]['text':'shouldTruncateAllAfterUpgrade=','line_number':169,'multiline':True]