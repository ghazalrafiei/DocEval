['text':'*
 * Tests setFeatureCompatibilityVersion.
 ','line_number':1,'multiline':True]['text':' Checking UUID consistency involves talking to a shard node, which in this test is shutdown','line_number':5,'multiline':False]['text':' A replset test case checks that replication to a secondary ceases, so we do not expect identical','line_number':8,'multiline':False]['text':' data.','line_number':9,'multiline':False]['text':' The oldest FCV that is supported is 'lastLTS'.','line_number':24,'multiline':False]['text':' A 'latest' binary standalone should default to 'latestFCV'.','line_number':31,'multiline':False]['text':' We do not support upgrading/downgrading to FCV's newer than last-lts but older than','line_number':45,'multiline':False]['text':' last-continuous.','line_number':46,'multiline':False]['text':' setFeatureCompatibilityVersion fails to downgrade FCV if the write fails.','line_number':65,'multiline':False]['text':' featureCompatibilityVersion can be downgraded to 'downgradeFCV'.','line_number':82,'multiline':False]['text':' setFeatureCompatibilityVersion does not support upgrading/downgrading between last-lts and','line_number':87,'multiline':False]['text':' last-continuous FCV by default. Upgrading from last-lts to last-continuous is allowed if','line_number':88,'multiline':False]['text':' fromConfigServer is set to true.','line_number':89,'multiline':False]['text':' Attempt to downgrade FCV from last-continuous to last-lts.','line_number':92,'multiline':False]['text':' Downgrading from last-continuous to last-lts is not allowed even with','line_number':96,'multiline':False]['text':' fromConfigServer: true.','line_number':97,'multiline':False]['text':' Attempt to upgrade FCV from last-lts to last-continuous.','line_number':105,'multiline':False]['text':' Reset the FCV back to last-lts.','line_number':124,'multiline':False]['text':' setFeatureCompatibilityVersion fails to upgrade to 'latestFCV' if the write fails.','line_number':134,'multiline':False]['text':' featureCompatibilityVersion can be upgraded to 'latestFCV'.','line_number':151,'multiline':False]['text':' featureCompatibilityVersion is durable.','line_number':158,'multiline':False]['text':' If you upgrade from 'downgradeVersion' binary to 'latest' binary and have non-local','line_number':178,'multiline':False]['text':' databases, FCV remains 'downgradeFCV'.','line_number':179,'multiline':False]['text':' 'latest' binary replica set.','line_number':210,'multiline':False]['text':' FCV should default to 'latestFCV' on primary and secondary in a 'latest' binary replica set.','line_number':217,'multiline':False]['text':' featureCompatibilityVersion propagates to secondary.','line_number':222,'multiline':False]['text':' A 'latest' binary secondary with a 'downgradeVersion' binary primary will have 'downgradeFCV'','line_number':235,'multiline':False]['text':' Test that a 'downgradeVersion' secondary can successfully perform initial sync from a','line_number':247,'multiline':False]['text':' 'latest' primary with 'downgradeFCV'.','line_number':248,'multiline':False]['text':' The default WC is majority and stopServerReplication will prevent satisfying any majority','line_number':260,'multiline':False]['text':' writes.','line_number':261,'multiline':False]['text':' The command should fail because wtimeout expires before a majority responds.','line_number':267,'multiline':False]['text':' Downgrading the FCV should fail if a previous upgrade has not yet completed.','line_number':275,'multiline':False]['text':' Upgrading to last-continuous should fail if we are in the middle of upgrading to latest.','line_number':281,'multiline':False]['text':' Because the failed upgrade command left the primary in an intermediary state, complete the','line_number':294,'multiline':False]['text':' upgrade.','line_number':295,'multiline':False]['text':' We will fail if we have not yet completed a downgrade and attempt to downgrade to a','line_number':310,'multiline':False]['text':' different target version.','line_number':311,'multiline':False]['text':' Complete the downgrade.','line_number':319,'multiline':False]['text':' The command should fail because wtimeout expires before a majority responds.','line_number':324,'multiline':False]['text':' Upgrading the FCV to latest should fail if a previous upgrade to lastContinuous has not','line_number':336,'multiline':False]['text':' yet completed.','line_number':337,'multiline':False]['text':' Complete the upgrade to last-continuous.','line_number':342,'multiline':False]['text':' Reset the FCV back to last-lts.','line_number':349,'multiline':False]['text':' Rig the election so that the first node running latest version remains the primary after the','line_number':359,'multiline':False]['text':' 'downgradeVersion' secondary is added to the replica set.','line_number':360,'multiline':False]['text':' Verify that the 'downgradeVersion' secondary successfully performed its initial sync.','line_number':366,'multiline':False]['text':' Test that a downgraded secondary can no longer replicate from the primary after the FCV is','line_number':371,'multiline':False]['text':' upgraded to 'latestFCV'.','line_number':372,'multiline':False]['text':' Note: the downgraded secondary must stop replicating during the upgrade to ensure it has no','line_number':373,'multiline':False]['text':' chance of seeing the 'upgrading to latest' message in the oplog, whereupon it would crash.','line_number':374,'multiline':False]['text':' Test idempotency for setFeatureCompatibilityVersion.','line_number':385,'multiline':False]['text':' Set FCV to 'downgradeFCV' so that a 'downgradeVersion' binary node can join the set.','line_number':390,'multiline':False]['text':' Add a 'downgradeVersion' binary node to the set.','line_number':396,'multiline':False]['text':' Ensure the 'downgradeVersion' binary node succeeded its initial sync.','line_number':400,'multiline':False]['text':' Run {setFCV: downgradeFCV}. This should be idempotent.','line_number':405,'multiline':False]['text':' Ensure the secondary is still running.','line_number':410,'multiline':False]['text':' The oldest FCV that is supported is 'lastLTS'.','line_number':417,'multiline':False]['text':' A 'latest' binary single node replica set and clean data files defaults to lastLTSFCV.','line_number':428,'multiline':False]['text':' A 'latest' binary cluster started with clean data files will set FCV to 'latestFCV'.','line_number':442,'multiline':False]['text':' Prevent the shard primary from receiving messages from the config server primary. When we try','line_number':477,'multiline':False]['text':' to set FCV to 'downgradeFCV', the command should fail because the shard cannot be contacted.','line_number':478,'multiline':False]['text':' indicates downgrade in progress ','line_number':485,'multiline':True]['text':' FCV can be set to 'downgradeFCV' on mongos.','line_number':488,'multiline':False]['text':' This is run through assert.soon() because we've just caused a network interruption','line_number':489,'multiline':False]['text':' by discarding messages in the bridge.','line_number':490,'multiline':False]['text':' featureCompatibilityVersion propagates to config and shard.','line_number':501,'multiline':False]['text':' A 'latest' binary replica set started as a shard server defaults to 'lastLTSFCV'.','line_number':505,'multiline':False]['text':' FCV can be set to 'latestFCV' on mongos.','line_number':519,'multiline':False]['text':' Call ShardingTest.stop before shutting down latestShard, so that the UUID check in','line_number':526,'multiline':False]['text':' ShardingTest.stop can talk to latestShard.','line_number':527,'multiline':False]['text':' Create cluster with a 'downgradeVersion' binary mongos so that we can add 'downgradeVersion'','line_number':531,'multiline':False]['text':' binary shards.','line_number':532,'multiline':False]['text':' Adding a 'downgradeVersion' binary shard to a cluster with 'downgradeFCV' succeeds.','line_number':538,'multiline':False]['text':' call ShardingTest.stop before shutting down downgradedShard, so that the UUID check in','line_number':550,'multiline':False]['text':' ShardingTest.stop can talk to downgradedShard.','line_number':551,'multiline':False]