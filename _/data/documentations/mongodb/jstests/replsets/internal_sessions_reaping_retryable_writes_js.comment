['text':'
 * Test that the logical session cache reaper reaps transaction sessions that correspond to the same
 * retryable write atomically.
 *
 * @tags: [requires_fcv_60, uses_transactions]
 ','line_number':1,'multiline':True]['text':' This test runs the reapLogicalSessionCacheNow command. That can lead to direct writes to the','line_number':12,'multiline':False]['text':' config.transactions collection, which cannot be performed on a session.','line_number':13,'multiline':False]['text':' Test reaping when neither the external session nor the internal sessions are checked out.','line_number':85,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions entry and','line_number':117,'multiline':False]['text':' config.image_collection entry for the retryable write in the external session do not get','line_number':118,'multiline':False]['text':' reaped since there is an in-progress internal transaction for that retryable write.','line_number':119,'multiline':False]['text':' Retry the write statement executed in the external session.','line_number':126,'multiline':False]['text':' Verify that the retried write statement did not re-execute.','line_number':139,'multiline':False]['text':' Retry the write statement executed in the external session.','line_number':208,'multiline':False]['text':' Retry the write statement executed in the committed internal transaction.','line_number':220,'multiline':False]['text':' Start another internal transaction in a separate thread, and make it hang right after it','line_number':234,'multiline':False]['text':' finishes executing the first statement.','line_number':235,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions entry and','line_number':246,'multiline':False]['text':' config.image_collection entry for the retryable write in the external session and the','line_number':247,'multiline':False]['text':' config.transactions for the committed internal transaction for that retryable write do not','line_number':248,'multiline':False]['text':' get reaped since there is an in-progress internal transaction for the same retryable write.','line_number':249,'multiline':False]['text':' Verify that the retried write statements did not re-execute.','line_number':259,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions entry and','line_number':316,'multiline':False]['text':' config.image_collection entry for the previous write do get reaped.','line_number':317,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions entry and','line_number':380,'multiline':False]['text':' config.image_collection entry for the previous write do get reaped.','line_number':381,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions entry and','line_number':438,'multiline':False]['text':' config.image_collection entry for the retryable write in external session do not get reaped','line_number':439,'multiline':False]['text':' since there has not been a retryble write or transaction with a higher txnNumber in the','line_number':440,'multiline':False]['text':' logical session.','line_number':441,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions entry for','line_number':496,'multiline':False]['text':' the committed non retryable-write internal transaction does get reaped since it is unrelated','line_number':497,'multiline':False]['text':' to the in-progress transaction in the external session.','line_number':498,'multiline':False]['text':' Test reaping when there is a checked out internal session.','line_number':519,'multiline':False]['text':' Retry the write statement executed in the external session.','line_number':567,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions entry and','line_number':593,'multiline':False]['text':' config.image_collection entry for the retryable write in the external session do not get','line_number':594,'multiline':False]['text':' reaped.','line_number':595,'multiline':False]['text':' Verify that the retried write statement did not re-execute.','line_number':605,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions entry and','line_number':677,'multiline':False]['text':' config.image_collection entry for the retryable write in the external session do not get','line_number':678,'multiline':False]['text':' reaped.','line_number':679,'multiline':False]['text':' Verify that the retried write statement did not re-execute.','line_number':689,'multiline':False]['text':' Retry the write statement executed in the external session.','line_number':759,'multiline':False]['text':' Retry the write statement executed in the committed internal transaction.','line_number':771,'multiline':False]['text':' Start another internal transaction in a separate thread, and make it hang right after it','line_number':785,'multiline':False]['text':' finishes executing the first statement.','line_number':786,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions and','line_number':797,'multiline':False]['text':' config.image_collection entry for the retryable write in the external session and for the','line_number':798,'multiline':False]['text':' committed internal transaction for that retryable write do not get reaped since there is an','line_number':799,'multiline':False]['text':' in-progress internal transaction for the same retryable write.','line_number':800,'multiline':False]['text':' Verify that the retried write statements did not re-execute.','line_number':810,'multiline':False]['text':' Test reaping when an internal session is about to be checked out.','line_number':823,'multiline':False]['text':' Retry the statement executed in the external session.','line_number':859,'multiline':False]['text':' Force the logical session cache to reap, and verify that the config.transactions entry and','line_number':883,'multiline':False]['text':' config.image_collection entry for the retryable write in the external session do get reaped.','line_number':884,'multiline':False]['text':' Verify that the internal transaction did not get interrupted but that the retried write','line_number':891,'multiline':False]['text':' statement re-execute, i.e. retryablity is violated because the retry occurs after the session','line_number':892,'multiline':False]['text':' got reaped.','line_number':893,'multiline':False]