['text':' Copyright 2022 The Impira Team and the HuggingFace Team. All rights reserved.','line_number':1,'multiline':False]['text':'','line_number':2,'multiline':False]['text':' Licensed under the Apache License, Version 2.0 (the "License");','line_number':3,'multiline':False]['text':' you may not use this file except in compliance with the License.','line_number':4,'multiline':False]['text':' You may obtain a copy of the License at','line_number':5,'multiline':False]['text':'','line_number':6,'multiline':False]['text':'     http://www.apache.org/licenses/LICENSE-2.0','line_number':7,'multiline':False]['text':'','line_number':8,'multiline':False]['text':' Unless required by applicable law or agreed to in writing, software','line_number':9,'multiline':False]['text':' distributed under the License is distributed on an "AS IS" BASIS,','line_number':10,'multiline':False]['text':' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.','line_number':11,'multiline':False]['text':' See the License for the specific language governing permissions and','line_number':12,'multiline':False]['text':' limitations under the License.','line_number':13,'multiline':False]['text':' normalize_bbox() and apply_tesseract() are derived from apply_tesseract in models/layoutlmv3/feature_extraction_layoutlmv3.py.','line_number':50,'multiline':False]['text':' However, because the pipeline may evolve from what layoutlmv3 currently does, it's copied (vs. imported) to avoid creating an','line_number':51,'multiline':False]['text':' unnecessary dependency.','line_number':52,'multiline':False]['text':' apply OCR','line_number':64,'multiline':False]['text':' filter empty words and corresponding coordinates','line_number':68,'multiline':False]['text':' turn coordinates into (left, top, left+width, top+height) format','line_number':76,'multiline':False]['text':' finally, normalize the bounding boxes','line_number':84,'multiline':False]['text':' TODO: Update task_summary docs to include an example with document QA and then update the first sentence','line_number':103,'multiline':False]['text':' NOTE: This code mirrors the code in question answering and will be implemented in a follow up PR','line_number':284,'multiline':False]['text':' to support documents with enough tokens that overflow the model's window','line_number':285,'multiline':False]['text':' Adapted from https://huggingface.co/spaces/nielsr/donut-docvqa/blob/main/app.py','line_number':333,'multiline':False]['text':' TODO: check why slower `LayoutLMTokenizer` and `LayoutLMv2Tokenizer` don't have this key in outputs','line_number':369,'multiline':False]['text':' FIXME: ydshieh and/or Narsil','line_number':370,'multiline':False]['text':' We do not use this','line_number':371,'multiline':False]['text':' p_mask: mask with 1 for token than cannot be in the answer (0 for token which can be in an answer)','line_number':375,'multiline':False]['text':' We put 0 on the tokens from the context and 1 everywhere else (question and special tokens)','line_number':376,'multiline':False]['text':' This logic mirrors the logic in the question_answering pipeline','line_number':377,'multiline':False]['text':' keep the cls_token unmasked (some models use it to indicate unanswerable questions)','line_number':388,'multiline':False]['text':' For each span, place a bounding box [0,0,0,0] for question and CLS tokens, [1000,1000,1000,1000]','line_number':394,'multiline':False]['text':' for SEP tokens, and the word's bounding box for words in the original document.','line_number':395,'multiline':False]['text':' TODO: A lot of this logic is specific to Donut and should probably be handled in the tokenizer','line_number':453,'multiline':False]['text':' (see https://github.com/huggingface/transformers/pull/18414/files#r961747408 for more context).','line_number':454,'multiline':False]['text':' remove first task start token','line_number':456,'multiline':False]['text':' large and positive','line_number':469,'multiline':False]