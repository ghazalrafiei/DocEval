['text':' outer_offset is the size of the outer dimensions of output (before axis)','line_number':41,'multiline':False]['text':' inner_offset is the size of the inner dimensions of output (after axis)','line_number':42,'multiline':False]['text':' ===== step1: initialize starting value','line_number':73,'multiline':False]['text':' ===== step2: apply reduction','line_number':89,'multiline':False]['text':' ===== step3: finalize reduction','line_number':111,'multiline':False]['text':' data and lengths should be contiguous from the call to .contiguous in segment_reduce_kernel','line_number':137,'multiline':False]['text':' reduction axis should always be the last dimension of lengths','line_number':140,'multiline':False]['text':' data and lengths should be contiguous from the call to .contiguous in segment_reduce_kernel','line_number':163,'multiline':False]['text':' reduction axis should always be the last dimension of lengths','line_number':166,'multiline':False]['text':'is_offsets_like=','line_number':176,'multiline':True]['text':' outer_offset is the size of the outer dimensions of output (before axis)','line_number':195,'multiline':False]['text':' inner_offset is the size of the inner dimensions of output (after axis)','line_number':196,'multiline':False]['text':' TODO: Switch to TensorIterator for better maintainablility and','line_number':207,'multiline':False]['text':' readability','line_number':208,'multiline':False]['text':' Used to calculate exclusive prod','line_number':219,'multiline':False]['text':' int64_t lengths_cum_sum = 0;','line_number':230,'multiline':False]['text':' int64_t segment_length = lengths_data[outer_idx * lengths_stride_axis * segment_count + dim_idx];','line_number':236,'multiline':False]['text':' Average gradient based on number of maximum elements in','line_number':264,'multiline':False]['text':' the segment','line_number':265,'multiline':False]['text':' explicitly compute exclusive prod','line_number':298,'multiline':False]['text':'is_offsets_like=','line_number':369,'multiline':True]['text':' namespace','line_number':385,'multiline':False]['text':' check that one of lengths or offsets is defined','line_number':399,'multiline':False]['text':' offsets related checks','line_number':415,'multiline':False]['text':' TODO: add checks when !unsafe','line_number':421,'multiline':False]['text':' length related checks','line_number':436,'multiline':False]['text':' offsets dispatches','line_number':471,'multiline':False]['text':' Currently some computation is being duplicated across forward and backward.','line_number':481,'multiline':False]['text':' TODO: Cache indices in forward pass to re-use in backward','line_number':482,'multiline':False]['text':' check that one of lengths or offsets is defined','line_number':493,'multiline':False]['text':' codegen for derivatives.yaml passes an undefined Tensor for None rather than a c10::optional','line_number':494,'multiline':False]['text':' so checking .has_value() doesn't work unlike in the forward pass','line_number':495,'multiline':False]['text':' namespace native','line_number':568,'multiline':False]['text':' namespace at','line_number':569,'multiline':False]