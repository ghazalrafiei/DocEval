['text':'
 * Copyright (c) Facebook, Inc. and its affiliates.
 * All rights reserved.
 *
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree.
 ','line_number':1,'multiline':True]['text':' This is a super slow kernel in that it does not use intrinsics to','line_number':16,'multiline':False]['text':' tranpose. Since this is for x86 we are not optimizing it.','line_number':17,'multiline':False]['text':' For ARM this will be optimized.','line_number':18,'multiline':False]['text':' Packed A format.','line_number':26,'multiline':False]['text':' 8kx4m blocks for alls blocks given 4 rows (4m) are placed in contiguous memory.','line_number':27,'multiline':False]['text':' Original A','line_number':28,'multiline':False]['text':' --------- K -----------          -- (K + 4 - 1) / 4 --','line_number':29,'multiline':False]['text':' |                     |          |                   |','line_number':30,'multiline':False]['text':' |                     |        (M + 8 - 1)/8         |','line_number':31,'multiline':False]['text':' |                     | Packed   |                   |','line_number':32,'multiline':False]['text':' M                     |  =>      |-------------------|','line_number':33,'multiline':False]['text':' |                     |        Thus Packed A has (K + 4 - 1)/4 * (M + 8 -1)/8 blocks','line_number':34,'multiline':False]['text':' |                     |','line_number':35,'multiline':False]['text':' |---------------------|','line_number':36,'multiline':False]['text':'','line_number':37,'multiline':False]['text':' Each 8 x 4 blocks is transposed and stored.','line_number':38,'multiline':False]['text':' Each of the (K + 4 - 1)/4 blocks for a given group of 8 m blocks','line_number':39,'multiline':False]['text':' are stored adjacent in memory','line_number':40,'multiline':False]['text':' Thus, each block:','line_number':41,'multiline':False]['text':' |----8m-----|----8m-----|','line_number':42,'multiline':False]['text':' 4k          |           | ..... (K + 4 - 1)/4 blocks','line_number':43,'multiline':False]['text':' |-----------|-----------|','line_number':44,'multiline':False]['text':' This locality helps in loading 8kx8m blocks of activations','line_number':45,'multiline':False]['text':' Note when M is not multiple of 8, the rest can contain arbitrary','line_number':46,'multiline':False]['text':' data in packed A as we will not be writing those out.','line_number':47,'multiline':False]['text':' This wil be taken care by just copying the appropriate valid data','line_number':48,'multiline':False]['text':' Note that parts of A that are not filled are:','line_number':50,'multiline':False]['text':' Remainder of M blocks. So some m values are random. This is ok','line_number':51,'multiline':False]['text':' because when sparse gemm accumulated into them, those values will not','line_number':52,'multiline':False]['text':' be written out.','line_number':53,'multiline':False]['text':' Remainder of K blocks. When K is not multiple of 4 the remaining k','line_number':54,'multiline':False]['text':' in 4x8 blocks are also random. this is also ok because the packed','line_number':55,'multiline':False]['text':' weights will be packed with zeros such that multiplication will result','line_number':56,'multiline':False]['text':' in zero.','line_number':57,'multiline':False]