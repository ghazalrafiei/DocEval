['text':' Owner(s): ["oncall: distributed"]','line_number':1,'multiline':False]['text':' Clamp the world size to 1 since these unit tests either exercise only','line_number':35,'multiline':False]['text':' the flattening logic or check sharding subroutines directly without','line_number':36,'multiline':False]['text':' requiring multiple ranks','line_number':37,'multiline':False]['text':' keep everything deterministic','line_number':54,'multiline':False]['text':' keep everything deterministic','line_number':65,'multiline':False]['text':' T x B x C','line_number':66,'multiline':False]['text':' T x B x C','line_number':67,'multiline':False]['text':' share the FFNs','line_number':75,'multiline':False]['text':' Check that flattened parameters have been replaced with a single','line_number':110,'multiline':False]['text':' `FlatParameter`','line_number':111,'multiline':False]['text':' Check that non-flattened parameters remain','line_number':115,'multiline':False]['text':' Check that calling `module.to()` affects the `FlatParameter`s','line_number':123,'multiline':False]['text':' keep everything deterministic','line_number':178,'multiline':False]['text':' keep everything deterministic','line_number':185,'multiline':False]['text':' recreate','line_number':296,'multiline':False]['text':' 0.weight','line_number':447,'multiline':False]['text':' 1.weight','line_number':448,'multiline':False]['text':' 2.weight','line_number':449,'multiline':False]['text':' For 32-bit full precision, FSDP pads up to 3 numel after each','line_number':455,'multiline':False]['text':' original parameter to achieve 0 mod 4 numel (i.e. 0 mod 16 bytes).','line_number':456,'multiline':False]['text':' Thus, the unsharded `FlatParameter` layout looks like:','line_number':457,'multiline':False]['text':'   21 + (3) + 35 + (1) + 25','line_number':458,'multiline':False]['text':' where (x) means x numel of padding. This gives a total of 85 numel.','line_number':459,'multiline':False]['text':' The `FlatParamShardMetadata` do not include alignment padding but do','line_number':461,'multiline':False]['text':' account for them','line_number':462,'multiline':False]['text':' Emulate rank 0 of 2 ranks','line_number':465,'multiline':False]['text':' 21 + (3) + 19 = 43','line_number':472,'multiline':False]['text':' Emulate rank 1 of 2 ranks','line_number':478,'multiline':False]['text':' 16 + (1) + 25 = 42','line_number':485,'multiline':False]['text':' 0.weight','line_number':496,'multiline':False]['text':' 1.weight','line_number':497,'multiline':False]['text':' 2.weight','line_number':498,'multiline':False]['text':' For 16-bit mixed precision, FSDP pads up to 7 numel after each','line_number':505,'multiline':False]['text':' original parameter to achieve 0 mod 8 numel (i.e. 0 mod 16 bytes).','line_number':506,'multiline':False]['text':' Thus, the unsharded `FlatParameter` layout looks like:','line_number':507,'multiline':False]['text':'   10 + (6) + 25 + (7) + 15','line_number':508,'multiline':False]['text':' where (x) means x numel of padding. This gives a total of 63 numel.','line_number':509,'multiline':False]['text':' The `FlatParamShardMetadata` do not include alignment padding but do','line_number':511,'multiline':False]['text':' account for them','line_number':512,'multiline':False]['text':' Emulate rank 0 of 2 ranks','line_number':515,'multiline':False]['text':' 10 + (6) + 16 = 32','line_number':522,'multiline':False]['text':' Emulate rank 1 of 2 ranks','line_number':528,'multiline':False]['text':' 9 + (7) + 15 = 31','line_number':535,'multiline':False]