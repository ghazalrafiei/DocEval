['text':' Owner(s): ["oncall: distributed"]','line_number':1,'multiline':False]['text':' the tensor parallel dimension is 0','line_number':43,'multiline':False]['text':' the data parallel dimension is 1','line_number':44,'multiline':False]['text':' a local model on meta device','line_number':47,'multiline':False]['text':' the col-wise parallel style shards the weight over tensor dim 0','line_number':49,'multiline':False]['text':' in most cases, the random number generator states is set by data loader','line_number':58,'multiline':False]['text':' in the following way:','line_number':59,'multiline':False]['text':'   - within a tensor parallel group, the RNG is set with the same seed','line_number':60,'multiline':False]['text':'   - across data parallel groups, the RNG is set with different seeds','line_number':61,'multiline':False]['text':' disable/enable parallel RNG feature','line_number':64,'multiline':False]['text':' initialize the model's local shard','line_number':67,'multiline':False]['text':' examine that the weights are initialized adhere to DP/TP','line_number':70,'multiline':False]['text':' check within the TP group','line_number':72,'multiline':False]['text':' the 1d mesh represents the TP group','line_number':73,'multiline':False]['text':' all-gather local shards','line_number':79,'multiline':False]['text':' compare local shards within the TP group','line_number':87,'multiline':False]['text':' each rank within a TP group shall initialize local weights differently','line_number':90,'multiline':False]['text':' without the parallel RNG, weight initialization violates the TP setup:','line_number':93,'multiline':False]['text':' each rank within a TP group has the same initial weights','line_number':94,'multiline':False]['text':' check across TP groups','line_number':99,'multiline':False]['text':' all-gather local shards','line_number':100,'multiline':False]['text':' compare local shards across TP groups','line_number':107,'multiline':False]['text':' local weights shall be initialized the same across TP groups','line_number':110,'multiline':False]['text':' without the parallel RNG, weight initialization violates the TP setup:','line_number':113,'multiline':False]['text':' local weights are initialized differently across TP groups due to different','line_number':114,'multiline':False]['text':' random seeds set in data loading.','line_number':115,'multiline':False]