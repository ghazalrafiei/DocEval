['text':' Copyright (c) Meta Platforms, Inc. and affiliates','line_number':1,'multiline':False]['text':' Owner(s): ["oncall: distributed"]','line_number':2,'multiline':False]['text':' test if addmm output is a partial','line_number':59,'multiline':False]['text':' test if result is the same as tensor','line_number':63,'multiline':False]['text':' backward checks','line_number':67,'multiline':False]['text':' backward','line_number':93,'multiline':False]['text':' mm(da, db) should return a _Partial tensor.','line_number':128,'multiline':False]['text':' transposing it should keep it _Partial','line_number':129,'multiline':False]['text':' check that the local and distributed op results match','line_number':134,'multiline':False]['text':' baddbmm introduces nan occasionally on CPU: https://github.com/pytorch/pytorch/issues/80588','line_number':140,'multiline':False]['text':' TODO: add test backward','line_number':171,'multiline':False]['text':' grad_dist_res = torch.ones_like(dist_res)','line_number':172,'multiline':False]['text':' dist_res.backward(grad_dist_res)','line_number':173,'multiline':False]['text':' self.assertIsNotNone(batch_1_dt.grad)','line_number':174,'multiline':False]['text':' batch_1_grad_local = batch_1_dt.grad.redistribute(','line_number':175,'multiline':False]['text':'     device_mesh, [Replicate()]','line_number':176,'multiline':False]['text':' ).to_local()','line_number':177,'multiline':False]['text':' self.assertEqual(batch_1_grad_local, batch_1_grad)','line_number':178,'multiline':False]['text':' If beta is 0, input tensor will be ignored','line_number':188,'multiline':False]['text':' zero-beta','line_number':190,'multiline':False]['text':' non-zero-beta','line_number':191,'multiline':False]['text':' test all combos','line_number':200,'multiline':False]['text':' test backward','line_number':227,'multiline':False]['text':' TODO: figure out (replicate, shard1) fail on backward','line_number':228,'multiline':False]['text':' it generates a different grad shape','line_number':229,'multiline':False]['text':' tests that currently pass','line_number':246,'multiline':False]