['text':'!/usr/bin/env python3','line_number':1,'multiline':False]['text':' Owner(s): ["oncall: r2p"]','line_number':2,'multiline':False]['text':' Copyright (c) Facebook, Inc. and its affiliates.','line_number':4,'multiline':False]['text':' All rights reserved.','line_number':5,'multiline':False]['text':'','line_number':6,'multiline':False]['text':' This source code is licensed under the BSD-style license found in the','line_number':7,'multiline':False]['text':' LICENSE file in the root directory of this source tree.','line_number':8,'multiline':False]['text':' one hot (by rank) tensor of size world_size','line_number':58,'multiline':False]['text':' example:','line_number':59,'multiline':False]['text':' rank 0, world_size 4 => [1, 0, 0, 0]','line_number':60,'multiline':False]['text':' rank 1, world_size 4 => [0, 1, 0, 0]','line_number':61,'multiline':False]['text':' ...','line_number':62,'multiline':False]['text':' after all_reduce t = tensor.ones(size=world_size)','line_number':65,'multiline':False]['text':' adding all elements in t should equal world_size','line_number':68,'multiline':False]