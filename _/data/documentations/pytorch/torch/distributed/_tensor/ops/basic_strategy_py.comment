['text':' parse einop equation and extract arg specs','line_number':27,'multiline':False]['text':' NOTE: only support at most two inputs, and single output','line_number':34,'multiline':False]['text':' extend to support more inputs if needed in future','line_number':35,'multiline':False]['text':' get a determinisitc order of all dim chars','line_number':52,'multiline':False]['text':' parse input and output dimensions','line_number':55,'multiline':False]['text':' parse einop equation and extract dims','line_number':98,'multiline':False]['text':' generate strategies for each mesh dim','line_number':104,'multiline':False]['text':' placement list stores placements of [output, input1, input2, ...]','line_number':108,'multiline':False]['text':' first we always have replicate all for inputs and output','line_number':109,'multiline':False]['text':' only replicate strategy for mesh dim with size 1','line_number':114,'multiline':False]['text':' TODO: see if this is valid for the submesh case','line_number':115,'multiline':False]['text':' split batch dim','line_number':118,'multiline':False]['text':' split contracting dim','line_number':128,'multiline':False]['text':' split lhs free dim','line_number':137,'multiline':False]['text':' this means split the lhs input and output','line_number':140,'multiline':False]['text':' i.e. S(0), R -> S(0)','line_number':141,'multiline':False]['text':' split rhs free dim','line_number':149,'multiline':False]['text':' linearity strategy','line_number':159,'multiline':False]['text':' generate strategies for entire mesh','line_number':168,'multiline':False]['text':' TODO: filter out invalid strategies, at this point we generate','line_number':171,'multiline':False]['text':' all possible strategies without considering the whether the tensor','line_number':172,'multiline':False]['text':' dim could be sharded or not, we would need to filter out invalid','line_number':173,'multiline':False]['text':' strategies base on the actual tensor shape','line_number':174,'multiline':False]['text':' (i.e. for Shard, tensor dim size must > mesh size)','line_number':175,'multiline':False]