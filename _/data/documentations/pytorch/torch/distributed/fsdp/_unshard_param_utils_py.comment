['text':' For sharded strategies, get the *unpadded* shard instead of','line_number':48,'multiline':False]['text':' the *padded* shard to persist user changes to the padding','line_number':49,'multiline':False]['text':' (though FSDP does not explicitly support this)','line_number':50,'multiline':False]['text':' For `NO_SHARD`, the `flat_param` or its gradient may be modified,','line_number':57,'multiline':False]['text':' so we write it back directly','line_number':58,'multiline':False]['text':' type: ignore[attr-defined]','line_number':62,'multiline':False]['text':' TODO: figure out the case for the composable APIs.','line_number':81,'multiline':False]['text':' TODO: figure out the case for the composable APIs.','line_number':96,'multiline':False]['text':' TODO: Rank 0 can broadcast the `FlatParameter` to allow all ranks to','line_number':142,'multiline':False]['text':' persist the changes.','line_number':143,'multiline':False]['text':' If handles are shared by other module(s), the handle may be already unsharded.','line_number':173,'multiline':False]['text':' No need to call `wait_stream()` since we unshard in the computation','line_number':193,'multiline':False]['text':' stream directly','line_number':194,'multiline':False]['text':' Free the unsharded flattened parameter early','line_number':201,'multiline':False]['text':' Unflatten the unsharded flattened parameters','line_number':210,'multiline':False]['text':' Invariant: rank == 0 or !rank0_only','line_number':212,'multiline':False]['text':' NOTE: Since PyTorch enforces that a parameter and its','line_number':215,'multiline':False]['text':' gradients need to match metadata (e.g. device), we must','line_number':216,'multiline':False]['text':' move gradients to CPU *after* we move parameters.','line_number':217,'multiline':False]['text':' NOTE: This assumes 1 `FlatParameter`','line_number':218,'multiline':False]['text':' TODO (awgu): The traversal function does not traverse through','line_number':253,'multiline':False]['text':' incompatible composable APIs. Verify if this is the desired','line_number':254,'multiline':False]['text':' behavior for this function.','line_number':255,'multiline':False]