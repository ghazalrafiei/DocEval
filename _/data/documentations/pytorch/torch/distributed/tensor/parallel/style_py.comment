['text':' Copyright (c) Meta Platforms, Inc. and affiliates','line_number':1,'multiline':False]['text':' colwise linear runtime sharding (desired sharding):','line_number':75,'multiline':False]['text':' 1. requires replicate input','line_number':76,'multiline':False]['text':' 2. shard output on last dim','line_number':77,'multiline':False]['text':' TODO: figure out dynamo support for instance method and switch this to instance method','line_number':83,'multiline':False]['text':' annotate module input placements/sharding with input_layouts','line_number':85,'multiline':False]['text':' transform the input layouts to the desired layouts of ColwiseParallel','line_number':90,'multiline':False]['text':' colwise shard weight/bias to Shard(0), weight be Shard(0)','line_number':97,'multiline':False]['text':' means Colwise as Linear is input * weight^T + bias, where','line_number':98,'multiline':False]['text':' weight would become Shard(1)','line_number':99,'multiline':False]['text':' colwise shard embedding.weight is straight forward as Shard(1)','line_number':106,'multiline':False]['text':' outputs is a shard on last dimension DTensor, i.e. Shard(-1)','line_number':120,'multiline':False]['text':' back to local tensor','line_number':122,'multiline':False]['text':' rowwise linear runtime sharding:','line_number':178,'multiline':False]['text':' 1. shard input on last dim','line_number':179,'multiline':False]['text':' 2. partial output, to replicate -> allreduce, to shard -> reduce_scatter','line_number':180,'multiline':False]['text':' Rowwise shard weight to Shard(1), bias to Replicate(), weight be Shard(1)','line_number':196,'multiline':False]['text':' means Rowwise as Linear is input * weight^T + bias, where','line_number':197,'multiline':False]['text':' weight would become Shard(0)','line_number':198,'multiline':False]['text':' back to local tensor if use_local_output is True','line_number':212,'multiline':False]['text':' type: ignore[misc, call-arg]','line_number':294,'multiline':False]['text':' type: ignore[misc, call-arg]','line_number':368,'multiline':False]