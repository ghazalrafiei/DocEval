['text':' Only include ShardedTensor when do type checking, exclude it','line_number':21,'multiline':False]['text':' from run-time to resolve circular dependency.','line_number':22,'multiline':False]['text':' Validate the sharding spec.','line_number':65,'multiline':False]['text':' TODO: support named dimension','line_number':66,'multiline':False]['text':' type: ignore[operator]','line_number':84,'multiline':False]['text':' type: ignore[index]','line_number':88,'multiline':False]['text':' generate ShardMetadata for each placement device','line_number':92,'multiline':False]['text':' type: ignore[index]','line_number':96,'multiline':False]['text':' type: ignore[index]','line_number':97,'multiline':False]['text':' relative imports to avoid circular dependency','line_number':120,'multiline':False]['text':' type: ignore[index]','line_number':138,'multiline':False]['text':' type: ignore[index]','line_number':142,'multiline':False]['text':' Reshape to get shard for this rank and we don't want autograd','line_number':147,'multiline':False]['text':' recording here for the narrow op and 'local_shard' should be a','line_number':148,'multiline':False]['text':' leaf variable in the autograd graph.','line_number':149,'multiline':False]['text':' type: ignore[index]','line_number':151,'multiline':False]['text':' for the last shard that might be smaller to other shards','line_number':152,'multiline':False]['text':' resize the narrowed tensor to the same size and use it for','line_number':153,'multiline':False]['text':' the scatter collective as dist.scatter requires same size','line_number':154,'multiline':False]['text':' inputs on every rank','line_number':155,'multiline':False]['text':' each rank should have local_tensor and local_metadata initialized if we build','line_number':167,'multiline':False]['text':' the metadata list in a correct way.','line_number':168,'multiline':False]['text':' Scatter the shards to all ranks in the pg','line_number':172,'multiline':False]['text':' scatter takes the global rank as ``src``','line_number':173,'multiline':False]['text':' detach again after receiving to ensure local shards remain a leaf node','line_number':186,'multiline':False]['text':' Sync requires_grad to local_shard.','line_number':189,'multiline':False]['text':' Manually set sharding_spec','line_number':199,'multiline':False]