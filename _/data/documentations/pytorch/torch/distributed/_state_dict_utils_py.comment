['text':' type: ignore[index]','line_number':23,'multiline':False]['text':' type: ignore[union-attr]','line_number':24,'multiline':False]['text':' TODO: should we use pytree?','line_number':62,'multiline':False]['text':' ShardedTensor does not seem to record the original device type.','line_number':146,'multiline':False]['text':' So if the tensor is moved to CPU, we won't know the original type.','line_number':147,'multiline':False]['text':' As a result, we have to rely on the user to tell us the correct one.','line_number':148,'multiline':False]['text':' FSDP all_gather: [Shard(0)] -> [Replicate()]','line_number':165,'multiline':False]['text':' HSDP all_gather: [Replicate(), Shard(0)] -> [Replicate(), Replicate()]','line_number':166,'multiline':False]['text':' 2D FSDP + TP all_gather:','line_number':167,'multiline':False]['text':' - [Shard(0), Shard(n)] -> [Replicate(), Replicate()]','line_number':168,'multiline':False]['text':' - [Shard(0), Replicate()] -> [Replicate(), Replicate()]','line_number':169,'multiline':False]