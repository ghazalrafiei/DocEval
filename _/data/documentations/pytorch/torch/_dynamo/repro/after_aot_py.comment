['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':52,'multiline':False]['text':'                           MAIN ENTRY POINT','line_number':53,'multiline':False]['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':54,'multiline':False]['text':' TODO: why do we need to deepcopy the original graph?','line_number':76,'multiline':False]['text':' Call the compiler_fn - which is either aot_autograd or inductor','line_number':81,'multiline':False]['text':' with fake inputs','line_number':82,'multiline':False]['text':' TODO: Failures here are troublesome because no real inputs,','line_number':85,'multiline':False]['text':' need a different serialization strategy','line_number':86,'multiline':False]['text':' We may run regular PyTorch compute that may trigger Dynamo, do NOT','line_number':103,'multiline':False]['text':' recursively attempt to accuracy minify in that case!','line_number':104,'multiline':False]['text':' This is a bit obscure: if we recursively try to accuracy minify','line_number':106,'multiline':False]['text':' the SAME function, this would trigger.  But most of the time','line_number':107,'multiline':False]['text':' we should never hit this branch','line_number':108,'multiline':False]['text':' Copy the tensor attrs like shape, stride etc by converting to Fake Tensor','line_number':122,'multiline':False]['text':' because inductor clears the tensor list in its codegen. And example_inputs','line_number':123,'multiline':False]['text':' are available only for the first invocation.','line_number':124,'multiline':False]['text':' Always dump the original module in case we have segfaults','line_number':131,'multiline':False]['text':' Call the compiled function with real inputs','line_number':157,'multiline':False]['text':' Call the compiled function with real inputs','line_number':161,'multiline':False]['text':' sync cuda kernels to ensure IMA detection','line_number':163,'multiline':False]['text':' type: ignore[attr-defined]','line_number':186,'multiline':False]['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':194,'multiline':False]['text':'                           DUMP REPROS','line_number':195,'multiline':False]['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':196,'multiline':False]['text':' get hint shape/stride when dynamic shape enabled','line_number':227,'multiline':False]['text':' TODO: improve these names with FQN','line_number':236,'multiline':False]['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':308,'multiline':False]['text':'                           DUMP MINIFIER','line_number':309,'multiline':False]['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':310,'multiline':False]['text':' TODO: factor this out','line_number':315,'multiline':False]['text':' with open(file_name, "r") as fd:','line_number':351,'multiline':False]['text':'     print(fd.read())','line_number':352,'multiline':False]['text':' print(f"Isolated test failed - {file_name}")','line_number':379,'multiline':False]['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':383,'multiline':False]['text':'                       MINIFIER TOOLS','line_number':384,'multiline':False]['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':385,'multiline':False]['text':' Ensures that segfaults are surfaced','line_number':397,'multiline':False]['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':440,'multiline':False]['text':'                           REPRO MAIN','line_number':441,'multiline':False]['text':' ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ #','line_number':442,'multiline':False]['text':' Invariant for graphs we generate with the repro script','line_number':446,'multiline':False]['text':' Turn mod into a GraphModule the slow way','line_number':479,'multiline':False]['text':' TODO: speed this up','line_number':480,'multiline':False]['text':' This might look inverted but it's not.  strict_accuracy means "we will','line_number':490,'multiline':False]['text':' minify any time we see anything that diverges", whereas accuracy is more','line_number':491,'multiline':False]['text':' conservative, and will only minify if there is a meaningful fp64','line_number':492,'multiline':False]['text':' divergence','line_number':493,'multiline':False]['text':' TODO: The logic for cloning inputs/models here is intentionally','line_number':555,'multiline':False]['text':' modeled off of run_fwd_maybe_bwd, but arguably it is better not to','line_number':556,'multiline':False]['text':' clone inputs (as you are doubling your effective GPU memory usage).','line_number':557,'multiline':False]['text':' It is certainly faster though!  It probably makes sense to let the','line_number':558,'multiline':False]['text':' user specify the offload strategy.','line_number':559,'multiline':False]['text':' type: ignore[has-type]','line_number':571,'multiline':False]['text':' NB: the module cast doesn't actually do anything, since there are no','line_number':623,'multiline':False]['text':' parameters/buffers on the module','line_number':624,'multiline':False]['text':' TODO: check eager determinism','line_number':644,'multiline':False]['text':' Now that we've saved everything, interp through the eager graph','line_number':652,'multiline':False]['text':' and do comparisons','line_number':653,'multiline':False]['text':' We don't really respect --accuracy vs --strict-accuracy here, it','line_number':695,'multiline':False]['text':' seems counterintuitive','line_number':696,'multiline':False]['text':' ensure segfaults are surfaced','line_number':707,'multiline':False]['text':' TODO: lazily load the inputs or something, rather than cloning them','line_number':710,'multiline':False]['text':' TODO: make this an option for --analyze too','line_number':859,'multiline':False]['text':' Run the repro in the context of minification, inverting exit code meaning','line_number':908,'multiline':False]