['text':' Input: X (logits), T (labels); Output: P (probs), Y','line_number':12,'multiline':False]['text':' Tensor with Shape [batch_size, num_classes]','line_number':21,'multiline':False]['text':' Tensor with shape [batch_size, ]','line_number':22,'multiline':False]['text':' Output 2 is scalar shape, so no dims added','line_number':33,'multiline':False]['text':' Input: X, T, P, dY; Output: dX','line_number':58,'multiline':False]['text':' Logits','line_number':65,'multiline':False]['text':' Labels / targets','line_number':66,'multiline':False]['text':' NOLINTNEXTLINE(cppcoreguidelines-init-variables)','line_number':68,'multiline':False]['text':' Probabilities from softmax','line_number':73,'multiline':False]['text':' Subtract max on each cell for numerical reasons','line_number':99,'multiline':False]['text':' TODO optimize','line_number':102,'multiline':False]['text':' Exponentiate','line_number':107,'multiline':False]['text':' Normalize','line_number':116,'multiline':False]['text':' Compute the avg cross-entropy loss','line_number':125,'multiline':False]['text':' Average loss','line_number':127,'multiline':False]['text':' NOLINTNEXTLINE(bugprone-narrowing-conversions,cppcoreguidelines-narrowing-conversions)','line_number':147,'multiline':False]['text':' Logits','line_number':165,'multiline':False]['text':' Labels / targets','line_number':166,'multiline':False]['text':' Input(2) is weights if given','line_number':167,'multiline':False]['text':' Probabilities from softmax','line_number':168,'multiline':False]['text':' Gradient w.r.t. avg loss','line_number':169,'multiline':False]['text':' NOLINTNEXTLINE(cppcoreguidelines-init-variables)','line_number':172,'multiline':False]['text':' Copy softmax probabilities into dX. All but the neuron','line_number':188,'multiline':False]['text':' corresponding to the correct label has gradient equaling e(x_j)','line_number':189,'multiline':False]['text':' which is the probability under softmax.','line_number':190,'multiline':False]['text':' NOLINTNEXTLINE(bugprone-narrowing-conversions,cppcoreguidelines-narrowing-conversions)','line_number':203,'multiline':False]['text':' Set gradient to zero for coordinates where we have dont care','line_number':217,'multiline':False]['text':' Add weight blob, if given','line_number':252,'multiline':False]['text':' namespace caffe2','line_number':266,'multiline':False]