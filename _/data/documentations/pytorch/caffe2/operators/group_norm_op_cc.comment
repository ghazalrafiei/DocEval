['text':' ------------------------------------------------------------------','line_number':1,'multiline':False]['text':' GroupNorm op in Caffe2 for CPU','line_number':2,'multiline':False]['text':' Written by Kaiming He','line_number':3,'multiline':False]['text':' Improved by Xiaomeng Yang','line_number':4,'multiline':False]['text':' see https://arxiv.org/abs/1803.08494','line_number':5,'multiline':False]['text':' This is a stand-alone op: Y = gamma * (X - mu) / sig + beta','line_number':6,'multiline':False]['text':' ------------------------------------------------------------------','line_number':7,'multiline':False]['text':' Math:','line_number':15,'multiline':False]['text':' Y = gamma * (X - mu) * rsig + beta','line_number':16,'multiline':False]['text':' let s = gamma * rsig','line_number':17,'multiline':False]['text':' let b = beta - gamma * mu * rsig','line_number':18,'multiline':False]['text':' Y = s * X + b','line_number':19,'multiline':False]['text':' let n = K * HxW','line_number':20,'multiline':False]['text':' dL/dX = dL/dY * dY/dX = dL/dY * (d(s * X)/dX + db/dX)','line_number':21,'multiline':False]['text':' d(s * X)/dX = s + X * ds/dX = s + gamma * X * drsig/dX','line_number':22,'multiline':False]['text':' db/dX = -gamma * u * drsig/dX - gamma * rsig * dmu/dX','line_number':23,'multiline':False]['text':' drsig/dX = -rsig^3 * (X - mu) / n','line_number':24,'multiline':False]['text':' dmu/dX = 1 / n','line_number':25,'multiline':False]['text':' namespace','line_number':216,'multiline':False]['text':' Math:','line_number':316,'multiline':False]['text':' let: s = gamma * rsig','line_number':317,'multiline':False]['text':' let: b = beta - mu * gamma * rsig','line_number':318,'multiline':False]['text':' then: Y = s * X + b','line_number':319,'multiline':False]['text':' Warning: mu and rsig are for backward usage or reference. They should NOT be','line_number':437,'multiline':False]['text':' used as forward activations as they have no direct gradients computed.','line_number':438,'multiline':False]['text':' Input: X, gamma, beta; Output: Y, mu, sig','line_number':440,'multiline':False]['text':'arxiv.org/abs/1803.08494','line_number':445,'multiline':False]['text':' Input: dY, X, gamma, beta, mu, sig; Output: dX, dgamma, dbeta','line_number':477,'multiline':False]['text':' NOLINTNEXTLINE(cppcoreguidelines-avoid-non-const-global-variables,cppcoreguidelines-avoid-magic-numbers)','line_number':478,'multiline':False]['text':' namespace','line_number':494,'multiline':False]['text':' namespace caffe2','line_number':498,'multiline':False]