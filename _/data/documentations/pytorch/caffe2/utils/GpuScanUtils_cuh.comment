['text':' from the cutorch library; can probably be replaced with their CUB','line_number':8,'multiline':False]['text':' equivalents','line_number':9,'multiline':False]['text':' Collection of in-kernel scan / prefix sum utilities','line_number':10,'multiline':False]['text':' Inclusive prefix sum using shared memory','line_number':12,'multiline':False]['text':' FIXME: this is a slow, simple implementation; need up/down sweep,','line_number':15,'multiline':False]['text':' prevent smem conflicts','line_number':16,'multiline':False]['text':' Prevent write-after-read dependencies on smem usage above if necessary','line_number':38,'multiline':False]['text':' Exclusive prefix sum using shared memory','line_number':44,'multiline':False]['text':' FIXME: crappy implementation','line_number':47,'multiline':False]['text':' We kill write-after-read dependencies separately below, hence the `false`','line_number':48,'multiline':False]['text':' Prevent write-after-read dependencies on smem usage above if necessary','line_number':54,'multiline':False]['text':' Inclusive prefix sum for binary vars using intra-warp voting +','line_number':60,'multiline':False]['text':' shared memory','line_number':61,'multiline':False]['text':' Within-warp, we use warp voting.','line_number':64,'multiline':False]['text':' USE_ROCM','line_number':74,'multiline':False]['text':' Per each warp, write out a value','line_number':78,'multiline':False]['text':' Sum across warps in one thread. This appears to be faster than a','line_number':85,'multiline':False]['text':' warp shuffle scan for CC 3.0+','line_number':86,'multiline':False]['text':' load the carry from the preceding warp','line_number':98,'multiline':False]['text':' Exclusive prefix sum for binary vars using intra-warp voting +','line_number':110,'multiline':False]['text':' shared memory','line_number':111,'multiline':False]['text':' Inclusive to exclusive','line_number':116,'multiline':False]['text':' The outgoing carry for all threads is the last warp's sum','line_number':119,'multiline':False]['text':' USE_ROCM','line_number':124,'multiline':False]['text':' namespace caffe2','line_number':131,'multiline':False]['text':' CAFFE2_UTILS_GPU_SCAN_UTILS_H_','line_number':133,'multiline':False]