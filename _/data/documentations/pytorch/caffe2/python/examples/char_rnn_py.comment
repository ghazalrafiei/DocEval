['text':'# @package char_rnn','line_number':1,'multiline':False]['text':' Module caffe2.python.examples.char_rnn','line_number':2,'multiline':False]['text':' Default set() here is intentional as it would accumulate values like a global','line_number':29,'multiline':False]['text':' variable','line_number':30,'multiline':False]['text':' noqa','line_number':31,'multiline':False]['text':' axis is 2 as first two are T (time) and N (batch size).','line_number':81,'multiline':False]['text':' We treat them as one big batch of size T * N','line_number':82,'multiline':False]['text':' Create a copy of the current net. We will use it on the forward','line_number':88,'multiline':False]['text':' pass where we don't need loss and backward operators','line_number':89,'multiline':False]['text':' Loss is average both across batch and through time','line_number':93,'multiline':False]['text':' Thats why the learning rate below is multiplied by self.seq_length','line_number':94,'multiline':False]['text':' use build_sdg function to build an optimizer','line_number':98,'multiline':False]['text':' As though we predict the same probability for each character','line_number':123,'multiline':False]['text':' We split text into batch_size pieces. Each piece will be used only','line_number':130,'multiline':False]['text':' by a corresponding batch during the training process','line_number':131,'multiline':False]['text':' Writing to output states which will be copied to input','line_number':139,'multiline':False]['text':' states within the loop below','line_number':140,'multiline':False]['text':' We iterate over text in a loop many times. Each time we peak','line_number':149,'multiline':False]['text':' seq_length segment and feed it to LSTM as a sequence','line_number':150,'multiline':False]['text':' Given a starting symbol we feed a fake sequence of size 1 to','line_number':218,'multiline':False]['text':' our RNN num_character times. After each time we use output','line_number':219,'multiline':False]['text':' probabilities to pick a next character to feed to the network.','line_number':220,'multiline':False]['text':' Same character becomes part of the output','line_number':221,'multiline':False]