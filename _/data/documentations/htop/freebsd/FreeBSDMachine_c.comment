['text':'
htop - FreeBSDMachine.c
(C) 2014 Hisham H. Muhammad
Released under the GNU GPLv2+, see the COPYING file
in the source distribution for its full text.
','line_number':1,'multiline':True]['text':' IWYU pragma: keep','line_number':8,'multiline':False]['text':' needs to be included before <sys/jail.h> for MAXPATHLEN','line_number':19,'multiline':False]['text':' physical memory in system: hw.physmem','line_number':64,'multiline':False]['text':' physical page size: hw.pagesize','line_number':65,'multiline':False]['text':' usable pagesize : vm.stats.vm.v_page_size','line_number':66,'multiline':False]['text':' usable page count vm.stats.vm.v_page_count','line_number':74,'multiline':False]['text':' actually usable memory : vm.stats.vm.v_page_count * vm.stats.vm.v_page_size','line_number':75,'multiline':False]['text':' fetch initial single (or average) CPU clicks from kernel','line_number':115,'multiline':False]['text':' on smp box, fetch rest of initial CPU's clicks','line_number':118,'multiline':False]['text':' TODO: support offline CPUs and hot swapping','line_number':128,'multiline':False]['text':' on smp we need CPUs + 1 to store averages too (as kernel kindly provides that as well)','line_number':134,'multiline':False]['text':'sane default for kernel provided CPU percentage scaling, at least on x86 machines, in case this sysctl call failed','line_number':140,'multiline':False]['text':' actual CPU count','line_number':173,'multiline':False]['text':' max iteration (in case we have average + smp)','line_number':174,'multiline':False]['text':' old clicks state','line_number':181,'multiline':False]['text':' current clicks state','line_number':182,'multiline':False]['text':' get averages or single CPU clicks','line_number':187,'multiline':False]['text':' get rest of CPUs','line_number':191,'multiline':False]['text':' on smp systems FreeBSD kernel concats all CPU states into one long array in','line_number':193,'multiline':False]['text':' kern.cp_times sysctl OID','line_number':194,'multiline':False]['text':' we store averages in this->cpus[0], and actual cores after that','line_number':195,'multiline':False]['text':' single CPU box','line_number':203,'multiline':False]['text':' average','line_number':208,'multiline':False]['text':' specific smp cores','line_number':212,'multiline':False]['text':' diff old vs new','line_number':219,'multiline':False]['text':' totals','line_number':229,'multiline':False]['text':' save current state as old and calc percentages','line_number':235,'multiline':False]['text':' this one is not really used','line_number':247,'multiline':False]['text':'cpuData->idlePercent      = cp_time_p[CP_IDLE];','line_number':248,'multiline':False]['text':' TODO: test with hyperthreading and multi-cpu systems','line_number':257,'multiline':False]['text':' convert from deci-Kelvin to Celsius','line_number':265,'multiline':False]['text':' TODO: test with hyperthreading and multi-cpu systems','line_number':268,'multiline':False]['text':' keep in MHz','line_number':276,'multiline':False]['text':' calculate max temperature and avg frequency for average meter and','line_number':280,'multiline':False]['text':' propagate frequency to all cores if only supplied for CPU 0','line_number':281,'multiline':False]['text':' @etosan:','line_number':313,'multiline':False]['text':' memory counter relationships seem to be these:','line_number':314,'multiline':False]['text':'  total = active + wired + inactive + cache + free','line_number':315,'multiline':False]['text':'  htop_used (unavail to anybody) = active + wired','line_number':316,'multiline':False]['text':'  htop_cache (for cache meter)   = buffers + cache','line_number':317,'multiline':False]['text':'  user_free (avail to procs)     = buffers + inactive + cache + free','line_number':318,'multiline':False]['text':'','line_number':319,'multiline':False]['text':' with ZFS ARC situation becomes bit muddled, as ARC behaves like "user_free"','line_number':320,'multiline':False]['text':' and belongs into cache, but is reported as wired by kernel','line_number':321,'multiline':False]['text':'','line_number':322,'multiline':False]['text':' htop_used   = active + (wired - arc)','line_number':323,'multiline':False]['text':' htop_cache  = buffers + cache + arc','line_number':324,'multiline':False]['text':'disabled for now, as it is always smaller than phycal amount of memory...','line_number':331,'multiline':False]['text':'...to avoid "where is my memory?" questions','line_number':332,'multiline':False]['text':'sysctl(MIB_vm_stats_vm_v_page_count, 4, &(super->totalMem), &len, NULL, 0);','line_number':333,'multiline':False]['text':'super->totalMem *= this->pageSizeKb;','line_number':334,'multiline':False]['text':' TODO: support offline CPUs and hot swapping','line_number':389,'multiline':False]